!function(e){function t(t){for(var r,a,s=t[0],c=t[1],u=t[2],h=0,d=[];h<s.length;h++)a=s[h],Object.prototype.hasOwnProperty.call(i,a)&&i[a]&&d.push(i[a][0]),i[a]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);for(l&&l(t);d.length;)d.shift()();return o.push.apply(o,u||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],r=!0,s=1;s<n.length;s++){var c=n[s];0!==i[c]&&(r=!1)}r&&(o.splice(t--,1),e=a(a.s=n[0]))}return e}var r={},i={2:0},o=[];function a(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=r,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(n,r,function(t){return e[t]}.bind(null,r));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="";var s=window.webpackJsonp=window.webpackJsonp||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var u=0;u<s.length;u++)t(s[u]);var l=c;o.push([1625,0]),n()}({1:function(e,t,n){"use strict";var r=n(30),i=n.n(r),o=(n(236),n(323),n(324),n(325),n(150)),a=n.n(o),s=n(4);i.a.Topic=function(){var e={},t={},n=s.a.topics||i.a.noop;function r(r){return t.hasOwnProperty(r)||function(r){var o=i.a.Callbacks("memory unique");n("new %c%s","font-weight: bold",r),o.add(function(t){e[r]=t,n("update %c%s %c%o","font-weight: bold",r,"color: black",t)}),t[r]={observe:function(e){return o.add(e),this},put:function(t,n){var i=e[r];return(i!=t||n)&&o.fire(t,i),this},assign:function(t){var n=e[r];return o.fire(a()(n,t),n),this},apply:function(t){var n=e[r];o.fire(t(n),n)},unobserve:function(e){return o.remove(e),this},get:function(){return e[r]},getPromise:function(){return new Promise(function(e){o.add(function t(n,r){e(n,r),o.remove(t)})})},discard:function(){t[r]=e[r]=void 0}}}(r),t[r]}return r.dump=function(){return e},r};t.a=i.a},100:function(e,t,n){"use strict";var r="topic/SET";n.d(t,"a",function(){return o}),n.d(t,"c",function(){return a}),n.d(t,"d",function(){return s}),n.d(t,"b",function(){return c});var i=r.length+1;function o(e){return"".concat(r,"/").concat(e)}function a(e){return e.slice(i)}function s(e){return"".concat(e," (old)")}function c(e){return e.startsWith(r)}},101:function(e,t,n){"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function i(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function o(e){return o=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},o(e)}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}function s(e,t){return s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},s(e,t)}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function h(e,t,n){return t&&l(e.prototype,t),n&&l(e,n),e}n.d(t,"b",function(){return f}),n.d(t,"a",function(){return m}),n.d(t,"c",function(){return b});var d=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;u(this,e),this.symbol=t,this.topic=n.put(t),this.fails=r}return h(e,[{key:"connected",value:function(){return this}},{key:"disconnected",value:function(){return this}},{key:"ok",value:function(){return this}},{key:"fail",value:function(){return this}},{key:"state",get:function(){return this.symbol}}]),e}(),f=Symbol("Online"),p=function(e){function t(){var e,n;u(this,t);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return n=i(this,(e=o(t)).call.apply(e,[this,t.symbol].concat(a))),n.fails=0,n}return a(t,e),h(t,[{key:"ok",value:function(){return this.fails=0,this}},{key:"fail",value:function(e){return this.fails+=1,this.fails>e?this.disconnected():this}},{key:"disconnected",value:function(){return new v(this.topic,this.fails)}}]),t}(d);c(p,"symbol",f);var m=Symbol("Offline"),v=function(e){function t(){var e;u(this,t);for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return i(this,(e=o(t)).call.apply(e,[this,t.symbol].concat(r)))}return a(t,e),h(t,[{key:"ok",value:function(){return this.connected()}},{key:"connected",value:function(){return new p(this.topic)}}]),t}(d);c(v,"symbol",m);var b=function(){function e(t){var n=this,r=t.fails,i=void 0===r?3:r,o=t.heartbeat,a=void 0===o?Function.prototype:o,s=t.interval,c=void 0===s?1e4:s,l=t.topic;u(this,e);var h=function(){n.connState=n.connState.ok()},d=function(){n.connState=n.connState.fail(i)};this.connState=new p(l),this.heartbeat=function(){setTimeout(function(){a().then(h,d),n.heartbeat()},c)}}return h(e,[{key:"state",get:function(){return this.connState.state}}]),e}()},11:function(e,t,n){"use strict";var r=n(30),i=n.n(r),o=(n(282),n(10)),a=n.n(o),s=n(6),c=n.n(s),u=n(56),l=n.n(u);function h(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var p=Number.MAX_SAFE_INTEGER,m=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;d(this,e),f(this,"key",void 0),f(this,"value",void 0),f(this,"parent",void 0),f(this,"subs",void 0),this.key=t,this.value=n,this.parent=null,this.subs=[]},v=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];d(this,e),f(this,"nelem",void 0),f(this,"root",void 0),Object.defineProperties(this,{nelem:{writable:!0,enumerable:!1,value:0}}),this.root=new m;for(var n=0;n<t.length;n+=1){var r=t[n],i=r.key,o=r.value;this.push(i,o)}}var t,n,r;return t=e,n=[{key:"push",value:function(t,n){var r=new m(t,n);return this.root=e.meld(this.root,r),this.nelem+=1,r}},{key:"pop",value:function(){var t=this.root,n=t.subs,r=t.value;return this.root=e.pair(n),this.nelem-=1,r}},{key:"decreaseKey",value:function(t,n){if(n.key-=t,n.parent){var r=n.parent,i=r.subs,o=i.indexOf(n);o>0&&(i.splice(o,1),e.meld(this.root,n))}}},{key:"remove",value:function(e){this.decreaseKey(1/0,e),this.pop()}},{key:"length",get:function(){return this.nelem}}],r=[{key:"meld",value:function(e,t){return e.key?t.key?(e.key<t.key?(n=e,r=t):(n=t,r=e),r.parent=n,n.subs.splice(0,0,r),n):e:t;var n,r}},{key:"pair",value:function(t){return t.length?t.reduce(e.meld):new m}}],n&&h(t.prototype,n),r&&h(t,r),e}(),b=n(73);function y(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function g(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function k(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var O=5,w=10,S=100,j=1e3,_=Symbol("queued"),P=Symbol("running"),C={jqXhr:{status:0},error:"Aborted while requesting"},E={jqXhr:{status:0},error:"Aborted while waiting"},x=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),k(this,"count",0),k(this,"limit",0),k(this,"queue",new v),k(this,"pending",!1),k(this,"next",function(){if(n.pending=!0,0===n.queue.length||n.count>=n.limit)n.pending=!1;else{n.busy();var e=n.queue.pop(),t=e.fn,r=e.args,i=e.resolve,o=e.reject,a=t.apply(void 0,y(r));e.setAbort(function(){return a.abort()}),e.state=P,a.then(i,o).then(n.done,n.done).then(n.tick,n.tick),n.tick()}}),k(this,"tick",function(){return setTimeout(n.next,0)}),k(this,"busy",function(){n.count+=1}),k(this,"done",function(){n.count-=1}),this.limit=t}var t,n,r;return t=e,n=[{key:"push",value:function(e,t){for(var n=this,r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];return new b.a(function(r,o,a){var s={args:i,abort:Function.prototype,fn:t,instance:null,resolve:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};r({data:e,status:n.status,jqXhr:n})},reject:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(arguments.length>1&&arguments[1],arguments.length>2?arguments[2]:void 0);return o({error:t,status:e.status,jqXhr:e})},setAbort:function(e){s.abort=e.bind(null,C)},state:_},c=n.queue.push(e,s);a(function(){c.value.state===P?c.value.abort(C):(c.value.reject(E),n.queue.remove(c))}),n.pending||n.tick()})}}],n&&g(t.prototype,n),r&&g(t,r),e}(),T=n(39),A=n(5),I=n(13);function D(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function L(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function M(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}n.d(t,"s",function(){return q}),n.d(t,"G",function(){return U}),n.d(t,"r",function(){return Y}),n.d(t,"n",function(){return W}),n.d(t,"q",function(){return G}),n.d(t,"U",function(){return X}),n.d(t,"f",function(){return K}),n.d(t,"e",function(){return Z}),n.d(t,"g",function(){return J}),n.d(t,"w",function(){return Q}),n.d(t,"u",function(){return ee}),n.d(t,"v",function(){return te}),n.d(t,"i",function(){return ne}),n.d(t,"b",function(){return re}),n.d(t,"B",function(){return ie}),n.d(t,"l",function(){return oe}),n.d(t,"j",function(){return ae}),n.d(t,"k",function(){return se}),n.d(t,"K",function(){return ce}),n.d(t,"p",function(){return ue}),n.d(t,"A",function(){return le}),n.d(t,"T",function(){return he}),n.d(t,"W",function(){return de}),n.d(t,"S",function(){return fe}),n.d(t,"o",function(){return pe}),n.d(t,"z",function(){return me}),n.d(t,"F",function(){return ve}),n.d(t,"O",function(){return be}),n.d(t,"Q",function(){return ye}),n.d(t,"J",function(){return ge}),n.d(t,"a",function(){return ke}),n.d(t,"N",function(){return Oe}),n.d(t,"y",function(){return we}),n.d(t,"M",function(){return Se}),n.d(t,"P",function(){return je}),n.d(t,"C",function(){return _e}),n.d(t,"d",function(){return Pe}),n.d(t,"x",function(){return Ce}),n.d(t,"V",function(){return Ee}),n.d(t,"L",function(){return xe}),n.d(t,"t",function(){return Te}),n.d(t,"E",function(){return Ae}),n.d(t,"D",function(){return Ie}),n.d(t,"H",function(){return De}),n.d(t,"R",function(){return Le}),n.d(t,"c",function(){return Me}),n.d(t,"h",function(){return $e}),n.d(t,"I",function(){return Re}),n.d(t,"m",function(){return Be});var R=l()(/^hosts\//,""),B="VIEW_MODE_FULL",N={getHostVer:a()("product/version"),getLangs:a()("languages"),getUUID:a()("uuid"),getHost:a()("hosts/${hostname}"),getCams:a()("video-origins/${hostname}"),getCam:a()("video-origins/${vsid}"),getSources:a()("video-sources/${ref}"),getBookmarks:a()("archive/contents/bookmarks/${host}/${endtime}/${begintime}?"),toggleProtectedBookmark:a()("archive/contents/bookmarks"),deleteRecord:a()("archive/contents/bookmarks?"),deleteBookmark:a()("archive/contents/bookmarks"),editBookmark:a()("archive/contents/bookmarks"),findCams:a()("camera/list"),getVideoJar:a()("jar/cambozola.jar"),getLive:a()("live/media/${vsid}?"),close:a()("live/media/${vsid}"),getSnapshot:a()("live/media/snapshot/${vsid}?"),getArchiveList:a()("archive/list/${vsid}"),getArchive:a()("archive/media/${vsid}/${begintime}?"),stopArchive:a()("archive/media/stop/${uuid}"),getArchiveContent:a()("archive/contents/intervals/${vsid}/${endtime}/${begintime}"),getArchiveFrames:a()("archive/contents/frames/${vsid}/${endtime}/${begintime}"),postExport:a()("export/${mode}/${vsid}/${begintime}/${endtime}?"),getExport:a()("${location}/status"),stopExport:a()("${location}"),urlExport:a()("${location}/file?name=${file}"),getEvents:a()("archive/events/${source}/${vsid}/${endtime}/${begintime}?limit_to_archive=1&archive=${archive}"),getTelemetry:a()("control/telemetry/list/${objid}"),getPtzSession:a()("control/telemetry/session/acquire/${tcid}"),releasePtzSession:a()("control/telemetry/session/release/${tcid}"),keepPtzSession:a()("control/telemetry/session/keepalive/${tcid}"),getDegrees:a()("control/telemetry/info/${tcid}"),setMove:a()("control/telemetry/move/${tcid}"),setZoom:a()("control/telemetry/zoom/${tcid}"),setFocus:a()("control/telemetry/focus/${tcid}"),setIris:a()("control/telemetry/iris/${tcid}"),pointMove:a()("control/telemetry/move/point/${tcid}"),areaZoom:a()("control/telemetry/zoom/area/${tcid}"),setAuto:a()("control/telemetry/auto/${tcid}"),getPresets:a()("control/telemetry/preset/info/${tcid}"),goPreset:a()("control/telemetry/preset/go/${tcid}"),setPreset:a()("control/telemetry/preset/set/${tcid}"),removePreset:a()("control/telemetry/preset/remove/${tcid}"),getPosition:a()("control/telemetry/position/${tcid}"),getLayouts:a()("layouts"),statistics:a()("statistics/${obj}"),batchStatistics:a()("statistics"),sse:a()("eventchannel"),archsearch:a()("search/${type}/${begintime}/${endtime}"),facesearch:a()("search/${type}/${begintime}/${endtime}"),getSearchResults:a()("${location}/result?"),stopSearch:a()("${location}"),grpc:a()("grpc"),getAvailableGroups:a()("group"),getMaps:a()("v1/maps?"),getMapImage:a()("v1/maps/image?"),getMapMarkers:a()("v1/maps/markers?")},F=c()([I.c,i.a.param,decodeURIComponent]),z=250,V=new x(5);function H(e){var t=e.url,n=e.data,r=void 0===n?{}:n,o=e.type,a=void 0===o?"GET":o,s=e.dataType,c=e.contentType,u=e.priority,l=void 0===u?S:u,h=e.timeout,d=void 0===h?0:h,f="",p=t,m=T.b.authToken;return"POST"===a?(p=Object(T.a)(p),f=JSON.stringify(r)):f=F(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?L(n,!0).forEach(function(t){M(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):L(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},r,{authToken:m})),V.push(l,i.a.ajax,{url:p,type:a,data:f,dataType:s,contentType:c,timeout:d})}function q(){return H({url:N.getHostVer()})}function U(){var e={url:N.getLangs(),priority:j};return H(e)}function Y(e){var t={url:N.getHost({hostname:e})};return H(t)}function W(e){var t=e.host,n=e.begintime,r=e.endtime,i={url:N.getBookmarks({host:t,begintime:Object(A.k)(n),endtime:Object(A.j)(r)})};return H(i)}function G(e){var t=e.begintime,n=e.endtime,r=e.origin,i=e.accessPoint,o=e.maskSize,a={access_point:i,camera_ID:r,dt_posix_start_time:Object(A.k)(t),dt_posix_end_time:Object(A.j)(n),mask_size:o,result_type:"RESULT_TYPE_IMAGE"},s={type:"POST",contentType:"application/json",url:N.grpc(),data:{method:"axxonsoft.bl.heatmap.HeatMapService.BuildHeatmap",data:a,result_type:"RESULT_TYPE_IMAGE"}};return H(s)}function X(e){var t={type:"POST",contentType:"application/json",url:N.toggleProtectedBookmark(),data:e};return H(t)}function K(e){var t={type:"DELETE",contentType:"application/json",url:N.deleteRecord()+F.apply(void 0,D(e))};return H(t)}function Z(e){var t={type:"POST",contentType:"application/json",url:N.deleteBookmark(),data:e};return H(t)}function J(e){var t={type:"POST",contentType:"application/json",url:N.editBookmark(),data:e};return H(t)}function Q(){return H({url:N.getMaps()+F({view:B})})}function ee(e){var t=e.mapId;return H({url:N.getMapImage()+F({map_id:t})})}function te(e){var t=e.mapId;return H({url:N.getMapMarkers()+F({map_id:t})})}function ne(e){var t=e.filter,n=e.next,r=e.limit,i={url:N.findCams(),data:{filter:t,limit:r,next_page:n},priority:O};return H(i)}function re(e){var t={type:"POST",contentType:"application/json",url:N.batchStatistics(),data:e};return H(t)}function ie(){var e={dataType:"buffer",url:function(e,t){var n=e.w,r=e.h,i=e.vsid;return N.getSnapshot({vsid:R(i)})+F({w:n,h:r,_:t||Date.now(),authToken:T.b.authToken})}.apply(void 0,arguments),timeout:A.i};return H(e)}function oe(e){var t={url:N.getArchiveList({vsid:R(e)})};return H(t)}function ae(e){var t=e.vsid,n=e.begintime,r=e.endtime,i=e.archive,o=e.offset,a=e.limit,s=void 0===a?z:a,c=e.scale,u=void 0===c?1:c,l={url:N.getArchiveContent({vsid:R(t),begintime:Object(A.k)(n),endtime:Object(A.j)(r)}),data:{archive:i,limit:s,offset:o,scale:u}};return H(l)}function se(e){var t=e.vsid,n=e.direction,r=e.timestamp,i=e.archive,o=e.limit,a=void 0===o?z:o,s=n>0?{endtime:"future",begintime:Object(A.k)(r)}:{endtime:"past",begintime:Object(A.j)(r)},c=s.begintime,u=s.endtime,l={url:N.getArchiveFrames({vsid:R(t),begintime:c,endtime:u}),dataType:"json",data:{archive:i,limit:a}};return H(l)}function ce(e){var t=e.vsid,n=e.isLive,r=e.extended,i=e.begintime,o=e.endtime,a=e.archive,s={type:"POST",data:r,contentType:"application/json",url:N.postExport({mode:n?"live":"archive",vsid:R(t),begintime:Object(A.k)(i),endtime:Object(A.j)(o)})+F({archive:a})};return H(s)}function ue(e){var t=e.location,n=e.archive,r={url:N.getExport({location:t}),data:{archive:n}};return H(r)}function le(e){var t=e.location,n={url:N.getSearchResults({location:t})};return H(n)}function he(e){var t=e.location,n={type:"DELETE",url:N.stopSearch({location:t})};return H(n)}function de(e){var t=e.location,n=e.file;return c()([N.urlExport,T.a])({location:t,file:n})}function fe(e){var t=e.location,n={type:"DELETE",url:N.stopExport({location:t})};return H(n)}function pe(e){var t=e.source,n=void 0===t?"detectors":t,r=e.vsid,i=e.begintime,o=e.endtime,a=e.limit,s=void 0===a?z:a,c=e.offset,u=void 0===c?0:c,l=e.archive,h={url:N.getEvents({source:n,vsid:R(r),begintime:Object(A.k)(i),endtime:Object(A.j)(o),archive:l}),data:{limit:s,offset:u},priority:j};return H(h)}function me(e){var t=e.session_priority,n=void 0===t?1:t,r=e.tcid,i={url:N.getPtzSession({tcid:R(r)}),data:{session_priority:n}};return H(i)}function ve(e){var t=e.session_id,n=e.tcid,r={type:"HEAD",url:N.keepPtzSession({tcid:R(n)}),data:{session_id:t}};return H(r)}function be(e){var t=e.mode,n=e.pan,r=e.tilt,i=e.session_id,o=e.tcid,a={url:N.setMove({tcid:R(o)}),data:{mode:t,pan:n,tilt:r,session_id:i}};return H(a)}function ye(e){var t=e.mode,n=e.zoom,r=e.session_id,i=e.tcid,o={url:N.setZoom({tcid:R(i)}),data:{mode:t,value:n,session_id:r}};return H(o)}function ge(e){var t=e.x,n=e.y,r=e.session_id,i=e.tcid,o={url:N.pointMove({tcid:R(i)}),data:{x:t,y:n,session_id:r}};return H(o)}function ke(e){var t=e.x,n=e.y,r=e.w,i=e.h,o=e.session_id,a=e.tcid,s={url:N.areaZoom({tcid:R(a)}),data:{x:t,y:n,w:r,h:i,session_id:o}};return H(s)}function Oe(e){var t=e.degree,n=void 0===t?"focus":t,r=e.session_id,i=e.tcid,o={url:N.setAuto({tcid:R(i)}),data:{degree:n,session_id:r}};return H(o)}function we(e){var t={url:N.getPresets({tcid:R(e)})};return H(t)}function Se(e){var t=e.pos,n=e.session_id,r=e.tcid,i={url:N.removePreset({tcid:R(r)}),data:{pos:t,session_id:n}};return H(i)}function je(e){var t=e.pos,n=e.label,r=e.session_id,i=e.tcid,o={url:N.setPreset({tcid:R(i)}),data:{pos:t,label:n,session_id:r}};return H(o)}function _e(e){var t=e.pos,n=e.session_id,r=e.tcid,i={url:N.goPreset({tcid:R(r)}),data:{pos:t,session_id:n}};return H(i)}function Pe(e){var t={type:"POST",contentType:"application/json",url:N.grpc(),data:{method:"axxonsoft.bl.layout.LayoutManager.Update",data:{created:e}}};return H(t)}function Ce(e){var t={url:N.getPosition({tcid:R(e)})};return H(t)}function Ee(e){var t={type:"POST",contentType:"application/json",url:N.grpc(),data:{method:"axxonsoft.bl.layout.LayoutManager.Update",data:{modified:e}}};return H(t)}function xe(e){var t={type:"POST",contentType:"application/json",url:N.grpc(),data:{method:"axxonsoft.bl.layout.LayoutManager.Update",data:{removed:e}}};return H(t)}function Te(){return H({url:N.getLayouts()})}function Ae(e){var t=e.type,n=e.begintime,r=e.endtime,i=e.query,o=void 0===i?{}:i,a={type:"POST",url:N.archsearch({type:t,begintime:Object(A.k)(n),endtime:Object(A.j)(r)}),data:Object(I.c)(o),contentType:"application/json"};return H(a)}function Ie(e){var t=e.type,n=e.begintime,r=e.endtime,i=e.query,o={type:"POST",url:N.facesearch({type:t,begintime:Object(A.k)(n),endtime:Object(A.j)(r)}),data:Object(I.c)(i),contentType:"application/json"};return H(o)}function De(){var e,t,n=!0,r="/statistics/webserver";document.execCommand("ClearAuthenticationCache"),(e=new XMLHttpRequest,t=i.a.Deferred(),e.addEventListener("loadend",t.resolve),e.open("GET",r,n,"\0","\0"),e.send(),t).then(function(){var e=new XMLHttpRequest,t=i.a.Deferred();return e.addEventListener("loadend",t.resolve),e.open("GET",r,n,"",""),e.send(),t}).then(function(){window.location.reload()})}document.cookie="Agent-Name=Agent",i.a.ajaxSetup({cache:!1}),i.a.ajaxTransport("buffer",function(e){var t=new XMLHttpRequest;return t.open("GET",e.url),t.responseType="arraybuffer",t.timeout=e.timeout,{send:function(e,n){Object.entries(e).map(function(e){var n=$(e,2),r=n[0],i=n[1];return t.setRequestHeader(r,i)}),t.onload=function(){return n(t.status,t.statusText,{buffer:t.response})},t.send()},abort:function(){t.abort()}}});var Le=Object(T.a)("stats.html"),Me=Object(T.a)("bookmarks.html"),$e=Object(T.a)("embedded.html");function Re(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:A.i,t={url:N.getLangs(),type:"HEAD",timeout:e,priority:w};return H(t)}function Be(){return H({url:N.getAvailableGroups()})}},115:function(e,t,n){"use strict";var r=n(72),i=n.n(r),o=n(6),a=n.n(o),s=n(3),c=n.n(s),u=n(21),l=n.n(u),h=n(157),d=n.n(h),f=n(70),p=n.n(f),m=n(56),v=n.n(m),b=n(43),y=n(120),g=n(13),k=n(4);function O(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function w(e){return w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},w(e)}function S(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function j(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?S(n,!0).forEach(function(t){I(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function _(e,t){return!t||"object"!==w(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function P(e){return P=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},P(e)}function C(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&E(e,t)}function E(e,t){return E=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},E(e,t)}function x(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function T(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function A(e,t,n){return t&&T(e.prototype,t),n&&T(e,n),e}function I(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var D=v()(/^hosts\//,""),L=["speed","beginTime","endpoint","keyFrames","archive","format"],M=a()(i()([[a()(c()(["method"]),l()("play")),p()(["endpoint","format","method","streamId","keyFrames","speed","beginTime","archive","width","height","vc"])],[a()(c()(["method"]),l()("stop")),p()(["method","streamId"])],[a()(c()(["method"]),l()("batch")),p()(["endpoint","format","method","streamId","keyFrames","timestampList","archive","width","height","vc"])]]),Object(g.i)({endpoint:D,archive:D})),$=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;x(this,e),I(this,"ctx",void 0),I(this,"options",void 0),this.options=t,this.ctx=n,n.conn.postMessage(M(t)),k.a.video("media state: %c%s %c%s","font-weight: bold",this.state,"color:gray",this.options.endpoint)}return A(e,[{key:"batch",value:function(){return this}},{key:"play",value:function(){return this}},{key:"stop",value:function(){return this}},{key:"state",get:function(){return this.constructor.name}}]),e}(),R=function(e){function t(e,n){return x(this,t),n.updateIndex(e.streamId),_(this,P(t).call(this,e,n))}return C(t,e),A(t,[{key:"stop",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.options,t=this.options.streamId,n=j({},e,{method:"stop",streamId:t});return this.ctx.clearIndex(t),new B(n,this.ctx)}},{key:"play",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.options,t=p()(L,this.options),n=d()(t,e);if(n)return this;var r=j({},e,{keepPlayer:n});return k.a.video("media %crestart%c %s %c%s","font-weight: bold","font-weight: normal",r.keepPlayer?"(keeping player)":"","color: gray",r.endpoint),this.stop(r).play()}}]),t}($),B=function(e){function t(e,n){var r;return x(this,t),r=_(this,P(t).call(this,e,n)),n.clearIndex(e.streamId),r}return C(t,e),A(t,[{key:"play",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.options,t=e.keepPlayer,n=O(e,["keepPlayer"]),r=n.format===b.a.MP4&&(n.archFastMjpeg?1===n.speed:0!==n.speed),i={},o="img";return r?(i=j({},n,{format:b.a.MP4}),o="mse"):i=j({},n,{format:"jpeg"}),t||this.ctx.setType(o),i.streamId=Object(y.a)(),i.method="play",new R(i,this.ctx)}},{key:"batch",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.options,t=j({},e,{format:"jpeg",method:"batch",streamId:Object(y.a)()});return new R(t,this.ctx)}}]),t}($);t.a=function(e){var t={ctx:e,options:{},stop:function(){return this},play:null,batch:null};return t.play=B.prototype.play.bind(t),t.batch=B.prototype.batch.bind(t),t}},12:function(e,t,n){"use strict";n.d(t,"b",function(){return r});var r={APP_LOADED:"appLoaded",APP_MODE:"appMode",ARCH_BOUNDS:"archBounds",ARCH_SPEED:"archSpeed",ARCH_TIME:"archTime",BITRATE:"bitrate",CAM_ACTIVE:"camActive",CAM_ARCH:"camArch",CAM_ARCH_IMAGE_INFO:"camArchImageInfo",CAM_LIST:"camList",CAM_STATES:"camStates",CELL_IDX:"cellIndex",CLIPBOARD:"clipboard",COMMENTS:"comments",CONNECTION:"connection",EXPORT_TASK:"exportTask",LAYOUT_CELLS:"layoutCells",LAYOUT_LIST:"layoutList",LAYOUT_PENDING:"layoutPending",LAYOUT_SELECTED:"layoutSelected",LAYOUT_SIZE:"layoutSize",MOVE_SCALE:"moveScale",PLAYBACK:"playback",PREFS:"preferences",PTZ_READY:"ptzReady",SEARCH_RESULTS:"searchResults",SELECTOR_FILTER:"selectorFilter",SELECTOR_MODE:"selectorMode",SOURCES:"sources",SOURCES_IDX:"sourcesIndex",STATS:"statistics",VIEW_COUNT:"viewCount",ZOOM:"zoom",UPDATE_CAM_ACTIVE:"updateCamActive"};t.a={key:r}},120:function(e,t,n){"use strict";function r(){return Math.floor(1e16*Math.random()).toString(16).slice(0,12)}function i(){var e=r()+r()+r(),t=0;return[e.slice(t=0,t+=8),e.slice(t+=1,t+=4),e.slice(t+=1,t+=4),e.slice(t+=1,t+=4),e.slice(t+=1,t+=12)].join("-")}n.d(t,"a",function(){return i})},122:function(e,t,n){"use strict";var r=n(161),i=n.n(r),o=n(32),a=n.n(o),s=n(109),c=n.n(s),u=n(6),l=n.n(u),h=n(4);function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var p=l()([a()(i.a),c.a]);t.a=function(e,t){var n={},r=new Set;return function(i){var o,a=i.begintime,s=i.endtime,c=i.scale,u=[],l=this.archiveDesc,m=l.accessPoint,v=l.storage;return n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(n,!0).forEach(function(t){f(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},n,{vsid:m,archive:v,limit:1e4,scale:c,source:t,offset:0,begintime:a,endtime:s}),r.size>0&&(h.a.arch("request cancelling (%i)",r.size),r.forEach(function(e){return e.abort()})),h.a.arch("request %s %c%s %c%s","".concat(a,"â€¦").concat(s),"color:blue",t,"color:gray",n.archive),u.length=0,o=e(n),o.then(function i(a){var s=a.data,c=p(s);if(c.length>0&&(u=u.concat(c)),s.more){n.offset+=1e4;var l=e(n);return r.add(l),l.then(i)}return h.a.arch("request %i %c%s %c%s",u.length,"color:blue",t,"color:gray",n.archive),r.delete(o),u},function(){return r.delete(o),[]})}}},13:function(e,t,n){"use strict";n.d(t,"a",function(){return G}),n.d(t,"e",function(){return K}),n.d(t,"f",function(){return Z}),n.d(t,"b",function(){return J}),n.d(t,"g",function(){return te}),n.d(t,"q",function(){return re}),n.d(t,"m",function(){return ie}),n.d(t,"k",function(){return oe}),n.d(t,"p",function(){return ae}),n.d(t,"o",function(){return se}),n.d(t,"j",function(){return ce}),n.d(t,"l",function(){return ue}),n.d(t,"h",function(){return le}),n.d(t,"c",function(){return de}),n.d(t,"n",function(){return fe}),n.d(t,"i",function(){return pe}),n.d(t,"d",function(){return me});var r=n(72),i=n.n(r),o=n(102),a=n.n(o),s=n(108),c=n.n(s),u=n(6),l=n.n(u),h=n(24),d=n.n(h),f=n(84),p=n.n(f),m=n(42),v=n.n(m),b=n(223),y=n.n(b),g=n(194),k=n.n(g),O=n(21),w=n.n(O),S=n(224),j=n.n(S),_=n(283),P=n.n(_),C=n(7),E=n.n(C),x=n(53),T=n.n(x),A=n(33),I=n.n(A),D=n(284),L=n.n(D),M=n(56),$=n.n(M),R=n(47),B=n.n(R),N=n(126),F=n.n(N),z=n(39),V=n(43);function H(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function U(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function W(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var G=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),W(this,"cacheKey",void 0),W(this,"cacheValue",void 0),this.cacheKey=void 0,this.cacheValue=void 0}var t,n,r;return t=e,n=[{key:"clear",value:function(){return this.cacheKey=void 0,this.cacheValue=void 0,this}},{key:"delete",value:function(){return this.clear(),this}},{key:"get",value:function(){return this.cacheValue}},{key:"has",value:function(e){return this.cacheKey===e}},{key:"set",value:function(e,t){return this.cacheKey=e,this.cacheValue=t,this}}],n&&Y(t.prototype,n),r&&Y(t,r),e}();function X(e,t){var n=t[t.length-1],r=t[0],i=t.length,o=i-1,a=-1,s=0;if(e>n)return[n,t.length-1];if(e<r)return[r,0];for(;1!==i;){if(i=Math.ceil(i/2),o+=i*a,s=t[o],s===e)return[s,o];a=s>e?-1:1}var c=Math.abs(t[o]-e),u=Math.abs(t[o+a]-e);return c>u&&(o+=a),[t[o],o]}var K=l()([X,function(e){var t=U(e,2),n=t[1];return n}]),Z=l()([X,function(e){var t=U(e,1),n=t[0];return n}]);function J(e,t,n){var r="",i=n;if(void 0===t){var o=new RegExp(".*".concat(e,"=([^;]+).*"));r=o.test(document.cookie)?document.cookie.replace(o,"$1"):void 0}else{if(r="".concat(e,"=").concat(t),null===t&&(i=-1),i){var a=new Date(Date.now()+i).toUTCString();r+="; expires=".concat(a)}document.cookie=r}return r}var Q="MediaSource"in window&&MediaSource.isTypeSupported('video/mp4; codecs="avc1.42c00d, mp4a.40.2"'),ee="MediaSource"in window&&MediaSource.isTypeSupported('video/mp4; codecs="hvc1.1.6.L120.80, mp4a.40.2"');function te(e){var t=window,n=t.disableMse;switch(!0){case!n&&Q&&w()(e,V.b.H264):case!n&&ee&&w()(e,V.b.H265):return V.a.MP4;default:return V.a.JPEG}}var ne=function(e){return Promise.resolve(e)};function re(e){var t=e.map(function(e){return e.then(v.a,ne)});return Promise.all(t)}function ie(e,t){var n=new XMLHttpRequest;n.open("GET","languages",!0,e,t),n.send()}var oe=function(e){return function(t){return l()([c.a,E()(function(t){var n=U(t,2),r=n[0],i=n[1];return{tcid:e,id:r,label:i}})])(t)}};function ae(e,t){var n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?q(n,!0).forEach(function(t){W(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):q(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},t,{deltaY:-t.deltaY||-t.originalEvent.deltaY,pageX:t.pageX||t.originalEvent.pageX,pageY:t.pageY||t.originalEvent.pageY});return e(n)}function se(e,t){return t.preventDefault(),e.apply(void 0,H(t.originalEvent.changedTouches))}var ce=l()([B.a,p.a.convert({rearg:!0})(1)]),ue=function(){var e=Object(z.a)(window.location.href.replace(/[^/]*$/,""));window.location.href=e},le=l()(y()(["getResponseHeader"],["Location"]),$()(/^\//,"")),he=function(e){return i()([e,[F.a,v.a]])},de=function e(t){return he([P.a,l()(T()(e),L()(j.a),he([k.a,I.a]))])(t)},fe=a()(function(e,t){var n=0,r=t;for(t>e&&(n=-e),t<0&&(n=e);r>e||r<0;r+=n);return r});function pe(e){return T.a.convert({cap:!1})(function(t,n){return d()(v.a,[n],e)(t)})}function me(e){return delete e.toString,e}},130:function(e,t,n){"use strict";n.d(t,"b",function(){return v}),n.d(t,"d",function(){return b}),n.d(t,"c",function(){return y}),n.d(t,"a",function(){return g});var r=n(1),i=n(3),o=n.n(i),a=n(15),s=n(11),c=n(171),u=n(101),l=n(4),h=(n(37),n(59)),d=n(5),f=n(9);function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function v(){var e,t;return regeneratorRuntime.async(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,regeneratorRuntime.awrap(s.s());case 3:e=n.sent,t=e.data.version,l.a.common("host version",t),n.next=12;break;case 8:return n.prev=8,n.t0=n.catch(0),n.next=12,regeneratorRuntime.awrap(s.H());case 12:case"end":return n.stop()}},null,null,[[0,8]])}function b(){return l.a.common("fetch locale"),s.G().then(o()(["data","languages"]),function(){return Promise.resolve(window.navigator.userLanguage||window.navigator.language)}).then(function(e){var t=e.substr(0,2).toLowerCase();return new Promise(function(e){Object(c.a)(t,function(n){e(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(n,!0).forEach(function(t){m(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({lang:t},n))})})}).then(function(e){return l.a.common("fetch locale %cdone","{color: green}"),f.a.locale=e,r.a.datepicker&&r.a.datepicker.setDefaults(f.a.locale.calendar),r.a.timepicker&&r.a.timepicker.setDefaults(f.a.locale.calendar),e})}function y(){return s.t().then(o()("data"),r.a.noop).then(h.h).then(function(e){return Object(a.b)(a.b.key.LAYOUT_LIST).put(e)}).then(function(){return Object(a.b)(a.b.key.APP_LOADED).put(!0)},r.a.noop)}function g(){var e=new u.c({fails:f.a.settings.errorThreshold,heartbeat:s.I.bind(null,d.i),interval:d.i,topic:Object(a.b)(a.b.key.CONNECTION)});e.heartbeat()}},134:function(e,t,n){"use strict";n.d(t,"a",function(){return f}),n.d(t,"b",function(){return m});var r=n(108),i=n.n(r),o=n(161),a=n.n(o),s=n(34),c=n.n(s);function u(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function h(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function f(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return a()(e)?c()(function(e,n){var r=h(n,2),i=r[0],o=r[1];return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(n,!0).forEach(function(t){d(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},e,{},f(o,[].concat(u(t),[i])))},[],i()(e)):d({},t.join("."),e)}var p=window.navigator.language||window.navigator.userLanguage,m="string"==typeof p?p.slice(0,2):"en"},135:function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e){return"function"==typeof e}n.d(t,"a",function(){return o});var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.queue=[],this.pending=!1,this.callback=Function.prototype,this.next=this.next.bind(this)}var t,n,o;return t=e,n=[{key:"getState",value:function(){return{pending:this.pending,length:this.queue.length}}},{key:"onUpdate",value:function(e){return"function"==typeof e&&(this.callback=e),this}},{key:"clear",value:function(){return this.pending=!1,this.queue.length=0,this}},{key:"next",value:function(){if(this.pending=!0,0===this.queue.length)return this.pending=!1,void this.callback(this.getState());var e,t=this.queue.shift(),n=i(t)?t():t;this.callback(this.getState()),Promise.resolve(n).then(this.next,(e=this.next,function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return console.error("job failed: %o",n),e.apply(void 0,n)}))}},{key:"push",value:function(e){if(o=e,o&&"function"==typeof o.then)this.queue.push(e);else{if(!i(e))throw new Error("Not a function nor a Promise");for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];this.queue.push(e.bind.apply(e,[null].concat(n)))}var o;return this.pending||this.next(),this}}],n&&r(t.prototype,n),o&&r(t,o),e}()},136:function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,"a",function(){return o});var o=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),i(this,"cache",void 0),i(this,"cacheTime",void 0),i(this,"validTime",void 0),this.cache=new Map,this.cacheTime=new Map,this.validTime=t}var t,n,o;return t=e,n=[{key:"valid",value:function(e){var t=this.cacheTime.get(e)||0;return!(Date.now()-t>this.validTime)||(this.delete(e),!1)}},{key:"has",value:function(e){return this.cacheTime.has(e)&&this.valid(e)}},{key:"set",value:function(e,t){var n=this;return t instanceof Promise&&t.then(void 0,function(){return n.delete(e)}),this.cacheTime.set(e,Date.now()),this.cache.set(e,t),this}},{key:"get",value:function(e){return this.valid(e)&&this.cache.get(e)}},{key:"delete",value:function(e){return this.cacheTime.delete(e),this.cache.delete(e),this}},{key:"clear",value:function(){return this.cacheTime.clear(),this.cache.clear(),this}}],n&&r(t.prototype,n),o&&r(t,o),e}()},137:function(e,t,n){"use strict";function r(e,t){if(!(this instanceof r))return new r(e,t);this.time={begin:e.getTime(),end:t.getTime()},this.date={begin:e,end:t}}r.prototype={inner:function(e){var t=e.getTime();return this.time.begin<=t&&this.time.end>=t},more:function(e){var t=e.getTime();return this.time.begin>t&&this.time.end>t},less:function(e){var t=e.getTime();return this.time.begin<t&&this.time.end<t}},t.a=r},138:function(e,t,n){"use strict";n.d(t,"c",function(){return X}),n.d(t,"b",function(){return K});var r=n(51),i=n(9),o=n(165),a=n.n(o),s=n(132),c=n.n(s),u=n(46),l=n.n(u),h=n(21),d=n.n(h),f=n(201),p=n.n(f),m=n(139),v=n.n(m),b=n(34),y=n.n(b),g=n(47),k=n.n(g),O=n(69),w=n.n(O),S=n(43),j=n(39),_=n(115),P=n(136),C=n(65),E=n(4),x=n(73),T=n(5);function A(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function I(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function D(e,t,n){return t&&I(e.prototype,t),n&&I(e,n),e}function L(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function M(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function $(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?M(n,!0).forEach(function(t){R(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):M(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function R(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function B(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var N=c()({method:d()("batch")}),F=c()({method:d()("play"),speed:d()(0),beginTime:p.a,archive:p.a}),z=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.endpoint,n=e.beginTime,r=e.archive;return[t,n,r].join(" ")},V=function(e){var t=e.timestampList,n=B(e,["timestampList"]),r=$({},n);return 1===k()(t)?(r.method="play",r.beginTime=l()(t)):(r.method="batch",r.timestampList=t),r},H=function(e){return function(t){var n=t.beginTime,r=t.timestampList,i=B(t,["beginTime","timestampList"]);return w()(["cmd"],V,y.a.convert({cap:!1})(function(e){return function(t,n,r){var i=t.buffer,o=t.cmd,a=z($({},o,{beginTime:n})),s=o,c=i;return e.has(a)?c[r]=e.get(a):s=w()(["timestampList"],function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return[].concat(L(e),[n])},s),{buffer:c,cmd:s}}}(e))({buffer:[],cmd:i},a()([n].concat(r))))}};var q=function(){function e(t,n){var r=this;A(this,e),R(this,"key",void 0),R(this,"conn",void 0),R(this,"mediaState",void 0),R(this,"pending",void 0),R(this,"resolve",void 0),R(this,"width",void 0),R(this,"catchMedia",function(e){var t=e.data,n=t;n.key===r.key&&(r.resolve(n),r.mediaState=r.mediaState.stop())});var i=Object(x.b)(),o=i.promise,a=i.resolve;this.key=-1,this.conn=t,this.mediaState=Object(_.a)(this),this.pending=o,this.resolve=a,this.width=n}return D(e,[{key:"request",value:function(e){var t=this;return this.mediaState=this.mediaState.play(e),this.pending.abort=function(){t.mediaState=t.mediaState.stop()},this.pending}},{key:"updateIndex",value:function(e){var t=this;this.key=Object(C.b)(e),this.pending=new Promise(function(e){t.resolve=e,t.conn.addEventListener("message",t.catchMedia)})}},{key:"clearIndex",value:function(){this.conn.removeEventListener("message",this.catchMedia)}},{key:"setType",value:function(){}}]),e}(),U=function(){function e(t,n){var i=this;A(this,e),R(this,"key",void 0),R(this,"buffer",void 0),R(this,"conn",void 0),R(this,"count",void 0),R(this,"mediaState",void 0),R(this,"catchMedia",function(e){var t=e.data,n=t,r=n.key===i.key;r&&i.count>0&&(i.count-=1,i.emit(n)),0===i.count&&i.stop()}),R(this,"stop",function(){i.mediaState=i.mediaState.stop(),i.emit(r.a)}),this.key=-1,this.conn=t,this.count=0,this.emit=n,this.mediaState=Object(_.a)(this)}return D(e,[{key:"request",value:function(e){return this.count=e.timestampList.length,this.mediaState=this.mediaState.batch(e),this.stop}},{key:"updateIndex",value:function(e){this.key=Object(C.b)(e),this.conn.addEventListener("message",this.catchMedia)}},{key:"clearIndex",value:function(){this.conn.removeEventListener("message",this.catchMedia)}},{key:"setType",value:function(){}}]),e}(),Y=new Worker(Object(j.a)("conn.js")),W=i.a.settings.frameWidthList[2],G=function(e){var t=regeneratorRuntime.mark(u),n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:T.d,r=new P.a(n),i=H(r),o=new MessageChannel,a=o.port1,s=o.port2,c=new Map;function u(e,n){var r,i,o,a,u,l;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:r=!0,i=!1,o=void 0,t.prev=3,a=n[Symbol.iterator]();case 5:if(r=(u=a.next()).done){t.next=16;break}if(l=u.value,void 0!==l){t.next=11;break}return void(t.next=10);case 10:return t.abrupt("continue",13);case 11:l.key=e,s.postMessage(l);case 13:r=!0,t.next=5;break;case 16:t.next=22;break;case 18:t.prev=18,t.t0=t.catch(3),i=!0,o=t.t0;case 22:t.prev=22,t.prev=23,r||null==a.return||a.return();case 25:if(t.prev=25,!i){t.next=28;break}throw o;case 28:return t.finish(25);case 29:return t.finish(22);case 30:c.delete(e);case 31:case"end":return t.stop()}},t,null,[[3,18,22,30],[23,,25,29]])}return a.start(),s.start(),s.addEventListener("message",function(t){var n=t.data,o=n,a=F(o)||N(o),s=a?i(o):{cmd:o,buffer:[]},l=s.cmd,h=s.buffer,d=N(l)?k()(l.timestampList):1;if(0!==h.length){var f=Object(C.b)(l.streamId),p=u(f,h);p.next(),c.set(f,p)}0!==d&&(a&&function(e,t,n){var r=Object(C.b)(n.streamId),i=k()(n.timestampList),o=0;t.addEventListener("message",function a(s){var c=s.data,u=c,l=N(n)?v()(o,n.timestampList):n.beginTime;if(u.key===r){var h=z($({},n,{beginTime:l}));e.set(h,u),E.a.ws("cache","cached new frame for ".concat(h," ").concat(u.checksum)),o+=1}o===i&&t.removeEventListener("message",a)})}(r,e,l),e.postMessage(l))}),e.addEventListener("message",function(e){var t=e.data;s.postMessage(t),c.has(t.key)&&c.get(t.key).next()}),a}(Y);function X(e){var t=e.endpoint,n=e.format,r=void 0===n?S.a.JPEG:n,i=e.beginTime,o=e.archive,a=void 0===o?"":o,s=e.speed,c=void 0===s?0:s,u=e.width,l=void 0===u?W:u,h=e.keyFrames,d=void 0!==h&&h;return new q(G).request({endpoint:t,format:r,beginTime:i,archive:a,speed:c,width:l,keyFrames:d})}function K(e,t){var n=e.endpoint,r=e.format,i=void 0===r?S.a.JPEG:r,o=e.keyFrames,a=void 0!==o&&o,s=e.timestampList,c=void 0===s?[]:s,u=e.archive,l=void 0===u?"":u,h=e.width,d=void 0===h?W:h;return new U(G,t).request({endpoint:n,format:i,keyFrames:a,timestampList:c,archive:l,width:d})}window.addEventListener("unload",function(){return Y.terminate()}),t.a=G},140:function(e,t,n){"use strict";function r(e){var t=document.createElement("div"),n=document.body;t.style.visibility="hidden",t.innerHTML="&nbsp;",t.classList.add(e),n.appendChild(t);var r=t.offsetHeight;return n.removeChild(t),r}n.d(t,"c",function(){return r}),n.d(t,"a",function(){return i}),n.d(t,"b",function(){return o}),n.d(t,"d",function(){return a});var i=16/9;function o(e,t){var n=Math.floor(t/e),r=Math.floor(n/i);return{width:n,height:r}}function a(e,t){var n=[],r=e.toLowerCase(),i=t.toLowerCase(),o=i.length,a=0,s=r.indexOf(i);if(!t)return[{match:!1,substr:e}];for(;-1!==s;){var c=e.slice(a,s);c.length&&n.push({match:!1,substr:c}),n.push({match:!0,substr:e.slice(s,s+o)}),a=s+o,s=r.indexOf(i,a)}return n.push({match:!1,substr:e.slice(a)}),n}},15:function(e,t,n){"use strict";var r=n(1),i=n(135),o=n(173),a=n(12),s=n(67),c=n(127),u=n.n(c),l=n(156),h=n.n(l),d=n(4),f=n(16);n(330);function p(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function m(e){var t=e.pos;return Object(r.a)("<div>").addClass("layout-showcase__layout__cell").css({left:Object(f.a)(t.left),right:Object(f.a)(t.right),top:Object(f.a)(t.top),bottom:Object(f.a)(t.bottom)})}function v(e,t){var n,i=r.a.map(e.cells,m),o=(n=Object(r.a)("<div>").addClass("layout-showcase__layout-overview")).append.apply(n,p(i)),a=Object(r.a)("<span>").addClass("layout-showcase__layout-name").text(e.displayName);return Object(r.a)("<li>").data({idx:t}).attr({title:e.displayName}).addClass("layout-showcase__layout").append(o).append(a)}var b=h()(u()("idx"));r.a.widget("app.layoutShowcase",{_create:function(){var e=this;this.disable=this.setEnable.bind(this,!1),this.enable=this.setEnable.bind(this,!0),this.waitUntilDone=this.waitUntilDone.bind(this),this.updateList=this.updateList.bind(this),this.updateSelect=this.updateSelect.bind(this),this.handleSelect=this.handleSelect.bind(this),this.closeListClickOut=this.closeListClickOut.bind(this),this.handleToggleOpenList=this.handleToggleOpenList.bind(this),this.$list=Object(r.a)("<ul>").addClass("layout-showcase__layout-list"),this.$label=Object(r.a)("<label>").addClass("layout-showcase__arrow"),this.$checkbox=Object(r.a)("<input>").attr({type:"checkbox",hidden:"hidden"}).addClass("layout-showcase__arrow-checkbox"),this.$input=Object(r.a)("<input>").addClass("layout-showcase__input"),this.$label.on({click:function(){document.body.addEventListener("click",e.closeListClickOut,!0),e.handleToggleOpenList()}}),this.topic(this.topic.key.LAYOUT_LIST).observe(this.updateList),this.topic(this.topic.key.LAYOUT_SELECTED).observe(this.updateSelect);var t=function t(n){n.stopPropagation(),Object(r.a)(window).off({keydown:t}),e.$input.appendTo(e.element).on({keyup:function(){var t=e.$input.val(),n=e.$list.get(0),r=n.querySelector("li[title*='".concat(t,"' i]"));r&&r.scrollIntoView({behavior:"smooth"})}}).focus()};this.element.addClass("layout-showcase").append(this.$list).append(this.$checkbox).append(this.$label),this.element.on({click:this.handleSelect,transitionend:function(){var t=e.topic(e.topic.key.LAYOUT_SELECTED).get();if(t){var n=e.$list.children().eq(t.idx);e.$list.scrollTop(e.$list.scrollTop()+n.offset().top+n.height()-e.$list.outerHeight())}},mouseenter:function(){Object(r.a)(window).on({keydown:t})},mouseleave:function(){Object(r.a)(window).off({keydown:t}),e.$input.remove().val("")}})},closeListClickOut:function(e){var t=e.target.classList.contains("layout-showcase__layout");t||(e.preventDefault(),e.stopPropagation(),this.handleToggleOpenList()),document.body.removeEventListener("click",this.closeListClickOut,!0)},handleToggleOpenList:function(){var e=this.$checkbox.prop("checked");this.$list.toggleClass("layout-showcase__layout-list--opened",!e),this.$checkbox.prop({checked:!e})},updateList:function(e){var t,n=r.a.map(e,v);(t=this.$list.empty()).append.apply(t,p(n))},updateSelect:function(e){var t=e.idx;this.$list.children().removeClass("layout-showcase__layout--selected").eq(t).addClass("layout-showcase__layout--selected")},setEnable:function(e){this.element.toggleClass("layout-showcase--disabled",!e),this.enabled=e,d.a.layout("showcase","is enabled: ".concat(e))},waitUntilDone:function(e){e||this.enable()},handleSelect:function(e){var t=Object(r.a)(e.target).data(),n=this.$checkbox.prop("checked");b(t)||(n&&this.handleToggleOpenList(),this.topic(this.topic.key.LAYOUT_SELECTED).put(t))}});n(207);var y=n(9),g=n(11);n(332);r.a.widget("app.logout",{options:{target:Object(r.a)()},defaultElement:"<a>",_create:function(){this.element.addClass("logout").text(y.a.locale.logout).on({click:g.H}).appendTo(this.options.target)}});var k=n(164),O=n.n(k),w=n(144),S=n.n(w),j=n(3),_=n.n(j),P=n(291),C=n.n(P),E=n(68),x=n.n(E),T=n(111),A=n.n(T),I=n(138),D=n(101),L=n(5);n(275),n(248);function M(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function $(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var R=function(e){return e.element},B=_()(["origin"]),N=O()(B),F=C()(B),z=x()(["origin"]);r.a.widget("app.multiCam",{options:{rows:2,cols:2},CSS_LAYOUT:"layout",CSS_ROW:"layout__row",INTERVAL:L.i,_init:function(){var e=this;this.cells=[],this.rows=0,this.cols=0,this.recvBytes=0,this.setCells=this.setCells.bind(this),this.updateCells=this.updateCells.bind(this),this.distributeData=this.distributeData.bind(this),this.initIndex=this.initIndex.bind(this),this.handleConn=this.handleConn.bind(this),this.videoSuspend=this.videoSuspend.bind(this),this.stats=this.stats.bind(this),this.conn=I.a,this.conn.addEventListener("message",this.distributeData),this.topic(this.topic.key.LAYOUT_CELLS).observe(this.setCells),this.topic(this.topic.key.STATS).observe(this.stats),this.initIndex(),Object(r.a)(document).on({visibilitychange:function(t){var n=t.target.hidden;return e.videoSuspend(n)}}),this.topic(this.topic.key.CONNECTION).observe(this.handleConn)},_create:function(){this.element.addClass(this.CSS_LAYOUT)},_destroy:function(){this.topic(this.topic.key.LAYOUT_CELLS).unobserve(this.setCells),this.topic(this.topic.key.STATS).unobserve(this.stats),this.topic(this.topic.key.CONNECTION).unobserve(this.handleConn),this.conn.removeEventListener("message",this.distributeData),this.element.remove()},setCells:function(e){var t,n,r=e.length-this.cells.length,i=this.createCells(r),o=(t=this.cells).splice.apply(t,$([this.cells.length+r,-r].concat(i)));d.a.video("MultiCam +%d -%d =%d",i.length,o.length,this.cells.length),o.forEach(this.destroyCell),(n=this.element).append.apply(n,$(i.map(R))),this.updateCells(e)},_setCells:function(e){var t;this.cells.forEach(this.destroyCell),this.cells=this.createCells(e.length),(t=this.element).append.apply(t,$(this.cells.map(R))),this.updateCells(e)},updateCells:function(e){var t=N(e,this.cells),n=N(this.cells,e),r=A()(n,t);S()(function(e){var t=M(e,2),n=t[0],r=t[1];return n.option(r)},r);var i=z(F(e,this.cells)),o=z(F(this.cells,e)),a=A()(o,i);S()(function(e){var t=M(e,2),n=t[0],r=t[1],i=r.origin,o=r.pos;return n.option({origin:i,pos:o})},a)},setSize:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[this.options.cols,this.options.rows];d.a.deprecated();var n=t[0],r=t[1],i=r*n,o=this.cells.length,a=o-i,s=this.createCells(-a),c=[];c=(e=this.cells).splice.apply(e,$([o-a,a].concat(s))),c.forEach(this.destroyCell),this.topic(this.topic.key.VIEW_COUNT).put(this.rows*this.cols)},createCells:function(e){for(var t=[],n=this.cells.length,i=n+e,o=n;o<i;o+=1)t.push(r.a.app.videoCell({key:o,conn:this.conn}));return t},destroyCell:function(e){e.destroy(),e.element.remove()},setRows:function(e){var t=-(this.rows-e),n=this.element.find(".".concat(this.CSS_ROW)),i=[],o=0;for(o=0;o<t;o+=1)i.push(Object(r.a)("<div>").addClass(this.CSS_ROW));this.element.append(i),t<0&&n.slice(t).each(this.removeRow),this.rows=e},removeRow:function(e,t){t.remove()},reorderByCols:function(e,t){var n=this.element.find(".".concat(this.CSS_ROW)),r=e.length,i=0,o=0;for(i=0;i<r;i+=1)o=Math.floor(i/t),n.eq(o).append(e[i].element);this.cols=t},getRecvBytes:function(){var e=this.recvBytes;return this.recvBytes=0,{bytes:e,streams:this.topic(this.topic.key.CELL_IDX).get().size}},publishRate:function(e){e.topic(e.topic.key.BITRATE).put(e.getRecvBytes())},stats:function(e){e?this.rateTimer=setInterval(this.publishRate,this.INTERVAL,this):clearInterval(this.rateTimer)},initIndex:function(){var e=this,t=new Map;t.toString=function(){return Object.keys(e).slice(-1).join(" ")},this.topic(this.topic.key.CELL_IDX).put(t)},distributeData:function(e){var t=e.data,n=this.topic(this.topic.key.CELL_IDX).get().get(t.key);n&&(this.recvBytes+=t.payload.byteLength,n.push(t))},handleConn:function(e){var t=e===D.a;this.videoSuspend(t)},videoSuspend:function(e){var t,n=this.topic(this.topic.key.ARCH_TIME).get(),r=this.topic(this.topic.key.PREFS).get(),i=r.disconnectInactive;i&&(!e&&Number.isFinite(this.keptSpeed)&&(t=this.keptSpeed,this.keptSpeed=void 0),e&&(t=0,this.keptSpeed=this.topic(this.topic.key.PLAYBACK).get().speed),(t||n)&&this.topic(this.topic.key.PLAYBACK).assign({speed:t,beginTime:n}))}}),r.a.widget("app.rateIndicator",{_create:function(){this.element.addClass("rate-indicator").addClass("hidden"),this.stats=this.stats.bind(this),this.render=this.render.bind(this),this.topic(this.topic.key.STATS).observe(this.stats)},_destroy:function(){this.topic(this.topic.key.STATS).unobserve(this.stats)},render:function(e){var t=e.bytes,n=e.streams,r=Date.now(),i=r-this.lastTime;this.element.text("".concat(Object(f.h)(t,i).toFixed(2)," KB/s (").concat(n,")")),this.lastTime=r},stats:function(e){e?(this.topic(this.topic.key.BITRATE).observe(this.render),this.lastTime=Date.now()):(this.element.text(""),this.topic(this.topic.key.BITRATE).unobserve(this.render)),this.element.toggleClass("hidden",!e)}});var V=n(24),H=n.n(V),q=n(7),U=n.n(q),Y=n(95),W=n(13);function G(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var X=U.a.convert({cap:!1});H()({});r.a.widget("app.selectArch",{options:{idx:-1},defaultElement:"<div>",_create:function(){this.update=this.update.bind(this),this.updateSelected=this.updateSelected.bind(this),this.setArch=this.setArch.bind(this),this.toggleShow=this.toggleShow.bind(this),this.$select=Object(r.a)("<select>").addClass("VideoCell-opts__selector").on({change:this.setArch}),this.element.addClass("VideoCell-opts").addClass("hidden").append(this.$select),this.topic(this.topic.key.CAM_ARCH).observe(this.toggleShow)},setCamera:function(e){this.camera&&this.camera.archSelected.unobserve(this.updateSelected),e&&(this.camera=e,this.camera.archSelected.observe(this.updateSelected),this.update())},setArch:function(e){var t=e.target.value;this.camera.setArchSelectedByIdx(t)},update:function(){var e;if(this.camera){var t=this.camera.archList,n=X(function(e,t){var n=Object(Y.a)(e.storage)?y.a.locale.embeddedStorage:e.storageDisplayName;return Object(r.a)("<option>").attr({value:t}).data(e).text(n)}),i=n(t);(e=this.$select.empty()).append.apply(e,G(i)),this.element.toggleClass("VideoCell-opts--active",Object(W.j)(i))}else this.$select.empty()},updateSelected:function(e){var t=this.camera.getArchIdx(e);this.$select.val(t)},toggleShow:function(e){this.element.toggleClass("hidden",Boolean(!e))},_destroy:function(){this.topic(this.topic.key.CAM_ARCH).unobserve(this.toggleShow)}});n(342);r.a.widget("app.notify",{options:{text:""},_create:function(){var e=this;this.$notify=Object(r.a)("<div>").addClass("notify").text(this.options.text).appendTo(document.body),this.$notify.fadeIn().delay(L.h).fadeOut().queue(function(){return e.destroy()})},_destroy:function(){this.$notify.remove(),this.$notify=void 0}});n(343);r.a.widget("app.offlineSign",{_create:function(){var e=Object(r.a)("<div>").text(y.a.locale.serverOffline);this.handleConn=this.handleConn.bind(this),this.topic(this.topic.key.CONNECTION).observe(this.handleConn),this.element.addClass("offline-sign").addClass("hidden").append(e)},_destroy:function(){this.topic(this.topic.key.CONNECTION).unobserve(this.handleConn)},handleConn:function(e){var t=e===D.b;this.element.toggleClass("hidden",t)}}),n.d(t,"b",function(){return K}),n.d(t,"a",function(){return Z});var K=Object.assign(o.a,a.a),Z=new i.a;Object.values(r.a.app).forEach(function(e){e.prototype.topic=K}),s.a.prototype.topic=K},16:function(e,t,n){"use strict";n.d(t,"l",function(){return w}),n.d(t,"h",function(){return S}),n.d(t,"e",function(){return _}),n.d(t,"f",function(){return P}),n.d(t,"i",function(){return C}),n.d(t,"m",function(){return E}),n.d(t,"k",function(){return x}),n.d(t,"j",function(){return T}),n.d(t,"g",function(){return A}),n.d(t,"a",function(){return I}),n.d(t,"b",function(){return D}),n.d(t,"d",function(){return L}),n.d(t,"c",function(){return M});var r=n(106),i=n.n(r),o=n(6),a=n.n(o),s=n(32),c=n.n(s),u=n(159),l=n.n(u),h=n(7),d=n.n(h),f=n(169),p=n.n(f),m=n(290),v=n.n(m),b=n(170),y=n.n(b),g=n(110),k=n.n(g),O=n(5);function w(e){return"".concat((e/1e6).toFixed(2),"Mbps")}function S(e,t){var n=e>>10;return n/(t*O.e)}var j=Intl.DateTimeFormat("en",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"}),_=j.format;function P(e){var t=Math.floor(e/O.d),n=Math.floor(e%O.d/O.f),r=Math.floor(e%O.f/O.h);return[C(t),C(n),C(r)].join(":")}function C(e,t){return isFinite(e)?e.toString(t).padStart(2,"0"):""}var E=a()([l.a,d()(function(e){var t=e;return t=(240&t)>>4|(15&t)<<4,t=(204&t)>>2|(51&t)<<2,t=(170&t)>>1|(85&t)<<1,t}),d()(function(e){return e.toString(16)}),d()(p()("0")(2)),y()(""),v()("0"),k.a]),x=a()([c()(Boolean),d()(function(e){return e.toString(16)}),d()(p()("0")(2)),y()("")]),T=a()([d()(function(e){return e.toString(16)}),d()(p()("0",2)),y()(""),k.a]);function A(e){var t=C(e.getDate()),n=C(e.getMonth()+1),r=e.getFullYear(),i=C(e.getHours()),o=C(e.getMinutes()),a=C(e.getSeconds());return"".concat(r,"-").concat(n,"-").concat(t,"--").concat(i,"-").concat(o,"-").concat(a)}function I(e){return"".concat(Math.round(100*e),"%")}var D=function(e){return e.toFixed(3)},L=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return i()(new Date(e),"HH:MM:ss dd.mm.yyyy")},M=function(e){return(e/1e6).toFixed(2)}},1625:function(e,t,n){n(399),n(413),e.exports=n(1630)},1626:function(e,t,n){},1630:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n.n(r),o=n(8),a=n(106),s=n.n(a),c=n(9),u=n(63),l=n(18),h=n.n(l),d=n(21),f=n.n(d),p=n(6),m=n.n(p),v=n(103),b=n.n(v),y=n(32),g=n.n(y),k=n(3),O=n.n(k),w=n(46),S=n.n(w),j=n(33),_=n.n(j),P=n(131),C=n.n(P),E=n(74),x=n.n(E),T=n(354),A=n.n(T),I=n(390),D=n.n(I),L=n(218),M=n.n(L),$=n(60),R=n.n($),B=n(870),N=n.n(B),F=n(17),z=(n(1626),n(146)),V=n(171),H=n(867),q=n.n(H),U=n(122),Y=n(11),W=n(37),G=n(5),X=n(56),K=n.n(X),Z=n(4);function J(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function Q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function ee(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Q(n,!0).forEach(function(t){te(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Q(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function te(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ne=K()("hosts/","");function re(e){var t,n,r,i,o;return regeneratorRuntime.async(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,regeneratorRuntime.awrap(Object(Y.r)());case 2:t=a.sent,n=t.data,r={},i=function(){var t,i;return regeneratorRuntime.async(function(o){for(;;)switch(o.prev=o.next){case 0:return t=n.shift(),o.next=3,regeneratorRuntime.awrap(Object(Y.n)(ee({},e,{host:t})).then(function(e){var t=e.data;return t},function(e){var n=e.error;return Z.a.bookmarks("Failed to load bookmarks for ".concat(t),n)}));case 3:if(i=o.sent,i){o.next=6;break}return o.abrupt("return","continue");case 6:r=ee({},r,{},i);case 7:case"end":return o.stop()}})};case 6:if(!n.length){a.next=14;break}return a.next=9,regeneratorRuntime.awrap(i());case 9:if(o=a.sent,"continue"!==o){a.next=12;break}return a.abrupt("continue",6);case 12:a.next=6;break;case 14:return a.abrupt("return",r);case 15:case"end":return a.stop()}})}var ie=function(e){return"hosts/".concat(e)},oe=function(e){return Promise.all(e.map(function(e){var t=e.endpoint,n=e.storage_id,r=(e.displayName,J(e,["endpoint","storage_id","displayName"]));return Object(Y.U)([ee({endpoint:ie(t),storage_id:ie(n)},r)])}))},ae=function(e){return Object(Y.f)(e.map(function(e){var t=e.begins_at,n=e.ends_at,r=e.endpoint,i=e.storage_id;return{begins_at:t,ends_at:n,storage_id:ie(i),endpoint:ie(r)}}))},se=function(e){return Object(Y.e)(e.map(function(e){e.endpoint,e.storage_id,e.displayName;var t=J(e,["endpoint","storage_id","displayName"]);return ee({},t,{endpoint:"",storage_id:""})}))},ce=function(e){return Object(Y.g)(e.map(function(e){var t=e.endpoint,n=e.storage_id,r=(e.displayName,J(e,["endpoint","storage_id","displayName"]));return ee({endpoint:ie(t),storage_id:ie(n)},r)}))};function ue(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function le(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function he(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var de=q()({}),fe=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),he(this,"archiveDesc",void 0),this.archiveDesc=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ue(n,!0).forEach(function(t){he(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ue(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},t,{accessPoint:ne(t.accessPoint),storage:ne(t.storage)}),this.getIntervals=new U.a(Y.j,"intervals")}var t,n,r;return t=e,n=[{key:"getArchBeginAndEnd",value:function(){return this.getIntervals({begintime:"past",endtime:"future",scale:365*G.a,limit:1}).then(function(e){if(!e.length)throw new Error("no data");return{begin:W.a(W.h(e)),end:W.e(W.h(e))}}).catch(function(e){return{begin:null,end:null}})}},{key:"archiveDesc",get:function(){return de(this.archiveDesc)}}],n&&le(t.prototype,n),r&&le(t,r),e}(),pe=n(130),me=n(27),ve=n(134),be=n(13),ye=n(253),ge=n.n(ye),ke=n(198),Oe=n.n(ke),we=n(61),Se=n.n(we),je=Object(F.withStyles)(function(e){return{input:{marginLeft:4*e.spacing.unit},searchIcon:{position:"absolute",marginTop:e.spacing.unit},active:{display:"block"},hidden:{display:"none"}}})(function(e){var t=e.update,n=e.classes,r=e.shouldDisplay;return i.a.createElement(Se.a,{className:r?n.active:n.hidden},i.a.createElement(Oe.a,{className:n.searchIcon}),i.a.createElement(ge.a,{className:n.input,id:"filter",onChange:t}))}),_e=n(155),Pe=n.n(_e),Ce=n(278),Ee=n.n(Ce),xe=n(280),Te=n.n(xe),Ae=n(68),Ie=n.n(Ae),De=n(279),Le=n.n(De),Me=n(554),$e=n.n(Me),Re=n(868),Be=n.n(Re),Ne=n(678),Fe=n.n(Ne);function ze(e){return ze="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ze(e)}function Ve(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function He(e){return He=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},He(e)}function qe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ue(e,t){return Ue=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Ue(e,t)}var Ye=[{id:"select_bookmark",numeric:!1,disablePadding:!0,label:"selectBookmark"},{id:"begins_at",numeric:!1,disablePadding:!0,label:"beginsAt"},{id:"ends_at",numeric:!1,disablePadding:!0,label:"endsAt"},{id:"timestamp",numeric:!1,disablePadding:!0,label:"created"},{id:"user_id",numeric:!1,disablePadding:!0,label:"createdBy"},{id:"is_protected",numeric:!1,disablePadding:!0,label:"protected"},{id:"displayName",numeric:!1,disablePadding:!0,label:"name"},{id:"comment",numeric:!1,disablePadding:!0,label:"comment"}],We=function(e){function t(){var e,n,r,i,o,a,s;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var c=arguments.length,u=new Array(c),l=0;l<c;l++)u[l]=arguments[l];return r=this,i=(e=He(t)).call.apply(e,[this].concat(u)),n=!i||"object"!==ze(i)&&"function"!=typeof i?qe(r):i,o=qe(n),a="createSortHandler",s=function(e){return function(t){var r=n.props.onRequestSort;r(t,e)}},a in o?Object.defineProperty(o,a,{value:s,enumerable:!0,configurable:!0,writable:!0}):o[a]=s,n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ue(e,t)}(t,e),n=t,r=[{key:"render",value:function(){var e=this,t=this.props,n=t.order,r=t.orderBy,a=t.classes;return i.a.createElement(Le.a,null,i.a.createElement(Fe.a,null,Ye.map(function(t){return i.a.createElement($e.a,{key:t.id,className:a.header,sortDirection:r===t.id&&n},i.a.createElement(Be.a,{active:r===t.id,direction:n,onClick:e.createSortHandler(t.id)},i.a.createElement(o.a,{id:"bookmark.".concat(t.label)})))}),i.a.createElement($e.a,{className:a.header},i.a.createElement(o.a,{id:"bookmark.video"}))))}}],r&&Ve(n.prototype,r),a&&Ve(n,a),t}(r.Component),Ge=Object(F.withStyles)(function(){return{header:{position:"sticky",top:0,background:"rgb(66,66,66)",zIndex:999}}})(We),Xe=n(66),Ke=n.n(Xe),Ze=n(175),Je=n.n(Ze),Qe=n(105),et=n.n(Qe),tt=n(869),nt=n.n(tt),rt=n(257),it=n(93),ot={width:"3em"},at={width:"10em"},st={overflow:"auto",overflowWrap:"break-word",maxWidth:"20vw"},ct=function(e,t,n,r,o,a,c,u,l){if(!e.length)return null;var h,d,f,p,m,v,b=[];return e.map(function(e){h=e.begins_at,d=e.ends_at,f=e.timestamp,p=e.is_protected,m=e.user_id,b.push({camId:e.camId,displayName:e.displayName}),v=e.comment}),b=Object(it.c)(["camId"],[it.b],b),i.a.createElement(Je.a,{hover:!0,onClick:function(r){return t(r,{bookmark:e,idx:n})},key:n,role:"checkbox",selected:r(n,e)},i.a.createElement(Ke.a,{style:ot,padding:"checkbox",key:"select_bookmark"},i.a.createElement(et.a,{checked:r(n,e)})),i.a.createElement(Ke.a,{style:at,key:"begins_at"},s()(new Date(Object(G.l)(h)),"dd.mm.yyyy HH:MM:ss "),i.a.createElement("br",null)),i.a.createElement(Ke.a,{style:at,key:"ends_at"},s()(new Date(Object(G.l)(d)),"dd.mm.yyyy HH:MM:ss")),i.a.createElement(Ke.a,{style:at,key:"timestamp"},s()(new Date(Object(G.l)(f)),"dd.mm.yyyy HH:MM:ss")),i.a.createElement(Ke.a,{style:at,key:"user_id"},m),i.a.createElement(Ke.a,{style:ot,key:"is_protected"},i.a.createElement(et.a,{checked:p,color:"default",disabled:c||!p,onChange:function(){o(e)},onClick:function(e){return e.stopPropagation()}})),i.a.createElement(Ke.a,{style:at,key:"displayName"},b.map(function(e){var t=e.camId,n=e.displayName,r="".concat(t,".").concat(n);return i.a.createElement("div",{key:r},i.a.createElement(rt.a,{string:r,rule:l}))})),i.a.createElement(Ke.a,{style:st,key:"comment"},i.a.createElement(rt.a,{string:v,rule:l})),i.a.createElement(Ke.a,{key:"actions"},i.a.createElement(x.a,{disabled:!(r(n,e)&&!u),onClick:function(t){t.stopPropagation(),a({bookmark:e,idx:n})}},i.a.createElement(nt.a,null))))};function ut(e){return ut="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ut(e)}function lt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ht(e){return ht=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ht(e)}function dt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ft(e,t){return ft=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},ft(e,t)}function pt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var mt=function(e){function t(){var e,n,r,i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,a=new Array(o),s=0;s<o;s++)a[s]=arguments[s];return r=this,i=(e=ht(t)).call.apply(e,[this].concat(a)),n=!i||"object"!==ut(i)&&"function"!=typeof i?dt(r):i,pt(dt(n),"state",{order:"desc",orderBy:"timestamp",pk:"timestamp"}),pt(dt(n),"sorter",function(e,t,n,r){var i=Ie()([n,r])(e);return"desc"===t?i.reverse():i}),pt(dt(n),"handleRequestSort",function(e,t){if("displayName"!==t){var r=n.state,i=r.orderBy,o=r.order,a=t,s="desc";i===t&&"desc"===o&&(s="asc"),n.setState({order:s,orderBy:a})}}),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ft(e,t)}(t,e),n=t,r=[{key:"render",value:function(){var e=this.props,t=e.bookmarks,n=e.classes,r=e.onSelect,o=e.isSelected,a=e.handleChecked,s=e.handleClickVideo,c=e.isUpdating,u=e.shouldDisplay,l=e.countSelectedBookmarks,h=e.filter,d=this.state,f=d.order,p=d.orderBy,m=d.pk,v=l>1;return i.a.createElement(Pe.a,{className:u?n.root:n.hidden},i.a.createElement(Ee.a,null,i.a.createElement(Ge,{order:f,orderBy:p,onRequestSort:this.handleRequestSort}),i.a.createElement(Te.a,null,this.sorter(Object.values(t),f,p,m).map(function(e,t){return ct(e,r,t,o,a,s,c,v,h)}))))}}],r&&lt(n.prototype,r),o&&lt(n,o),t}(r.Component),vt=Object(F.withStyles)(function(){return{root:{marginTop:"5em",minWidth:"50%",width:"100%",maxHeight:"90vh",overflowY:"auto",position:"relative"},header:{position:"sticky",top:0,background:"rgb(66,66,66)",zIndex:999},hidden:{display:"none"}}})(mt),bt=n(24),yt=n.n(bt);function gt(e){return gt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},gt(e)}function kt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ot(e){return Ot=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Ot(e)}function wt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function St(e,t){return St=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},St(e,t)}function jt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var _t=function(e){function t(){var e,n,r,i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,a=new Array(o),s=0;s<o;s++)a[s]=arguments[s];return r=this,i=(e=Ot(t)).call.apply(e,[this].concat(a)),n=!i||"object"!==gt(i)&&"function"!=typeof i?wt(r):i,jt(wt(n),"state",{mode:"archive",options:{archivePane:!0,exportManager:!0}}),jt(wt(n),"postMessage",function(e){var t=e.type,r=e.bookmark,i=r.origin,o=r.archive,a=n.props.elemRef,s=n.state,c=s.mode,u=s.options;a.contentWindow.postMessage({type:t,origin:i,archive:o,mode:c,options:u},"*")}),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&St(e,t)}(t,e),n=t,r=[{key:"render",value:function(){var e=this.props,t=e.classes,n=e.elemRef,r=e.shouldDisplay,o=e.bookmark,a=e.switchCamera,s=e.handleLoadIframe,c=yt()([],"bookmark",o);return i.a.createElement("div",{className:h()(t.root,r?t.active:t.hidden)},c.map(function(e){return i.a.createElement(R.a,{key:e.displayName,onClick:function(){return a(e)},variant:"flat"},"".concat(e.camId,".").concat(e.displayName))}),i.a.createElement("iframe",{title:"Embedded",ref:n,className:t.iframe,src:Y.h,frameBorder:"0",onLoad:s}))}}],r&&kt(n.prototype,r),o&&kt(n,o),t}(r.Component),Pt=Object(F.withStyles)({root:{marginTop:"5em",width:"100%",height:"80vh",position:"relative"},iframe:{width:"100%",height:"100%"},active:{display:"block"},hidden:{display:"none"}})(_t),Ct=n(19),Et=n(212),xt=n(555),Tt=n.n(xt);function At(e){return At="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},At(e)}function It(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Dt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Lt(e){return Lt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Lt(e)}function Mt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $t(e,t){return $t=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},$t(e,t)}function Rt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Bt=function(e){return s()(new Date(Object(G.l)(e)),"yyyy-mm-dd HH:MM:ss")},Nt=function(e){function t(){var e,n,r,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var s=arguments.length,c=new Array(s),u=0;u<s;u++)c[u]=arguments[u];return r=this,a=(e=Lt(t)).call.apply(e,[this].concat(c)),n=!a||"object"!==At(a)&&"function"!=typeof a?Mt(r):a,Rt(Mt(n),"state",{isError:!1}),Rt(Mt(n),"getErrorMessage",function(e){var t=n.props,r=t.minDate,a=t.maxDate;switch(e){case"wrongDate":return i.a.createElement(o.a,{id:"dateInput.wrongDate"});case"minDateDenied":return i.a.createElement(o.a,{id:"dateInput.minDateDenied",values:{minDate:Bt(Object(G.m)(r))}});case"maxDateDenied":return i.a.createElement(o.a,{id:"dateInput.maxDateDenied",values:{maxDate:Bt(Object(G.m)(a))}});default:return e}}),Rt(Mt(n),"handleChange",function(e){var t=e.target.value;n.onChange(t)}),Rt(Mt(n),"onChange",function(e){var t={value:e,validation:n.validate(e)};n.props.onChange(t)}),Rt(Mt(n),"isDateValid",function(e){return e instanceof Date&&!isNaN(e)}),Rt(Mt(n),"validate",function(e){var t=n.props,r=t.minDate,i=t.maxDate,o=new Date(e),a=null,s=!0;return n.isDateValid(o)||(a="wrongDate",s=!1),r&&o.getTime()<r.getTime()&&(a="minDateDenied",s=!1),i&&o.getTime()>i.getTime()&&(a="maxDateDenied",s=!1),n.setState({isError:!s}),{isValid:s,errorMessage:n.getErrorMessage(a),minDate:r,maxDate:i}}),n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$t(e,t)}(t,e),n=t,r=[{key:"componentDidMount",value:function(){this.onChange(this.props.value)}},{key:"render",value:function(){var e=this.props,t=e.value,n=e.label,r=e.inputProps,o=e.id,a=this.state.isError;return i.a.createElement(Et.f,{error:a,id:o,label:n,inputProps:function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?It(n,!0).forEach(function(t){Rt(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):It(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},r,{pattern:"\\d{4}-([0][1-9]|[1][0-2])-([0][1-9]|[12][0-9]|[3][01]) ([01][0-9]|2[0-3]):[0-5][0-9]:\\d{2}"}),value:t,onChange:this.handleChange})}}],r&&Dt(n.prototype,r),a&&Dt(n,a),t}(r.Component);Rt(Nt,"defaultProps",{inputProps:{}});var Ft=Nt;function zt(e){return zt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},zt(e)}function Vt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ht(e){return Ht=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Ht(e)}function qt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ut(e,t){return Ut=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Ut(e,t)}function Yt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Wt=function(e){return s()(new Date(Object(G.l)(e)),"yyyy-mm-dd HH:MM:ss")},Gt=function(e){return Object(G.m)(new Date(e.replace(" ","T")))},Xt=function(e){function t(e){var n,r,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,a=Ht(t).call(this,e),n=!a||"object"!==zt(a)&&"function"!=typeof a?qt(r):a,Yt(qt(n),"onChange",function(e){var t=n.props,r=t.group,a=t.handleSave,s=n.state,c=s.beginsAtField,u=s.endsAtField;if(null!==r){var l=r.bookmark,h=Gt(c.value),d=Gt(u.value),f=e.target["bookmark-comment"].value,p=[];if(c.validation.isValid||p.push(c.validation.errorMessage),u.validation.isValid||p.push(u.validation.errorMessage),!p.length&&h>d&&p.push(i.a.createElement(o.a,{id:"bookmark.editErrorMessage"})),p.length)n.setState({errorMessages:p});else{var m=l.map(function(e){return Object.assign({},e,{begins_at:h,ends_at:d,comment:f})});a(m)}}}),Yt(qt(n),"handleBlur",function(){n.setState({errorMessages:[]})}),Yt(qt(n),"onInputChange",function(e){return function(t){n.setState(Yt({},e,t))}}),Yt(qt(n),"isDateValid",function(e){return!isNaN(e)});var s={value:"",validation:{errorMessage:null,isValid:!0}};return n.state={refBookmark:null,beginsAtField:s,endsAtField:s,errorMessages:[]},n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ut(e,t)}(t,e),n=t,r=[{key:"render",value:function(){var e=this,t=this.props,n=t.shouldOpen,r=t.handleClose,a=t.classes,s=t.group,c=t.intl,u=this.state,l=u.beginsAtField,h=u.endsAtField,d=u.errorMessages;if(null===s)return s;var f=S()(s.bookmark),p=f.archBegin,m=f.archEnd;return i.a.createElement("div",{onBlur:this.handleBlur},i.a.createElement(Et.e,{open:n,onClose:r},i.a.createElement("div",{className:a.paper},i.a.createElement("form",{onSubmit:function(t){t.persist(),t.preventDefault(),e.onChange(t)}},i.a.createElement(Et.b,{className:a.margin},i.a.createElement(Ft,{id:"bookmark-begins-at",label:c.formatMessage({id:"bookmark.beginsAt"}),inputProps:{required:!0},value:l.value,onChange:this.onInputChange("beginsAtField"),minDate:p})),i.a.createElement(Et.b,{className:a.margin},i.a.createElement(Ft,{id:"bookmark-ends-at",label:c.formatMessage({id:"bookmark.endsAt"}),inputProps:{required:!0},value:h.value,onChange:this.onInputChange("endsAtField"),maxDate:m})),i.a.createElement(Et.b,{className:a.margin},i.a.createElement(Et.d,{htmlFor:"bookmark-comment"},i.a.createElement(o.a,{id:"bookmark.comment"})),i.a.createElement(Et.c,{id:"bookmark-comment",type:"text",defaultValue:f.comment})),i.a.createElement(Et.a,{variant:"contained",color:"primary",className:a.margin,type:"submit"},i.a.createElement(o.a,{id:"bookmark.save"})),d.map(function(e,t){return i.a.createElement("span",{className:a.error,key:t},i.a.createElement(Tt.a,null),i.a.createElement(Et.g,{className:a.errorMessage},e))})))))}}],a=[{key:"getDerivedStateFromProps",value:function(e,t){if(null!==e.group){var n=S()(e.group.bookmark),r=Wt(n.begins_at),i=Wt(n.ends_at);if(!f()(n,t.refBookmark))return{refBookmark:n,beginsAtField:{validation:{errorMessage:null,isValid:!0},value:r},endsAtField:{validation:{errorMessage:null,isValid:!0},value:i}}}return null}}],r&&Vt(n.prototype,r),a&&Vt(n,a),t}(r.Component),Kt=Object(Ct.d)(Object(F.withStyles)(function(e){return{paper:{position:"absolute",width:50*e.spacing.unit,backgroundColor:e.palette.background.paper,boxShadow:e.shadows[5],padding:4*e.spacing.unit,top:"50%",left:"50%",transform:"translate(-50%, -50%)"},margin:{margin:2*e.spacing.unit},error:{display:"flex",justifyContent:"flex-start",alignItems:"flex-end",color:e.palette.text.primary},errorMessage:{marginLeft:e.spacing.unit}}}),o.e)(Xt),Zt=n(277),Jt=n.n(Zt),Qt=n(125),en=n.n(Qt),tn=n(276),nn=n.n(tn),rn=function(e){var t=e.show,n=e.confirmPendingAction,r=e.cancelPendingAction;return i.a.createElement(nn.a,{open:t,disableBackdropClick:!0,disableEscapeKeyDown:!0},i.a.createElement(en.a,null,i.a.createElement(o.a,{id:"bookmark.confirmActionText"})),i.a.createElement(Jt.a,null,i.a.createElement(R.a,{variant:"contained",color:"default",onClick:n},i.a.createElement(o.a,{id:"bookmark.confirmActionYes"})),i.a.createElement(R.a,{variant:"contained",color:"default",onClick:r},i.a.createElement(o.a,{id:"bookmark.confirmActionNo"}))))};function on(e){return on="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},on(e)}function an(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function sn(e){return sn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},sn(e)}function cn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function un(e,t){return un=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},un(e,t)}var ln=function(e){function t(){var e,n,r,i,o,a,s;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var c=arguments.length,u=new Array(c),l=0;l<c;l++)u[l]=arguments[l];return r=this,i=(e=sn(t)).call.apply(e,[this].concat(u)),n=!i||"object"!==on(i)&&"function"!=typeof i?cn(r):i,o=cn(n),a="handleClick",s=function(){var e=n.props,t=e.action,r=e.queue;r(t)},a in o?Object.defineProperty(o,a,{value:s,enumerable:!0,configurable:!0,writable:!0}):o[a]=s,n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&un(e,t)}(t,e),n=t,r=[{key:"render",value:function(){var e=this.props,t=e.classname,n=e.message,r=e.MessageComponent,o=e.paramsPlural;return i.a.createElement(R.a,{className:t,onClick:this.handleClick,variant:"contained",color:"secondary"},o?i.a.createElement(r,o):i.a.createElement(r,{id:n}))}}],r&&an(n.prototype,r),o&&an(n,o),t}(r.Component),hn=ln;function dn(e){return dn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},dn(e)}function fn(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function pn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function mn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pn(n,!0).forEach(function(t){kn(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pn(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function vn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function bn(e){return bn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},bn(e)}function yn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gn(e,t){return gn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},gn(e,t)}function kn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var On={MESSAGE:o.a,PLURAL:o.b},wn=Object(F.createMuiTheme)({palette:{type:"dark",accent:z.orange[500]}}),Sn={INIT:"init",REINIT:"reInit",STOP:"stop"},jn=m()([S.a,O()("group_id")]),_n=m()([O()("bookmark"),S.a,O()("id")]),Pn=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=bn(t).call(this,e),n=!o||"object"!==dn(o)&&"function"!=typeof o?yn(r):o,kn(yn(n),"iframe",void 0),kn(yn(n),"state",{filter:"",bookmarks:[],loading:!0,activeBookmarks:new Map,iframeInitialized:!1,iframeLoaded:!1,videoMode:!1,openModal:!1,showConfirm:!1,pendingAction:_.a,bookmarksMap:new Map}),kn(yn(n),"handleLoadIframe",function(){return n.setState({iframeLoaded:!0})}),kn(yn(n),"getArchBeginAndEnd",function(e,t){var n=new fe({accessPoint:t,storage:e});return n.getArchBeginAndEnd()}),kn(yn(n),"fetchAll",function(){var e,t,r,i,o;return regeneratorRuntime.async(function(a){for(;;)switch(a.prev=a.next){case 0:if(e=n.state.bookmarksMap,e.size){a.next=12;break}return a.next=4,regeneratorRuntime.awrap(re({}));case 4:return t=a.sent,r={archives:t.archives,cameras:t.cameras,events:[],more:t.more},a.next=8,regeneratorRuntime.awrap(Promise.all(t.events.map(function(e){var t;return regeneratorRuntime.async(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,regeneratorRuntime.awrap(n.getArchBeginAndEnd(e.storage_id,e.endpoint));case 2:return t=r.sent,r.abrupt("return",mn({},e,{archBegin:t.begin,archEnd:t.end}));case 4:case"end":return r.stop()}})})));case 8:r.events=a.sent,i=n.processBookmarks(r),o=Array.from(i.values()),n.setState({bookmarks:o,bookmarksMap:i,loading:!1});case 12:case"end":return a.stop()}})}),kn(yn(n),"processBookmarks",function(e){var t=new Map,n=e.events,r=e.cameras;return n.filter(function(e){var t=e.archBegin;return!t||Object(G.l)(e.begins_at).getTime()>t.getTime()}).forEach(function(e){var n=e.group_id,i=e.endpoint,o=e.storage_id,a=fn(e,["group_id","endpoint","storage_id"]),s=r.find(function(e){return e.endpoint===i}),c=Object(me.f)(s.endpoint),u=t.get(n);if(n&&s){u||(u=[],t.set(n,u));var l={hostname:Object(me.h)(ne(s.endpoint)),displayName:s.friendly_name,camId:Object(me.g)(c)};u.push(mn({endpoint:i,storage_id:o,group_id:n},a,{},l))}}),t}),kn(yn(n),"selectRow",function(e,t){var r=n.state.activeBookmarks,i=_n(t);e.ctrlKey||e.metaKey||r.clear(),r.has(i)?r.delete(i):r.set(i,t),n.setState({activeBookmarks:new Map(r)})}),kn(yn(n),"clearSelectionRows",function(){n.setState({activeBookmarks:new Map})}),kn(yn(n),"handleClickVideo",function(e){var t=n.getFirstBookmark(),r=f()(_n(t),_n(e));n.setState({videoMode:r},n.toggleFrame.bind(r))}),kn(yn(n),"toggleFrame",function(e){var t,r=Sn.STOP,i=n.getFirstBookmark();if(i&&!e){var o=i.bookmark;n.startVideo(o[0]),n.setState({iframeInitialized:!0})}else t={type:r};n.iframePostMessage(t),n.iframePostMessage({type:"setBookmarks",bookmarks:[i]})}),kn(yn(n),"startVideo",function(e){var t=n.state.iframeInitialized,r=Sn.INIT,i=Sn.REINIT,o=e.endpoint,a=e.storage_id,s=e.begins_at,c=e.displayName,u={type:t?i:r,mode:"archive",origin:o,displayName:c,archive:{storage:a,time:Object(G.l)(s)}};n.iframePostMessage(u),n.iframePostMessage({type:"setBookmarks",bookmarks:[e]})}),kn(yn(n),"isSelected",function(e,t){var r=n.state.activeBookmarks,i=m()([S.a,O()("id")]);return r.has(i(t))}),kn(yn(n),"handleChecked",function(e){n.setState({loading:!0});var t=e.map(function(e){return mn({},e,{},{is_protected:!1})});oe(t).then(function(){return t.map(n.updateBookmark)},function(){return n.setState({loading:!1})})}),kn(yn(n),"updateFilter",function(e){var t=e.target.value;n.setState(function(){return{filter:t.toLowerCase()}})}),kn(yn(n),"updateBookmark",function(e){var t=n.state,r=t.bookmarksMap,i=t.activeBookmarks,o=r.get(e.group_id);if(o){var a=b()(function(t){return t.endpoint===e.endpoint},o);o[a]=e;var s=Array.from(r.values()),c=O()("id",e),u=i.get(c);u&&(u.bookmark[0]=e,i.set(c,u)),n.setState({bookmarksMap:r,bookmarks:s,loading:!1,activeBookmarks:i})}}),kn(yn(n),"expandTable",function(){var e=n.getFirstBookmark();n.setState({videoMode:!1}),n.selectRow({},e)}),kn(yn(n),"deleteRecord",function(){var e=n.getFirstBookmark(),t=e.bookmark;ae(t).then(function(){return n.setState({showConfirm:!1})})}),kn(yn(n),"deleteBookmark",function(){var e=n.state,t=e.bookmarksMap,r=e.activeBookmarks;r.forEach(function(e){var r=e.bookmark,i=jn(r);se(r).then(function(){var e=t.get(i),o=new Set(r);if(e&&e.length>0){var a=e.filter(function(e){return!o.has(e)});t.set(i,a)}var s=Array.from(t.values());n.setState(function(){return{bookmarks:s,bookmarksMap:t,showConfirm:!1}})})}),n.clearSelectionRows()}),kn(yn(n),"toggleModal",function(){return n.setState(function(e){var t=e.openModal;return{openModal:!t}})}),kn(yn(n),"saveBookmark",function(e){return ce(e).then(function(){return e.map(n.updateBookmark)}).then(n.toggleModal)}),kn(yn(n),"queueAction",function(e){return n.setState({pendingAction:e,showConfirm:!0})}),kn(yn(n),"confirmAction",function(){var e=n.state.pendingAction;e()}),kn(yn(n),"cancelAction",function(){return n.setState(function(){return{pendingAction:_.a,showConfirm:!1}})}),kn(yn(n),"iframePostMessage",function(e){var t=n.iframe.current,r=t&&t.contentWindow;r&&r.postMessage(e,"*")}),n.iframe=i.a.createRef(),n.getArchBeginAndEnd=C()(n.getArchBeginAndEnd),n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&gn(e,t)}(t,e),n=t,r=[{key:"componentDidMount",value:function(){this.fetchAll()}},{key:"getFirstBookmark",value:function(){var e=this.state.activeBookmarks,t=Array.from(e.values());return S()(t)}},{key:"render",value:function(){var e,t,n,r=this,a=this.props.classes,s=this.state,u=s.loading,l=s.iframeLoaded,d=s.bookmarks,f=s.filter,p=s.videoMode,v=s.openModal,b=s.activeBookmarks,y=s.showConfirm,k=d.map(function(e){return g()(function(e){var t=e.comment,n=e.begins_at,r=e.ends_at,i=e.timestamp,o=e.displayName,a=e.user_id;return n.includes(f)||r.includes(f)||i.includes(f)||a.toLowerCase().includes(f)||o.toLowerCase().includes(f)||t.toLowerCase().includes(f)})(e)}),w=1===b.size?this.getFirstBookmark():null,j=m()([O()("bookmark"),S.a,O()("is_protected")])(w),_=u||!l;return i.a.createElement("div",null,i.a.createElement(A.a,null,i.a.createElement(D.a,null,i.a.createElement(R.a,{className:a.indent,variant:"outlined",onClick:be.l},i.a.createElement(o.a,{id:c.a.locale.back})),i.a.createElement(je,{update:this.updateFilter,shouldDisplay:!p}),i.a.createElement("div",{className:a.filler}),i.a.createElement(R.a,{variant:"contained",color:"default",onClick:this.toggleModal,className:h()((e={},kn(e,a.active,null!==w),kn(e,a.hidden,null===w),e))},i.a.createElement(o.a,{id:"bookmark.edit"})),i.a.createElement(hn,{queue:this.queueAction,action:this.deleteRecord,MessageComponent:On.MESSAGE,classname:h()((t={},kn(t,a.active,null!==w&&j),kn(t,a.hidden,null===w||!j),t)),message:"bookmark.deleteRecord"}),i.a.createElement(hn,{queue:this.queueAction,action:this.deleteBookmark,MessageComponent:On.PLURAL,classname:h()((n={},kn(n,a.active,!!b.size),kn(n,a.hidden,!b.size),n)),paramsPlural:{value:b.size,one:i.a.createElement(o.a,{id:"bookmark.deleteBookmark"}),other:i.a.createElement(o.a,{id:"bookmark.deleteBookmarks"})}}))),i.a.createElement("div",{className:a.row},i.a.createElement(x.a,{className:a.expandButton,onClick:this.expandTable,style:{display:p?"block":"none"}},i.a.createElement(N.a,null)),i.a.createElement(vt,{bookmarks:_?[]:k,onSelect:this.selectRow,handleChecked:this.handleChecked,isUpdating:u,shouldDisplay:!p,isSelected:this.isSelected,handleClickVideo:this.handleClickVideo,countSelectedBookmarks:b.size,filter:f}),i.a.createElement(Pt,{elemRef:this.iframe,bookmark:w,shouldDisplay:p,switchCamera:function(e){return r.startVideo(e)},handleLoadIframe:this.handleLoadIframe})),i.a.createElement(Kt,{shouldOpen:v,handleClose:this.toggleModal,handleSave:this.saveBookmark,group:w}),i.a.createElement(rn,{show:y,confirmPendingAction:this.confirmAction,cancelPendingAction:this.cancelAction}),_&&i.a.createElement(M.a,{type:"query"}))}}],r&&vn(n.prototype,r),a&&vn(n,a),t}(r.Component),Cn=Object(F.withStyles)({filler:{flexGrow:1},active:{display:"block",marginRight:"1em"},hidden:{display:"none"},indent:{marginRight:"3em"},row:{display:"flex",justifyContent:"flex-start",alignItems:"flex-start"},expandButton:{marginTop:"50vh"}})(Pn);Object(pe.d)().then(function(){var e=Object(V.b)(c.a.locale),t=i.a.createElement(o.c,{messages:e,locale:ve.b},i.a.createElement(F.MuiThemeProvider,{theme:wn},i.a.createElement(Cn,null))),n=document.querySelector(".bookmarks-container");n&&Object(u.render)(t,n)})},171:function(e,t,n){"use strict";n.d(t,"b",function(){return G});var r=n(1),i=n(8),o=n(293),a=n.n(o),s=n(294),c=n.n(s),u=n(295),l=n.n(u),h=n(296),d=n.n(h),f=n(297),p=n.n(f),m=n(298),v=n.n(m),b=n(299),y=n.n(b),g=n(300),k=n.n(g),O=n(301),w=n.n(O),S=n(302),j=n.n(S),_=n(303),P=n.n(_),C=n(304),E=n.n(C),x=n(305),T=n.n(x),A=n(306),I=n.n(A),D=n(307),L=n.n(D),M=n(308),$=n.n(M),R=n(309),B=n.n(R),N=n(310),F=n.n(N),z=n(311),V=n.n(z),H=n(312),q=n.n(H);function U(e){return U="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},U(e)}function Y(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function W(e,t){for(var n=W.lang.length,i=!0,o={};n--&&i;)-1!==W.lang[n].langCode.indexOf(e)&&(i=!1,n+=1);for(var a in-1===n&&(n=1),W.loc)W.loc.hasOwnProperty(a)&&(o[a]=W.loc[a][n]);function s(e,t){Object(r.a)(t).find("resources").children().each(function(){var t=Object(r.a)(this),n=t.attr("name").split("-"),i=e;n.forEach(function(e,t,n,r){function o(e,t){return"array"===e?Array.isArray(t):U(t)===e}if(e===r)if(o("string",n))void 0===i[n]&&(i[n]=t);else{if(!o("number",n))throw TypeError;o("array",i)?void 0===i[n]&&(i[n]=t):(i=[],i[n]=t)}else{if(!o("string",n))throw TypeError;n in i||(i[n]={}),i=i[n]}}.bind(void 0,n.length-1,t.text()))})}var c={},u="".concat("locale/","strings-").concat(e,".xml"),l="".concat("locale/","strings.xml");return r.a.get(u,s.bind(void 0,c)).always(function(){r.a.get(l,s.bind(void 0,c)).always(function(){t(c)})}),o}function G(e){var t={};return function e(t,n,r){for(var i in n)if(n.hasOwnProperty(i)){var o=i,a=n[i];t.length>0&&(o="".concat(t,".").concat(i)),"object"===U(a)?e(o,a,r):r[o]=a}}("",e,t),t}Object(i.d)([].concat(Y(a.a),Y(c.a),Y(l.a),Y(d.a),Y(p.a),Y(v.a),Y(y.a),Y(k.a),Y(w.a),Y(j.a),Y(P.a),Y(E.a),Y(T.a),Y(I.a),Y(L.a),Y($.a),Y(B.a),Y(F.a),Y(V.a),Y(q.a))),W.lang=[{langCode:["ru","ru-RU"],langName:"Ð ÑƒÑÑÐºÐ¸Ð¹"},{langCode:["en","en-US"],langName:"English"}],W.loc={enter:["Ð’Ð¾Ð¹Ñ‚Ð¸","Enter"],find:["Ð˜Ð¼Ñ ÐºÐ°Ð¼ÐµÑ€Ñ‹","Cameras name"],findTitle:["ÐŸÐ¾Ð¸ÑÐº Ð¿Ð¾ Ð¸Ð¼ÐµÐ½Ð¸: ","Search by Name: "],live:["Ð–Ð¸Ð²Ð¾Ð¹","Live"],archive:["ÐÑ€Ñ…Ð¸Ð²","Archive"],edit:["Ð ÐµÐ´Ð°Ð²Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ","Edit"],presets:["ÐŸÑ€ÐµÐ´ÑƒÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ¸","Presets"],ptzControl:["Ð£Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ PTZ","PTZ control"],calendar:[{closeText:"Ð£ÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ñ‚ÑŒ",timeOnlyTitle:"Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ð²Ñ€ÐµÐ¼Ñ",timeText:"Ð’Ñ€ÐµÐ¼Ñ",hourText:"Ð§Ð°ÑÑ‹",minuteText:"ÐœÐ¸Ð½.",secondText:"Ð¡ÐµÐº.",millisecText:"ÐœÐ¸Ð»Ð»Ð¸ÑÐµÐºÑƒÐ½Ð´Ñ‹",timezoneText:"Ð§Ð°ÑÐ¾Ð²Ð¾Ð¹ Ð¿Ð¾ÑÑ",currentText:"Ð¡ÐµÐ¹Ñ‡Ð°Ñ",dateFormate:"dd/mm/yy",dayNames:["Ð’Ð¾ÑÐºÑ€ÐµÑÐµÐ½ÑŒÐµ","ÐŸÐ¾Ð½ÐµÐ´ÐµÐ»ÑŒÐ½Ð¸Ðº","Ð’Ñ‚Ð¾Ñ€Ð½Ð¸Ðº","Ð¡Ñ€ÐµÐ´Ð°","Ð§ÐµÑ‚Ð²ÐµÑ€Ð³","ÐŸÑÑ‚Ð½Ð¸Ñ†Ð°","Ð¡ÑƒÐ±Ð±Ð¾Ñ‚Ð°"],dayNamesMin:["Ð’Ñ","ÐŸÐ½","Ð’Ñ‚","Ð¡Ñ€","Ð§Ñ‚","ÐŸÑ‚","Ð¡Ð±"],dayNamesShort:["Ð’Ð¾Ñ","ÐŸÐ¾Ð½","Ð’Ñ‚Ñ€","Ð¡Ñ€Ð´","Ð§Ñ‚Ð²","ÐŸÑÑ‚","Ð¡ÑƒÐ±"],monthNames:["Ð¯Ð½Ð²Ð°Ñ€ÑŒ","Ð¤ÐµÐ²Ñ€Ð°Ð»ÑŒ","ÐœÐ°Ñ€Ñ‚","ÐÐ¿Ñ€ÐµÐ»ÑŒ","ÐœÐ°Ð¹","Ð˜ÑŽÐ½ÑŒ","Ð˜ÑŽÐ»ÑŒ","ÐÐ²Ð³ÑƒÑÑ‚","Ð¡ÐµÐ½Ñ‚ÑÐ±Ñ€ÑŒ","ÐžÐºÑ‚ÑÐ±Ñ€ÑŒ","ÐÐ¾ÑÐ±Ñ€ÑŒ","Ð”ÐµÐºÐ°Ð±Ñ€ÑŒ"],monthNamesShort:["Ð¯Ð½Ð²","Ð¤ÐµÐ²","ÐœÐ°Ñ€","ÐÐ¿Ñ€","ÐœÐ°Ð¹","Ð˜ÑŽÐ½","Ð˜ÑŽÐ»","ÐÐ²Ð³","Ð¡ÐµÐ½","ÐžÐºÑ‚","ÐÐ¾ÑÐ±","Ð”ÐµÐº"],nextText:"Ð¡Ð»ÐµÐ´ÑƒÑŽÑ‰Ð¸Ð¹",prevText:"ÐŸÑ€ÐµÐ´Ñ‹Ð´ÑƒÑ‰Ð¸Ð¹"},{closeText:"Set",currentText:"Today",dateFormate:"mm/dd/yy",dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],nextText:"Next",prevText:"Prev"}],prevFrame:["ÐŸÑ€ÐµÐ´Ñ‹Ð´ÑƒÑ‰Ð¸Ð¹ ÐºÐ°Ð´Ñ€","Prev frame"],nextFrame:["Ð¡Ð»ÐµÐ´ÑƒÑŽÑ‰Ð¸Ð¹ ÐºÐ°Ð´Ñ€","Next frame"],prevInt:["ÐŸÑ€ÐµÐ´Ñ‹Ð´ÑƒÑ‰Ð¸Ð¹ Ð¸Ð½Ñ‚ÐµÑ€Ð²Ð°Ð»","Prev interval"],nextInt:["Ð¡Ð»ÐµÐ´ÑƒÑŽÑ‰Ð¸Ð¹ Ð¸Ð½Ñ‚ÐµÑ€Ð²Ð°Ð»","Next interval"],error:["ÐžÑˆÐ¸Ð±ÐºÐ°","Error:"],warn:["ÐŸÑ€ÐµÐ´ÑƒÐ¿Ñ€ÐµÐ¶Ð´ÐµÐ½Ð¸Ðµ:","Warning:"],info:["Ð˜Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ:","Info:"],escapePress:["ÐÐ°Ð¶Ð°Ñ‚ Esc, Ð²Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ Ð½Ðµ Ð²ÑÐµ Ð¾Ð±ÑŠÐµÐºÑ‚Ñ‹ Ð·Ð°Ð³Ñ€ÑƒÐ·Ð¸Ð»Ð¸ÑÑŒ, Ð¿Ð¾Ð¶Ð°Ð»ÑƒÐ¹ÑÑ‚Ð° Ð¿Ð¾Ð²Ñ‚Ð¾Ñ€Ð¸Ñ‚Ðµ Ð¿Ð¾Ð¿Ñ‹Ñ‚ÐºÑƒ.","Pressed Esc, maybe not all objects are loaded, please try again."],running:["Ð—Ð°Ð¿ÑƒÑÐº ÐºÐ»Ð¸ÐµÐ½Ñ‚Ð° ITV","Running ITV client"],logged:["Ð’Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½ Ð²Ñ…Ð¾Ð´","Logged"],notAllPresetsRecieved:["ÐÐµ Ð²ÑÐµ Ð¿Ñ€ÐµÐ´ÑƒÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ¸ Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ñ‹, Ð¿Ð¾Ð¶Ð°Ð»ÑƒÐ¹ÑÑ‚Ð° Ð¿Ð¾Ð²Ñ‚Ð¾Ñ€Ð¸Ñ‚Ðµ Ð¿Ð¾Ð¿Ñ‹Ñ‚ÐºÑƒ","Not all presets received, please try again"],notAllDegreesRecieved:["ÐÐµ Ð²ÑÐµ ÑÑ‚ÐµÐ¿ÐµÐ½Ð¸ ÑÐ²Ð¾Ð±Ð¾Ð´Ñ‹ Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ñ‹, Ð¿Ð¾Ð¶Ð°Ð»ÑƒÐ¹ÑÑ‚Ð° Ð¿Ð¾Ð²Ñ‚Ð¾Ñ€Ð¸Ñ‚Ðµ Ð¿Ð¾Ð¿Ñ‹Ñ‚ÐºÑƒ","Not all degrees of freedom are obtained, please try again"],notTelemetryRecieved:["ÐÐµ Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð¾ ÑƒÑÑ‚Ñ€Ð¾Ð¹ÑÑ‚Ð²Ð¾ Ñ‚ÐµÐ»ÐµÐ¼ÐµÑ‚Ñ€Ð¸Ð¸, Ð¿Ð¾Ð¶Ð°Ð»ÑƒÐ¹ÑÑ‚Ð° Ð¿Ð¾Ð²Ñ‚Ð¾Ñ€Ð¸Ñ‚Ðµ Ð¿Ð¾Ð¿Ñ‹Ñ‚ÐºÑƒ","Not received telemetry device, please try again"],timeoutException:["Ð¡ÐµÑ€Ð²ÐµÑ€ ÑƒÐ´ÐµÑ€Ð¶Ð°Ð» ÑÐ¾ÐµÐ´Ð¸Ð½ÐµÐ½Ð¸Ðµ Ð²Ñ‹ÑˆÐµ Ñ‚Ð°Ð¹Ð¼Ð°ÑƒÑ‚Ð°. Ð’Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ ÐºÐ¾Ð¼Ð°Ð½Ð´Ð° Ð½Ðµ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð°, Ð¿Ð¾Ð¶Ð°Ð»ÑƒÐ¹ÑÑ‚Ð° Ð¿Ð¾Ð²Ñ‚Ð¾Ñ€Ð¸Ñ‚Ðµ Ð¿Ð¾Ð¿Ñ‹Ñ‚ÐºÑƒ.","The server connection is kept above the timeout. Perhaps the team failed, please try again."],notGetArchive:["ÐÐµ ÑƒÐ´Ð°Ð»Ð¾ÑÑŒ Ð¿Ð¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑŒ Ð°Ñ€Ñ…Ð¸Ð², Ð¿Ð¾Ð¶Ð°Ð»ÑƒÐ¹ÑÑ‚Ð° Ð¿Ð¾Ð²Ñ‚Ð¾Ñ€Ð¸Ñ‚Ðµ Ð¿Ð¾Ð¿Ñ‹Ñ‚ÐºÑƒ.","Could not get archive, please try again."],cameraNotFound:["ÐšÐ°Ð¼ÐµÑ€Ð° Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½Ð°:","Camera not found:"],notGetUUID:["ÐÐµ Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½ UUID","Do not get the UUID"],archiveNotFound:[" ÐŸÐ¾Ð·Ð¸Ñ†Ð¸Ð¾Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð½Ð° Ð°Ñ€Ñ…Ð¸Ð² Ð½ÐµÐ²Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾.","Positioning of the archive is not possible."],cameraWithNameNotFound:["ÐšÐ°Ð¼ÐµÑ€Ð° Ñ Ñ‚Ð°ÐºÐ¸Ð¼ Ð¸Ð¼ÐµÐ½ÐµÐ¼ Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½Ð°:","Unable to find specified camera:"],choseDate:["Ð’Ñ‹Ð±Ñ€Ð°Ñ‚ÑŒ Ð´Ð°Ñ‚Ñƒ","Select date"],badDate:["ÐÑ€Ñ…Ð¸Ð² Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½ Ð½Ð° Ð´Ð°Ð½Ð½ÑƒÑŽ Ð´Ð°Ñ‚Ñƒ: ","Archive not found: "]},t.a=W},173:function(e,t,n){"use strict";n.d(t,"a",function(){return y}),n.d(t,"b",function(){return g});var r=n(150),i=n.n(r),o=n(281),a=n.n(o),s=n(3),c=n.n(s),u=n(88),l=n.n(u),h=n(23);function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var p={},m=l.a,v=l.a,b=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),f(this,"key",void 0),f(this,"handlers",void 0),f(this,"mustFireCount",void 0),f(this,"unsubscribe",void 0),this.key=t,this.handlers=[],this.mustFireCount=0}var t,n,r;return t=e,n=[{key:"observe",value:function(e){if("function"!=typeof e)throw new Error("No handler provided");this.handlers.push(e);var t=this.get();return t&&e(t),this}},{key:"unobserve",value:function(e){var t=this.handlers.findIndex(function(t){return t===e});return-1!==t&&this.handlers.splice(t,1),this}},{key:"put",value:function(e,t){return t&&(this.mustFireCount=this.handlers.length),v(Object(h.e)(this.key,e)),this}},{key:"assign",value:function(e){var t=this.get(),n=i()(t,e);return this.mustFireCount=this.handlers.length,v(Object(h.e)(this.key,n)),this}},{key:"get",value:function(){return m(this.key).val}},{key:"getPromise",value:function(){return Promise.resolve(this.value)}},{key:"notifyHandlers",value:function(){var e=m(this.key),t=e.val,n=e.old,r=this.mustFireCount>0;(t!==n||r)&&this.handlers.forEach(function(e){return e(t,n)})}}],n&&d(t.prototype,n),r&&d(t,r),e}();function y(e){return p[e]||(p[e]=new b(e)),p[e]}function g(e){return m=function(t){var n=e.getState();return{val:c()(["topic",t],n),old:c()(["topic",Object(h.d)(t)],n)}},v=e.dispatch.bind(e),y.dump=function(){return{values:e.getState().topic,topics:p}},function(e){return function(t){var n=t.type,r=t.payload,i=Object(h.b)(n)?Object(h.c)(n):"";i&&y(i)&&a()(function(){return p[i].notifyHandlers(r)}),e(t)}}}},174:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=function(e){return function(t){2===t.button&&e(t)}}},207:function(e,t,n){"use strict";var r=n(1);n(331);r.a.widget("app.fscreen",{options:{target:Object(r.a)()},defaultElement:"<div>",_create:function(){var e=this,t=Object(r.a)("<label>").addClass("fscreen"),n=Object(r.a)("<div>").addClass("fscreen__full fscreen__state"),i=Object(r.a)("<div>").addClass("fscreen__norm fscreen__state"),o=Object(r.a)("<span>").addClass("fscreen__arrow"),a=Object(r.a)("<input>").addClass("fscreen__chk").attr({type:"checkbox",hidden:!0});t.append(a).append(o).append(n).append(i),this.element.append(t).on({change:function(){Object(r.a)(this.options.target).fullScreen(a.prop("checked"))}.bind(this)}),Object(r.a)(document).on({fullscreenchange:function(){var t=e.options.target,n=t.get(0),r=t.fullScreen(),i=n===r;t.toggleClass("VideoCell--fullscreen",i),a.prop("checked",i)}})}})},209:function(e,t,n){},23:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(100);n.d(t,"a",function(){return r.a}),n.d(t,"b",function(){return r.b}),n.d(t,"c",function(){return r.c}),n.d(t,"d",function(){return r.d});var i=function(e,t){return{type:Object(r.a)(e),payload:t}}},242:function(e,t,n){"use strict";var r=n(1),i=n(111),o=n.n(i),a=n(11),s=n(16),c=n(5),u=n(4),l=n(13);n(334);function h(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function d(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}r.a.widget("app.exportMgr",{options:{pollInterval:5e3},exportState:{PENDING:1,DONE:2,FAILED:3,NOSPACE:4},exportClass:{1:"export-task--pending",2:"export-task--done",3:"export-task--error",4:"export-task--error"},_create:function(){var e=this,t=Object(r.a)("<div>").addClass("export-task__button-bar"),n=Object(r.a)("<button>").addClass("export-task__button export-task__button-prev"),i=Object(r.a)("<button>").addClass("export-task__button export-task__button-next"),o=Object(r.a)("<button>").addClass("export-task__button export-task__button-stop"),a=Object(r.a)("<button>").addClass(["export-task__button","export-task__button-stop","export-task__button-stop--all"].join(" ")),s=Object(r.a)("<span>").addClass("export-task__progress"),c=Object(r.a)("<span>").addClass("export-task__caption"),u=Object(r.a)("<ul>").addClass("export-task__links"),l=Object(r.a)("<span>"),h=this.element.addClass("export-task");return h.append(c).append(c).append(s).append(u).append(t),t.append(o).append(n).append(l).append(i).append(a),n.on({click:function(){var t=e.tasks.length,n=e.idx,r=(n+t-1)%t;e.renderTask(r)}}),i.on({click:function(){var t=e.tasks.length,n=e.idx,r=(n+1)%t;e.renderTask(r)}}),o.on({click:function(){var t;e.stopTask(e.idx),t=Math.min(e.idx,e.tasks.length-1),e.renderTask(t)}}),a.on({click:this.stopAllTasks.bind(this)}),this.$task=h,this.$progress=s,this.$caption=c,this.$links=u,this.$index=l,this},addTask:function(e,t,n,r){var i,o=this,h=Object.create(null),d=this.exportState;h.caption="".concat(e.id," ").concat(e.name," ").concat(Object(s.e)(t)," +").concat(Object(s.f)(n-t)),h.state=d.PENDING,u.a.export("Exporting","from",t,"to",n);var f=e.isLive,p=e.activeSource,m=e.archiveDesc,v=void 0===m?{}:m,b=v.accessPoint,y=v.storage;h.postXhr=a.K({isLive:f,vsid:f?p:b,archive:y,begintime:t===c.g?"past":t,endtime:n===c.g?"future":n,extended:r}),h.postXhr.then(function(e){var t=e.jqXhr;h.location=Object(l.h)(t),u.a.export("Export at",h.location)},function(){u.a.export("Export post","failed"),h.state=d.FAILED,o.renderTask(i)}),i=this.tasks.push(h)-1,this.statusQueue.push(i),this.renderTask(i),this.pollStatus()},tasks:[],idx:-1,getStatus:function(e){var t=this,n=r.a.ajax.prototype;return n=a.p({location:this.tasks[e].location}),this.tasks[e].statusXhr=n,n.then(function(n){var i=n.data;return u.a.export("Export status",i.id,i.progress,i.state,i.error),t.tasks[e]=r.a.extend(t.tasks[e],i),i.state===t.exportState.PENDING&&t.statusQueue.push(e),{idx:e,state:i.state}},function(){return t.statusQueue.push(e),{idx:-1,state:t.exportState.PENDING}})},statusTimerId:0,statusQueue:[],pollStatus:function(){var e=this;this.statusTimerId=setTimeout(function(){var t="";e.statusQueue.length>0&&(t=e.statusQueue.shift(),e.getStatus(t).then(function(t){t.state===e.exportState.PENDING&&t.idx!==e.idx||e.renderTask(t.idx),e.pollStatus()}))},this.options.pollInterval)},renderTask:function(e){var t;if(this.idx=e,-1!==e){var n=this.tasks[e],i=o()(n.files,n.filesFriendly).map(function(e){var t=d(e,2),i=t[0],o=t[1],s=Object(r.a)("<li>"),c=Object(r.a)("<a>").addClass("export-task__links-item").attr({download:o,href:a.W({location:n.location,file:i})}).text(o);return s.append(c)});this.$caption.text(n.caption),this.$progress.text(n.progress?Math.floor(100*n.progress):0),this.$task.attr({class:"export-task export-task--active"}).addClass(this.exportClass[n.state]),this.$links.empty(),(t=this.$links).append.apply(t,h(i)),this.$index.text([e+1,this.tasks.length].join("/"))}else this.$task.removeClass(["export-task--active","export-task--done"])},stopTask:function(e){var t=this.tasks.splice(e,1)[0];t.postXhr&&t.postXhr.abort(),this.statusQueue=this.statusQueue.filter(function(t){return t!==e}),t.statusXhr&&t.statusXhr.abort(),a.S({location:t.location}),u.a.export("Export clear",t.location)},stopAllTasks:function(){for(var e=this.tasks.length-1;e>=0;e-=1)this.stopTask(e);this.$task.removeClass(["export-task--active","export-task--done"]),this.idx=-1},_destroy:function(){this.stopAllTasks(),this.element.removeAttr("class").empty()}})},243:function(e,t,n){},244:function(e,t){e.exports='<svg class="Playback__icon" viewBox="0 0 19 13"><g><polygon points="7,6.5 13.8,13 13.8,0"></polygon><polygon points="0.2,6.5 7,13 7,0"></polygon><rect x="17" y="0" width="2" height="13"></rect></g></svg>'},245:function(e,t){e.exports='<svg class="Playback__icon" viewBox="0 0 13 13"><g><polygon points="0,6.5 6.8,13 6.8,0"></polygon><rect x="10" y="0" width="2" height="13"></rect></g></svg>'},246:function(e,t){e.exports='<svg class="Playback__icon" viewBox="0 0 13 13"><g><polygon points="12,6.5 5.2,13 5.2,0 "></polygon><rect x="0" y="0" width="2" height="13"></rect></g></svg>'},247:function(e,t){e.exports='<svg class="Playback__icon" viewBox="0 0 19 13"><g><polygon points="12.2,6.5 5.3,13 5.3,0 "></polygon><polygon points="19,6.5 12.2,13 12.2,0 "></polygon><rect x="0" y="0" width="2" height="13"></rect></g></svg>'},248:function(e,t,n){},25:function(e,t,n){"use strict";n.d(t,"c",function(){return r}),n.d(t,"a",function(){return i}),n.d(t,"b",function(){return o});var r="common/CAM_SELECT",i={ARCH:"arch",LIVE:"live",ARCH_SEARCH:"search",LAYOUT_EDITOR:"layoutEditor"},o=16/9},257:function(e,t,n){"use strict";var r=n(0),i=n.n(r),o=n(17),a=n(18),s=n.n(a),c=n(7),u=n.n(c),l=n(140);var h=u.a.convert({cap:!1});t.a=Object(o.withStyles)(function(e){return{selected:{textDecoration:"underline",textDecorationColor:e.palette.accent}}})(function(e){var t=e.string,n=e.rule,r=e.classes;return i.a.createElement(i.a.Fragment,null,h(function(e,t){var n,o,a,c=e.substr,u=e.match;return i.a.createElement("span",{key:"".concat(c,"-").concat(t),className:s()((n={},o=r.selected,a=u,o in n?Object.defineProperty(n,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):n[o]=a,n))},c)})(Object(l.d)(t,n)))})},27:function(e,t,n){"use strict";n.d(t,"h",function(){return X}),n.d(t,"l",function(){return Z}),n.d(t,"o",function(){return Q}),n.d(t,"f",function(){return ee}),n.d(t,"g",function(){return te}),n.d(t,"k",function(){return ie}),n.d(t,"e",function(){return ue}),n.d(t,"c",function(){return le}),n.d(t,"n",function(){return de}),n.d(t,"a",function(){return fe}),n.d(t,"b",function(){return pe}),n.d(t,"p",function(){return ve}),n.d(t,"j",function(){return be}),n.d(t,"i",function(){return ye}),n.d(t,"m",function(){return ge}),n.d(t,"d",function(){return ke});var r,i=n(285),o=n.n(i),a=n(6),s=n.n(a),c=n(32),u=n.n(c),l=n(108),h=n.n(l),d=n(3),f=n.n(d),p=n(24),m=n.n(p),v=n(84),b=n.n(v),y=n(127),g=n.n(y),k=n(42),O=n.n(k),w=n(21),S=n.n(w),j=n(158),_=n.n(j),P=n(85),C=n.n(P),E=n(7),x=n.n(E),T=n(92),A=n.n(T),I=n(70),D=n.n(I),L=n(56),M=n.n(L),$=n(159),R=n.n($),B=n(43),N=n(11),F=n(136),z=n(95),V=n(73),H=n(93),q=n(5);function U(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function W(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Y(n,!0).forEach(function(t){G(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Y(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function G(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var X=s()(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e.match(/^(hosts\/)?([^/]+)/)},f()(2)),K=M()(/[^/]*$/,""),Z=M()(/:\d{1,}$/,""),J=M()(/video:\d+/,"video:1"),Q=/DeviceIpint\.(.+)\/SourceEndpoint\.video:(\d+):(\d+)/;function ee(e){var t=Q.exec(e);return t?[t[1],t[2]]:[]}function te(e){return"0"===e[1]?e[0]:e.join(".")}var ne=f()("videoStreams[0].accessPoint"),re=f()("origin"),ie=s()([f()("videoStreams"),C.a,f()("accessPoint")]),oe=s()([f()("videoStreams.length"),b.a.convert({rearg:!0})(0)]);var ae=x()(D()("accessPoint"));var se=f()(["data","nextPageToken"]),ce=s()([f()(["data","cameras"]),x()(function(e){var t=e;return oe(e)||(t.videoStreams=ae(e.archives)),t}),u()(oe),_()(ne),x.a.convert({cap:!1})(function(e,t,n){var r=ne(e),i=ee(r),o="0"===i[1],a=g()(J(r),n);return W({dev:K(r),host:X(r),id:o&&!a?i[0]:i.join("."),channel:Z(r),origin:r},e)})]);function ue(e,t){var n=[],r=N.i({filter:e,limit:t}),i=[],a=Object(V.b)(),c=a.promise,u=a.resolve,l=a.reject,h={abort:function(){r.abort()},progress:function(e){return"function"==typeof e&&i.push(e),this},then:function(e,t){return this.promise=this.promise.then(e,t),this},promise:c};return r.then(function a(c){var l=se(c);return n=o()(n)(ce(c)),s()(i)(n),l?(r=N.i({filter:e,limit:t,next:l}),r.then(a,O.a),h.abort=r.abort,h):(u(n),n)},function(e){return l(e),e}),h}var le=A()(function(e){return N.i({filter:e}).then(ce)});le.cache=new F.a(q.d);var he=m()(0,"streamType"),de=s()(f()(["data"]),h.a,x()(function(e){var t=U(e,2),n=t[0],r=t[1];return W({format:Object(z.b)(he(r)),accessPoint:n},r)}),u()(f()("streamType"))),fe="ALPHABET",pe="ID",me=(r={},G(r,fe,function(e){return Object(H.c)(["displayName","id"],[H.a,H.b],e)}),G(r,pe,function(e){return Object(H.c)(["id"],[H.b],e)}),r),ve=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:pe;return s()([me[t],e?R.a:O.a])},be=f()("ptzs[0].accessPoint"),ye=f()("ptzs[0]"),ge=(s()(ye,D()(["move","zoom"])),function(e,t){return S()(re(e),re(t))}),ke=x()(function(e){return W({format:B.b.MJPG},e)})},275:function(e,t,n){"use strict";var r=n(1),i=n(151),o=n.n(i),a=n(3),s=n.n(a),c=n(24),u=n.n(c),l=n(97),h=n.n(l),d=n(21),f=n.n(d),p=n(92),m=n.n(p),v=n(121),b=n.n(v),y=n(9),g=n(115),k=n(44);function O(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function w(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var S=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),w(this,"handleLoad",void 0),w(this,"handleError",void 0),w(this,"handleLoad",Function.prototype),w(this,"handleError",Function.prototype),w(this,"handleStop",Function.prototype)}var t,n,r;return t=e,n=[{key:"clean",value:function(){}},{key:"play",value:function(){}},{key:"stop",value:function(){}},{key:"push",value:function(){}},{key:"stats",value:function(){}},{key:"setAudio",value:function(){}},{key:"getImageData",value:function(){return k.d}},{key:"getImageInfo",value:function(){return{}}}],n&&O(t.prototype,n),r&&O(t,r),e}(),j=S,_=n(40),P=n.n(_),C=n(188),E=n.n(C),x=n(4),T=8;function A(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=0,i=0;i<e;i+=1)r+=t[n+i]<<(e-1-i)*T;return r}function I(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return e[n+(t=r,t/T|0)]>>T-1-r%T&1}function D(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var L={tags:[null,null,null,"ES_DescrTag","DecoderConfigDescrTag","DecoderSpecificInfo"],DecoderSpecificInfo:function(e){var t={};return t.objectType=e[1]>>3,t},DecoderConfigDescrTag:function(e){var t={},n=1;t.objectTypeIndication=e[n++],t.streamType=127&e[n],t.upStream=2&e[n++],t.bufferSizeDB=A(3,e,n+=3),t.maxBitrate=A(4,e,n),n+=4,t.avgBitrate=A(4,e,n),n+=4;var r=this.tags[e[n++]],i=M(e,n);return this[r]&&(t[r]=this[r](i)),t},ES_DescrTag:function(e){var t={},n=1;t.ES_ID=A(2,e,n),n+=2,t.streamDependenceFlag=256&e[n],t.URL_Flag=128&e[n],t.OCRstreamFlag=64&e[n],t.streamPriority=63&e[n],n+=1,t.streamDependenceFlag&&(t.dependsOn_ES_ID=A(2,e,n),n+=2),t.URL_Flag&&(t.URLlength=e[n++],t.URLstring=e.subarray(n,n+=t.URLlength)),t.OCRstreamFlag&&(t.OCR_ES_Id=A(2,e,n),n+=2);var r=this.tags[e[n++]],i=M(e,n);return this[r]&&(t[r]=this[r](i)),t}};function M(e,t){var n=function(e,t){for(var n=t,r=128&e[n],i=127&e[n],o=i;r;)r=128&e[++n],i=127&e[n],o=o<<7|i;return[n,o]}(e,t),r=D(n,2),i=r[0],o=r[1];return e.subarray(i,i+o)}var $=function(e){var t={},n=0;t.version=e[n++],t.flags=e.subarray(n,n+=3);var r=L.tags[e[n++]],i=M(e,n);return L[r]&&(t[r]=L[r](i)),t},R=n(16),B=["n/s","nonIDR","partA","partB","partC","IDR","SEI","SPS","PPS","AUD","EOSq","EOS","FD"],N=["I","I P","I P B","SI","SI SP","I SI","I SI P SP","I SI P SP B"],F=["P","B","I","SP","SI","P","B","I","SP","SI"];function z(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=t%T,r=t-n,i=(t-n)/T,o=-1,a=n,s=0;!s;a+=1,o+=1)s=I(e,i,a);for(var c=(1<<o)-1,u=0;u<o;u+=1){var l=I(e,i,a+u);c+=l<<o-u-1}return{codeNum:c,offsetBits:r+a+o}}function V(e){for(var t=0,n=0,r=[];t+4<=e.byteLength;){if(n=A(4,e,t),n<0||n>e.byteLength)return r.push("invalid NALU"),r;t+=4;var i=31&e[t];switch(i){case 1:var o=z(e,(t+1)*T),a=o.offsetBits,s=z(e,a),c=s.codeNum;r.push(F[c]?F[c]:c);break;case 5:r.push(B[i]);break;case 6:break;case 9:var u=(286261248&e[t+1])>>5;r.push(N[u])}t+=n}return r}function H(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var q=new Uint8Array([109,100,97,116]),U=new Uint8Array([97,118,99,67]),Y=new Uint8Array([104,118,99,67]),W=new Uint8Array([101,115,100,115]),G=new Uint8Array([116,102,100,116]),X=4,K=4,Z=Math.pow(2,32),J=4,Q=8;function ee(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=!1,i=n;i<e.byteLength-t.length;i++){r=!0;for(var o=0;o<t.length;o++)if(e[i+o]!=t[o]){r=!1;break}if(r)return i-X}return-1}function te(e){var t=function(e){var t=ee(e,U);if(-1===t)return"";t+=X+K;var n=e[t++],r=Object(R.j)(e.subarray(t,t+3));return"avc".concat(n,".").concat(r)}(e)||function(e){var t=ee(e,Y);if(t<0)return"";t+=X+K;var n=e[t++],r=(192&e[t])>>6,i=["","A","B","C"][r],o=(32&e[t])>>5,a=["L","H"][o],s=31&e[t++],c=Object(R.m)(H(e.subarray(t,t+=4))),u=Object(R.k)(e.subarray(t,t+=6)),l=e[t];return"hvc".concat(n)+".".concat(i).concat(s)+".".concat(c)+".".concat(a).concat(l)+".".concat(u)}(e),n=function(e){var t=ee(e,W);if(t<0)return"";var n=t+K+X,r=e.subarray(n,t+A(X,e,t)),i=$(r),o=i.ES_DescrTag.DecoderConfigDescrTag,a=o.objectTypeIndication,s=o.DecoderSpecificInfo.objectType,c="mp4a.".concat(a.toString(16),".").concat(s);return c}(e),r=[],i=!1,o=!1;return t&&(i=!0,r.push(t)),n&&(o=!0,r.push(n)),{hasVideo:i,hasAudio:o,mime:'video/mp4; codecs="'.concat(r.join(),'"')}}function ne(e){for(var t=[],n=0,r=ee(e,q);-1!==r;){var i=A(4,e,r),o=r+X+K,a=o+i;t.push(V(e.subarray(o,a))),n=a,r=ee(e,q,n)}return t.join("\n")}var re=n(5);function ie(e){return ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ie(e)}function oe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function ae(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function se(e){return se=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},se(e)}function ce(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ue(e,t){return ue=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},ue(e,t)}function le(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var he="n/a",de="stalled",fe="waiting",pe="no buffer",me="in progress",ve="playing",be="paused",ye="seek",ge=re.i,ke={leading:!0,trailing:!1},Oe=function(e){return P()(.5,16,E()((t=e,t+Math.pow(t,3)+1),1));var t};var we=function(e){function t(e,n){var i,o,a,s=n.handleLoad,c=n.handleError,u=n.handleStop;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o=this,a=se(t).call(this),i=!a||"object"!==ie(a)&&"function"!=typeof a?ce(o):a,le(ce(i),"buffer",void 0),le(ce(i),"bufDiff",void 0),le(ce(i),"pendingPlay",void 0),le(ce(i),"remote0",void 0),le(ce(i),"remoteT",void 0),le(ce(i),"local0",void 0),le(ce(i),"mse",void 0),le(ce(i),"queue",void 0),le(ce(i),"$videoTag",void 0),le(ce(i),"video",void 0),le(ce(i),"handleData",void 0),le(ce(i),"codec",void 0),le(ce(i),"bdmt",void 0),le(ce(i),"state",void 0),x.a.video("videoCell","MSE player"),i.handleLoad=s,i.handleError=c,i.handleStop=u,i.bufDiff=0,i.pendingPlay=null,i.initBuffer=i.initBuffer.bind(ce(i)),i.consume=i.consume.bind(ce(i)),i.correctRate=b()(i.correctRate.bind(ce(i)),re.h),i.free=b()(i.free.bind(ce(i)),ge,ke),i.mse=new MediaSource,i.queue=[],i.codec="â€¦",i.bdmt=-1,i.state=he,i.$videoTag=Object(r.a)("<video>").addClass("VideoCell__video").attr({src:URL.createObjectURL(i.mse)}).one({error:function(e){x.a.video("mse error %s\n%o",i.video.error,e),i.handleError(i.video.error)}}).on({stalled:function(){i.state=de,x.a.video("mse %cstalled","color: crimson")},waiting:function(){i.state=fe,x.a.video("mse %cwaiting","color: orange")},play:function(){return i.handleLoad()},playing:function(){i.state=ve},paused:function(){i.state=be},progress:function(e){var t=e.target,n=t;if(0===n.buffered.length)return i.state=pe,void(i.video.currentTime=0);i.state=me;var r=n.buffered.start(n.buffered.length-1),o=n.buffered.end(n.buffered.length-1);if(!i.pendingPlay&&n.paused&&(i.pendingPlay=n.play(),i.pendingPlay)){var a=function(){i.pendingPlay=null};i.pendingPlay.then(a,a)}!n.paused&&(r>n.currentTime||n.currentTime>o)&&(i.state=ye,n.currentTime=o,x.a.video("mse seek to last TimeRange (%d)",n.buffered.length))}}).appendTo(e);var l=oe(i.$videoTag,1);return i.video=l[0],i.video.muted=!0,i.video.controls=!1,i.video.preload="none",i.handleData=i.initBuffer,i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ue(e,t)}(t,e),n=t,i=[{key:"getImageInfo",value:function(){return{width:this.video.videoWidth,height:this.video.videoHeight}}},{key:"start",value:function(){var e=this.remoteT-this.remote0,t=this.video.buffered,n=t.length-1;t.length>0&&(this.video.currentTime=t.start(n)+e,this.video.play(),x.a.video("mse start playing (at %fs)",this.video.currentTime),this.buffer.removeEventListener("updateend",this.start),this.remote0=this.remoteT)}},{key:"consume",value:function(){if(!this.buffer.updating){var e=this.queue[0];if(e){var t=this.bdmt;if(this.bdmt=function(e){var t=-1,n=ee(e,G);if(-1!==n){n+=X+K;var r=e.slice(n,n+Q),i=new DataView(r.buffer);t=i.getUint32(0)*Z+i.getUint32(J)}return t}(new Uint8Array(e.payload)),this.bdmt<t&&0===this.bdmt)this.buffer.remove(0,1/0);else{try{this.buffer.appendBuffer(e.payload)}catch(e){x.a.video("mse error %s\n%o",this.video.error,e),this.handleError(this.video.error)}this.queue.shift()}}}}},{key:"free",value:function(){if(this.video&&!this.video.paused&&!this.buffer.updating){var e=this.video.played.end(0)-8;e<0||this.buffer.remove(0,e)}}},{key:"initBuffer",value:function(){var e,t=this,n=this.queue,r={};do{var i=oe(n,1);e=i[0];var o=new Uint8Array(e.payload);if(r=te(o),r.hasVideo){x.a.video("mse","NALU",ne(o));break}n.shift()}while(n.length>0);if(!r.hasVideo)return x.a.video("mse %cno moov","font: bold; color: red"),void this.handleError("no moov");r.hasAudio&&this.$videoTag.trigger({type:"audioTrack"}),this.remote0=Object(re.p)(e.pts);var a,s,c;a="open"===this.mse.readyState,s=function(){x.a.video("videoCell","mse",r.mime),t.buffer=t.mse.addSourceBuffer(r.mime),t.buffer.mode="segments",t.buffer.addEventListener("update",t.consume),t.codec=r.mime,t.handleData=t.consume},c=this.mse.addEventListener.bind(this.mse,"sourceopen"),a?s():c(s)}},{key:"stop",value:function(){this.video.pause(),this.queue.length=0}},{key:"push",value:function(e){this.queue.push(e),this.handleData()}},{key:"clean",value:function(){this.free.cancel(),this.handleStop(),URL.revokeObjectURL(this.video.src),this.$videoTag.remove(),this.mse=void 0,this.$videoTag=void 0,this.video=void 0}},{key:"setAudio",value:function(e){this.video.muted=e}},{key:"setVolume",value:function(e){this.video.volume=e}},{key:"getImageData",value:function(){return Object(k.f)(this.video)}},{key:"stats",value:function(){var e=this.queue.length,t=this.video.currentTime,n=this.remote0,r=this.remoteT,i=r-n,o=i-t,a=["","state\t".concat(this.state),"codec\t".concat(this.codec),"queue\t".concat(e," pkts")," bdmt\t".concat(this.bdmt),"   Î”t\t".concat(Object(R.b)(o)," s"),"mse t\t".concat(Object(R.b)(t)," s")];if(this.buffer&&this.buffer.buffered.length>0){var s=this.buffer.buffered,c=this.bufferEnd;a.push("buf t\t".concat(Object(R.b)(s.start(0)),"â€¦").concat(Object(R.b)(c)," s"))}return a.join("\n")}},{key:"correctRate",value:function(){if(this.video&&!this.video.paused&&0!==this.video.played.length&&0!==this.buffer.buffered.length){var e=this.video.currentTime,t=this.bufferEnd-e;this.video.playbackRate=Oe(t-.1),this.bufDiff=t}}},{key:"bufferEnd",get:function(){var e=this.buffer.buffered;return e.end(e.length-1)}}],i&&ae(n.prototype,i),o&&ae(n,o),t}(j),Se=we,je=n(292),_e=n.n(je);function Pe(e){return Pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Pe(e)}function Ce(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Ee(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function xe(e){return xe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},xe(e)}function Te(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ae(e,t){return Ae=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Ae(e,t)}function Ie(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var De=function(e){function t(e,n){var i,o,a,s=n.handleLoad,c=n.handleError,u=n.handleStop;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o=this,a=xe(t).call(this),i=!a||"object"!==Pe(a)&&"function"!=typeof a?Te(o):a,Ie(Te(i),"blobFactory",void 0),Ie(Te(i),"inPkt",void 0),Ie(Te(i),"outPkt",void 0),Ie(Te(i),"last",void 0),Ie(Te(i),"key",void 0),Ie(Te(i),"videoTag",void 0),Ie(Te(i),"$videoTag",void 0),Ie(Te(i),"queuedPkt",void 0),Ie(Te(i),"oldUrl",void 0),Ie(Te(i),"renderId",void 0),x.a.video("videoCell","IMG player"),i.handleLoad=s,i.handleError=c,i.handleStop=u,i.inPkt=0,i.outPkt=0,i.last=performance.now(),i.renderBlob=i.renderBlob.bind(Te(i)),i.queueRender=i.queueRender.bind(Te(i)),i.queuedPkt={payload:[]},i.loading=!1,i.$videoTag=Object(r.a)("<img>").addClass("VideoCell__video").one({load:s,error:c}),i.$helpImg=Object(r.a)("<img>").on({load:function(){URL.revokeObjectURL(i.oldUrl),i.loading=!1}});var l=Ce(i.$helpImg,1);i.helpImg=l[0];var h=Ce(i.$videoTag,1);return i.videoTag=h[0],e.append(i.$videoTag),_e()(i.$videoTag),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ae(e,t)}(t,e),n=t,i=[{key:"getImageInfo",value:function(){return{width:this.videoTag.naturalWidth,height:this.videoTag.naturalHeight}}},{key:"queueRender",value:function(e){this.renderId||this.loading||(this.renderId=requestAnimationFrame(this.renderBlob)),this.queuedPkt=e}},{key:"renderBlob",value:function(){var e=URL.createObjectURL(new Blob([this.queuedPkt.payload],{type:"image/jpeg"}));this.oldUrl=this.helpImg.src,this.videoTag.src=e,this.helpImg.src=e,this.loading=!0,this.outPkt+=1,this.renderId=0}},{key:"push",value:function(e){this.key=e.key,this.inPkt+=1,this.queueRender(e)}},{key:"clean",value:function(){cancelAnimationFrame(this.renderId),this.handleStop(),URL.revokeObjectURL(this.videoTag.src),this.key=-1,this.$videoTag.remove(),this.$videoTag=null,this.videoTag=null}},{key:"getImageData",value:function(){return Object(k.f)(this.videoTag)}},{key:"stats",value:function(){var e=performance.now(),t=e-this.last,n=Math.floor(re.h*this.inPkt/t),r=Math.floor(re.h*this.outPkt/t);return this.inPkt=0,this.outPkt=0,this.last=e,"\n in ".concat(n," pkt/s\nout ").concat(r," pkt/s\n\t\t")}}],i&&Ee(n.prototype,i),o&&Ee(n,o),t}(j),Le=De,Me=n(25),$e=n(43),Re=n(27),Be=n(65),Ne=n(174),Fe=n(13);n(333);r.a.widget("app.selectMode",{options:{},defaultElement:"<form>",_create:function(){var e=this,t=this.element,n=Object(r.a)("<label>").addClass("Mode-trigger__btn"),i=Object(r.a)("<input>").attr({type:"radio",name:"videoMode"}),o=Object(r.a)(this.iconLive).addClass("Mode-trigger__icon"),a=Object(r.a)(this.iconArch).addClass("Mode-trigger__icon"),s=Object(r.a)(this.iconSearch).addClass("Mode-trigger__icon"),c=i.clone().attr({value:"live",name:"mode"}).prop({checked:!0}).addClass("Mode-trigger__input_live"),u=i.clone().attr({value:"arch",name:"mode"}).addClass("Mode-trigger__input_arch"),l=i.clone().attr({value:"search",name:"mode"}).addClass("Mode-trigger__input_search"),h=n.clone().attr({title:y.a.locale.live}).addClass("Mode-trigger__btn_live").append(c).append(o),d=n.clone().attr({title:y.a.locale.archive}).addClass("Mode-trigger__btn_arch").append(u).append(a),f=n.clone().attr({title:y.a.locale.search}).addClass("Mode-trigger__btn_search").append(l).append(s);this.$arch=d,this.$search=f,this.$radioLive=c,this.$radioArch=u,this.$radioSearch=l,this.updateSelect=this.updateSelect.bind(this),t.append(h).append(d).append(f).appendTo(this.element).on({click:function(e){e.stopPropagation()},change:function(){var t=e.topic,n=e.getMode();t(t.key.APP_MODE).put(n)}}),this.element.addClass("Mode-trigger").append(t),this.topic(this.topic.key.APP_MODE).observe(this.updateSelect)},_destroy:function(){this.topic(this.topic.key.APP_MODE).unobserve(this.updateSelect),this.element.empty()},getMode:function(){return this.element.find(":checked").val()},disabled:function(e){e&&this.$radioLive.prop({checked:!0}),this.$radioArch.prop({disabled:e}),this.$arch.toggleClass("Mode-trigger--disabled",e),this.$radioSearch.prop({disabled:e}),this.$search.toggleClass("Mode-trigger--disabled",e)},updateSelect:function(e){switch(e){case Me.a.ARCH_SEARCH:this.$radioSearch.prop({checked:!0});break;case Me.a.ARCH:this.$radioArch.prop({checked:!0});break;case Me.a.LIVE:this.$radioLive.prop({checked:!0})}},iconLive:'\n<svg viewBox="0 0 32 32">\n\t<rect x="3" y="5" width="26" height="18" />\n\t<rect x="6" y="7" width="20" height="14"\n\t\tstyle="fill: currentColor"\n\t/>\n\t<path d="m 13,23 v 4 0 h -4 10 5 -5 v -4"\n\t\tstyle="fill: currentColor"\n\t/>\n<svg>',iconArch:'\n<svg viewBox="0 0 32 32">\n\t<rect width="26" height="22" y="5" x="3" />\n\t<path d="m 12,18 v -2 c 0,0 0,-2 -2,-2 -2,0 -2,2 -2,2 0,0 0,2 2,2\n\t\th 12 c 2,0 2,-2 2,-2 0,0 0,-2 -2,-2 -2,0 -2,2 -2,2 v 2" />\n\t<path id="p1" d="M 8,10 V 5 m 5,0 v 5 m 5,0 V 5 m 5,0 v 5"></path>\n\t<use height="100%" width="100%" xlink:href="#p1" y="17" x="0" />\n\t<path d="m 3,10 h 26 m 0,12 H 3" />\n</svg>',iconSearch:'\n\t<svg viewBox="0 0 32 32">\n\t <g>\n\t  <circle fill-opacity="0" id="svg_1" r="8" cy="14" cx="14" stroke-width="2" style="stroke: currentColor" />\n\t  <line id="svg_4" y2="21" x2="21" y1="28" x1="28" fill-opacity="0" stroke-width="4" style="stroke: currentColor" />\n\t </g>\n\t</svg>\n\t'});var ze=n(6),Ve=n.n(ze);function He(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var qe=u()(0),Ue=qe("width"),Ye=qe("height"),We=Ve()([qe("bitrate"),R.l]);r.a.widget("app.selectStream",{options:{idx:-1},defaultElement:"<div>",_create:function(){this.update=this.update.bind(this),this.setStream=this.setStream.bind(this),this.toggleShow=this.toggleShow.bind(this),this.updateSelected=this.updateSelected.bind(this),this.topic(this.topic.key.CAM_ARCH).observe(this.toggleShow),this.$select=Object(r.a)("<select>").addClass("VideoCell-opts__selector").on("change",this.setStream),this.element.addClass("VideoCell-opts").append(this.$select)},setCamera:function(e){this.camera&&(this.camera.streams.unobserve(this.update),this.camera.streamActive.unobserve(this.updateSelected),this.camera=void 0,this.update([])),e&&(this.camera=e,e.streams.observe(this.update),this.camera.streamActive.observe(this.updateSelected))},setStream:function(e){var t=Number(e.target.value);this.camera.streamActive.put(t)},update:function(e){var t;if(this.camera){var n=r.a.map(e,function(e,t){return Object(r.a)("<option>").attr({value:t}).text("".concat(Ue(e),"â¨¯").concat(Ye(e),"\t").concat(We(e)))});(t=this.$select.empty()).append.apply(t,He(n)),this.element.toggleClass("VideoCell-opts--active",Object(Fe.j)(n))}else this.$select.empty()},updateSelected:function(e){this.$select.val(e)},toggleShow:function(e){this.element.toggleClass("hidden",Boolean(e))},_destroy:function(){}});n(242);r.a.widget("app.exportNow",{options:{camera:null},defaultElement:"<button>",_create:function(){this.exportServer=this.exportServer.bind(this),this.element.addClass("exportBtn").on({click:this.exportServer})},_destroy:function(){this.element.off({click:this.exportServer})},exportServer:function(){var e=this.options.camera,t=this.topic;if(!e)return x.a.export("no camera selected"),this;var n=t(t.key.ARCH_TIME).get(),r=e.isLive,i=r?new Date:n;return t(t.key.EXPORT_TASK).put([e,i,i,{format:"jpg"}]),this},exportCanvas:function(e){var t=Object(r.a)(e.target).parents(".VideoCell").find(".VideoCell__video").get(0),n=this.getImageCanvas(t),i=this.options.camera,o=i.id,a=i.name,s=Object(R.g)(new Date),c="".concat(o,".").concat(a,"-").concat(s,".png").replace(" ","_");window.navigator&&window.navigator.msSaveBlob?window.navigator.msSaveBlob(n.msToBlob(),c):this.saveImage(n.toDataURL("image/png"),c)},getImageCanvas:function(e){var t=document.createElement("canvas"),n=t.getContext("2d",{alpha:!1});return t.width=e.videoWidth||e.naturalWidth,t.height=e.videoHeight||e.naturalHeight,n.drawImage(e,0,0),t},saveImage:function(e,t){var n=Object(r.a)("<a>").attr({download:t,href:e}).appendTo(document.body);n.get(0).click(),n.remove()}});n(207);var Ge=n(48),Xe=n.n(Ge),Ke=n(254),Ze=n.n(Ke),Je=n(88),Qe=n.n(Je),et=n(145),tt=n.n(et),nt=n(196),rt=n.n(nt);r.a.widget("app.zoombar",{options:{min:1,max:1},_create:function(){var e=this.options.min,t=this.options.max,n=Object(r.a)("<span>").text(e).addClass("zoom-bar__val"),i=Object(r.a)("<span>").text(t).addClass("zoom-bar__val");this.$resetButton=Object(r.a)("<button>").addClass("zoom-bar__reset ").addClass("ui-button ui-priority-primary").html("&orarr;"),this.$scale=Object(r.a)("<span>").addClass("zoom-bar__scale"),this.$indicator=Object(r.a)("<span>").addClass("zoom-bar__indicator"),this.$scale.append(this.$indicator),this.element.addClass("zoom-bar").append(n).append(this.$scale).append(i).append(this.$resetButton)},setValue:function(e){var t=this.options.min,n=this.options.max,r=this.$scale.width()/(n-t),i=r*(e-t);return this.$indicator.css({transform:"translateX(".concat(i,"px)")}),this},onReset:function(){return r.a.prototype.on.apply(this.$resetButton,arguments)},_destroy:function(){this.element.remove()}});n(335);function it(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function ot(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?it(n,!0).forEach(function(t){at(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):it(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function at(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}r.a.widget("app.zoomable",{options:{min:y.a.settings.zoomMin,max:y.a.settings.zoomMax,steps:y.a.settings.zoomSteps,delta:y.a.settings.zoomDelta},REF_SCALE:1,HALF_SCALE:.5,T_TIME:.1,NO_TRANSI:!0,NO_ZOOMABLE:Object(r.a)(),_init:function(){this.geom0={scale:this.options.min,x:0,y:0},this.drag0={x:0,y:0},this.dragS={},this.transition=!1,this.drag=this.drag.bind(this),this.dragBegin=this.dragBegin.bind(this),this.dragEnd=this.dragEnd.bind(this),this.dragInit=this.dragInit.bind(this),this.publishGeom=Qe.a,this.publishTopic=rt()(re.c,this.publishTopic.bind(this)),this.reset=this.reset.bind(this),this.togglePublish=this.togglePublish.bind(this),this.transitionStart=this.transitionStart.bind(this),this.transitionStop=this.transitionStop.bind(this),this.updateGeom=this.updateGeom.bind(this),this.zoom=tt()(this.zoom.bind(this),Fe.p)},_create:function(){this._init(),this.element.wrapAll(Object(r.a)("<div>").addClass("zoom")),this.$container=this.element.parent(),this.zoomBar=r.a.app.zoombar(this.options),this.topic(this.topic.key.APP_MODE).observe(this.togglePublish),this.element.on({wheel:this.zoom,mousedown:this.dragInit,transitionend:this.transitionStop}),this.zoomBar.onReset({click:this.reset}),this.zoomBar.widget().insertAfter(this.$container),this.reset(this.NO_TRANSI)},updateGeom:function(e,t){t||this.transitionStart(),this.element.css({transform:this.makeTransform(e)}),this.zoomBar.setValue(e.scale),this.publishGeom(e)},publishTopic:function(e){this.topic(this.topic.key.ZOOM).put(ot({},e))},togglePublish:function(e){switch(e){case Me.a.LIVE:this.publishGeom=Qe.a;break;case Me.a.ARCH:case Me.a.ARCH_SEARCH:this.publishGeom=this.publishTopic,this.reset(this.NO_TRANSI)}},dragged:function(e){return void 0!==e&&(this._dragged=Boolean(e)),this._dragged},reset:function(e){this.geom=Ze()(this.geom0),this.updateGeom(this.geom,e),this.$container.removeClass("zoom--transformed"),this.transitionStop(),this.publishGeom(this.geom0)},dragInit:function(e){e.preventDefault(e),this.dragged(!1),this.geom.scale>this.geom0.scale&&(this.dragBegin(e),Object(r.a)(window).on({mousemove:this.drag,mouseup:this.dragEnd,mouseleave:this.dragEnd}),this.$container.addClass("zoom--transformed"))},frameZoom:function(e){var t=this.element.get(0),n=t.offsetHeight,r=t.offsetWidth,i=this.$container.get(0),o=i.clientHeight,a=i.clientWidth,s=a/r,c=o/n,u=Math.abs((e.scale-s)/2),l=Math.abs((e.scale-c)/2);return ot({},e,{x:Xe()(e.x,-u,u),y:Xe()(e.y,-l,l)})},drag:function(e){this.dragged(!0);var t=this.element.get(0),n=t.offsetHeight,r=t.offsetWidth,i={x:this.geom.x+(e.pageX-this.dragS.x)/r,y:this.geom.y+(e.pageY-this.dragS.y)/n,scale:this.geom.scale};this.geom=this.frameZoom(i),this.dragBegin(e),this.updateGeom(this.geom,this.NO_TRANSI)},dragBegin:function(e){this.dragS.x=e.pageX,this.dragS.y=e.pageY},dragEnd:function(){Object(r.a)(window).off({mousemove:this.drag,mouseup:this.dragEnd,mouseleave:this.dragEnd})},fit:function(e){this.$container.css({flexDirection:e})},zoom:function(e){var t=this.options.min,n=this.options.max,r=this.options.delta,i=r*Math.sign(e.deltaY),o=this.geom.scale,a=o*(this.REF_SCALE+i);if(e.originalEvent.preventDefault(),!(this.transition||a>n))if(a<t)this.reset();else{var s=this.element.get(0).getBoundingClientRect(),c=(e.pageX-s.left)/s.width,u=(e.pageY-s.top)/s.height,l={x:this.geom.x+(a-o)*(this.HALF_SCALE-c),y:this.geom.y+(a-o)*(this.HALF_SCALE-u),scale:a};this.geom=this.frameZoom(l),this.updateGeom(this.geom),this.$container.addClass("zoom--transformed")}},transitionStart:function(){this.transition=!0,this.element.css({transition:"transform ".concat(this.T_TIME,"s")})},transitionStop:function(){this.transition=!1,this.element.css({transition:"transform ".concat(0,"s")})},_destroy:function(){this.reset(),this.zoomBar.destroy(),this.element.off().unwrap(this.$container)},makeTransform:function(e){var t=e.x,n=e.y,r=e.scale;return"translate(".concat(100*t,"%,").concat(100*n,"%) scale(").concat(r,")")}});n(336);r.a.widget("app.speaker",{option:{target:Object(r.a)()},defaultElement:"<div>",_create:function(){var e=this;this.setVolume=this.setVolume.bind(this),this.setAudio=this.setAudio.bind(this);this.$label=Object(r.a)("<label>").addClass("speaker");var t=Object(r.a)("<div>").addClass("speaker__volume");this.$check=Object(r.a)("<input>").addClass("speaker__chk").prop({type:"checkbox",checked:!1,hidden:!0}),this.$track=Object(r.a)("<div>").addClass("speaker__volume-track"),this.$progress=Object(r.a)("<div>").addClass("speaker__volume-progress"),this.$handle=Object(r.a)("<div>").addClass("speaker__volume-handle").draggable({axis:"y",containment:"parent",drag:function(t,n){e.setVolume(n.position.top)}}),this.$track.on({click:function(t){t.preventDefault(),t.stopPropagation();var n=Xe()(t.pageY-e.$track.offset().top,0,e.$track.height()-e.$handle.height());e.$handle.css({top:n}),e.setVolume(n)}}),this.$track.append(this.$handle).append(this.$progress),this.$label.append(this.$check).append(t.append(this.$track)),this.element.append(this.$label).on({change:this.setAudio,layoutHidden:function(){e.$check.prop({checked:!1}),e.setAudio()}}).hide()},setVolume:function(e){var t=this.$track.height()-e-this.$handle.height(),n=Xe()(1-e/this.$track.height(),0,1);this.$progress.css({height:"".concat(t,"px")}),this.options.setVolume(n)},setAudio:function(){this.options.setAudio&&this.options.setAudio(this.$check.prop("checked")),this.$label.toggleClass("speaker--with_sound",this.$check.prop("checked"))}});n(243);var st=n(337),ct=n(338),ut=n(339),lt=n(340),ht=n(244),dt=n(245),ft=n(246),pt=n(247);r.a.widget("app.playbackPanel",{_create:function(){var e=this;this.handleSpeed=this.handleSpeed.bind(this),this.setCamera=this.setCamera.bind(this),this.show=this.show.bind(this),this.hide=this.hide.bind(this),this.$playPause=Object(r.a)("<div>").addClass("Playback__btn").on({click:function(){var t=e.topic(e.topic.key.ARCH_SPEED).get(),n=0===e.topic(e.topic.key.PLAYBACK).get().speed;e.topic(e.topic.key.PLAYBACK).assign({beginTime:e.topic(e.topic.key.ARCH_TIME).get(),speed:n?t:0}),n?e.$playPause.html(lt):e.$playPause.html(ut),e.$previousFrame.toggleClass("hidden",n),e.$nextFrame.toggleClass("hidden",n),e.$incSpeed.toggleClass("hidden",!n),e.$decSpeed.toggleClass("hidden",!n)}}).append(ut),this.$nextFrame=Object(r.a)("<div>").addClass("Playback__btn").on({click:function(){return e.camera.stepForward()}}).append(ft),this.$nextFragment=Object(r.a)("<div>").addClass("Playback__btn").on({click:function(){return e.camera.nextInterval()}}).append(pt),this.$previousFrame=Object(r.a)("<div>").addClass("Playback__btn").on({click:function(){return e.camera.stepBack()}}).append(dt),this.$previousFragment=Object(r.a)("<div>").addClass("Playback__btn").on({click:function(){return e.camera.prevInterval()}}).append(ht),this.$incSpeed=Object(r.a)("<div>").addClass("Playback__btn hidden").on({click:function(){return e.handleSpeed(1)}}).append(st),this.$decSpeed=Object(r.a)("<div>").addClass("Playback__btn hidden").on({click:function(){return e.handleSpeed(-1)}}).append(ct),this.element.append(this.$previousFragment).append(this.$decSpeed).append(this.$previousFrame).append(this.$playPause).append(this.$nextFrame).append(this.$incSpeed).append(this.$nextFragment).addClass("hidden VideoCell__playback").on({dblclick:function(e){return e.stopPropagation()}})},handleSpeed:function(e){var t=y.a.settings.playspeed,n=this.topic(this.topic.key.ARCH_TIME).get(),r=this.topic(this.topic.key.ARCH_SPEED).get(),i=y.a.settings.playspeed.indexOf(r),o=P()(0,t.length-1,i+e),a=t[o];this.topic(this.topic.key.PLAYBACK).assign({speed:a,beginTime:n}),this.topic(this.topic.key.ARCH_SPEED).put(a)},setCamera:function(e){this.camera&&(this.camera=void 0),e&&(this.camera=e)},show:function(){this.element.removeClass("hidden")},hide:function(){this.element.addClass("hidden")}});n(341);r.a.widget("app.timeCell",{_create:function(){var e=this;this.handleCLick=this.handleCLick.bind(this),this.setValue=this.setValue.bind(this),this.getValue=this.getValue.bind(this);var t=this.options,n=t.value,i=t.onChange;this.$timeInput=Object(r.a)("<input>").val(n).addClass("TimeCell__time-input").on({change:i});var o=Object(r.a)("<div>").addClass("TimeCell__timeBtn prev").on({click:function(){return e.handleCLick(e.$timeInput,-1)}}),a=Object(r.a)("<div>").addClass("TimeCell__timeBtn next").on({click:function(){return e.handleCLick(e.$timeInput,1)}});this.element.append(o).append(a).append(this.$timeInput).addClass("TimeCell__timeCell"),this.element.on("mousewheel",function(t){return e.handleCLick(e.$timeInput,Math.sign(t.originalEvent.wheelDelta))})},handleCLick:function(e,t){var n=this.options.onChange,r=Number(e.val())+t;e.val(r),n()},setValue:function(e){this.$timeInput.val(e)},getValue:function(){return Number(this.$timeInput.val())}});n(209);function mt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function vt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function bt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}r.a.widget("app.selectTime",{_create:function(){this.handleChange=this.handleChange.bind(this),this.setTime=this.setTime.bind(this),this.show=this.show.bind(this),this.hide=this.hide.bind(this),this.hours=r.a.app.timeCell({onChange:this.handleChange}),this.minutes=r.a.app.timeCell({onChange:this.handleChange}),this.seconds=r.a.app.timeCell({onChange:this.handleChange}),this.element.append(this.hours.element).append(this.minutes.element).append(this.seconds.element).addClass("VideoCell__select-time hidden").on({click:function(e){return e.stopPropagation()},dblclick:function(e){return e.stopPropagation()}})},handleChange:function(){var e=this.options.onChange,t=this.hours.getValue(),n=this.minutes.getValue(),r=this.seconds.getValue();e(new Date(this.archTime.setHours(t,n,r)))},setTime:function(e){this.archTime=e;var t=e.getHours(),n=e.getMinutes(),r=e.getSeconds();return this.hours.setValue(t),this.minutes.setValue(n),this.seconds.setValue(r),this},show:function(){return this.element.removeClass("hidden"),document.addEventListener("click",this.hide),this.topic(this.topic.key.ARCH_TIME).observe(this.setTime),this},hide:function(){return this.element.addClass("hidden"),document.removeEventListener("click",this.hide),this.topic(this.topic.key.ARCH_TIME).unobserve(this.setTime),this},_destroy:function(){this.hide(),this.element.empty()}});var yt=u()("NULL","dev"),gt=u()(!1,"isLive");r.a.widget("app.videoCell",{options:{key:-1,conn:null},STYLE_ACTIVE:"VideoCell--active",STYLE_LOADING:"VideoCell--loading",STYLE_PLAYING:"VideoCell--playing",STYLE_EMPTY:"VideoCell--empty",STYLE_ERROR:"VideoCell--error",STYLE_NOVIDEO:"VideoCell--novideo",_init:function(){var e=this;this.handleActive=this.handleActive.bind(this),this.handleList=this.handleList.bind(this),this.handleLoad=this.handleLoad.bind(this),this.handleError=this.handleError.bind(this),this.handlePlaybackPanel=this.handlePlaybackPanel.bind(this),this.handleStop=this.handleStop.bind(this),this.updateState=this.updateState.bind(this),this.handleFullscreen=this.handleFullscreen.bind(this),this.handleVisibilityChange=this.handleVisibilityChange.bind(this),this.updatePlayer=this.updatePlayer.bind(this),this.updateIndex=this.updateIndex.bind(this),this.propagateTime=this.propagateTime.bind(this),this.publishImageInfo=this.publishImageInfo.bind(this),this.getDecoratorsHeight=m()(this.getDecoratorsHeight.bind(this)),this.debugInfo=b()(this.debugInfo.bind(this),re.c,{trailing:!1}),this.stats=this.stats.bind(this),this.gotFrame=function(){return e.element.trigger("frame")},this.renderStat=r.a.noop,this.showSpeaker=this.showSpeaker.bind(this),this.setCamera=this.setCamera.bind(this),this.setVolume=this.setVolume.bind(this),this.setAudio=this.setAudio.bind(this),this.setVisibleControls=this.setVisibleControls.bind(this),this.resetLiveStream=this.resetLiveStream.bind(this),this.videoMuted=!0,this.renderTime=m()(this.renderTime.bind(this),Object(re.q)(re.h)),this.renderTime.cache=new Fe.a,this.pushTime=m()(this.pushTime.bind(this),Object(re.q)(re.h)),this.pushTime.cache=new Fe.a,this.mediaState=Object(g.a)(this),this.meta={time:function(){return Object(R.d)(e.lastPts)},title:function(){return u()("",["camera","fullname"],e)}},this.topic(this.topic.key.STATS).observe(this.stats),this.topic(this.topic.key.APP_MODE).observe(this.handlePlaybackPanel),this.topic(this.topic.key.CAM_ARCH).observe(this.publishImageInfo);this.element.on({click:function(t){var n=t.ctrlKey;e.topic(e.topic.key.CAM_ACTIVE).get()!==e.camera&&e.topic(e.topic.key.UPDATE_CAM_ACTIVE).put(n?void 0:e.camera)},dblclick:function(){var t=e.element.fullScreen();e.element.fullScreen(!t),e.element.toggleClass("VideoCell--fullscreen")}}),Object(r.a)(document).on({fullscreenchange:this.handleFullscreen,visibilitychange:this.handleVisibilityChange})},_create:function(){var e=this,t=this.players.null,n=Object(r.a)("<div>").addClass("VideoCell__bar__fill"),i=Object(r.a)("<div>").addClass(["VideoCell__title","VideoCell__title__left"]).data("key","title"),o=Object(r.a)("<div>").addClass(["VideoCell__title","VideoCell__title__right"]).data("key","time"),a=Object(r.a)().add(i).add(o);if(a.on({mousedown:Object(Ne.a)(function(t){var n=Object(r.a)(t.currentTarget).data("key"),i=h()(["meta",n],e);e.topic(e.topic.key.CLIPBOARD).put({text:i})}),contextmenu:function(){return!1}}),!this.options.conn)throw new Error("No connection provided to VideoCell");this.$bar=Object(r.a)("<div>").addClass("VideoCell__bar"),this.$barContainer=Object(r.a)("<div>").addClass("VideoCell__bar-container").on({dblclick:function(e){return e.stopPropagation()}}),this.$frontLayer=Object(r.a)("<div>").addClass("VideoCell__front-layer"),this.$container=Object(r.a)("<div>").addClass("VideoCell__box"),this.$title=Object(r.a)("<span>").addClass("VideoCell__title__text"),this.$intermediateFrame=Object(r.a)("<canvas>").addClass("VideoCell__video-canvas"),this.$time=Object(r.a)("<span>").addClass("VideoCell__title__text").on({click:function(t){t.stopPropagation(),e.selectTime.show()}}),this.conn=this.options.conn,this.selectTime=r.a.app.selectTime({onChange:function(t){return e.topic(e.topic.key.PLAYBACK).assign({beginTime:t})}}),this.selectStream=r.a.app.selectStream(),this.selectArch=r.a.app.selectArch(),this.exportNow=r.a.app.exportNow(),this.fscreen=r.a.app.fscreen({target:this.element}),this.player=new t,this.speaker=r.a.app.speaker({target:this.$container}),this.playbackPanel=r.a.app.playbackPanel(),this.exportNow.element.addClass("VideoCell-button").addClass("VideoCell-button--blank"),this.fscreen.element.addClass("VideoCell-button"),this.speaker.element.addClass("VideoCell-button").addClass("VideoCell-button--blank"),this.$barContainer.append(i.append(this.$title)).append(n.clone()).append(o.append(this.$time)).append(this.selectStream.element).append(this.selectArch.element),this.$bar.append(this.$barContainer),this.$frontLayer.append(n.clone()).append(this.exportNow.element).append(this.speaker.element),this.element.addClass("VideoCell").addClass(this.STYLE_EMPTY).append(this.$bar).append(this.$frontLayer).append(this.$container).append(this.playbackPanel.element).append(this.selectTime.element),this.$container.append(this.$intermediateFrame).zoomable()},_destroy:function(){this.camera&&this.setCamera(void 0),this.topic(this.topic.key.STATS).unobserve(this.stats),this.topic(this.topic.key.APP_MODE).unobserve(this.handlePlaybackPanel),this.topic(this.topic.key.CAM_ARCH).unobserve(this.publishImageInfo),this.selectStream.destroy(),this.selectArch.destroy(),this.exportNow.destroy(),this.fscreen.destroy(),this.speaker.destroy(),this.$container.zoomable("destroy"),this.element.remove(),this.selectTime.destroy(),this.playbackPanel.destroy()},_setOptions:function(e){var t=e.camera,n=e.origin,r=e.pending,i=e.pos;i&&this.element.css({left:Object(R.a)(i.left),right:Object(R.a)(i.right),top:Object(R.a)(i.top),bottom:Object(R.a)(i.bottom)});var o=f()(this.origin,n);o||(this.origin=n),!o&&t&&this.setCamera(t),!o&&r&&r.then(this.setCamera)},setVisibleControls:function(e){this.$barContainer&&this.$frontLayer&&(e?(this.$barContainer.show(),this.$frontLayer.show()):(this.$barContainer.hide(),this.$frontLayer.hide()))},showSpeaker:function(){this.speaker.options.setAudio=this.setAudio,this.speaker.options.setVolume=this.setVolume,this.player.setAudio(this.videoMuted),Object(r.a)(this.speaker.element).show()},setVolume:function(e){this.player.setVolume(e)},setAudio:function(e){this.videoMuted=!e,this.player.setAudio(this.videoMuted)},setCamera:function(e){x.a.video("videoCell",this.options.key,"setting camera to",yt(e),"from",yt(this.camera)),Object(Re.m)(e,this.camera)&&x.a.video("videoCell","same camera!"),this.camera&&(this.mediaState=this.mediaState.stop(),this.topic(this.topic.key.PLAYBACK).unobserve(this.updatePlayer),this.topic(this.topic.key.CAM_ACTIVE).unobserve(this.handleActive),this.topic(this.topic.key.CAM_ACTIVE).unobserve(this.updatePlayer),this.topic(this.topic.key.CAM_STATES).unobserve(this.updateState),this.camera.streamActive.unobserve(this.updatePlayer),this.camera.streams.unobserve(this.resetLiveStream),this.element.removeClass([this.STYLE_NOVIDEO,this.STYLE_PLAYING,this.STYLE_LOADING,this.STYLE_ERROR]).addClass(this.STYLE_EMPTY),this.$container.zoomable("reset"),this.exportNow.options.camera=void 0,this.playbackPanel.setCamera(void 0),this.selectStream.setCamera(void 0),this.selectArch.setCamera(void 0),this.camera=void 0,this.speaker.element.hide(),this.clearCell(),this.renderStat()),e?(this.setTitle(e),this.camera=e,this.topic(this.topic.key.CAM_STATES).observe(this.updateState),this.exportNow.options.camera=e,this.playbackPanel.setCamera(e),this.selectStream.setCamera(e),this.selectArch.setCamera(e),this.topic(this.topic.key.PLAYBACK).observe(this.updatePlayer),this.topic(this.topic.key.CAM_ACTIVE).observe(this.handleActive),this.topic(this.topic.key.CAM_ACTIVE).observe(this.updatePlayer),e.streamActive.observe(this.updatePlayer),e.streams.observe(this.resetLiveStream),this.element.removeClass([this.STYLE_EMPTY,this.STYLE_ERROR,this.STYLE_NOVIDEO]),this.renderStat()):this.element.addClass([this.STYLE_NOVIDEO]),this.canvasClear()},setTitle:function(e){var t="",n="";e&&(t=e.id,n=e.fullname),this.$title.text(n),this.$container.attr({"data-id":t})},setType:function(e){if(this.player.clean(),e in this.players){var t=this.players[e];this.player=new t(this.$container,{handleLoad:this.handleLoad,handleError:this.handleError,handleStop:this.handleStop}),this.resetStyle()}},clearCell:function(){this.key=0,this.setTitle(),this.setType(null),this.element.addClass(this.STYLE_NOVIDEO)},handleActive:function(e){var t=Object(Re.m)(e,this.camera);this.element.toggleClass(this.STYLE_ACTIVE,t)},handleList:function(e){var t=e[this.options.key];Object(Re.m)(t,this.camera)||this.setCamera(t)},resetStyle:function(){this.element.removeClass([this.STYLE_ERROR,this.STYLE_LOADING])},handleLoad:function(){this.resetStyle(),this.canvasClear(),this.publishImageInfo(this.camera)},handleError:function(){this.element.addClass(this.STYLE_ERROR),this.mediaState=this.mediaState.stop().play()},handleStop:function(){var e=this.player.getImageData();if(e){var t=bt(this.$intermediateFrame,1),n=t[0],r=n.getContext("2d");n.width=e.width,n.height=e.height,r.putImageData(e,0,0)}},updateState:function(e,t){var n,r,i,o,a;return regeneratorRuntime.async(function(c){for(;;)switch(c.prev=c.next){case 0:if(n=s()("origin",this.camera),r=s()([n],e),i=s()([n],t),n||!f()(r,i)){c.next=5;break}return c.abrupt("return");case 5:return c.next=7,regeneratorRuntime.awrap(this.camera.isReady);case 7:if(o=c.sent,a=r,!a||o){c.next=13;break}return c.next=12,regeneratorRuntime.awrap(this.camera.getStreamsMeta());case 12:this.setCamera(this.camera);case 13:a&&o&&this.updatePlayer(),a||(this.mediaState=this.mediaState.stop()),this.element.toggleClass(this.STYLE_NOVIDEO,!a);case 16:case"end":return c.stop()}},null,this)},handleFullscreen:function(){var e=this.topic(this.topic.key.PREFS).get(),t=e.disconnectInactive,n=Object(r.a)(document).fullScreen(),i=n===this.element[0]||n===document.body;n&&!i&&t&&(this.mediaState=this.mediaState.stop()),!n&&this.camera&&(this.mediaState=this.mediaState.play())},updateIndex:function(e){var t=this.topic(this.topic.key.CELL_IDX).get(),n=Object(Be.b)(e);t.set(n,this)},clearIndex:function(e){var t=this.topic(this.topic.key.CELL_IDX).get(),n=Object(Be.b)(e);t.delete(n)},handleVisibilityChange:function(){this.speaker.element.trigger("layoutHidden")},handlePlaybackPanel:function(e){e===Me.a.ARCH_SEARCH?this.playbackPanel.show():this.playbackPanel.hide()},updatePlayer:function(){if(this.camera){var e=this.camera,t=e.stream,n=e.isOnline,i=this.topic(this.topic.key.APP_MODE).get(),o=i===Me.a.LIVE&&!n;if(t.format){var a=Object(Re.m)(this.topic(this.topic.key.CAM_ACTIVE).get(),this.camera),s=this.topic(this.topic.key.PREFS).get(),c=s.noKeyFrames,u=this.topic(this.topic.key.PLAYBACK).get(),l=0===u.speed&&!u.beginTime||o,h={endpoint:t.accessPoint,format:Object(Fe.g)(t.format),method:l?"stop":"play",speed:u.speed,keyFrames:!c&&!a};u.beginTime&&(h.beginTime=Object(re.m)(u.beginTime),h.archive=this.camera.archSelectedStorage,h.archFastMjpeg=this.topic(this.topic.key.PREFS).get().archFastMjpeg),h.format===$e.a.JPEG&&(h.width=Object(Fe.f)(this.element.width(),y.a.settings.frameWidthList),h.height=0,h.vc=y.a.settings.mjpegCompression),this.mediaState=this.mediaState[h.method](h),this.resetStyle(),this.element.toggleClass(this.STYLE_NOVIDEO,o),Object(r.a)(this.player.video).one("audioTrack",this.showSpeaker)}}},player:null,players:{null:j,mse:Se,img:Le},push:function(e){this.pts0=this.pts0||e.pts,this.now0=this.now0||Date.now(),this.player.push(e),o()(this.propagateTime,e),o()(this.renderStat,e),o()(this.gotFrame)},updateTime:function(e,t){t(e)},renderTime:function(e){this.$time[0].innerText=Object(R.e)(e)},pushTime:function(e){this.topic(this.topic.key.ARCH_TIME).put(e)},propagateTime:function(e){var t=gt(this.camera);if(!t){var n=new Date(e.pts);this.pushTime(n)}this.renderTime(e.pts),this.lastPts=e.pts},debugInfo:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.pts-this.pts0,n=Date.now()-this.now0,r=t-n,i=this.camera?Object.entries(this.camera.state.get()):["n/a"],o=yt(this.camera);this.$debug[0].innerText="\nplr\t".concat(this.mediaState.state,"\ncam\t").concat(o,"\n\t").concat(i.join("\n\t"),"\n\nkey ").concat(e.key,"\npts ").concat(e.pts,"\nÎ”ts ").concat(r,"\nlen ").concat(e.payload&&e.payload.byteLength,"\n").concat(this.player.stats(),"\n\t\t")},stats:function(e){e&&(this.$debug=Object(r.a)("<pre>").addClass("VideoCell__debug"),this.element.append(this.$debug),this.renderStat=this.debugInfo),e&&this.camera&&this.camera.state.observe(this.debugInfo),!e&&this.$debug&&(this.$debug.remove(),this.$debug=void 0,this.renderStat=r.a.noop),!e&&this.camera&&this.camera.state.unobserve(this.debugInfo)},getImageInfo:function(){var e=this.player.getImageInfo();return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?mt(n,!0).forEach(function(t){vt(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):mt(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},e,{aspect:Object(k.a)(e)})},publishImageInfo:function(e){var t=Object(Re.m)(e,this.camera);t&&this.topic(this.topic.key.CAM_ARCH_IMAGE_INFO).put(this.getImageInfo())},canvasClear:function(){var e=bt(this.$intermediateFrame,1),t=e[0];t.getContext("2d").clearRect(0,0,t.width,t.height)},resetLiveStream:function(){var e=this.topic(this.topic.key.APP_MODE).get();e===Me.a.LIVE&&this.camera.resetLiveStream()},getDecoratorsHeight:function(){return this.$bar.height()+this.playbackPanel.element.height()}})},323:function(e,t,n){var r,i,o;i=[n(30)],r=function(e){var t,n,r=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],i="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],o=Array.prototype.slice;if(e.event.fixHooks)for(var a=r.length;a;)e.event.fixHooks[r[--a]]=e.event.mouseHooks;var s=e.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var t=i.length;t;)this.addEventListener(i[--t],c,!1);else this.onmousewheel=c;e.data(this,"mousewheel-line-height",s.getLineHeight(this)),e.data(this,"mousewheel-page-height",s.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var t=i.length;t;)this.removeEventListener(i[--t],c,!1);else this.onmousewheel=null;e.removeData(this,"mousewheel-line-height"),e.removeData(this,"mousewheel-page-height")},getLineHeight:function(t){var n=e(t),r=n["offsetParent"in e.fn?"offsetParent":"parent"]();return r.length||(r=e("body")),parseInt(r.css("fontSize"),10)||parseInt(n.css("fontSize"),10)||16},getPageHeight:function(t){return e(t).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};function c(r){var i=r||window.event,a=o.call(arguments,1),c=0,h=0,d=0,f=0,p=0,m=0;if(r=e.event.fix(i),r.type="mousewheel","detail"in i&&(d=-1*i.detail),"wheelDelta"in i&&(d=i.wheelDelta),"wheelDeltaY"in i&&(d=i.wheelDeltaY),"wheelDeltaX"in i&&(h=-1*i.wheelDeltaX),"axis"in i&&i.axis===i.HORIZONTAL_AXIS&&(h=-1*d,d=0),c=0===d?h:d,"deltaY"in i&&(d=-1*i.deltaY,c=d),"deltaX"in i&&(h=i.deltaX,0===d&&(c=-1*h)),0!==d||0!==h){if(1===i.deltaMode){var v=e.data(this,"mousewheel-line-height");c*=v,d*=v,h*=v}else if(2===i.deltaMode){var b=e.data(this,"mousewheel-page-height");c*=b,d*=b,h*=b}if(f=Math.max(Math.abs(d),Math.abs(h)),(!n||f<n)&&(n=f,l(i,f)&&(n/=40)),l(i,f)&&(c/=40,h/=40,d/=40),c=Math[c>=1?"floor":"ceil"](c/n),h=Math[h>=1?"floor":"ceil"](h/n),d=Math[d>=1?"floor":"ceil"](d/n),s.settings.normalizeOffset&&this.getBoundingClientRect){var y=this.getBoundingClientRect();p=r.clientX-y.left,m=r.clientY-y.top}return r.deltaX=h,r.deltaY=d,r.deltaFactor=n,r.offsetX=p,r.offsetY=m,r.deltaMode=0,a.unshift(r,c,h,d),t&&clearTimeout(t),t=setTimeout(u,200),(e.event.dispatch||e.event.handle).apply(this,a)}}function u(){n=null}function l(e,t){return s.settings.adjustOldDeltas&&"mousewheel"===e.type&&t%120==0}e.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}})},o="function"==typeof r?r.apply(t,i):r,void 0===o||(e.exports=o)},324:function(e,t,n){var r=n(30);n(362);
/*!
 * jQuery UI Touch Punch 0.2.3
 *
 * Copyright 2011â€“2014, Dave Furfero
 * Dual licensed under the MIT or GPL Version 2 licenses.
 *
 * Depends:
 *  jquery.ui.widget.js
 *  jquery.ui.mouse.js
 */
!function(e){if(e.support.touch="ontouchend"in document,e.support.touch){var t,n=e.ui.mouse.prototype,r=n._mouseInit,i=n._mouseDestroy;n._touchStart=function(e){!t&&this._mouseCapture(e.originalEvent.changedTouches[0])&&(t=!0,this._touchMoved=!1,o(e,"mouseover"),o(e,"mousemove"),o(e,"mousedown"))},n._touchMove=function(e){t&&(this._touchMoved=!0,o(e,"mousemove"))},n._touchEnd=function(e){t&&(o(e,"mouseup"),o(e,"mouseout"),this._touchMoved||o(e,"click"),t=!1)},n._mouseInit=function(){this.element.bind({touchstart:e.proxy(this,"_touchStart"),touchmove:e.proxy(this,"_touchMove"),touchend:e.proxy(this,"_touchEnd")}),r.call(this)},n._mouseDestroy=function(){this.element.unbind({touchstart:e.proxy(this,"_touchStart"),touchmove:e.proxy(this,"_touchMove"),touchend:e.proxy(this,"_touchEnd")}),i.call(this)}}function o(e,t){if(!(e.originalEvent.touches.length>1)){e.preventDefault();var n=e.originalEvent.changedTouches[0],r=document.createEvent("MouseEvents");r.initMouseEvent(t,!0,!0,window,1,n.screenX,n.screenY,n.clientX,n.clientY,!1,!1,!1,!1,0,null),e.target.dispatchEvent(r)}}}(r)},325:function(e,t,n){var r=n(30);
/**
 * @preserve jquery.fullscreen 1.1.5
 * https://github.com/kayahr/jquery-fullscreen-plugin
 * Copyright (C) 2012-2013 Klaus Reimer <k@ailis.de>
 * Licensed under the MIT license
 * (See http://www.opensource.org/licenses/mit-license)
 */
/**
 * @preserve jquery.fullscreen 1.1.5
 * https://github.com/kayahr/jquery-fullscreen-plugin
 * Copyright (C) 2012-2013 Klaus Reimer <k@ailis.de>
 * Licensed under the MIT license
 * (See http://www.opensource.org/licenses/mit-license)
 */
!function(e){function t(e){var t,n,r;return this.length?(t=this[0],t.ownerDocument?r=t.ownerDocument:(r=t,t=r.documentElement),null==e?r.exitFullscreen||r.webkitExitFullscreen||r.webkitCancelFullScreen||r.msExitFullscreen||r.mozCancelFullScreen?(e=!!(r.fullscreenElement||r.msFullscreenElement||r.webkitIsFullScreen||r.mozFullScreen),e&&(r.fullscreenElement||r.webkitFullscreenElement||r.webkitCurrentFullScreenElement||r.msFullscreenElement||r.mozFullScreenElement)||e):null:e?(n=t.requestFullscreen||t.webkitRequestFullscreen||t.webkitRequestFullScreen||t.msRequestFullscreen||t.mozRequestFullScreen,n&&n.call(t),this):(n=r.exitFullscreen||r.webkitExitFullscreen||r.webkitCancelFullScreen||r.msExitFullscreen||r.mozCancelFullScreen,n&&n.call(r),this)):this}function n(t){e(document).trigger(new e.Event("fullscreenchange"))}function r(t){e(document).trigger(new e.Event("fullscreenerror"))}var i,o,a;e.fn.fullScreen=t,e.fn.toggleFullScreen=function(){return t.call(this,!t.call(this))},i=document,i.webkitCancelFullScreen?(o="webkitfullscreenchange",a="webkitfullscreenerror"):i.msExitFullscreen?(o="MSFullscreenChange",a="MSFullscreenError"):i.mozCancelFullScreen?(o="mozfullscreenchange",a="mozfullscreenerror"):(o="fullscreenchange",a="fullscreenerror"),e(document).bind(o,n),e(document).bind(a,r)}(r)},330:function(e,t,n){},331:function(e,t,n){},332:function(e,t,n){},333:function(e,t,n){},334:function(e,t,n){},335:function(e,t,n){},336:function(e,t,n){},337:function(e,t){e.exports='<svg class="Playback__icon" viewBox="0 0 27 19"><polygon points="20,8 15,8 15,3 12,3 12,8 7,8 7,11 12,11 12,16 15,16 15,11 20,11 "></polygon></svg>'},338:function(e,t){e.exports='<svg class="Playback__icon" viewBox="0 0 27 19"><rect x="7" y="8" width="13" height="3"></rect></svg>'},339:function(e,t){e.exports='<svg class="Playback__icon" viewBox="0 0 27 19"><polygon points="11.5,2.5 9.5,2.5 9.5,16.5 11.5,16.5 18.5,9.5 18.5,8.5 "></polygon></svg>'},340:function(e,t){e.exports='<svg class="Playback__icon" viewBox="0 0 27 19"><rect x="7.5" y="2.5" width="4" height="14"></rect><rect x="15.5" y="2.5" width="4" height="14"></rect></svg>'},341:function(e,t,n){},342:function(e,t,n){},343:function(e,t,n){},37:function(e,t,n){"use strict";n.d(t,"a",function(){return x}),n.d(t,"e",function(){return T}),n.d(t,"h",function(){return A}),n.d(t,"g",function(){return I}),n.d(t,"f",function(){return D}),n.d(t,"b",function(){return L}),n.d(t,"c",function(){return M}),n.d(t,"d",function(){return $});var r=n(6),i=n.n(r),o=n(109),a=n.n(o),s=n(85),c=n.n(s),u=n(24),l=n.n(u),h=n(7),d=n.n(h),f=n(34),p=n.n(f),m=n(195),v=n.n(m),b=n(163),y=n.n(b),g=n(137),k=n(5);function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(n,!0).forEach(function(t){S(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function S(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function j(e,t){var n=e.get(t.multiPhaseSyncId),r=n?n.timestamp:t.timestamp,i={begin:t.timestamp,end:t.timestamp,type:t.type,timestamp:t.timestamp,positions:t.rectangles,accessPoint:t.origin};switch(t.alertState){case"began":e.set(t.multiPhaseSyncId,w({},i,{end:r}));break;case"ended":e.set(t.multiPhaseSyncId,w({},i,{begin:r,timestamp:r,positions:n?n.rectangles:t.rectangles}));break;case"happened":e.set(t.id,{timestamp:t.timestamp,type:t.type,positions:t.rectangles,accessPoint:t.origin})}return e}var _=new Date(0);function P(e){var t=l()(_,["raisedAt"],e),n=l()(t,["reaction","reactedAt"],e);return w({},e,{begin:t,end:n})}function C(e){var t=w({},e);return e.begin&&e.end&&(t.begin=Object(k.l)(e.begin),t.end=Object(k.l)(e.end)),e.timestamp&&(t.begin=Object(k.l)(e.timestamp),t.end=new Date(t.begin.getTime()+1)),t}function E(e){return Object(g.a)(Object(k.l)(e.begin),Object(k.l)(e.end))}var x=i()([a.a,l()(new Date,"date.begin")]),T=i()([c.a,l()(new Date,"date.end")]),A=d()(E);function I(e){return i()([p()(j,new Map),function(e){return e.values()},Array.from,d()(C)])(e)}var D=i()([d()(P),d()(C)]),L=p()(function(e,t){for(var n=t.time,r=n.begin,i=n.end,o=w({},e),a=new Date(0),s=0;a.getTime()<i-k.a;s+=1)a=new Date(r+k.a*s),a.setHours(0,0,0,0),o[a]=!0;return o},{}),M=p()(function(e,t){return e||t.length>0},v()()),$=function(e){return function(t){for(var n=0;n<e.length;n+=1){var r=e[n].date,i=r.begin,o=r.end,a=y()(i,o);if(a(t))return!0}return!1}}},39:function(e,t,n){"use strict";n.d(t,"a",function(){return h});var r=n(3),i=n.n(r),o=n(6),a=n.n(o),s=n(157),c=n.n(s),u=a()([i()("data.type"),c()("authToken")]),l=function(e){var t=/authToken=([^&]+)/;if(!t.test(e))return;return t.exec(e)[1]}(location.search);function h(e){if(!l)return e;var t=/\?/.test(e)?"&":"?";return e+t+"authToken="+l}window.addEventListener("message",function(e){u(e)&&(l=e.data.token)}),t.b={get authToken(){return l}}},4:function(e,t,n){"use strict";n.d(t,"b",function(){return s});var r,i=n(35),o=n.n(i),a={arch:o()("arch"),bookmarks:o()("bookmarks"),cam:o()("camera"),camptz:o()("camera:ptz"),common:o()("common"),deprecated:(r=o()("deprecated"),function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.apply(void 0,t.concat([new Error]))}),embedded:o()("embedded"),events:o()("events"),export:o()("arch:export"),layout:o()("layout"),locomote:o()("video:locomote"),search:o()("arch:search"),topics:o()("topics"),video:o()("video"),player:o()("video:player"),ws:o()("video:ws"),pref:o()("preferences"),maps:o()("maps")};function s(e){e?o.a.enable("*"):o.a.disable()}t.a=a},43:function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"a",function(){return i});var r={H264:"H264",H265:"H265",MJPG:"MJPG"},i={JPEG:"jpeg",MP4:"mp4"}},433:function(e,t){},44:function(e,t,n){"use strict";n.d(t,"g",function(){return b}),n.d(t,"e",function(){return y}),n.d(t,"a",function(){return g}),n.d(t,"c",function(){return k}),n.d(t,"d",function(){return S}),n.d(t,"f",function(){return j}),n.d(t,"b",function(){return _}),n.d(t,"h",function(){return P});var r=n(6),i=n.n(r),o=n(7),a=n.n(o),s=n(33),c=n.n(s),u=n(34),l=n.n(u),h=n(160),d=n.n(h);function f(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||m(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function p(e){return function(e){if(Array.isArray(e))return e}(e)||m(e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function m(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}var v=i()(d()(""),a()(function(e){return e.charCodeAt(0)}),function(e){return Uint8Array.from(e)});function b(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return new Promise(function(n,r){var i=new Image;i.opacity=t,i.src=e,i.onload=function(){n(i)},i.onerror=r})}function y(e){var t=p(e.layers),n=t[0],r=t.slice(1),i=e.opacity,o=document.createElement("canvas"),a=o.getContext("2d"),s=b(n);return s.then(function(e){o.width=e.width,o.height=e.height},c.a),Promise.all([s].concat(f(r.map(function(e){return b(e,i)})))).then(function(e){return l()(function(e,t){return e.globalAlpha=t.opacity,e.drawImage(t,0,0,e.canvas.width,e.canvas.height),e},e)}(a)).then(function(e){return new Promise(function(t){e.canvas.msToBlob?t(e.canvas.msToBlob()):e.canvas.toBlob(t,"image/png")})})}function g(e){var t=e.width,n=e.height;if(Boolean(t)&&Boolean(n))return t/n}function k(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"image/png",n=atob(e),r=v(n);return new Blob([r],{type:t})}var O,w,S=(O=document.createElement("canvas"),w=O.getContext("2d"),O.width=1,O.height=1,w?w.getImageData(0,0,O.width,O.height):null);function j(e){var t=e.naturalWidth||e.videoWidth,n=e.naturalHeight||e.videoHeight;if(t&&n){var r=document.createElement("canvas"),i=r.getContext("2d");return r.width=t,r.height=n,i.drawImage(e,0,0),i.getImageData(0,0,r.width,r.height)}}function _(e){return URL.createObjectURL(new Blob([e],{type:"image/jpeg"}))}var P=a()(function(e){var t=e.payload;return _(t)})},488:function(e,t){},489:function(e,t){},493:function(e,t){},494:function(e,t){},5:function(e,t,n){"use strict";n.d(t,"h",function(){return u}),n.d(t,"c",function(){return l}),n.d(t,"i",function(){return h}),n.d(t,"f",function(){return d}),n.d(t,"d",function(){return f}),n.d(t,"a",function(){return p}),n.d(t,"e",function(){return m}),n.d(t,"b",function(){return v}),n.d(t,"g",function(){return b}),n.d(t,"q",function(){return y}),n.d(t,"p",function(){return g}),n.d(t,"l",function(){return k}),n.d(t,"m",function(){return O}),n.d(t,"n",function(){return w}),n.d(t,"o",function(){return S}),n.d(t,"k",function(){return j}),n.d(t,"j",function(){return _});var r=n(106),i=n.n(r),o=n(119),a=n.n(o),s=n(6),c=n.n(s),u=1e3,l=u/10,h=10*u,d=60*u,f=60*d,p=24*f,m=1/u,v=p*m,b=0;function y(e){return function(t){return Math.floor(t/e)}}var g=function(e){return e*m};function k(e){var t,n=parseInt(e.substr(0,4),10),r=parseInt(e.substr(4,2),10)-1,i=parseInt(e.substr(6,2),10),o=parseInt(e.substr(9,2),10),a=parseInt(e.substr(11,2),10),s=parseInt(e.substr(13,2),10),c=parseInt(e.substr(16,3),10);return Number.isNaN(c)&&(c=0),t=Date.UTC(n,r,i,o,a,s,c),new Date(t)}function O(e){var t;return e instanceof Date&&(t=e.toISOString().replace(/[-:Z]/g,"")),t}function w(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"HH:MM:ss dd.mm.yyyy";return i()(new Date(e),t)}function S(e){var t=new Date(e),n=new Date(e);return t.setHours(0,0,0,0),n.setHours(23,59,59,999),{begintime:t,endtime:n}}var j=c()(O,a()("past")),_=c()(O,a()("future"))},59:function(e,t,n){"use strict";var r=n(7),i=n.n(r),o=n(32),a=n.n(o),s=n(3),c=n.n(s),u=n(53),l=n.n(u),h=n(167),d=n.n(h),f=n(313),p=n.n(f),m=n(68),v=n.n(m),b=n(6),y=n.n(b),g=n(210),k=n.n(g),O="MAP_VIEW_MODE_LAYOUT_ONLY",w=n(95);function S(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function j(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?S(n,!0).forEach(function(t){_(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function _(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,"c",function(){return P}),n.d(t,"g",function(){return C}),n.d(t,"a",function(){return M}),n.d(t,"d",function(){return $}),n.d(t,"b",function(){return N}),n.d(t,"e",function(){return q}),n.d(t,"f",function(){return U}),n.d(t,"h",function(){return G});var P=-1,C=function(){return{idx:P}},E=/Cell/,x=a()(function(e){var t=e.type;return E.test(t)}),T=i()(function(e){var t=e.Key,n=e.Value,r=n.camera_adapter,i=n.dimenstions,o=n.linked_cells,a=n.position,s=n.left_sibling,c=n.right_sibling,u=n.top_sibling,l=n.bottom_sibling,h=n.video_parameters,d=h.audio_volume,f=h.camera_stream_resolution,p=h.default_channel_mode,m=n.$type;return{key:t,origin:r,size:Object(w.c)(i),position:a,linkedCells:o,sibling:{left:s,right:c,top:u,bottom:l},ext:{audioVolume:d,cameraStream:!p&&f},type:m}}),A=-1,I={left:0,right:0,top:1,bottom:1};function D(e){var t=p()(function(e,t){e[t.key]=t},k()())(e),n=function(e){return function t(n,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=n.sibling[r];if(o===A)return i;var a=e[o],s=a.size[I[r]];return t(a,r,i+s)}}(t);return e.map(function(e){return j({pos:{left:n(e,"left"),right:n(e,"right"),top:n(e,"top"),bottom:n(e,"bottom")}},e)})}var L=i()(function(e){var t=e.key,n=e.pos,r=e.origin,i=e.ext;return{key:t,pos:n,origin:r,ext:i}}),M={key:0,origin:"",pos:{left:0,right:0,top:0,bottom:0},ext:{audioVolume:50,cameraStream:0}};function $(e){var t=[];return e&&t.push(j({},M,{camera:e,origin:e.origin})),t}var R={left:"width",right:"width",top:"height",bottom:"height"},B={width:{start:"left",end:"right"},height:{start:"top",end:"bottom"}},N={cells:[]},F={top:"top_sibling_position",left:"left_sibling_position",right:"right_sibling_position",bottom:"bottom_sibling_position"},z={top:"top",right:"right",bottom:"bottom",left:"left"},V=function(e){return function(t){return e[F[t]]}},H=function(e){return{position:e.index,dimensions:e.size,left_sibling_position:e.sibling.left,right_sibling_position:e.sibling.right,top_sibling_position:e.sibling.top,bottom_sibling_position:e.sibling.bottom,camera_ap:e.origin}};var q=function(e){return{id:e.id,display_name:e.displayName,alarm_mode:!1,is_for_alarm:!1,is_user_defined:!0,map_id:"",map_view_mode:O,cells:l()(H)(e.cells)}},U=function(e){return{etag:e.etag||"",body:q(e)}};function Y(e,t,n){for(var r=R[e],i=0,o=V(n)(e);o>-1;){var a=t[o],s=a.dimensions[r];i+=s,o=V(a)(e)}return i}var W=function(e){return function(t){return y()([a()(function(e){return function(t){var n=B[e].start,r=V(t)(n);return r===A}}(e)),i()(function(n){return Y(B[e].end,t,n)+n.dimensions[e]}),d.a])(t)}},G=i()(function(e){return{displayName:e.display_name,cells:y()([T,D,x,L,v()("key")])(e.cells)}}),X=function(e){return l()(function(t){return{index:t.position,position:t.position,origin:t.camera_ap,size:t.dimensions,pos:l()(function(e,t){return function(n){var r=Y(n,e,t),i=W(R[n])(e);return r/i}}(e,t))(z),sibling:l()(V(t))(z),ext:{audioVolume:c()("video_parameters.audio_volume")(t),cameraStream:c()("video_parameters.stream_resolution")(t)}}})(e)};i()(function(e){var t=e.body,n=e.meta;return{etag:n.etag,id:n.layout_id,displayName:t.display_name,size:{height:W("height")(t.cells),width:W("width")(t.cells)},cells:X(t.cells)}})},65:function(e,t,n){"use strict";function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=e^t;return n+(n<<1)+(n<<4)+(n<<7)+(n<<8)+(n<<24)>>>0}n.d(t,"a",function(){return r}),n.d(t,"b",function(){return i});var i=function(e){return function(e){for(var t=new Uint8Array(e.length),n=0;n<e.length;n+=1)t[n]=e.charCodeAt(n);return t}(e).reduce(r,0)}},67:function(e,t,n){"use strict";var r=n(103),i=n.n(r),o=n(6),a=n.n(o),s=n(3),c=n.n(s),u=n(24),l=n.n(u),h=n(7),d=n.n(h),f=n(34),p=n.n(f),m=n(11),v=n(4),b=n(27),y=n(73),g=n(168),k=n.n(g),O=n(46),w=n.n(O),S=n(42),j=n.n(S),_=n(21),P=n.n(_),C=n(162),E=n.n(C),x=n(133),T=n.n(x),A=n(122),I=n(128),D=n.n(I),L=n(68),M=n.n(L),$=n(288),R=n.n($),B=n(5),N=n(13),F=a()([d()(a()(B.l,D()("getTime"))),R()(j.a),M()(j.a)]);var z=function(){var e=[],t=-1/0;this.init=function(n){e=F(n),t=-1/0},this.step=function(n,r){return e.length?(Number.isFinite(t)?t+=n:t=Object(N.e)(r,e),e[t]):null},this.next=this.step.bind(null,this.FORWARD),this.prev=this.step.bind(null,this.BACKWARD),this.clear=function(){e=[],t=-1/0},this.current=function(){return e[t]}},V=n(37);function H(e){return H="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},H(e)}function q(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function U(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Y(e){return Y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Y(e)}function W(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function G(e,t){return G=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},G(e,t)}function X(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var K=c()("storage"),Z=c()("accessPoint"),J="archive",Q=n(40),ee=n.n(Q),te=n(72),ne=n.n(te),re=n(71),ie=n.n(re),oe=n(181),ae=n.n(oe),se=n(289),ce=n.n(se),ue=n(33),le=n.n(ue),he=n(9),de=n(30),fe=n.n(de);function pe(e){return pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pe(e)}function me(e,t){return!t||"object"!==pe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ve(e){return ve=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ve(e)}function be(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ye(e,t)}function ye(e,t){return ye=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},ye(e,t)}function ge(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ke(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Oe(e,t,n){return t&&ke(e.prototype,t),n&&ke(e,n),e}var we=.67,Se="ptzSession",je=function(){function e(t){ge(this,e),this.ctx=t,this.ctx.state=this}return Oe(e,[{key:"init",value:function(){return this}},{key:"failed",value:function(){return this}},{key:"acquired",value:function(){return this}},{key:"release",value:function(){return new Ae(this.ctx)}}]),e}(),_e=function(e){function t(){return ge(this,t),me(this,ve(t).apply(this,arguments))}return be(t,e),Oe(t,[{key:"init",value:function(){return new Pe(this.ctx)}}]),t}(je),Pe=function(e){function t(e){var n;ge(this,t),n=me(this,ve(t).call(this,e));var r=Object(N.b)(Se);return r?(v.a.camptz("session %c%s (%o)","font-weight: bold","Reusing",r),me(n,new xe(n.ctx))):me(n,new Ce(n.ctx))}return be(t,e),t}(je),Ce=function(e){function t(e){var n;return ge(this,t),n=me(this,ve(t).call(this,e)),n.ctx.acquireId=null,v.a.camptz("session %c%s","font-weight: bold","Request"),m.z({tcid:e.tcid}).then(function(e){var t=e.data.session_id;v.a.camptz("session %c%s (%o)","font-weight: bold","Acquired",t),Object(N.b)(Se,t,he.a.settings.ptzKeepaliveInterval)},function(){return n.ctx.state.failed()}).then(function(){return n.ctx.state.acquired()}),n}return be(t,e),Oe(t,[{key:"failed",value:function(){return new Ee(this.ctx)}},{key:"acquired",value:function(){return document.hidden?new Ee(this.ctx):new xe(this.ctx)}}]),t}(je),Ee=function(e){function t(e){var n;ge(this,t),n=me(this,ve(t).call(this,e)),v.a.camptz("session %c%s","font-weight: bold","Failed to acquire.");var r=n.ctx.topic;return r(r.key.PTZ_READY).put(!1),n.ctx.acquireId=setTimeout(function(){return new Ce(n.ctx)},he.a.settings.ptzKeepaliveInterval),n}return be(t,e),t}(je),xe=function(e){function t(e){var n;ge(this,t),n=me(this,ve(t).call(this,e));var r=n.ctx.topic;return r(r.key.PTZ_READY).put(!0),fe()(window).on({"blur.ptz":function(){fe()(window).one({focus:function(){return new Pe(n.ctx)}}),new Ae(n.ctx)}}),function(){Ie(this),this.keepId=setInterval(Ie,he.a.settings.ptzKeepaliveInterval*we,this)}.call(n.ctx),n}return be(t,e),t}(je),Te=function(e){function t(e){var n;return ge(this,t),n=me(this,ve(t).call(this,e)),v.a.camptz("session %c%s","font-weight: bold, color: red","Lost"),De.call(n.ctx),new Ce(n.ctx),n}return be(t,e),t}(je),Ae=function(e){function t(e){var n;ge(this,t),n=me(this,ve(t).call(this,e));var r=n.ctx.topic;return r(r.key.PTZ_READY).put(!1),v.a.camptz("session %c%s (%o)","font-weight: bold","Release",Object(N.b)(Se)),fe()(window).off("blur.ptz"),De.call(n.ctx),function(){clearTimeout(this.acquireId)}.call(n.ctx),n}return be(t,e),Oe(t,[{key:"init",value:function(){return new Pe(this.ctx)}}]),t}(je);function Ie(e){var t=Object(N.b)(Se);m.F({tcid:e.tcid,session_id:t}).then(function(){return Object(N.b)(Se,t,he.a.settings.ptzKeepaliveInterval)},function(){return new Te(e)})}function De(){this.keepId&&(clearInterval(this.keepId),this.keepId=void 0,Object(N.b)(Se,null))}var Le=function(){function e(t,n){ge(this,e),this.ctx={tcid:t,topic:n,acquireId:null,keepId:null},this.ctx.state=new _e(this.ctx)}return Oe(e,[{key:"init",value:function(){this.ctx.state.init()}},{key:"release",value:function(){this.ctx.state.release()}}]),e}();function Me(e){return Me="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Me(e)}function $e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Re(e,t){return!t||"object"!==Me(t)&&"function"!=typeof t?Ne(e):t}function Be(e){return Be=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Be(e)}function Ne(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Fe(e,t){return Fe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Fe(e,t)}function ze(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ve=5,He=ee()(1,10),qe=d()(function(e){return Number(e.id)}),Ue=E()(j.a),Ye=Object(N.n)(1),We=ee()(0,1),Ge=function(e){return e?function(e){return Math.pow(1.5,e-15.7)}:ce()(.1)},Xe={pan:0,tilt:0,zoom:0},Ke="absolute",Ze="continuous",Je=P()(Ke),Qe=ne()([[c()("isContinous"),ie()(Ze)],[c()("isAbsolute"),ie()(Ke)]]);function et(e){v.a.camptz("error",e)}function tt(e){return tt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},tt(e)}function nt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function rt(e){return rt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},rt(e)}function it(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ot(e,t){return ot=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},ot(e,t)}function at(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function st(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ct=p.a.convert({cap:!1}),ut="initial",lt=l()({});function ht(e,t){return 0!==e.streamType&&e.width*e.height<t.width*t.height}var dt=a()(function(e){var t;return t=function(e){function t(e){var n,r,i;return at(this,t),r=this,i=rt(t).call(this,e),n=!i||"object"!==tt(i)&&"function"!=typeof i?it(r):i,st(it(n),"online",void 0),st(it(n),"isReady",void 0),n.initLive=n.initLive.bind(it(n)),n.streams=n.localTopic("streams"),n.streamActive=n.localTopic("streamActive"),n.state=n.localTopic("state").assign(st({},ut,"")),n.desc.isActivated?n.getStreamsMeta():n.setDefaultStreams(),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ot(e,t)}(t,e),n=t,r=[{key:"setDefaultStreams",value:function(){var e=this.desc.videoStreams,t=Object(b.d)(e);this.streamsPromise=Promise.resolve(t),this.streamsPromise.then(this.initLive)}},{key:"getStreamsMeta",value:function(){var e=this.desc,t=e.dev,n=e.videoStreams,r=Object(y.b)(),i=r.promise,o=r.resolve;return v.a.cam("%s has %o streams",t,n.length),this.isReady=i,this.state.assign(st({},"streams",-1)),this.fetchStreamStats().then(o),this.isReady}},{key:"fetchStreamStats",value:function(){var e=this.desc.videoStreams;return this.streamsPromise=m.b(d()(c()(["accessPoint"]),e)).then(b.n),this.streamsPromise.then(this.initLive)}},{key:"initLive",value:function(e){return this.streams.put(e),this.resetLiveStream(),this.state.assign(st({},"streams",e.length)),this.desc.isActivated}},{key:"getStream",value:function(e){return lt(e,this.streams.get())}},{key:"setSource",value:function(e){this.playSourceIdx=e,this.streamActive.put(e),v.a.cam("Select stream",e,this.sourceInfo)}},{key:"getStreamIdx",value:function(e){return i()(function(t){var n=t.accessPoint;return e===n})(this.streams.get())}},{key:"getStreamBy",value:function(e){return ct(function(t,n,r,i){return e(n,i[t])?r:t})(0)(this.streams.get())}},{key:"resetLiveStream",value:function(){var e=ht,t=this.topic(this.topic.key.PREFS).get(),n=t.defaultStream;if(c()(n,this.streams.get()))return v.a.pref("Setting %cuser%c stream","font-weight: bold","font-weight: normal"),void this.streamActive.put(n);v.a.cam("Setting %clowest resolution%c stream","font-weight: bold","font-weight: normal"),this.streamActive.put(this.getStreamBy(e))}},{key:"stream",get:function(){var e=this.streamActive.get();return this.getStream(e)}},{key:"activeSource",get:function(){var e=this.streamActive.get();return c()([e,"accessPoint"],this.streams.get())}},{key:"isOnline",get:function(){var e=this.topic(this.topic.key.CAM_STATES).get(),t=c()(this.origin,e);return t}},{key:"dev",get:function(){return this.desc.dev}},{key:"origin",get:function(){return this.desc.origin}},{key:"id",get:function(){return this.desc.id}},{key:"name",get:function(){return this.desc.displayName}},{key:"fullname",get:function(){return"".concat(this.id," ").concat(this.name)}},{key:"isLive",get:function(){return this!==this.topic(this.topic.key.CAM_ARCH).get()}},{key:"detectors",get:function(){return this.desc.detectors}},{key:"channel",get:function(){return this.desc.channel}}],r&&nt(n.prototype,r),o&&nt(n,o),t}(e),t},function(e){var t;return t=function(e){function t(e){var n,r,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,i=Y(t).call(this,e),n=!i||"object"!==H(i)&&"function"!=typeof i?W(r):i,X(W(n),"archPromise",void 0),X(W(n),"checkArchExists",function(){return n.state.assign(X({},J,-1)),Object(N.q)(n.archList.map(function(e){return m.j({vsid:e.accessPoint,archive:e.storage,limit:1}).then(function(e){var t=e.data.intervals;return t.length>0},function(){return Promise.resolve(!1)})})).then(E()(j.a)).then(T()(function(e){return n.state.assign(X({},J,e))}))}),n.archTime=n.localTopic("archTime"),n.archSelected=n.localTopic("archSelected"),n.frames=new z,n.framesReset=function(e){e.getTime()!==n.frames.current()&&(n.frames.clear(),n.archTime.unobserve(n.framesReset))},n.archive=[],n.events={},n.xhr={},n.archiveCache={},n.archHash=function(){return"".concat(n.activeSource).concat(n.archSelectedStorage)},n.fetchIntervals=new A.a(m.j,"intervals"),n.archClear=function(){n.archive=[],n.events={alerts:[],detectors:[]}},n.getIntervals=function(e){return n.fetchIntervals(e).then(V.h).then(T()(function(e){n.archive=e}))},n.getArchiveDays=function(e,t){var r=new Date(Date.UTC(e,t-1,1)),i=new Date(Date.UTC(e,t,0,23,59,59,999));return n.fetchIntervals({scale:B.b,begintime:r,endtime:i}).then(V.h).then(V.b)},n.fetchDetectors=new A.a(m.o,"detectors"),n.fetchAlerts=new A.a(m.o,"alerts"),n.getDetectors=function(e){return n.fetchDetectors(e).then(V.g).then(T()(function(e){n.events.detectors=e}))},n.getAlerts=function(e){return n.fetchAlerts(e).then(V.f).then(T()(function(e){n.events.alerts=e}))},n.currentTimestamp="",n.uuid="",n.archiveIndex=0,n.frameIndex=0,n.speed=1,n.FORWARD=1,n.BACKWARD=-1,n.stepForward=n.stepFrame.bind(W(n),n.FORWARD),n.stepBack=n.stepFrame.bind(W(n),n.BACKWARD),n.nextInterval=n.stepInterval.bind(W(n),n.FORWARD),n.prevInterval=n.stepInterval.bind(W(n),n.BACKWARD),n.archPromise=n.checkArchExists(),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&G(e,t)}(t,e),n=t,r=[{key:"getArchIdx",value:function(e){return i()(function(t){return P()(t,e)})(this.archList)}},{key:"updateArch",value:function(e){var t=q(e,3),n=t[0],r=t[1],i=t[2];return this.archiveIndex=n.length,this.archive=V.h(n),this.events={detectors:V.g(r),alerts:V.f(i)},Promise.all([this.archive,this.events])}},{key:"getArchEnd",value:function(){return this.fetchIntervals({begintime:"past",endtime:"future",scale:B.b,limit:1}).then(function(e){return V.e(V.h(e))})}},{key:"getArchiveContent",value:function(e,t){var n=this;v.a.deprecated();var r={begintime:e,endtime:t};return this.fetchIntervals(r).then(function(e){return Promise.all([e,n.fetchDetectors(r),n.fetchAlerts(r)])}).then(this.updateArch.bind(this))}},{key:"getArchiveList",value:function(){var e=this;v.a.deprecated();var t=this.streams.getPromise(),n=c()(["data","archives"]);return t.then(function(e){return Promise.all(e.map(function(e){var t=e.source;return m.l({vsid:t})}))}).then(function(e){return e.map(n)}).then(function(t){return e.archStreamsList.put(t),t})}},{key:"initArchive",value:function(){this.setArchSelected(this.archiveDesc)}},{key:"setArchSelectedByIdx",value:function(e){var t=c()(e,this.archList);this.setArchSelected(t)}},{key:"setArchSelectedByStorage",value:function(e){var t=k()(function(e){return a()([c()("storage"),P()(e)])}(e),this.archList);this.setArchSelected(t)}},{key:"setArchSelected",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.defaultArch,t=this.getStreamIdx(e.accessPoint);this.streamActive.put(t),this.archSelected.put(e)}},{key:"dateChange",value:function(e){this.archExist&&this.setDate(e,!0)}},{key:"getArchiveByDate",value:function(e){var t=new Date(e),n=new Date(e);return t.setHours(0,0,0,0),n.setHours(23,59,59,999),this.getArchiveContent(t,n)}},{key:"stepFrame",value:function(e){var t=this,n=this.topic(this.topic.key.ARCH_TIME).get().valueOf(),r=this.frames.step(e,n);if(r){var i=new Date(r);this.topic(this.topic.key.ARCH_TIME).put(i),this.topic(this.topic.key.PLAYBACK).assign({beginTime:i,speed:0}),this.archTime.observe(this.framesReset)}else m.k({vsid:this.activeSource,direction:e,timestamp:new Date(n),limit:10,archive:this.archSelectedStorage}).then(function(n){var r=n.data.frames;t.frames.init(r),t.stepFrame(e)})}},{key:"getIntervalIndex",value:function(e){return i()(function(t){return t.date.begin<=e&&t.date.end>=e})(this.archive)}},{key:"stepInterval",value:function(e){var t,n=this.topic(this.topic.key.ARCH_TIME).get().getTime(),r=this.getIntervalIndex(n),i=r+e,o=this.archive.length-1;if(i>=0&&i<=o)t=this.archive[i].date.begin;else switch(e){case this.FORWARD:t=this.archive[o].date.end;break;case this.BACKWARD:t=this.archive[0].date.begin}this.frames.clear(),this.topic(this.topic.key.ARCH_TIME).put(t),this.topic(this.topic.key.PLAYBACK).assign({beginTime:t,speed:0})}},{key:"archList",get:function(){return this.desc.archives}},{key:"archSelectedStorage",get:function(){return K(this.archiveDesc)}},{key:"archSelectedAccessPoint",get:function(){return Z(this.archiveDesc)}},{key:"archiveDesc",get:function(){var e=this.archSelected.get();return e}},{key:"defaultArch",get:function(){var e=this.archList,t=k()(function(e){return!e.isEmbedded}),n=t(e)||w()(e)||{};return v.a.arch("default","\narch:",n.storage,"\nstream:",n.accessPoint),n}}],r&&U(n.prototype,r),o&&U(n,o),t}(e),t},function(e){var t;return t=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=Re(this,Be(t).call(this,e)),ze(Ne(n),"ABSOLUTE",Ke),ze(Ne(n),"CONTINUOUS",Ze),ze(Ne(n),"mode",{}),ze(Ne(n),"move",le.a),ze(Ne(n),"zoom",le.a),ze(Ne(n),"areaZoom",le.a),ze(Ne(n),"focusAuto",le.a),ze(Ne(n),"pointMove",le.a),ze(Ne(n),"ptzPos",void 0),ze(Ne(n),"savePosition",function(e){var t=e.data;return n.ptzPos=t,v.a.camptz("pan %o; tilt %o; zoom %o",t.pan,t.tilt,t.zoom),t}),ze(Ne(n),"getPosition",function(){return m.x(n.tcid).then(n.savePosition)}),ze(Ne(n),"makeMove",function(e){var t=Je(e)?n.getPosition:ie()(Xe),r=Ge(Je(e)),i=Je(e)?Ye:j.a,o=Je(e)?We:j.a;return function(a){var s=a.pan,c=void 0===s?0:s,u=a.tilt,l=void 0===u?0:u;return Promise.resolve(t()).then(function(t){var a=t.pan,s=t.tilt,u=Ne(n),h=u.tcid,d=u.ptzSpeed,f=r(d),p=i(c*f+a),b=o(l*f+s);return v.a.camptz("move ".concat(e,": pan ").concat(a," ").concat(p,", tilt ").concat(s," ").concat(b)),m.O({tcid:h,mode:e,pan:p,tilt:b,session_id:Object(N.b)(Se)}).catch(et)})}}),ze(Ne(n),"makeZoom",function(e){var t=Je(e)?n.getPosition:ie()(Xe),r=Ge(Je(e)),i=Je(e)?We:j.a;return function(o){return Promise.resolve(t()).then(function(t){var a=t.zoom,s=Ne(n),c=s.tcid,u=s.ptzSpeed,l=r(u),h=i(o*l+a);return v.a.camptz("move ".concat(e,": zoom ").concat(a," ").concat(h)),m.Q({tcid:c,mode:e,zoom:h,session_id:Object(N.b)(Se)}).catch(et)})}}),n.ptzMgr=new Le(n.tcid,n.topic),c()(["is_active"],n.ptz)?(n.ptzExist=!0,n.ptzSpeedT=n.localTopic("ptzSpeed").put(Ve),n.ptzPresets=n.localTopic("ptzPresets"),n.mode.move=Qe(n.ptz.move),n.move=n.makeMove(n.mode.move),n.mode.zoom=Qe(n.ptz.zoom),n.zoom=n.makeZoom(n.mode.zoom),n.ptz.pointMove&&(n.pointMove=n.oPointMove),n.ptz.areaZoom&&(n.areaZoom=n.oAreaZoom),n.ptz.autoFocus&&(n.focusAuto=n.oFocusAuto),v.a.camptz("move %o; zoom %o",n.ptz.move,n.ptz.zoom),Ue(n.isAbsolute)&&n.getPosition(),n):Re(n)}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Fe(e,t)}(t,e),n=t,r=[{key:"releasePtz",value:function(){this.ptzMgr.release()}},{key:"initPtz",value:function(){this.ptzMgr.init(),this.getPresets()}},{key:"getPresets",value:function(){var e=this,t=this.desc.ptzs.map(function(e){var t=e.accessPoint;return m.y(t).then(a()([c()("data"),Object(N.k)(t)])).catch(et)});return Promise.all(t).then(ae.a).then(function(t){return e.presetsLastId=Math.max.apply(null,qe(t))||1,t}).then(function(t){return e.ptzPresets.put(t)}).catch(et)}},{key:"setPreset",value:function(e){var t=e.pos,n=void 0===t?this.presetsLastId+=1:t,r=e.label,i=this.tcid;return m.P({tcid:i,pos:n,label:r,session_id:Object(N.b)(Se)}).then(this.getPresets).catch(et)}},{key:"goPreset",value:function(e){var t=this.ptzPresets.get()[e].tcid;return m.C({tcid:t,pos:e,session_id:Object(N.b)(Se)}).catch(et)}},{key:"removePreset",value:function(e){var t=this.ptzPresets.get()[e].tcid;return m.M({tcid:t,pos:e,session_id:Object(N.b)(Se)}).then(this.getPresets).catch(et)}},{key:"oPointMove",value:function(e){var t=e.x,n=e.y,r=this.tcid;return m.J({tcid:r,x:t,y:n,session_id:Object(N.b)(Se)}).catch(et)}},{key:"oAreaZoom",value:function(e){var t=e.x,n=e.y,r=e.w,i=e.h,o=this.tcid;return m.a({tcid:o,x:t,y:n,w:r,h:i,session_id:Object(N.b)(Se)}).catch(et)}},{key:"oFocusAuto",value:function(){var e=this.tcid;return m.N({tcid:e,degree:"focus",session_id:Object(N.b)(Se)}).catch(et)}},{key:"ptz",get:function(){return Object(b.i)(this.desc)}},{key:"tcid",get:function(){return Object(b.j)(this.desc)}},{key:"ptzSpeed",get:function(){return this.ptzSpeedT.get()},set:function(e){this.ptzSpeedT.put(He(e))}}],r&&$e(n.prototype,r),i&&$e(n,i),t}(e),t})(function e(t){var n=this;at(this,e),st(this,"desc",void 0),st(this,"localTopic",void 0),v.a.cam(t),this.desc=t,this.localTopic=function(e){return n.topic("_".concat(t.channel,"::").concat(e))}});t.a=dt},73:function(e,t,n){"use strict";function r(){var e,t;return{promise:new Promise(function(n,r){e=n,t=r}),resolve:e,reject:t}}function i(e){var t=this;function n(e){return e}function r(e){return"function"==typeof e?e:n}var o=n,a=n;function s(e){o=r(e)}var c=new Promise(function(t,n){e(t,n,s),a=r(n)});function u(e,t,n){var a,s=r(e),u=r(t),l=(a=n,"function"==typeof a?a:null);return new i(function(e,t,n){c.catch(l).then(s,u).then(e,t),n(o)})}c.catch(n),this.then=function(e,t){return u(e,t)},this.catch=function(e){return u(void 0,void 0,e)},this.abort=function(e){return o(e),a(e),t}}n.d(t,"b",function(){return r}),n.d(t,"a",function(){return i})},9:function(e,t,n){"use strict";var r={zoomSteps:8,zoomMin:1,zoomMax:8,hashTime:1e4,pollInterval:3e3,refreshInterval:3e4,ptzKeepaliveInterval:5e3,animationTime:250,maxScaleHeight:1e5,slideWindowMessage:!1,prefix:!1,frameWidthList:[360,480,720,960],errorThreshold:3,zoom:3,zoomScaleStep:1.2,mjpegCompression:3,previewTimeout:5e3,prefsDefault:{archFastMjpeg:!1,disconnectInactive:!0,defaultStream:-1,defaultLayout:-1,favorites:[],searchAutoScroll:!1,noKeyFrames:!1,pinned:!0,searchDefaultInterval:1e4},searchHistory:5,alertFrameWidth:320,scaleTags:[{min:-1/0,max:1e3,tags:[{step:144e5,width:20,xbase:63,lineWidth:1,color:"#000",textOut:!0,font:"500 14px Arial",textBaseline:"bottom",textColor:"#000",padding:25,format:function(e){return"".concat(4*e/this.step,":00")}},{step:72e5,width:15,xbase:63,lineWidth:1,color:"#333",textOut:!1,font:"500 14px Arial",textBaseline:"bottom",textColor:"#111",padding:25,format:function(e){return"".concat(e/this.step,":00")}},{step:18e5,width:7,xbase:63,lineWidth:1,color:"#333",textOut:!1,font:"500 14px Arial",textBaseline:"bottom",textColor:"#111",padding:25,format:function(e){return"".concat(e/this.step,":00")}}]},{min:1e3,max:2e3,tags:[{step:72e5,width:20,xbase:63,lineWidth:1,color:"#000",textOut:!0,font:"500 14px Arial",textBaseline:"bottom",textColor:"#000",padding:25,format:function(e){return"".concat(2*e/this.step,":00")}},{step:36e5,width:15,xbase:63,lineWidth:1,color:"#333",textOut:!1,font:"500 14px Arial",textBaseline:"bottom",textColor:"#111",padding:25,format:function(e){return"".concat(e/this.step,":00")}},{step:18e5,width:7,xbase:63,lineWidth:1,color:"#333",textOut:!1,font:"500 14px Arial",textBaseline:"bottom",textColor:"#111",padding:25,format:function(e){return"".concat(e/this.step,":00")}}]},{min:2e3,max:3e3,tags:[{step:36e5,width:20,xbase:63,lineWidth:1,color:"#000",textOut:!0,font:"500 14px Arial",textBaseline:"bottom",textColor:"#000",padding:25,format:function(e){return"".concat(1*e/this.step,":00")}},{step:18e5,width:15,xbase:63,lineWidth:1,color:"#333",textOut:!1,font:"500 14px Arial",textBaseline:"bottom",textColor:"#111",padding:25,format:function(e){return"".concat(e/this.step,":00")}},{step:3e5,width:7,xbase:63,lineWidth:1,color:"#333",textOut:!1,font:"500 14px Arial",textBaseline:"bottom",textColor:"#111",padding:25,format:function(e){return"".concat(e/this.step,":00")}}]},{min:3e3,max:7e3,tags:[{step:36e5,width:20,xbase:63,lineWidth:1,color:"#000",textOut:!0,font:"500 14px Arial",textBaseline:"bottom",textColor:"#000",padding:25,format:function(e){return"".concat(1*e/this.step,":00")}},{step:18e5,width:15,xbase:63,lineWidth:1,color:"#333",textOut:!0,font:"500 14px Arial",textBaseline:"bottom",textColor:"#000",padding:25,format:function(e){return"".concat(Math.floor(.5*e/this.step),":30")}},{step:3e5,width:7,xbase:63,lineWidth:1,color:"#333",textOut:!1,font:"500 12px Arial",textBaseline:"bottom",textColor:"#111",padding:10,format:function(e){var t=.5*e/18e5,n=Math.floor(.5*e/18e5),r=Math.round(60*(t-n));return"".concat(n,":").concat(r)}}]},{min:7e3,max:1/0,tags:[{step:36e5,width:20,xbase:63,lineWidth:1,color:"#000",textOut:!0,font:"500 14px Arial",textBaseline:"bottom",textColor:"#000",padding:25,format:function(e){return"".concat(1*e/this.step,":00")}},{step:18e5,width:15,xbase:63,lineWidth:1,color:"#333",textOut:!0,font:"500 14px Arial",textBaseline:"bottom",textColor:"#000",padding:25,format:function(e){return"".concat(Math.floor(.5*e/this.step),":30")}},{step:3e5,width:7,xbase:63,lineWidth:1,color:"#333",textOut:!0,font:"500 12px Arial",textBaseline:"bottom",textColor:"#111",padding:10,format:function(e){var t=.5*e/18e5,n=Math.floor(.5*e/18e5),r=Math.round(60*(t-n));return r<10&&(r="0".concat(r)),"".concat(n,":").concat(r)}},{step:6e4,width:3,xbase:63,lineWidth:1,color:"#333",textOut:!1,font:"500 12px Arial",textBaseline:"bottom",textColor:"#111",padding:10,format:function(){}}]}],searchFaces:{redSquareMargin:.05},playspeed:[-8,-4,-3,-2,-1,1,2,3,4,8]};r.zoomDelta=Math.pow(r.zoomMax,1/r.zoomSteps)-1;var i=r,o={locale:{},settings:i,scale:0,lastDate:{}};t.a=o},93:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"b",function(){return o}),n.d(t,"c",function(){return a});var r=n(134),i=new Intl.Collator(r.b,{sensitivity:"base"}).compare,o=function(e,t){return Math.sign(e-t)};function a(e,t,n){var r=n.slice();return Array.prototype.sort.call(r,function(n,r){for(var i=0,o=0;o<t.length&&0===i;o+=1){var a=e[o];i=t[o](n[a],r[a])}return i})}},95:function(e,t,n){"use strict";n.d(t,"b",function(){return b}),n.d(t,"a",function(){return y}),n.d(t,"c",function(){return g});n(139);var r=n(160),i=n.n(r),o=n(7),a=n.n(o),s=n(3),c=n.n(s),u=n(32),l=n.n(u),h=n(6),d=n.n(h),f=n(286),p=n.n(f),m=n(287),v=n.n(m);function b(e){for(var t=[],n=e,r=0;r<4;r+=1)t.push(String.fromCharCode(255&n)),n>>=8;return t.join("")}var y=function(e){return/DeviceIpint/.test(e)},g=d()([i()(","),a()(p.a),l()(v.a)]);d()([JSON.parse,c()("objects"),l()(function(e){var t=e.name;return t.includes("DeviceIpint")})])}});
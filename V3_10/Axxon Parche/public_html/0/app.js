!function(e){function t(t){for(var r,o,c=t[0],s=t[1],u=t[2],p=0,f=[];p<c.length;p++)o=c[p],Object.prototype.hasOwnProperty.call(i,o)&&i[o]&&f.push(i[o][0]),i[o]=0;for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r]);for(l&&l(t);f.length;)f.shift()();return a.push.apply(a,u||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],r=!0,c=1;c<n.length;c++){var s=n[c];0!==i[s]&&(r=!1)}r&&(a.splice(t--,1),e=o(o.s=n[0]))}return e}var r={},i={1:0},a=[];function o(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.e=function(e){var t=[],n=i[e];if(0!==n)if(n)t.push(n[2]);else{var r=new Promise(function(t,r){n=i[e]=[t,r]});t.push(n[2]=r);var a,c=document.createElement("script");c.charset="utf-8",c.timeout=120,o.nc&&c.setAttribute("nonce",o.nc),c.src=function(e){return o.p+""+({}[e]||e)+".js"}(e);var s=new Error;a=function(t){c.onerror=c.onload=null,clearTimeout(u);var n=i[e];if(0!==n){if(n){var r=t&&("load"===t.type?"missing":t.type),a=t&&t.target&&t.target.src;s.message="Loading chunk "+e+" failed.\n("+r+": "+a+")",s.name="ChunkLoadError",s.type=r,s.request=a,n[1](s)}i[e]=void 0}};var u=setTimeout(function(){a({type:"timeout",target:c})},12e4);c.onerror=c.onload=a,document.head.appendChild(c)}return Promise.all(t)},o.m=e,o.c=r,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o.oe=function(e){throw console.error(e),e};var c=window.webpackJsonp=window.webpackJsonp||[],s=c.push.bind(c);c.push=t,c=c.slice();for(var u=0;u<c.length;u++)t(c[u]);var l=s;a.push([918,0]),n()}({1:function(e,t,n){"use strict";var r=n(30),i=n.n(r),a=(n(236),n(323),n(324),n(325),n(150)),o=n.n(a),c=n(4);i.a.Topic=function(){var e={},t={},n=c.a.topics||i.a.noop;function r(r){return t.hasOwnProperty(r)||function(r){var a=i.a.Callbacks("memory unique");n("new %c%s","font-weight: bold",r),a.add(function(t){e[r]=t,n("update %c%s %c%o","font-weight: bold",r,"color: black",t)}),t[r]={observe:function(e){return a.add(e),this},put:function(t,n){var i=e[r];return(i!=t||n)&&a.fire(t,i),this},assign:function(t){var n=e[r];return a.fire(o()(n,t),n),this},apply:function(t){var n=e[r];a.fire(t(n),n)},unobserve:function(e){return a.remove(e),this},get:function(){return e[r]},getPromise:function(){return new Promise(function(e){a.add(function t(n,r){e(n,r),a.remove(t)})})},discard:function(){t[r]=e[r]=void 0}}}(r),t[r]}return r.dump=function(){return e},r};t.a=i.a},100:function(e,t,n){"use strict";var r="topic/SET";n.d(t,"a",function(){return a}),n.d(t,"c",function(){return o}),n.d(t,"d",function(){return c}),n.d(t,"b",function(){return s});var i=r.length+1;function a(e){return"".concat(r,"/").concat(e)}function o(e){return e.slice(i)}function c(e){return"".concat(e," (old)")}function s(e){return e.startsWith(r)}},101:function(e,t,n){"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function i(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function a(e){return a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},a(e)}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}function c(e,t){return c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},c(e,t)}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(e,t,n){return t&&l(e.prototype,t),n&&l(e,n),e}n.d(t,"b",function(){return h}),n.d(t,"a",function(){return m}),n.d(t,"c",function(){return v});var f=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;u(this,e),this.symbol=t,this.topic=n.put(t),this.fails=r}return p(e,[{key:"connected",value:function(){return this}},{key:"disconnected",value:function(){return this}},{key:"ok",value:function(){return this}},{key:"fail",value:function(){return this}},{key:"state",get:function(){return this.symbol}}]),e}(),h=Symbol("Online"),d=function(e){function t(){var e,n;u(this,t);for(var r=arguments.length,o=new Array(r),c=0;c<r;c++)o[c]=arguments[c];return n=i(this,(e=a(t)).call.apply(e,[this,t.symbol].concat(o))),n.fails=0,n}return o(t,e),p(t,[{key:"ok",value:function(){return this.fails=0,this}},{key:"fail",value:function(e){return this.fails+=1,this.fails>e?this.disconnected():this}},{key:"disconnected",value:function(){return new b(this.topic,this.fails)}}]),t}(f);s(d,"symbol",h);var m=Symbol("Offline"),b=function(e){function t(){var e;u(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return i(this,(e=a(t)).call.apply(e,[this,t.symbol].concat(r)))}return o(t,e),p(t,[{key:"ok",value:function(){return this.connected()}},{key:"connected",value:function(){return new d(this.topic)}}]),t}(f);s(b,"symbol",m);var v=function(){function e(t){var n=this,r=t.fails,i=void 0===r?3:r,a=t.heartbeat,o=void 0===a?Function.prototype:a,c=t.interval,s=void 0===c?1e4:c,l=t.topic;u(this,e);var p=function(){n.connState=n.connState.ok()},f=function(){n.connState=n.connState.fail(i)};this.connState=new d(l),this.heartbeat=function(){setTimeout(function(){o().then(p,f),n.heartbeat()},s)}}return p(e,[{key:"state",get:function(){return this.connState.state}}]),e}()},11:function(e,t,n){"use strict";var r=n(30),i=n.n(r),a=(n(282),n(10)),o=n.n(a),c=n(6),s=n.n(c),u=n(56),l=n.n(u);function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var d=Number.MAX_SAFE_INTEGER,m=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;f(this,e),h(this,"key",void 0),h(this,"value",void 0),h(this,"parent",void 0),h(this,"subs",void 0),this.key=t,this.value=n,this.parent=null,this.subs=[]},b=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];f(this,e),h(this,"nelem",void 0),h(this,"root",void 0),Object.defineProperties(this,{nelem:{writable:!0,enumerable:!1,value:0}}),this.root=new m;for(var n=0;n<t.length;n+=1){var r=t[n],i=r.key,a=r.value;this.push(i,a)}}var t,n,r;return t=e,n=[{key:"push",value:function(t,n){var r=new m(t,n);return this.root=e.meld(this.root,r),this.nelem+=1,r}},{key:"pop",value:function(){var t=this.root,n=t.subs,r=t.value;return this.root=e.pair(n),this.nelem-=1,r}},{key:"decreaseKey",value:function(t,n){if(n.key-=t,n.parent){var r=n.parent,i=r.subs,a=i.indexOf(n);a>0&&(i.splice(a,1),e.meld(this.root,n))}}},{key:"remove",value:function(e){this.decreaseKey(1/0,e),this.pop()}},{key:"length",get:function(){return this.nelem}}],r=[{key:"meld",value:function(e,t){return e.key?t.key?(e.key<t.key?(n=e,r=t):(n=t,r=e),r.parent=n,n.subs.splice(0,0,r),n):e:t;var n,r}},{key:"pair",value:function(t){return t.length?t.reduce(e.meld):new m}}],n&&p(t.prototype,n),r&&p(t,r),e}(),v=n(73);function y(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function g(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function O(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var w=5,j=10,_=100,E=1e3,A=Symbol("queued"),S=Symbol("running"),x={jqXhr:{status:0},error:"Aborted while requesting"},k={jqXhr:{status:0},error:"Aborted while waiting"},P=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),O(this,"count",0),O(this,"limit",0),O(this,"queue",new b),O(this,"pending",!1),O(this,"next",function(){if(n.pending=!0,0===n.queue.length||n.count>=n.limit)n.pending=!1;else{n.busy();var e=n.queue.pop(),t=e.fn,r=e.args,i=e.resolve,a=e.reject,o=t.apply(void 0,y(r));e.setAbort(function(){return o.abort()}),e.state=S,o.then(i,a).then(n.done,n.done).then(n.tick,n.tick),n.tick()}}),O(this,"tick",function(){return setTimeout(n.next,0)}),O(this,"busy",function(){n.count+=1}),O(this,"done",function(){n.count-=1}),this.limit=t}var t,n,r;return t=e,n=[{key:"push",value:function(e,t){for(var n=this,r=arguments.length,i=new Array(r>2?r-2:0),a=2;a<r;a++)i[a-2]=arguments[a];return new v.a(function(r,a,o){var c={args:i,abort:Function.prototype,fn:t,instance:null,resolve:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};r({data:e,status:n.status,jqXhr:n})},reject:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(arguments.length>1&&arguments[1],arguments.length>2?arguments[2]:void 0);return a({error:t,status:e.status,jqXhr:e})},setAbort:function(e){c.abort=e.bind(null,x)},state:A},s=n.queue.push(e,c);o(function(){s.value.state===S?s.value.abort(x):(s.value.reject(k),n.queue.remove(s))}),n.pending||n.tick()})}}],n&&g(t.prototype,n),r&&g(t,r),e}(),C=n(39),T=n(5),M=n(13);function D(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function I(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function R(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function L(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,c=e[Symbol.iterator]();!(r=(o=c.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(i)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}n.d(t,"s",function(){return U}),n.d(t,"G",function(){return V}),n.d(t,"r",function(){return W}),n.d(t,"n",function(){return q}),n.d(t,"q",function(){return G}),n.d(t,"U",function(){return X}),n.d(t,"f",function(){return Z}),n.d(t,"e",function(){return K}),n.d(t,"g",function(){return Q}),n.d(t,"w",function(){return J}),n.d(t,"u",function(){return ee}),n.d(t,"v",function(){return te}),n.d(t,"i",function(){return ne}),n.d(t,"b",function(){return re}),n.d(t,"B",function(){return ie}),n.d(t,"l",function(){return ae}),n.d(t,"j",function(){return oe}),n.d(t,"k",function(){return ce}),n.d(t,"K",function(){return se}),n.d(t,"p",function(){return ue}),n.d(t,"A",function(){return le}),n.d(t,"T",function(){return pe}),n.d(t,"W",function(){return fe}),n.d(t,"S",function(){return he}),n.d(t,"o",function(){return de}),n.d(t,"z",function(){return me}),n.d(t,"F",function(){return be}),n.d(t,"O",function(){return ve}),n.d(t,"Q",function(){return ye}),n.d(t,"J",function(){return ge}),n.d(t,"a",function(){return Oe}),n.d(t,"N",function(){return we}),n.d(t,"y",function(){return je}),n.d(t,"M",function(){return _e}),n.d(t,"P",function(){return Ee}),n.d(t,"C",function(){return Ae}),n.d(t,"d",function(){return Se}),n.d(t,"x",function(){return xe}),n.d(t,"V",function(){return ke}),n.d(t,"L",function(){return Pe}),n.d(t,"t",function(){return Ce}),n.d(t,"E",function(){return Te}),n.d(t,"D",function(){return Me}),n.d(t,"H",function(){return De}),n.d(t,"R",function(){return Ie}),n.d(t,"c",function(){return Re}),n.d(t,"h",function(){return Le}),n.d(t,"I",function(){return Ne}),n.d(t,"m",function(){return ze});var N=l()(/^hosts\//,""),z="VIEW_MODE_FULL",F={getHostVer:o()("product/version"),getLangs:o()("languages"),getUUID:o()("uuid"),getHost:o()("hosts/${hostname}"),getCams:o()("video-origins/${hostname}"),getCam:o()("video-origins/${vsid}"),getSources:o()("video-sources/${ref}"),getBookmarks:o()("archive/contents/bookmarks/${host}/${endtime}/${begintime}?"),toggleProtectedBookmark:o()("archive/contents/bookmarks"),deleteRecord:o()("archive/contents/bookmarks?"),deleteBookmark:o()("archive/contents/bookmarks"),editBookmark:o()("archive/contents/bookmarks"),findCams:o()("camera/list"),getVideoJar:o()("jar/cambozola.jar"),getLive:o()("live/media/${vsid}?"),close:o()("live/media/${vsid}"),getSnapshot:o()("live/media/snapshot/${vsid}?"),getArchiveList:o()("archive/list/${vsid}"),getArchive:o()("archive/media/${vsid}/${begintime}?"),stopArchive:o()("archive/media/stop/${uuid}"),getArchiveContent:o()("archive/contents/intervals/${vsid}/${endtime}/${begintime}"),getArchiveFrames:o()("archive/contents/frames/${vsid}/${endtime}/${begintime}"),postExport:o()("export/${mode}/${vsid}/${begintime}/${endtime}?"),getExport:o()("${location}/status"),stopExport:o()("${location}"),urlExport:o()("${location}/file?name=${file}"),getEvents:o()("archive/events/${source}/${vsid}/${endtime}/${begintime}?limit_to_archive=1&archive=${archive}"),getTelemetry:o()("control/telemetry/list/${objid}"),getPtzSession:o()("control/telemetry/session/acquire/${tcid}"),releasePtzSession:o()("control/telemetry/session/release/${tcid}"),keepPtzSession:o()("control/telemetry/session/keepalive/${tcid}"),getDegrees:o()("control/telemetry/info/${tcid}"),setMove:o()("control/telemetry/move/${tcid}"),setZoom:o()("control/telemetry/zoom/${tcid}"),setFocus:o()("control/telemetry/focus/${tcid}"),setIris:o()("control/telemetry/iris/${tcid}"),pointMove:o()("control/telemetry/move/point/${tcid}"),areaZoom:o()("control/telemetry/zoom/area/${tcid}"),setAuto:o()("control/telemetry/auto/${tcid}"),getPresets:o()("control/telemetry/preset/info/${tcid}"),goPreset:o()("control/telemetry/preset/go/${tcid}"),setPreset:o()("control/telemetry/preset/set/${tcid}"),removePreset:o()("control/telemetry/preset/remove/${tcid}"),getPosition:o()("control/telemetry/position/${tcid}"),getLayouts:o()("layouts"),statistics:o()("statistics/${obj}"),batchStatistics:o()("statistics"),sse:o()("eventchannel"),archsearch:o()("search/${type}/${begintime}/${endtime}"),facesearch:o()("search/${type}/${begintime}/${endtime}"),getSearchResults:o()("${location}/result?"),stopSearch:o()("${location}"),grpc:o()("grpc"),getAvailableGroups:o()("group"),getMaps:o()("v1/maps?"),getMapImage:o()("v1/maps/image?"),getMapMarkers:o()("v1/maps/markers?")},$=s()([M.c,i.a.param,decodeURIComponent]),H=250,B=new P(5);function Y(e){var t=e.url,n=e.data,r=void 0===n?{}:n,a=e.type,o=void 0===a?"GET":a,c=e.dataType,s=e.contentType,u=e.priority,l=void 0===u?_:u,p=e.timeout,f=void 0===p?0:p,h="",d=t,m=C.b.authToken;return"POST"===o?(d=Object(C.a)(d),h=JSON.stringify(r)):h=$(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?I(n,!0).forEach(function(t){R(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):I(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},r,{authToken:m})),B.push(l,i.a.ajax,{url:d,type:o,data:h,dataType:c,contentType:s,timeout:f})}function U(){return Y({url:F.getHostVer()})}function V(){var e={url:F.getLangs(),priority:E};return Y(e)}function W(e){var t={url:F.getHost({hostname:e})};return Y(t)}function q(e){var t=e.host,n=e.begintime,r=e.endtime,i={url:F.getBookmarks({host:t,begintime:Object(T.k)(n),endtime:Object(T.j)(r)})};return Y(i)}function G(e){var t=e.begintime,n=e.endtime,r=e.origin,i=e.accessPoint,a=e.maskSize,o={access_point:i,camera_ID:r,dt_posix_start_time:Object(T.k)(t),dt_posix_end_time:Object(T.j)(n),mask_size:a,result_type:"RESULT_TYPE_IMAGE"},c={type:"POST",contentType:"application/json",url:F.grpc(),data:{method:"axxonsoft.bl.heatmap.HeatMapService.BuildHeatmap",data:o,result_type:"RESULT_TYPE_IMAGE"}};return Y(c)}function X(e){var t={type:"POST",contentType:"application/json",url:F.toggleProtectedBookmark(),data:e};return Y(t)}function Z(e){var t={type:"DELETE",contentType:"application/json",url:F.deleteRecord()+$.apply(void 0,D(e))};return Y(t)}function K(e){var t={type:"POST",contentType:"application/json",url:F.deleteBookmark(),data:e};return Y(t)}function Q(e){var t={type:"POST",contentType:"application/json",url:F.editBookmark(),data:e};return Y(t)}function J(){return Y({url:F.getMaps()+$({view:z})})}function ee(e){var t=e.mapId;return Y({url:F.getMapImage()+$({map_id:t})})}function te(e){var t=e.mapId;return Y({url:F.getMapMarkers()+$({map_id:t})})}function ne(e){var t=e.filter,n=e.next,r=e.limit,i={url:F.findCams(),data:{filter:t,limit:r,next_page:n},priority:w};return Y(i)}function re(e){var t={type:"POST",contentType:"application/json",url:F.batchStatistics(),data:e};return Y(t)}function ie(){var e={dataType:"buffer",url:function(e,t){var n=e.w,r=e.h,i=e.vsid;return F.getSnapshot({vsid:N(i)})+$({w:n,h:r,_:t||Date.now(),authToken:C.b.authToken})}.apply(void 0,arguments),timeout:T.i};return Y(e)}function ae(e){var t={url:F.getArchiveList({vsid:N(e)})};return Y(t)}function oe(e){var t=e.vsid,n=e.begintime,r=e.endtime,i=e.archive,a=e.offset,o=e.limit,c=void 0===o?H:o,s=e.scale,u=void 0===s?1:s,l={url:F.getArchiveContent({vsid:N(t),begintime:Object(T.k)(n),endtime:Object(T.j)(r)}),data:{archive:i,limit:c,offset:a,scale:u}};return Y(l)}function ce(e){var t=e.vsid,n=e.direction,r=e.timestamp,i=e.archive,a=e.limit,o=void 0===a?H:a,c=n>0?{endtime:"future",begintime:Object(T.k)(r)}:{endtime:"past",begintime:Object(T.j)(r)},s=c.begintime,u=c.endtime,l={url:F.getArchiveFrames({vsid:N(t),begintime:s,endtime:u}),dataType:"json",data:{archive:i,limit:o}};return Y(l)}function se(e){var t=e.vsid,n=e.isLive,r=e.extended,i=e.begintime,a=e.endtime,o=e.archive,c={type:"POST",data:r,contentType:"application/json",url:F.postExport({mode:n?"live":"archive",vsid:N(t),begintime:Object(T.k)(i),endtime:Object(T.j)(a)})+$({archive:o})};return Y(c)}function ue(e){var t=e.location,n=e.archive,r={url:F.getExport({location:t}),data:{archive:n}};return Y(r)}function le(e){var t=e.location,n={url:F.getSearchResults({location:t})};return Y(n)}function pe(e){var t=e.location,n={type:"DELETE",url:F.stopSearch({location:t})};return Y(n)}function fe(e){var t=e.location,n=e.file;return s()([F.urlExport,C.a])({location:t,file:n})}function he(e){var t=e.location,n={type:"DELETE",url:F.stopExport({location:t})};return Y(n)}function de(e){var t=e.source,n=void 0===t?"detectors":t,r=e.vsid,i=e.begintime,a=e.endtime,o=e.limit,c=void 0===o?H:o,s=e.offset,u=void 0===s?0:s,l=e.archive,p={url:F.getEvents({source:n,vsid:N(r),begintime:Object(T.k)(i),endtime:Object(T.j)(a),archive:l}),data:{limit:c,offset:u},priority:E};return Y(p)}function me(e){var t=e.session_priority,n=void 0===t?1:t,r=e.tcid,i={url:F.getPtzSession({tcid:N(r)}),data:{session_priority:n}};return Y(i)}function be(e){var t=e.session_id,n=e.tcid,r={type:"HEAD",url:F.keepPtzSession({tcid:N(n)}),data:{session_id:t}};return Y(r)}function ve(e){var t=e.mode,n=e.pan,r=e.tilt,i=e.session_id,a=e.tcid,o={url:F.setMove({tcid:N(a)}),data:{mode:t,pan:n,tilt:r,session_id:i}};return Y(o)}function ye(e){var t=e.mode,n=e.zoom,r=e.session_id,i=e.tcid,a={url:F.setZoom({tcid:N(i)}),data:{mode:t,value:n,session_id:r}};return Y(a)}function ge(e){var t=e.x,n=e.y,r=e.session_id,i=e.tcid,a={url:F.pointMove({tcid:N(i)}),data:{x:t,y:n,session_id:r}};return Y(a)}function Oe(e){var t=e.x,n=e.y,r=e.w,i=e.h,a=e.session_id,o=e.tcid,c={url:F.areaZoom({tcid:N(o)}),data:{x:t,y:n,w:r,h:i,session_id:a}};return Y(c)}function we(e){var t=e.degree,n=void 0===t?"focus":t,r=e.session_id,i=e.tcid,a={url:F.setAuto({tcid:N(i)}),data:{degree:n,session_id:r}};return Y(a)}function je(e){var t={url:F.getPresets({tcid:N(e)})};return Y(t)}function _e(e){var t=e.pos,n=e.session_id,r=e.tcid,i={url:F.removePreset({tcid:N(r)}),data:{pos:t,session_id:n}};return Y(i)}function Ee(e){var t=e.pos,n=e.label,r=e.session_id,i=e.tcid,a={url:F.setPreset({tcid:N(i)}),data:{pos:t,label:n,session_id:r}};return Y(a)}function Ae(e){var t=e.pos,n=e.session_id,r=e.tcid,i={url:F.goPreset({tcid:N(r)}),data:{pos:t,session_id:n}};return Y(i)}function Se(e){var t={type:"POST",contentType:"application/json",url:F.grpc(),data:{method:"axxonsoft.bl.layout.LayoutManager.Update",data:{created:e}}};return Y(t)}function xe(e){var t={url:F.getPosition({tcid:N(e)})};return Y(t)}function ke(e){var t={type:"POST",contentType:"application/json",url:F.grpc(),data:{method:"axxonsoft.bl.layout.LayoutManager.Update",data:{modified:e}}};return Y(t)}function Pe(e){var t={type:"POST",contentType:"application/json",url:F.grpc(),data:{method:"axxonsoft.bl.layout.LayoutManager.Update",data:{removed:e}}};return Y(t)}function Ce(){return Y({url:F.getLayouts()})}function Te(e){var t=e.type,n=e.begintime,r=e.endtime,i=e.query,a=void 0===i?{}:i,o={type:"POST",url:F.archsearch({type:t,begintime:Object(T.k)(n),endtime:Object(T.j)(r)}),data:Object(M.c)(a),contentType:"application/json"};return Y(o)}function Me(e){var t=e.type,n=e.begintime,r=e.endtime,i=e.query,a={type:"POST",url:F.facesearch({type:t,begintime:Object(T.k)(n),endtime:Object(T.j)(r)}),data:Object(M.c)(i),contentType:"application/json"};return Y(a)}function De(){var e,t,n=!0,r="/statistics/webserver";document.execCommand("ClearAuthenticationCache"),(e=new XMLHttpRequest,t=i.a.Deferred(),e.addEventListener("loadend",t.resolve),e.open("GET",r,n,"\0","\0"),e.send(),t).then(function(){var e=new XMLHttpRequest,t=i.a.Deferred();return e.addEventListener("loadend",t.resolve),e.open("GET",r,n,"",""),e.send(),t}).then(function(){window.location.reload()})}document.cookie="Agent-Name=Agent",i.a.ajaxSetup({cache:!1}),i.a.ajaxTransport("buffer",function(e){var t=new XMLHttpRequest;return t.open("GET",e.url),t.responseType="arraybuffer",t.timeout=e.timeout,{send:function(e,n){Object.entries(e).map(function(e){var n=L(e,2),r=n[0],i=n[1];return t.setRequestHeader(r,i)}),t.onload=function(){return n(t.status,t.statusText,{buffer:t.response})},t.send()},abort:function(){t.abort()}}});var Ie=Object(C.a)("stats.html"),Re=Object(C.a)("bookmarks.html"),Le=Object(C.a)("embedded.html");function Ne(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:T.i,t={url:F.getLangs(),type:"HEAD",timeout:e,priority:j};return Y(t)}function ze(){return Y({url:F.getAvailableGroups()})}},1140:function(e,t,n){"use strict";n.r(t),function(e){var t=n(556),r=n.n(t),i=n(4),a=n(15),o=n(130),c=n(858),s=n(123);n(675),n(1601),n(1602);function u(){i.a.common("version %c%s","color: blue","ASIP-ANWC-WC-974"),this.stats=Object(a.b)(a.b.key.STATS).put,this.dump=a.b.dump,this.debug=i.b,a.a.push(s.o).push(o.b).push(o.d).push(o.c).push(o.a).push(s.j).push(s.d).push(s.a).push(s.m).push(s.c).push(s.n).push(s.g).push(s.h).push(s.e).push(s.l).push(s.p).push(s.f).push(s.k).push(s.b).push(s.i),Object(a.b)(a.b.key.CLIPBOARD).observe(c.a)}"production"===e.env?(i.a.common("raven %c%s","color: blue",r.a.VERSION),r.a.config("https://dfbf0a3fdf7045719d6d726d8efdfedb@sentry.io/280050",{release:"ASIP-ANWC-WC-974"}).install(),r.a.context(function(){window.app=new u})):window.app=new u}.call(this,n(215))},115:function(e,t,n){"use strict";var r=n(72),i=n.n(r),a=n(6),o=n.n(a),c=n(3),s=n.n(c),u=n(21),l=n.n(u),p=n(157),f=n.n(p),h=n(70),d=n.n(h),m=n(56),b=n.n(m),v=n(43),y=n(120),g=n(13),O=n(4);function w(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function j(e){return j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},j(e)}function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(n,!0).forEach(function(t){M(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function A(e,t){return!t||"object"!==j(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function S(e){return S=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},S(e)}function x(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&k(e,t)}function k(e,t){return k=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},k(e,t)}function P(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function C(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function T(e,t,n){return t&&C(e.prototype,t),n&&C(e,n),e}function M(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var D=b()(/^hosts\//,""),I=["speed","beginTime","endpoint","keyFrames","archive","format"],R=o()(i()([[o()(s()(["method"]),l()("play")),d()(["endpoint","format","method","streamId","keyFrames","speed","beginTime","archive","width","height","vc"])],[o()(s()(["method"]),l()("stop")),d()(["method","streamId"])],[o()(s()(["method"]),l()("batch")),d()(["endpoint","format","method","streamId","keyFrames","timestampList","archive","width","height","vc"])]]),Object(g.i)({endpoint:D,archive:D})),L=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;P(this,e),M(this,"ctx",void 0),M(this,"options",void 0),this.options=t,this.ctx=n,n.conn.postMessage(R(t)),O.a.video("media state: %c%s %c%s","font-weight: bold",this.state,"color:gray",this.options.endpoint)}return T(e,[{key:"batch",value:function(){return this}},{key:"play",value:function(){return this}},{key:"stop",value:function(){return this}},{key:"state",get:function(){return this.constructor.name}}]),e}(),N=function(e){function t(e,n){return P(this,t),n.updateIndex(e.streamId),A(this,S(t).call(this,e,n))}return x(t,e),T(t,[{key:"stop",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.options,t=this.options.streamId,n=E({},e,{method:"stop",streamId:t});return this.ctx.clearIndex(t),new z(n,this.ctx)}},{key:"play",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.options,t=d()(I,this.options),n=f()(t,e);if(n)return this;var r=E({},e,{keepPlayer:n});return O.a.video("media %crestart%c %s %c%s","font-weight: bold","font-weight: normal",r.keepPlayer?"(keeping player)":"","color: gray",r.endpoint),this.stop(r).play()}}]),t}(L),z=function(e){function t(e,n){var r;return P(this,t),r=A(this,S(t).call(this,e,n)),n.clearIndex(e.streamId),r}return x(t,e),T(t,[{key:"play",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.options,t=e.keepPlayer,n=w(e,["keepPlayer"]),r=n.format===v.a.MP4&&(n.archFastMjpeg?1===n.speed:0!==n.speed),i={},a="img";return r?(i=E({},n,{format:v.a.MP4}),a="mse"):i=E({},n,{format:"jpeg"}),t||this.ctx.setType(a),i.streamId=Object(y.a)(),i.method="play",new N(i,this.ctx)}},{key:"batch",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.options,t=E({},e,{format:"jpeg",method:"batch",streamId:Object(y.a)()});return new N(t,this.ctx)}}]),t}(L);t.a=function(e){var t={ctx:e,options:{},stop:function(){return this},play:null,batch:null};return t.play=z.prototype.play.bind(t),t.batch=z.prototype.batch.bind(t),t}},12:function(e,t,n){"use strict";n.d(t,"b",function(){return r});var r={APP_LOADED:"appLoaded",APP_MODE:"appMode",ARCH_BOUNDS:"archBounds",ARCH_SPEED:"archSpeed",ARCH_TIME:"archTime",BITRATE:"bitrate",CAM_ACTIVE:"camActive",CAM_ARCH:"camArch",CAM_ARCH_IMAGE_INFO:"camArchImageInfo",CAM_LIST:"camList",CAM_STATES:"camStates",CELL_IDX:"cellIndex",CLIPBOARD:"clipboard",COMMENTS:"comments",CONNECTION:"connection",EXPORT_TASK:"exportTask",LAYOUT_CELLS:"layoutCells",LAYOUT_LIST:"layoutList",LAYOUT_PENDING:"layoutPending",LAYOUT_SELECTED:"layoutSelected",LAYOUT_SIZE:"layoutSize",MOVE_SCALE:"moveScale",PLAYBACK:"playback",PREFS:"preferences",PTZ_READY:"ptzReady",SEARCH_RESULTS:"searchResults",SELECTOR_FILTER:"selectorFilter",SELECTOR_MODE:"selectorMode",SOURCES:"sources",SOURCES_IDX:"sourcesIndex",STATS:"statistics",VIEW_COUNT:"viewCount",ZOOM:"zoom",UPDATE_CAM_ACTIVE:"updateCamActive"};t.a={key:r}},120:function(e,t,n){"use strict";function r(){return Math.floor(1e16*Math.random()).toString(16).slice(0,12)}function i(){var e=r()+r()+r(),t=0;return[e.slice(t=0,t+=8),e.slice(t+=1,t+=4),e.slice(t+=1,t+=4),e.slice(t+=1,t+=4),e.slice(t+=1,t+=12)].join("-")}n.d(t,"a",function(){return i})},122:function(e,t,n){"use strict";var r=n(161),i=n.n(r),a=n(32),o=n.n(a),c=n(109),s=n.n(c),u=n(6),l=n.n(u),p=n(4);function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var d=l()([o()(i.a),s.a]);t.a=function(e,t){var n={},r=new Set;return function(i){var a,o=i.begintime,c=i.endtime,s=i.scale,u=[],l=this.archiveDesc,m=l.accessPoint,b=l.storage;return n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(n,!0).forEach(function(t){h(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},n,{vsid:m,archive:b,limit:1e4,scale:s,source:t,offset:0,begintime:o,endtime:c}),r.size>0&&(p.a.arch("request cancelling (%i)",r.size),r.forEach(function(e){return e.abort()})),p.a.arch("request %s %c%s %c%s","".concat(o,"…").concat(c),"color:blue",t,"color:gray",n.archive),u.length=0,a=e(n),a.then(function i(o){var c=o.data,s=d(c);if(s.length>0&&(u=u.concat(s)),c.more){n.offset+=1e4;var l=e(n);return r.add(l),l.then(i)}return p.a.arch("request %i %c%s %c%s",u.length,"color:blue",t,"color:gray",n.archive),r.delete(a),u},function(){return r.delete(a),[]})}}},123:function(e,t,n){"use strict";var r={};n.r(r),n.d(r,"MAP_LIST_REQUEST",function(){return Yn}),n.d(r,"MAP_LIST",function(){return Un}),n.d(r,"MAP_IMAGE_REQUEST",function(){return Vn}),n.d(r,"MAP_IMAGE_UPDATE",function(){return Wn}),n.d(r,"MAP_MARKER_REQUEST",function(){return qn}),n.d(r,"MAP_MARKER_UPDATE",function(){return Gn}),n.d(r,"requestMaps",function(){return Xn}),n.d(r,"updateMaps",function(){return Zn}),n.d(r,"updateMapImage",function(){return Kn}),n.d(r,"fetchMapImage",function(){return Qn}),n.d(r,"fetchMapMarkers",function(){return Jn}),n.d(r,"updateMapMarkers",function(){return er});var i={};n.r(i),n.d(i,"setListMode",function(){return Mi}),n.d(i,"requestList",function(){return Di}),n.d(i,"resetList",function(){return Ii}),n.d(i,"updateList",function(){return Ri}),n.d(i,"doneList",function(){return Li}),n.d(i,"toggleFavorite",function(){return Ni}),n.d(i,"favoritesChecked",function(){return zi}),n.d(i,"selectCam",function(){return S}),n.d(i,"changeSortDirection",function(){return Fi}),n.d(i,"setSelection",function(){return $i}),n.d(i,"selectOne",function(){return Hi}),n.d(i,"toggleSelection",function(){return Bi});var a={};n.r(a),n.d(a,"searchInit",function(){return $o}),n.d(a,"searchAuto",function(){return Ho}),n.d(a,"searchFace",function(){return Bo}),n.d(a,"searchFrag",function(){return Yo}),n.d(a,"searchHeatmap",function(){return Uo}),n.d(a,"searchVmda",function(){return Vo}),n.d(a,"searchEvents",function(){return Wo}),n.d(a,"setSearchParam",function(){return qo}),n.d(a,"replaceQuery",function(){return Go}),n.d(a,"replaceForms",function(){return Xo}),n.d(a,"setForms",function(){return Zo}),n.d(a,"searchRaw",function(){return Ko}),n.d(a,"searchFetchFrames",function(){return Qo}),n.d(a,"searchResults",function(){return Jo}),n.d(a,"setSearchIdx",function(){return ec}),n.d(a,"searchItemSelect",function(){return tc}),n.d(a,"searchAbort",function(){return nc}),n.d(a,"searchReceived",function(){return rc}),n.d(a,"searchDone",function(){return ic}),n.d(a,"searchClear",function(){return ac}),n.d(a,"setColumns",function(){return oc}),n.d(a,"searchExpand",function(){return cc}),n.d(a,"setSearchCams",function(){return sc}),n.d(a,"setHeatmapOpacity",function(){return uc});var o={};n.r(o),n.d(o,"stateChanOpen",function(){return sl}),n.d(o,"stateChanClose",function(){return ul}),n.d(o,"stateWatch",function(){return ll}),n.d(o,"updateAlerts",function(){return pl}),n.d(o,"updateAlertsState",function(){return fl});var c=n(0),s=n.n(c),u=n(63),l=n(1),p=n(47),f=n.n(p),h=n(67),d=n(15),m=n(9),b=n(25),v=n(4),y=n(19),g=n(45),O=n(17),w=n(146),j=Object(O.createMuiTheme)({palette:{type:"dark",accent:w.orange[500],background:{default:w.grey[800],primary:"#324262",secondary:w.grey[200]},primary:{main:w.blue[400]},secondary:{main:w.orange[500]},alert:{main:w.red[700]}}});j.palette.alert=j.palette.augmentColor(j.palette.alert),j.dimension={alertHeight:18*j.spacing.unit};var _=function(e){return function(t){return c.createElement(O.MuiThemeProvider,{theme:j},c.createElement(e,t))}},E=_,A=n(12);function S(e){return{type:b.c,payload:e}}var x=Object(g.b)(null,function(e){return Object(y.b)({selectCam:S},e)}),k=n(49),P=n(110),C=n.n(P),T=n(6),M=n.n(T),D=n(514),I=n.n(D),R=n(3),L=n.n(R),N=n(7),z=n.n(N),F=n(352),$=n.n(F),H=n(51),B=n(32),Y=n.n(B),U=n(129),V=n.n(U),W=n(21),q=n.n(W),G=n(314),X=n.n(G),Z=n(22),K=n.n(Z),Q=n(34),J=n.n(Q),ee=n(141),te=n.n(ee),ne="stateChan/OPEN",re="stateChan/WATCH",ie="stateChan/CLOSE",ae="stateChan/UPDATE_ALERTS",oe="stateChan/UPDATE_ALERTS_STATE";function ce(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function se(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ce(n,!0).forEach(function(t){ue(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ce(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function ue(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var le={alerts:{}},pe=M()([L()("state"),q()("closed")]),fe=M()([L()("state"),V()(K.a,["reaction","processed"])]),he="filters/CAMERA_NAME",de="filters/GROUP_REQUEST",me="filters/GROUP_SET",be="filters/GROUP_SELECT_SET",ve="filters/TOGGLE_FAVORITE";function ye(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function ge(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ye(n,!0).forEach(function(t){Oe(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ye(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Oe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var we={searchTerms:"",list:null,selectedGroup:null},je=n(226),_e=n.n(je),Ee=n(27),Ae="closed",Se="list",xe="grid",ke=n(5),Pe="cameraList/MODE",Ce="cameraList/REQUEST",Te="cameraList/RESET",Me="cameraList/UPDATE",De="cameraList/DONE",Ie="cameraList/CHANGE_DIRECTION",Re="cameraList/FAVORITES_CHECKED",Le="cameraList/SELECT_ONE",Ne="cameraList/SELECTION",ze="cameraList/TOGGLE_SELECT",Fe="",$e=ke.h;function He(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Be(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?He(n,!0).forEach(function(t){Ye(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):He(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Ye(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ue=z()(_e()([L()("dev"),L()("desc")])),Ve={filter:"",cams:[],pending:!1,mode:Ae,favorites:!1,directionSort:!1,selection:new Map,typeSort:Ee.b},We=n(40),qe=n.n(We),Ge=n(97),Xe=n.n(Ge),Ze=n(69),Ke=n.n(Ze),Qe=n(197),Je=n.n(Qe),et=n(46),tt=n.n(et),nt=n(515),rt=n.n(nt),it="search/AUTO",at="search/FACE",ot="search/FRAGMENTS",ct="search/HEATMAP",st="search/VMDA",ut="search/EVENTS",lt="search/RESULT_LIST",pt="search/RESULT_RAW",ft="search/RESULT_IDX",ht="search/INIT",dt="search/ABORT",mt="search/DONE",bt="search/CLEAR",vt="search/RECEIVED",yt="search/FETCH_FRAMES",gt="search/ITEM_SELECT",Ot="search/SEARCH_SET_COLUMNS",wt="search/SET_PARAM",jt="search/SET_FORMS",_t="search/SET_HEATMAP_OPACITY",Et="search/REPLACE_FORMS",At="search/EXPAND_INTERVAL",St="search/REPLACE_QUERY",xt="search/CAMERAS",kt="searchHistory",Pt="heatmap",Ct=(n(427),n(85)),Tt=n.n(Ct),Mt=n(53),Dt=n.n(Mt);function It(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,c=e[Symbol.iterator]();!(r=(o=c.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(i)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var Rt=[.01,1],Lt=function(){},Nt=function(e){return function(t){return Dt()(function(t){var n=It(t,2),r=n[0],i=n[1];return["min"===e?.01:r,"max"===e?1:i]})(t)}},zt=function(e){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Rt;return"min"===e?[.01,Tt()(t)]:[tt()(t),1]}},Ft={color:{path:["objectProperties","color"],ruleReset:Lt},direction:{path:["conditions","duration"],ruleReset:Lt},enterExit:{path:["queryProperties","action"],ruleReset:Lt},objectType:{path:["objectProperties","category"],ruleReset:Lt},minSize:{path:["objectProperties","size"],ruleReset:Nt("min")},maxSize:{path:["objectProperties","size"],ruleReset:Nt("max")},maxSpeed:{path:["objectProperties","conditions","speed"],ruleReset:zt("max")},minSpeed:{path:["objectProperties","conditions","speed"],ruleReset:zt("min")}};function $t(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Ht(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$t(n,!0).forEach(function(t){Bt(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$t(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Bt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Yt(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Xe()(["results","values"],e),n=t.next();!n.done;n=t.next())URL.revokeObjectURL(n.value.image),URL.revokeObjectURL(n.value.heatmap)}var Ut=m.a.settings.searchHistory,Vt=J()(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Map,t=arguments.length>1?arguments[1]:void 0;return e.set(function(e){return[e.camera.dev,e.timestamp.getTime()].join(" ")}(t),t)}),Wt={cameras:[],columns:3,opacity:.7,pending:!1,query:{},forms:[],idx:-1,history:[],sort:"timestamp"},qt=n(100);function Gt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Xt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Zt=n(230),Kt=n.n(Zt);function Qt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Jt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Qt(n,!0).forEach(function(t){en(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Qt(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function en(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var tn={top:"height",left:"width",right:"width",bottom:"height"},nn={top:"y",left:"x",right:"x",bottom:"y"},rn={top:"right",right:"bottom",bottom:"left",left:"top"},an=function(e){return{width:1/e.width,height:1/e.height}},on=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return-1};return Array.from({length:e.height},function(n,r){return Array.from({length:e.width},function(e,n){return t({x:n,y:r})})})},cn=function(e){return Array.from(e,function(e){return e.slice(0)})},sn=function(e,t){var n=t.x,r=t.y;return e&&void 0!==e[r]&&void 0!==e[r][n]?e[r][n]:-1},un=function(e,t,n){var r=t.x,i=t.y,a={top:0,left:0,right:0,bottom:0},o=function(){return sn(e,{x:r+a.right-a.left,y:i+a.bottom-a.top})},c=o();do{a[n]+=1}while(o()===c);return{index:o(),size:a[n]}},ln=function(e,t,n){for(var r={},i=0;i<n.height;i+=1)for(var a=0;a<n.width;a+=1){var o=e[i][a];if(!r[o]){var c={x:a,y:i},s=un(e,c,"right"),u=s.index,l=s.size,p=un(e,c,"bottom"),f=p.index,h=p.size;r[o]=Kt()(t[o],{sibling:{top:sn(e,{x:a,y:i-1}),left:sn(e,{x:a-1,y:i}),right:u,bottom:f},size:{width:l,height:h}})}}return r},pn=function(e){return{index:e,origin:void 0,sibling:{top:-1,left:-1,right:-1,bottom:-1},size:{width:1,height:1}}},fn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{width:0,height:0},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{x:0,y:0},n=t.x,r=t.y;return n+r*e.width},hn=function(e,t){var n={},r=on(e,function(t){var r=t.x,i=t.y,a=fn(e,{x:r,y:i});return n[a]=pn(a),a});return{id:t,cells:ln(r,n,e),grid:r,size:e}},dn=function(e,t,n){for(var r=0,i=t.sibling[n];i>-1;){var a=e[i],o=a.size,c=a.sibling;r+=o[tn[n]],i=c[n]}return r},mn=function(e,t){return{x:dn(e,t,"left"),y:dn(e,t,"top")}},bn=function(e){var t,n,r=(t=e.cells,n=e.size,J()(function(e,n){for(var r=mn(t,n),i=r.x,a=r.y,o=e,c=0;c<n.size.height;c+=1)for(var s=0;s<n.size.width;s+=1)o[a+c][i+s]=n.index;return o},on(n))(t));return Jt({},e,{grid:r})};function vn(e,t){var n=e.cells,r=e.size,i=an(r);return J()(function(e,r){return Jt({},e,en({},r,function e(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=n.sibling[r];if(a<0)return i;var o=t[a],c=o.size[tn[r]];return e(t,o,r,i+c)}(n,t,r)*i[tn[r]]))},{})(["top","right","bottom","left"])}var yn=function(e,t,n){var r=e.cells[t],i=mn(e.cells,r),a={top:0,left:0,right:0,bottom:0},o=cn(e.grid),c=Jt({},e.cells),s=function(t){var n=t.top,r=t.left,a=t.right,s=t.bottom,u=i.y+s-n,l=i.x+a-r,p=fn(e.size,{x:l,y:u}),f=pn(p);o[u][l]=f.index,c[f.index]=f};if("top"===n)for(a.bottom=r.size.height-1;a.right<r.size.width;)s(a),a.right+=1;else if("bottom"===n)for(;a.right<r.size.width;)s(a),a.right+=1;else if("left"===n)for(a.right=r.size.width-1;a.bottom<r.size.height;)s(a),a.bottom+=1;else if("right"===n)for(;a.bottom<r.size.height;)s(a),a.bottom+=1;var u=ln(o,c,e.size);return Jt({},e,{grid:o,cells:u})},gn=function(e,t,n){var r=e.cells[t],i=Kt()(r,{origin:n.origin}),a=Jt({},e.cells,en({},r.index,i));return Jt({},e,{cells:a})},On="layoutEditor/CREATE",wn="layoutEditor/startEdit",jn="layoutEditor/copyCurrent",_n="layoutEditor/remove",En="layoutEditor/initForm",An="layoutEditor/FILL_WITH_CAMERAS",Sn="layoutEditor/selectCell",xn="layoutEditor/removeCameraCell",kn="layoutEditor/adjustFormCell",Pn="layoutEditor/collapseFormCell",Cn="layoutEditor/startSubmitForm",Tn="layoutEditor/resetForm",Mn="layoutEditor/SET_NAME";function Dn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function In(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Dn(n,!0).forEach(function(t){Rn(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Dn(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Rn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ln,Nn={type:null,form:{id:"",displayName:"",cells:{},grid:[],size:{width:0,height:0}},selectedCellIndex:-1},zn=function(e){return e/Math.PI*180},Fn=function(e,t,n){var r,i=t.x-e.x,a=t.y-e.y,o=Math.sqrt(Math.pow(i,2)+Math.pow(a,2)),c=Math.atan(a/i)+(i<0?Math.PI:0),s=(r=n/2,r*Math.PI/180),u=c+s,l=c-s;return{begin:e,end:t,distance:o,directionAngle:c,startAngle:u,endAngle:l}},$n=function(e){var t=e.src,n=e.onLoad,r=e.onError,i=document.createElement("script");i.src=t,i.onload=n,i.onError=r,document.body.appendChild(i)},Hn=(Ln=!1,function(){return new Promise(function(e,t){var n,r,i;Ln?e():(n={href:"https://api.mapbox.com/mapbox.js/v3.1.1/mapbox.css"},r=n.href,i=document.createElement("link"),i.href=r,i.rel="stylesheet",document.head.appendChild(i),$n({src:"https://api.mapbox.com/mapbox.js/v3.1.1/mapbox.js",onLoad:function(){Ln=!0,e()},onError:t}))})}),Bn=(function(){var e=!1}(),n(44)),Yn="MAP_LIST_REQUEST",Un="MAP_LIST",Vn="MAP_IMAGE_REQUEST",Wn="MAP_IMAGE_UPDATE",qn="MAP_MARKER_REQUEST",Gn="MAP_MARKER_UPDATE",Xn=function(){return{type:Yn}},Zn=function(e){return{type:Un,maps:e}},Kn=function(e){return{type:Wn,payload:e}},Qn=function(e){return{type:Vn,mapId:e}},Jn=function(e){return{type:qn,mapId:e}},er=function(e){return{type:Gn,payload:e}};function tr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function nr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?tr(n,!0).forEach(function(t){rr(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):tr(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function rr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ir={maps:[],mapImages:{},mapMarkers:{}},ar=Object(y.c)({alertPanel:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:le,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case ae:var n=e.alerts;return se({},e,{alerts:M()([Y()(fe),J()(function(e,t){return te()(t.alert_id,t,e)},n)])(t.payload)});case oe:var r=e.alerts;return se({},e,{alerts:M()([J()(function(e,t){return te()([t.alert_id,"state"],t.state,e)},r),Y()(pe),z()(L()("alert_id")),X()(K.a,r)])(t.payload)});default:return e}},cameraList:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ve,t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;switch(n){case Ce:return Be({},e,{pending:!0});case Me:return Be({},e,{cams:r.cams,pending:!0});case De:return Be({},e,{pending:!1});case Te:return Be({},e,{},Ve);case Pe:return Be({},e,{mode:r.mode});case he:return Be({},e,{pending:!0});case Re:return Be({},e,{favorites:!e.favorites});case Ie:return Be({},e,{directionSort:r.direction,typeSort:r.typeSort});case ze:var i=new Map(e.selection);return i.has(r.dev)?i.delete(r.dev):i.set(r.dev,r),Be({},e,{selection:i});case Le:var a=new Map(e.selection);return a.set(r.dev,r),Be({},e,{selection:a});case Ne:return Be({},e,{selection:new Map(Ue(r))});default:return e}},filters:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:we,t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;switch(n){case he:return ge({},e,{searchTerms:r.searchTerms});case me:return ge({},e,{list:r.groups});case be:return ge({},e,{selectedGroup:r});default:return e}},search:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Wt,t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;switch(n){case it:case at:case ot:case ct:case st:case ut:var i=e.query,a=e.forms,o=e.history,c=Ke()(o.length,function(){return{query:i,forms:a,results:new Map}},o),s=c.splice(-Ut);return c.forEach(Yt),Ht({},e,{pending:!0,history:s});case _t:var u=r;return Ht({},e,{opacity:u});case lt:var l=e.history,p=l.length-1,f=Ke()([p,"results"],function(e){return new Map(Vt(e,r))})(l);return Ht({},e,{history:f,idx:p});case ft:var h=r,d=e.history,m=qe()(0,d.length-1)(h),b=d[m],v=b.query,y=b.forms;return Ht({},e,{query:rt()(v),forms:y,idx:m});case bt:var g=e.history;return g.forEach(Yt),Ht({},e,{idx:Wt.idx,history:Wt.history});case dt:case mt:return Ht({},e,{pending:!1});case wt:var O=te()(r.path,r.value)(e.query);return Ht({},e,{query:O});case St:return Ht({},e,{query:r});case Et:return Ht({},e,{forms:r});case jt:var w=M()(Je()(r),tt.a)(e.forms),j=Ft[w],_=j.path,E=j.ruleReset,A=Ke()(_,E,e.query);return Ht({},e,{query:A,forms:r});case Ot:var S=r;return Ht({},e,{columns:S});case xt:return Ht({},e,{cameras:r});default:return e}},topic:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;if(Object(qt.b)(n)){var i,a=Object(qt.c)(n);return v.a.topics("%s: %o",a,r),function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Gt(n,!0).forEach(function(t){Xt(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Gt(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},e,(i={},Xt(i,a,r),Xt(i,Object(qt.d)(a),e[a]),i))}return e},layoutEditor:function(){var e,t,n,r,i,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Nn,o=arguments.length>1?arguments[1]:void 0,c=o.type,s=o.payload;switch(c){case En:return In({},a,{type:s.type,form:s.form,selectedCellIndex:-1});case Sn:return In({},a,{selectedCellIndex:s});case kn:var u=s.directions,l=s.id,p=u.reduce(function(e,t){return function(e,t,n){for(var r=e.cells[t],i=mn(e.cells,r),a=Jt({},e,{grid:cn(e.grid),cells:Jt({},e.cells)}),o=rn[n],c=tn[o],s={},u=0;u<r.size[c];u+=1){var l=un(e.grid,Kt()(i,en({},nn[o],i[nn[o]]+u)),n),p=l.index;s[p]=e.cells[p]}a=J()(function(e,t){return t.size[c]>1?yn(e,t.id,n):e},a)(s);for(var f=0;f<r.size[c];f+=1){var h=en({},nn[o],i[nn[o]]+f);"right"===n?h.x=i.x+r.size.width:"left"===n?h.x=i.x-1:"top"===n?h.y=i.y-1:"bottom"===n&&(h.y=i.y+r.size.height),a.grid[h.y][h.x]=r.index}return Jt({},a,{cells:ln(a.grid,a.cells,a.size)})}(e,l,t)},a.form);return In({},a,{form:p});case Pn:return In({},a,{form:yn(a.form,s.id,s.direction)});case xn:var f=a.form,h=a.selectedCellIndex;return h in f.cells?In({},a,{form:gn(f,h,s)}):a;case An:return In({},a,{form:(e=a.form,t=s,n=Array.from(t),r=n.reduce(function(e,t,n){var r=e[n],i=Jt({},r,{origin:t});return Jt({},e,en({},n,i))},Jt({},e.cells)),i=Jt({},e,{cells:r}),i)});case Mn:return In({},a,{form:In({},a.form,{displayName:s})});default:return a}},map:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ir,t=arguments.length>1?arguments[1]:void 0,n=t.payload,r=e.maps;switch(t.type){case Un:return nr({},e,{},{maps:t.maps});case Wn:return r.map(function(e){if(e.id===n.mapId&&!e.mapImage){var t=Object(Bn.c)(n.image.data);e.mapImage=URL.createObjectURL(t)}return e}),nr({},e,{},{maps:r});case Gn:return r.map(function(e){return e.id===n.mapId&&e.cameraMarkers.push(n.markers),e}),nr({},e,{},{maps:r});default:return e}}}),or=ar,cr=n(2),sr=n(84),ur=n.n(sr),lr=n(256),pr=n.n(lr),fr=n(59),hr=n(23),dr=n(13),mr=regeneratorRuntime.mark(vr);function br(e,t){return Object(H.d)(function(n){var r=function(){return n(H.a)},i=Object(Ee.e)(e,t).progress(n).then(n,r).then(r);return i.abort})}function vr(e){var t,n,r;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,Object(cr.l)(L()(["topic",e]));case 2:if(t=i.sent,t){i.next=9;break}return i.next=6,Object(cr.n)(Object(hr.a)(e));case 6:n=i.sent,r=n.payload,t=r;case 9:return i.abrupt("return",t);case 10:case"end":return i.stop()}},mr)}function yr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function gr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?yr(n,!0).forEach(function(t){Or(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):yr(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Or(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var wr=regeneratorRuntime.mark(Tr),jr=regeneratorRuntime.mark(Mr),_r=regeneratorRuntime.mark(Ir),Er=regeneratorRuntime.mark(Rr),Ar=regeneratorRuntime.mark(Lr),Sr=regeneratorRuntime.mark(Nr),xr=M()([L()("idx"),ur()(K.a,fr.c)]),kr=M()(L()(["topic",A.b.LAYOUT_CELLS]),f.a,q()(1)),Pr=L()(["topic",A.b.CAM_ACTIVE]),Cr=L()(["topic",A.b.LAYOUT_SELECTED]);function Tr(){var e,t;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(cr.l)(kr);case 2:if(e=n.sent,!e){n.next=5;break}return n.abrupt("return");case 5:return n.delegateYield(vr(A.b.CAM_ACTIVE),"t0",6);case 6:return t=n.t0,n.next=9,Object(cr.j)(Object(hr.e)(A.b.LAYOUT_CELLS,Object(fr.d)(t)));case 9:case"end":return n.stop()}},wr)}function Mr(e){var t;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t=e.payload,n.next=3,Object(cr.j)(Object(hr.e)(A.b.CAM_ARCH,t));case 3:case"end":return n.stop()}},jr)}var Dr=Object(dr.d)(pr()({type:Object(hr.a)(A.b.APP_MODE),payload:b.a.LIVE}));function Ir(){var e,t;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(cr.p)(Object(hr.a)(A.b.CAM_ACTIVE),Mr);case 2:return e=n.sent,n.next=5,Object(cr.l)(Pr);case 5:if(t=n.sent,!t){n.next=8;break}return n.delegateYield(Mr({payload:t}),"t0",8);case 8:return n.next=10,Object(cr.n)(Dr);case 10:return n.next=12,Object(cr.j)(Object(hr.e)(A.b.CAM_ARCH,void 0));case 12:return n.next=14,Object(cr.d)(e);case 14:case"end":return n.stop()}},_r)}function Rr(e){var t,n;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:t=e.payload,r.t0=t,r.next=r.t0===b.a.ARCH?4:r.t0===b.a.ARCH_SEARCH?4:r.t0===b.a.LIVE?10:19;break;case 4:return r.next=6,Object(cr.j)(Object(hr.e)(A.b.PLAYBACK,{speed:0}));case 6:return r.delegateYield(Tr(),"t1",7);case 7:return r.next=9,Object(cr.m)(Ir);case 9:return r.abrupt("break",19);case 10:return r.next=12,Object(cr.l)(Cr);case 12:if(n=r.sent,!xr(n)){r.next=16;break}return r.next=16,Object(cr.j)(Object(hr.e)(A.b.LAYOUT_SELECTED,gr({},n)));case 16:return r.next=18,Object(cr.j)(Object(hr.e)(A.b.PLAYBACK,{beginTime:void 0,speed:1}));case 18:return r.abrupt("break",19);case 19:case"end":return r.stop()}},Er)}function Lr(e){var t,n;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(t=e.payload,t){r.next=3;break}return r.abrupt("return");case 3:return r.next=5,t.archPromise;case 5:if(n=r.sent,n){r.next=10;break}return r.next=9,Object(cr.j)(Object(hr.e)(A.b.APP_MODE,b.a.LIVE));case 9:return r.abrupt("return");case 10:return r.next=12,Object(cr.c)([t,t.resetLiveStream]);case 12:return r.next=14,Object(cr.c)([t,t.initArchive]);case 14:case"end":return r.stop()}},Ar)}function Nr(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(cr.p)(Object(hr.a)(A.b.APP_MODE),Rr);case 2:return e.next=4,Object(cr.p)(Object(hr.a)(A.b.CAM_ARCH),Lr);case 4:return e.next=6,Object(cr.j)(Object(hr.e)(A.b.APP_MODE,b.a.LIVE));case 6:case"end":return e.stop()}},Sr)}var zr=regeneratorRuntime.mark($r),Fr=regeneratorRuntime.mark(Hr);function $r(e){var t,n,r;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return t=e.payload,i.next=3,Object(cr.k)({success:Object(cr.f)(ke.h),cancelByLayout:Object(cr.n)(Object(hr.a)(A.b.LAYOUT_SELECTED))});case 3:if(n=i.sent,r=n.success,!r){i.next=8;break}return i.next=8,Object(cr.j)(Object(hr.e)(A.b.CAM_ACTIVE,t));case 8:case"end":return i.stop()}},zr)}function Hr(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(cr.p)(Object(hr.a)(A.b.UPDATE_CAM_ACTIVE),$r);case 2:case"end":return e.stop()}},Fr)}var Br=Hr,Yr=regeneratorRuntime.mark(Gr),Ur=regeneratorRuntime.mark(Xr);function Vr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Wr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Vr(n,!0).forEach(function(t){qr(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Vr(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function qr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Gr(e){var t,n,r;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(t=e.payload,n=[],t){i.next=6;break}return i.next=5,Object(cr.j)(Object(hr.e)(A.b.LAYOUT_SELECTED,Object(fr.g)()));case 5:return i.abrupt("return");case 6:return r=t instanceof h.a?t:new h.a(t),n.push(Wr({},fr.a,{camera:r,origin:t.origin})),i.next=10,Object(cr.j)(Object(hr.e)(A.b.LAYOUT_CELLS,n));case 10:return i.next=12,Object(cr.j)(Object(hr.e)(A.b.CAM_ACTIVE,r));case 12:case"end":return i.stop()}},Yr)}function Xr(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(cr.p)(b.c,Gr);case 2:case"end":return e.stop()}},Ur)}var Zr=n(144),Kr=n.n(Zr),Qr=n(24),Jr=n.n(Qr),ei=n(353),ti=n.n(ei),ni=regeneratorRuntime.mark(hi),ri=regeneratorRuntime.mark(di),ii=regeneratorRuntime.mark(mi);function ai(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,c=e[Symbol.iterator]();!(r=(o=c.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(i)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function oi(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function ci(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?oi(n,!0).forEach(function(t){si(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):oi(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function si(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ui=z()(L()("pending")),li=M()(f.a,q()(1)),pi=M()(L()("origin"),function(e){return Ee.o.test(e)}),fi=M()([L()("idx"),ur()(K.a,fr.c)]);function hi(e){var t,n,r,i,a,o,c,s,u;return regeneratorRuntime.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return t=e.payload.idx,l.prev=1,l.next=4,Object(cr.l)(L()(["topic",A.b.LAYOUT_LIST]));case 4:return r=l.sent,i=Jr()(fr.b,t,r),a=i.cells,o=M()([Y()(pi),z()(function(e){return ci({},e,{camera:null,pending:Object(Ee.c)(e.origin).then(function(e){var t=ai(e,1),n=t[0];return n&&new h.a(n)})})})])(a),v.a.layout("change","loading ".concat(o.length," cam(s)")),n=ui(o),l.next=11,Object(cr.c)(dr.q,n);case 11:return c=l.sent,s=li(c),u=s?ti()(c):void 0,l.next=16,Object(cr.j)(Object(hr.e)(A.b.CAM_ACTIVE,u));case 16:return l.next=18,Object(cr.j)(Object(hr.e)(A.b.LAYOUT_CELLS,o));case 18:return l.prev=18,l.next=21,Object(cr.e)();case 21:if(!l.sent){l.next=23;break}Kr()(Xe()("abort"),n);case 23:return l.finish(18);case 24:case"end":return l.stop()}},ni,null,[[1,,18,24]])}function di(e){var t,n;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return t=e.payload,r.next=3,Object(cr.l)(L()(["topic",A.b.APP_MODE]));case 3:if(n=r.sent,!fi(t)||n===b.a.LIVE){r.next=7;break}return r.next=7,Object(cr.j)(Object(hr.e)(A.b.APP_MODE,b.a.LIVE));case 7:case"end":return r.stop()}},ri)}function mi(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(cr.p)(Object(hr.a)(A.b.LAYOUT_SELECTED),hi);case 2:return e.next=4,Object(cr.p)(Object(hr.a)(A.b.LAYOUT_SELECTED),di);case 4:case"end":return e.stop()}},ii)}var bi=n(516),vi=n.n(bi),yi=n(11);function gi(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Oi(){return Object(yi.m)().then(M()([L()(["data","groups"]),tt.a]),vi.a)}function wi(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return e.reduce(function(e,n){var r=[].concat(gi(t),[n.Brief.trim()]),i={name:r,id:n.Id};if(0===n.groups.length)return e.concat(i);var a=wi(n.groups,r);return e.concat(i,a)},[])}function ji(e){return{type:he,payload:{searchTerms:e}}}function _i(e){return{type:me,payload:{groups:e}}}function Ei(e){return{type:be,payload:e}}function Ai(e){return{type:ve,payload:{cameraId:e}}}var Si=regeneratorRuntime.mark(Ci),xi=regeneratorRuntime.mark(Ti);function ki(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var Pi=Jr()([],["groups"]);function Ci(){var e,t,n;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Object(cr.c)(Oi);case 2:if(e=r.sent,v.a.common("groups","failed to fetch groups"),t=Pi(e),!(t.length>0)){r.next=11;break}return n=[{name:[e.Brief],id:e.Id,root:!0}].concat(ki(wi(t))),r.next=9,Object(cr.j)(_i(n));case 9:return r.next=11,Object(cr.j)(Ei({name:e.Brief,id:e.Id}));case 11:case"end":return r.stop()}},Si)}function Ti(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(cr.p)(de,Ci);case 2:case"end":return e.stop()}},xi)}function Mi(e){return{type:Pe,payload:{mode:e}}}function Di(e){return{type:Ce,payload:{filter:e}}}function Ii(){return{type:Te}}function Ri(e){return{type:Me,payload:{cams:e}}}function Li(){return{type:De}}function Ni(e){return Ai(e)}function zi(){return{type:Re}}function Fi(e,t){return{type:Ie,payload:{direction:e,typeSort:t}}}function $i(e){return{type:Ne,payload:e}}function Hi(e){return{type:Le,payload:e}}function Bi(e){return{type:ze,payload:e}}var Yi=function(e){var t=e.filters;return t.searchTerms};function Ui(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Vi(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Wi(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var qi=z.a.convert({cap:!1}),Gi=z()(L()(["dev"])),Xi=L()(["cameraList","mode"]),Zi=L()(["cameraList","cams"]),Ki=(L()(["cameraList","filter"]),L()(["topic",A.b.CAM_ARCH])),Qi=L()(["topic",A.b.PREFS,"favorites"]),Ji=L()(["topic",A.b.PREFS,"pinned"]),ea=L()(["cameraList","selection"]),ta=Object(k.createSelector)(ea,function(e){return new Set(Gi(Wi(e.values())))}),na=Object(k.createSelector)(Ki,function(e){return new Set(Gi([e]))}),ra=function(e){var t=e.cameraList;return t.favorites},ia=Object(k.createSelector)(Qi,function(e){return new Set(e)}),aa=function(e){var t=e.cameraList;return t.directionSort},oa=function(e){var t=e.cameraList;return t.typeSort},ca=Object(k.createSelector)(Zi,Yi,function(e){var t=e.filters;return t.selectedGroup},ia,ra,aa,oa,function(e,t,n,r,i,a,o){var s=t.toLowerCase();return M()([function(e){return i?e.filter(function(e){var t=e.dev;return r.has(t)}):e},function(e){return null!==n&&"Default"!==n.name?e.filter(function(e){return e.groups.includes(n.id)}):e},Y()(function(e){var t=e.displayName,n=e.id;return"".concat(n,".").concat(t).toLowerCase().includes(s)}),Object(Ee.p)(a,o),qi(function(e,t){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ui(n,!0).forEach(function(t){Vi(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ui(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},e,{ref:Object(c.createRef)(),idx:t})})])(e)}),sa=Object(k.createStructuredSelector)({cams:ca,mode:Xi,pinned:Ji,pending:L()(["cameraList","pending"]),selectionMode:M()(L()(["topic",A.b.APP_MODE]),q()(b.a.ARCH_SEARCH)),appMode:L()(["topic",A.b.APP_MODE]),preselection:na,selection:ta,filter:Yi,favorites:ra,favoriteItems:ia,directionSort:aa,typeSort:oa}),ua=regeneratorRuntime.mark(va),la=regeneratorRuntime.mark(ya),pa=regeneratorRuntime.mark(ga),fa=regeneratorRuntime.mark(Oa),ha=regeneratorRuntime.mark(ja),da=regeneratorRuntime.mark(_a),ma=regeneratorRuntime.mark(Ea),ba=100;function va(e){var t,n,r;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return t=e.payload.searchTerms,i.next=3,Object(cr.f)(ke.h);case 3:return i.next=5,Object(cr.c)(br,t,ba);case 5:n=i.sent,i.prev=6;case 7:return i.next=10,Object(cr.n)(n);case 10:return r=i.sent,v.a.common("Fetched ".concat(r.length," cameras")),i.next=14,Object(cr.j)(Ri(r));case 14:i.next=7;break;case 16:return i.prev=16,i.next=19,Object(cr.e)();case 19:if(!i.sent){i.next=22;break}v.a.common("Request cancelled"),n.close();case 22:return v.a.common("Finished fetching cameras"),i.next=25,Object(cr.j)(Li());case 25:return i.finish(16);case 26:case"end":return i.stop()}},ua,null,[[6,,16,26]])}function ya(e){var t;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(cr.l)(Xi);case 2:if(t=n.sent,t!==Ae){n.next=6;break}return n.next=6,Object(cr.j)(Mi(Se));case 6:return n.next=8,Object(cr.k)({request:Object(cr.c)(va,e),cancel:Object(cr.k)([Object(cr.n)(Te),Object(cr.n)(he)])});case 8:case"end":return n.stop()}},la)}function ga(e){var t,n,r,i;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return t=e.payload,a.next=3,Object(cr.l)(sa);case 3:if(n=a.sent,r=n.mode,i=n.pinned,i||!(t.length>0)||r===Ae){a.next=9;break}return a.next=9,Object(cr.j)(Mi(Ae));case 9:case"end":return a.stop()}},pa)}function Oa(e){var t,n;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:t=e.payload.mode,r.t0=t,r.next=r.t0===Se?4:r.t0===xe?4:r.t0===Ae?11:12;break;case 4:return r.next=6,Object(cr.l)(Zi);case 6:if(n=r.sent,n.length){r.next=10;break}return r.next=10,Object(cr.j)(Di(Fe));case 10:case 11:case 12:return r.abrupt("break",13);case 13:case"end":return r.stop()}},fa)}var wa=L()("dev");function ja(){var e;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(cr.l)(Ki);case 2:if(e=t.sent,!e){t.next=6;break}return t.next=6,Object(cr.j)(Hi(e));case 6:case"end":return t.stop()}},ha)}function _a(e){var t,n;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return t=e.payload,r.next=3,Object(cr.l)(ea);case 3:if(n=r.sent,n.has(wa(t))){r.next=7;break}return r.next=7,Object(cr.j)($i([]));case 7:case"end":return r.stop()}},da)}function Ea(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(cr.o)(Ce,ya);case 2:return e.next=4,Object(cr.o)(Pe,Oa);case 4:return e.next=6,Object(cr.o)(ze,ja);case 6:return e.next=8,Object(cr.o)(Object(hr.a)(A.b.CAM_ARCH),_a);case 8:return e.next=10,Object(cr.p)(he,ya);case 10:return e.next=12,Object(cr.o)(Object(hr.a)(A.b.LAYOUT_CELLS),ga);case 12:case"end":return e.stop()}},ma)}function Aa(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Sa(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function xa(e,t){v.a.pref("Saving %s: %o",e,t),localStorage.setItem(e,JSON.stringify(t))}function ka(e){var t=localStorage.getItem(e);return JSON.parse(t)}function Pa(e,t){var n=ka(e),r=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Aa(n,!0).forEach(function(t){Sa(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Aa(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},n,{},t);xa(e,r)}var Ca=n(517),Ta=n.n(Ca),Ma=function(e,t){return e.includes(t)?Ta()(e,t):e.concat(t)},Da="preferences/SUBMIT";var Ia=regeneratorRuntime.mark(Ya),Ra=regeneratorRuntime.mark(Va),La=regeneratorRuntime.mark(Wa),Na=regeneratorRuntime.mark(qa),za=regeneratorRuntime.mark(Ga);function Fa(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function $a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Fa(n,!0).forEach(function(t){Ha(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Fa(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Ha(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ba(e){var t=ka(e),n=m.a.settings.prefsDefault,r=$a({},n,{},t);return v.a.pref("Reading %s: %o",e,t),r}function Ya(e){var t;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(t=e.defaultLayout,t!==fr.c){n.next=3;break}return n.abrupt("return");case 3:return v.a.pref("Restoring default layout",t),n.next=6,Object(cr.j)(Object(hr.e)(A.b.LAYOUT_SELECTED,{idx:t}));case 6:case"end":return n.stop()}},Ia)}function Ua(){if(window.login&&window.pass&&Object(dr.m)(window.login,window.pass),window.layout>=fr.c){var e=ka("preferences");xa("preferences",$a({},e,{defaultLayout:window.layout}))}}function Va(){var e;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=Ba(A.b.PREFS),v.a.pref("loaded",e),t.next=4,Object(cr.j)(Object(hr.e)(A.b.PREFS,e));case 4:return t.delegateYield(Ya(e),"t0",5);case 5:case"end":return t.stop()}},Ra)}function Wa(e){var t,n,r;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return t=e.payload,n=Ba(A.b.PREFS),r=$a({},n,{},t),xa(A.b.PREFS,r),v.a.pref("saved",t),i.next=7,Object(cr.j)(Object(hr.e)(A.b.PREFS,r));case 7:case"end":return i.stop()}},La)}function qa(e){var t,n,r;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return t=e.payload.cameraId,n=Ba(A.b.PREFS),r=Ma(n.favorites,t),i.next=5,Wa({payload:{favorites:r}});case 5:case"end":return i.stop()}},Na)}function Ga(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(cr.h)(Ua);case 2:return e.next=4,Object(cr.h)(Va);case 4:return e.next=6,Object(cr.o)(Da,Wa);case 6:return e.next=8,Object(cr.o)(ve,qa);case 8:case"end":return e.stop()}},za)}var Xa=n(227),Za=n.n(Xa),Ka=n(72),Qa=n.n(Ka),Ja=n(132),eo=n.n(Ja),to=n(102),no=n.n(to),ro=n(164),io=n.n(ro),ao=n(127),oo=n.n(ao),co=n(156),so=n.n(co),uo=n(518),lo=n.n(uo),po=n(519),fo=n.n(po),ho=n(394),mo=n.n(ho),bo=n(165),vo=n.n(bo),yo=n(71),go=n.n(yo),Oo=n(168),wo=n.n(Oo),jo=n(520),_o=n.n(jo),Eo=n(126),Ao=n.n(Eo);function So(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function xo(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ko(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,c=e[Symbol.iterator]();!(r=(o=c.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(i)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Po(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var Co=no()(function(e,t){return J.a.convert({cap:!1})(function(t,n,r){return Ke()(r%e,function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return[].concat(Po(e),[n])},t)},[],t)}),To=Jr()(new Date(0),["timestamp"]),Mo=function(e){return _o()(z()(V.a,Za()(e)))},Do=["queryType"],Io=function(e){return M()(L()(Do),Mo(Za()(e)))},Ro=Qa()([[Io("auto"),go()(Mo("Lpr"))],[Io("face"),go()(Mo("Face"))],[Io(["zone","line","transition","multiple","loitering"]),go()(Mo(["Scene","Motion"]))],[Io("heatmap"),go()(Mo(["Scene","Lpr","Face","Motion"]))],[Ao.a,go.a]]),Lo=function(e){return M()(L()("detectors"),wo()(M()([L()("type"),Ro(e)])),L()("accessPoint"))},No=function(e){return M()(z()(Lo(e)),vo.a)};var zo=z()(M()(L()("timestamp"),ke.m)),Fo=z()(function(e){var t=ko(e,2),n=t[0],r=t[1];return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?So(n,!0).forEach(function(t){xo(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):So(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},n,{image:r})});function $o(){return{type:ht}}function Ho(e){return{type:it,payload:e}}function Bo(e){return{type:at,payload:e}}function Yo(e){return{type:ot,payload:e}}function Uo(e){return{type:ct,payload:e}}function Vo(e){return{type:st,payload:e}}function Wo(e){return{type:ut,payload:e}}var qo=no()(function(e,t){return{type:wt,payload:{path:e,value:t}}});function Go(e){return{type:St,payload:e}}function Xo(e){return{type:Et,payload:e}}function Zo(e){return{type:jt,payload:e}}function Ko(e){return{type:pt,payload:e}}function Qo(e){return{type:yt,payload:e}}function Jo(e){return{type:lt,payload:e}}function ec(e){return{type:ft,payload:e}}function tc(e){return{type:gt,payload:e}}function nc(){return{type:dt}}function rc(){return{type:vt}}function ic(){return{type:mt}}function ac(){return{type:bt}}function oc(e){return{type:Ot,payload:e}}function cc(e){return{type:At,payload:e}}function sc(e){return{type:xt,payload:e}}function uc(e){return{type:_t,payload:e}}var lc=n(521),pc=n.n(lc),fc=n(68),hc=n.n(fc),dc=L()(["topic",A.b.ARCH_BOUNDS]),mc=L()(["topic",A.b.ARCH_TIME]),bc=L()(["topic",A.b.CAM_ARCH]),vc=(L()(["topic",A.b.PREFS]),L()(["topic",A.b.CAM_ARCH,"archive"])),yc=L()(["search","history"]),gc=L()(["search","sort"]),Oc=L()(["search","forms"]),wc=L()(["search","query"]),jc=L()(["search","idx"]),_c=function(e){return Object(k.createSelector)(wc,function(t){return Dt()(function(e){return L()(e,t)},e)})},Ec=L()(["search","cameras"]),Ac=L()(["cameraList","selection"]);var Sc=Object(k.createSelector)(yc,gc,jc,function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"timestamp",n=arguments.length>2?arguments[2]:void 0,r=Xe()([n,"results","values"],e)||Array.prototype.values(),i=Array.from(r);return hc()(t,i)}),xc=Object(k.createSelector)(Sc,mc,function(e,t){var n=pc()(function(e){var n=e.timestamp;return Math.abs(n-t)},e),r=e.indexOf(n);return{item:n,idx:r}}),kc=Object(k.createStructuredSelector)({columns:L()(["search","columns"]),pending:L()(["search","pending"]),opacity:L()(["search","opacity"]),query:wc,searchCount:M()(yc,f.a),searchIdx:jc,results:Sc,firstSearch:M()(yc,f.a,q()(0)),sort:gc,selected:xc}),Pc=Object(k.createStructuredSelector)({forms:Oc});function Cc(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Tc(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Mc(e){var t=e.interval,n=Date.parse(t)?new Date(t):void 0;return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Cc(n,!0).forEach(function(t){Tc(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Cc(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},e,{interval:n})}var Dc=n(33),Ic=n.n(Dc),Rc=n(128),Lc=n.n(Rc),Nc=n(111),zc=n.n(Nc),Fc=n(138),$c=n(37),Hc=200,Bc=500,Yc=(n(428),regeneratorRuntime.mark(Xc)),Uc=regeneratorRuntime.mark(Zc),Vc=regeneratorRuntime.mark(Kc),Wc=regeneratorRuntime.mark(Qc),qc=regeneratorRuntime.mark(Jc),Gc=io()(Lc()(["timestamp","getTime"]));function Xc(e){var t,n,r,i,a=arguments;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:t=a.length>1&&void 0!==a[1]?a[1]:ke.i,o.prev=1;case 2:return o.next=5,Object(cr.c)(yi.A,{location:e});case 5:n=o.sent,r=n.data,i=n.status,o.t0=i,o.next=o.t0===Hc?10:o.t0===Bc?13:(o.t0,14);break;case 10:return o.next=12,Object(cr.j)(Ko(r));case 12:case 13:return o.abrupt("return");case 14:return o.next=16,Object(cr.j)(Ko(r));case 16:return o.abrupt("break",17);case 17:Object(cr.f)(t),o.next=2;break;case 20:o.next=25;break;case 22:o.prev=22,o.t1=o.catch(1),v.a.search("poll failed");case 25:return o.prev=25,o.next=28,Object(cr.e)();case 28:if(!o.sent){o.next=30;break}yi.T({location:e});case 30:return o.next=32,Object(cr.j)(Ko(H.a));case 32:return o.finish(25);case 33:case"end":return o.stop()}},Yc,null,[[1,22,25,33]])}function Zc(e){var t,n,r,i,a,o,c,s,u;return regeneratorRuntime.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return t=e.results,n=e.archive,r=e.endpoint,i=e.wantAccurate,a=zo(t),o={close:Ic.a},l.prev=3,o=Object(H.d)(function(e){return Object(Fc.b)({archive:n,endpoint:r,keyFrames:!i,timestampList:a},e)},H.b.expanding(3)),l.next=7,Object(cr.g)(o);case 7:c=l.sent;case 8:if(c===H.a){l.next=21;break}if(s=t.splice(0,c.length),u=Fo(zc()(s,Object(Bn.h)(c))),!(u.length>0)){l.next=14;break}return l.next=14,Object(cr.j)(Jo(u));case 14:return l.next=16,Object(cr.f)(ke.h);case 16:return l.next=18,Object(cr.g)(o);case 18:c=l.sent,l.next=8;break;case 21:return l.prev=21,o.close(),l.finish(21);case 24:case"end":return l.stop()}},Uc,null,[[3,,21,24]])}function Kc(){var e,t,n,r,i,a,o,c,s,u,l,p,f,h,d,m,b,y=arguments;return regeneratorRuntime.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return e=!(y.length>0&&void 0!==y[0])||y[0],g.next=3,Object(cr.a)(yt,H.b.expanding());case 3:return t=g.sent,n=[],g.prev=5,g.next=8,Object(cr.n)(t);case 8:r=g.sent,i=r.payload;case 10:if(i===H.a){g.next=51;break}o=L()([0,"camera"],i),c=o.archSelectedStorage,s=o.archSelectedAccessPoint,O=i.length,u=window.fetchWorkers?window.fetchWorkers:O<50?1:O<200?2:4,v.a.search("fetch","starting ".concat(u," workers")),l=!0,p=!1,f=void 0,g.prev=17,h=Co(u,i)[Symbol.iterator]();case 19:if(l=(d=h.next()).done){g.next=28;break}return m=d.value,g.next=23,Object(cr.h)(Zc,{archive:c,endpoint:s,results:m,wantAccurate:e});case 23:b=g.sent,n.push(b);case 25:l=!0,g.next=19;break;case 28:g.next=34;break;case 30:g.prev=30,g.t0=g.catch(17),p=!0,f=g.t0;case 34:g.prev=34,g.prev=35,l||null==h.return||h.return();case 37:if(g.prev=37,!p){g.next=40;break}throw f;case 40:return g.finish(37);case 41:return g.finish(34);case 42:return g.next=44,Object(cr.i)(n);case 44:return g.next=46,Object(cr.n)(t);case 46:a=g.sent,i=a.payload,g.next=10;break;case 51:return g.prev=51,g.next=54,Object(cr.j)(ic());case 54:return g.next=56,Object(cr.d)(n);case 56:return t.close(),g.finish(51);case 58:case"end":return g.stop()}var O},Vc,null,[[5,,51,58],[17,30,34,42],[35,,37,41]])}function Qc(e){var t,n,r;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,Object(cr.k)({done:Object(cr.n)(mt),abort:Object(cr.n)(dt)});case 2:if(t=i.sent,n=t.abort,!n){i.next=13;break}r=0;case 6:if(!(r<e.length)){i.next=13;break}return i.next=9,Object(cr.d)(e[r]);case 9:v.a.search("cancelled",e[r]);case 10:r+=1,i.next=6;break;case 13:case"end":return i.stop()}},Wc)}function Jc(e,t,n){var r,i,a,o,c,s,u,l,p,f,h,d;return regeneratorRuntime.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,Object(cr.l)(vc);case 2:return r=m.sent,m.next=5,Object(cr.h)(Xc,Object(dr.h)(e));case 5:return i=m.sent,m.next=8,Object(cr.h)(Kc);case 8:return a=m.sent,m.next=11,Object(cr.a)(pt);case 11:return o=m.sent,c=[],m.next=15,Object(cr.h)(Qc,[i,a]);case 15:if(!i.isRunning()){m.next=36;break}return m.next=18,Object(cr.k)({raw:Object(cr.n)(o),abort:Object(cr.n)(dt)});case 18:if(s=m.sent,u=s.raw.payload,l=s.abort,!l&&u!==H.a){m.next=23;break}return m.abrupt("break",36);case 23:if(p=z()(n,t(u)),f=Y()(M()(To,Object($c.d)(r))),h=f(Gc(p,c)),d=h.length,c=p,!(d>0)){m.next=34;break}return v.a.search("results","received ".concat(d)),m.next=32,Object(cr.j)(Qo(h));case 32:return m.next=34,Object(cr.j)(Jo(h));case 34:m.next=15;break;case 36:return m.next=38,Object(cr.j)(Qo(H.a));case 38:case"end":return m.stop()}},qc)}var es=n(158),ts=n.n(es),ns=regeneratorRuntime.mark(us);function rs(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function is(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?rs(n,!0).forEach(function(t){as(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):rs(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function as(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function os(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var cs=Jr()([],["events"]);function ss(e){var t=ts()("origin",e);return function(e){var n=e.timestamp,r=e.origin,i=e.plates,a=e.position;return{camera:L()(r,t),plates:i,positions:[a],timestamp:Object(ke.l)(n)}}}function us(e,t){var n,r,i,a,o,c,s,u,l,p;return regeneratorRuntime.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return n=t.payload,f.prev=1,f.next=4,Object(cr.l)(dc);case 4:return r=f.sent,i=r.begin,a=r.end,f.next=9,Object(cr.l)(Ec);case 9:return o=f.sent,c=No(n)(o),s=n.queryType,u=os(n,["queryType"]),f.next=14,Object(cr.c)(yi.E,{begintime:i,endtime:a,query:is({},u,{sources:c}),type:s});case 14:return l=f.sent,p=l.jqXhr,f.delegateYield(e(p,cs,ss(o)),"t0",17);case 17:f.next=24;break;case 19:return f.prev=19,f.t1=f.catch(1),v.a.search("auto failed","\n",f.t1),f.next=24,Object(cr.j)(nc());case 24:case"end":return f.stop()}},ns,null,[[1,19]])}n(618);var ls=regeneratorRuntime.mark(vs);function ps(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function fs(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ps(n,!0).forEach(function(t){hs(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ps(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function hs(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ds(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var ms=Jr()([],["events"]);function bs(e){var t=ts()("origin",e);return function(e){var n=e.accuracy,r=e.origin,i=e.position,a=e.timestamp;return{camera:L()(r,t),timestamp:Object(ke.l)(a),positions:[i],accuracy:n}}}function vs(e,t){var n,r,i,a,o,c,s,u,l,p,f;return regeneratorRuntime.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return n=t.payload,h.next=3,Object(cr.l)(dc);case 3:return r=h.sent,i=r.begin,a=r.end,h.next=8,Object(cr.l)(Ec);case 8:return o=h.sent,c=No(n)(o),s=n.image,u=n.queryType,l=ds(n,["image","queryType"]),h.prev=11,h.next=14,Object(cr.c)(yi.D,{begintime:i,endtime:a,type:u,query:fs({image:s.split(",")[1],sources:c},l)});case 14:return p=h.sent,f=p.jqXhr,h.delegateYield(e(f,ms,bs(o)),"t0",17);case 17:h.next=24;break;case 19:return h.prev=19,h.t1=h.catch(11),v.a.search("face failed","\n",h.t1),h.next=24,Object(cr.j)(nc());case 24:case"end":return h.stop()}},ls,null,[[11,19]])}var ys=n(103),gs=n.n(ys),Os=n(139),ws=n.n(Os),js=n(137);function _s(e,t){return xs(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,c=e[Symbol.iterator]();!(r=(o=c.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(i)throw a}}return n}(e,t)||As()}function Es(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||Ss(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function As(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function Ss(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function xs(e){if(Array.isArray(e))return e}function ks(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ps=function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),ks(this,"mapFragmentedToContinuous",function(e){var t,n=(t=e,xs(t)||Ss(t)||As()),r=n[0],i=n.slice(1);return i.reduce(function(e,t){var n=tt()(Tt()(e)),r=t.time.begin-(n.time.end+1),i=new js.a(new Date(t.time.begin-r),new Date(t.time.end-r));return[].concat(Es(e),[[i,t]])},[[r,r]])}),ks(this,"getRealTS",function(e){var t=n.map.find(function(t){var n=_s(t,1),r=n[0];return r.inner(e)}),r=_s(t,2),i=r[0],a=r[1];return new Date(e.getTime()-i.time.begin+a.time.begin)}),this.map=this.mapFragmentedToContinuous(t)},Cs=(n(619),regeneratorRuntime.mark(Is)),Ts=regeneratorRuntime.mark(Ls),Ms=regeneratorRuntime.mark(Ns);function Ds(e,t,n){for(var r,i=Object($c.a)(n),a=new Ps(n),o=[i];o.length<=t;){var c=Tt()(o),s=(r=c,new Date(r.getTime()+e));o.push(s)}return o.map(a.getRealTS)}function Is(e){var t,n,r,i,a,o,c,s,u,l,p,f,h;return regeneratorRuntime.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return t=e.bounds,n=t.begin,r=t.end,i=e.camera,a=e.columns,o=e.interval,d.next=3,Object(cr.c)([i,i.initArchive]);case 3:return d.next=5,i.getIntervals({begintime:n,endtime:r});case 5:if(c=d.sent,c.length){d.next=11;break}return v.a.search("no archive"),d.next=10,Object(cr.j)(nc());case 10:return d.abrupt("return");case 11:return s=qe()(n,r),u=c.filter(function(e){var t=e.time,i=t.begin,a=t.end;return a>n&&i<r}).map(function(e){var t=e.time,n=t.begin,r=t.end;return new js.a(new Date(s(n)),new Date(s(r)))}),l=u.map(function(e){var t=e.time,n=t.begin,r=t.end;return r-n}).reduce(function(e,t){return e+t},0),p=o?Math.floor(l/o):Math.pow(a,2)-1,f=Xe()("getTime",o)||Math.floor(l/p),h=M()(z()(function(e){return{timestamp:e}}),z()(te()(["camera"],i)))(Ds(f,p,u)),d.next=19,Object(cr.j)(Jo(h));case 19:return d.next=21,Object(cr.j)(Qo(h));case 21:case"end":return d.stop()}},Cs)}var Rs=!1;function Ls(e,t){var n,r,i,a,o,c,s,u,l,p,f,h,d;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.payload.interval,e.next=3,Object(cr.l)(kc);case 3:return r=e.sent,i=r.columns,e.next=7,Object(cr.l)(dc);case 7:return a=e.sent,e.next=10,Object(cr.l)(Ec);case 10:return o=e.sent,e.next=13,Object(cr.h)(Kc,Rs);case 13:c=e.sent,s=[],u=!0,l=!1,p=void 0,e.prev=18,f=o[Symbol.iterator]();case 20:if(u=(h=f.next()).done){e.next=30;break}return d=h.value,e.t0=s,e.next=25,Object(cr.h)(Is,{bounds:a,camera:d,columns:i,interval:n});case 25:e.t1=e.sent,e.t0.push.call(e.t0,e.t1);case 27:u=!0,e.next=20;break;case 30:e.next=36;break;case 32:e.prev=32,e.t2=e.catch(18),l=!0,p=e.t2;case 36:e.prev=36,e.prev=37,u||null==f.return||f.return();case 39:if(e.prev=39,!l){e.next=42;break}throw p;case 42:return e.finish(39);case 43:return e.finish(36);case 44:return e.next=46,Object(cr.h)(Qc,[c].concat(s));case 46:return e.next=48,Object(cr.i)(s);case 48:return e.next=50,Object(cr.j)(Qo(H.a));case 50:case"end":return e.stop()}},Ts,null,[[18,32,36,44],[37,,39,43]])}function Ns(e){var t,n,r,i,a,o,c,s;return regeneratorRuntime.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return t=e.payload,u.next=3,Object(cr.l)(Sc);case 3:return n=u.sent,r=M()(gs()(q()(t)),qe()(0,n.length-2))(n),i=qe()(0,n.length-1)(r+1),a=ws()(r,n),o=a.timestamp,c=ws()(i,n),s=c.timestamp,u.next=10,Object(cr.j)(Object(hr.e)(A.b.MOVE_SCALE,{begin:o,end:s}));case 10:return u.next=12,Object(cr.j)($o());case 12:case"end":return u.stop()}},Ms)}var zs=n(56),Fs=n.n(zs),$s=(n(620),regeneratorRuntime.mark(Vs)),Hs="HeatMapBuilder.0/HeatMapBuilder",Bs={width:320,height:240},Ys=Fs()("EventSupplier","SourceEndpoint.vmda"),Us=no()(function(e,t,n){var r=n.image_data;return{camera:t,heatmapImage:URL.createObjectURL(Object(Bn.c)(r)),timestamp:e}});function Vs(e,t){var n,r,i,a,o,c,s,u,l,p,f,h;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.payload,e.next=3,Object(cr.l)(dc);case 3:return r=e.sent,i=r.begin,a=r.end,e.next=8,Object(cr.l)(bc);case 8:return o=e.sent,c=Lo(n)(o),s=Object(Ee.h)(c),e.prev=11,e.next=14,Object(cr.c)(yi.q,{accessPoint:"hosts/".concat(s,"/").concat(Hs),origin:Ys(c),begintime:i,endtime:a,maskSize:Bs});case 14:return u=e.sent,l=u.data,e.next=18,Object(cr.l)(mc);case 18:return p=e.sent,e.next=21,Object(cr.h)(Kc);case 21:return f=e.sent,h=[Us(p,o,l)],e.next=25,Object(cr.h)(Qc,[f]);case 25:return e.next=27,Object(cr.j)(Jo(h));case 27:return e.next=29,Object(cr.j)(Qo(h));case 29:return e.next=31,Object(cr.j)(Qo(H.a));case 31:e.next=38;break;case 33:return e.prev=33,e.t0=e.catch(11),v.a.search("heatmap failed","\n",e.t0),e.next=38,Object(cr.j)(nc());case 38:case"end":return e.stop()}},$s,null,[[11,33]])}n(621);var Ws=regeneratorRuntime.mark(nu);function qs(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Gs(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?qs(n,!0).forEach(function(t){Xs(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qs(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Xs(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Zs=Ke()(["figures"],z()(function(e){return{shape:e}})),Ks=Ke()(["sources"],z()(Fs()("EventSupplier","SourceEndpoint.vmda"))),Qs=Ke()(["queryType"],function(e){return["loitering","multiple"].includes(e)?"zone":e}),Js=M()(Zs,Ks,Qs),eu=Jr()([],["intervals"]);function tu(e){return function(t){var n=t.startTime,r=t.endTime,i=t.positions;return{camera:e,endTime:Object(ke.l)(r),positions:i,timestamp:Object(ke.l)(n)}}}function nu(e,t){var n,r,i,a,o,c,s,u;return regeneratorRuntime.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return n=t.payload,l.next=3,Object(cr.l)(dc);case 3:return r=l.sent,i=r.begin,a=r.end,l.next=8,Object(cr.l)(bc);case 8:return o=l.sent,c=Lo(n)(o),l.prev=10,l.next=13,Object(cr.c)(yi.E,{begintime:i,endtime:a,query:Js(Gs({},n,{sources:[c]})),type:"vmda"});case 13:return s=l.sent,u=s.jqXhr,l.delegateYield(e(u,eu,tu(o)),"t0",16);case 16:l.next=23;break;case 18:return l.prev=18,l.t1=l.catch(10),v.a.search("vmda failed","\n",l.t1),l.next=23,Object(cr.j)(nc());case 23:case"end":return l.stop()}},Ws,null,[[10,18]])}var ru=n(163),iu=n.n(ru),au=n(522),ou=n.n(au),cu=regeneratorRuntime.mark(lu),su=regeneratorRuntime.mark(fu);function uu(e){var t=e.timestamp,n=e.positions;return{timestamp:Object(ke.l)(t),positions:n}}function lu(e){var t,n,r,i,a,o,c,s,u;return regeneratorRuntime.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return t=e.bounds,n=t.begin,r=t.end,i=e.camera,a=e.eventInitiator,l.next=3,Object(cr.c)([i,i.initArchive]);case 3:return l.next=5,i.getIntervals({begintime:n,endtime:r});case 5:return o=l.sent,l.next=8,i.getDetectors({begintime:n,endtime:r});case 8:if(c=l.sent,s="all"===a?Ao.a:q()(a),u=M()(Y()(eo()({accessPoint:s,begin:ou()([iu()(n.getTime(),r.getTime()),Object($c.d)(o)])})),z()(uu),z()(te()(["camera"],i)))(c),!(u.length>0)){l.next=16;break}return l.next=14,Object(cr.j)(Jo(u));case 14:return l.next=16,Object(cr.j)(Qo(u));case 16:case"end":return l.stop()}},cu)}var pu=!1;function fu(e){var t,n,r,i,a,o,c,s,u,l,p;return regeneratorRuntime.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return t=e.payload.eventInitiator,f.next=3,Object(cr.l)(dc);case 3:return n=f.sent,f.next=6,Object(cr.l)(Ec);case 6:return r=f.sent,f.next=9,Object(cr.h)(Kc,pu);case 9:i=f.sent,a=[],o=!0,c=!1,s=void 0,f.prev=14,u=r[Symbol.iterator]();case 16:if(o=(l=u.next()).done){f.next=26;break}return p=l.value,f.t0=a,f.next=21,Object(cr.h)(lu,{bounds:n,camera:p,eventInitiator:t});case 21:f.t1=f.sent,f.t0.push.call(f.t0,f.t1);case 23:o=!0,f.next=16;break;case 26:f.next=32;break;case 28:f.prev=28,f.t2=f.catch(14),c=!0,s=f.t2;case 32:f.prev=32,f.prev=33,o||null==u.return||u.return();case 35:if(f.prev=35,!c){f.next=38;break}throw s;case 38:return f.finish(35);case 39:return f.finish(32);case 40:return f.next=42,Object(cr.h)(Qc,[i].concat(a));case 42:return f.next=44,Object(cr.i)(a);case 44:return f.next=46,Object(cr.j)(Qo(H.a));case 46:case"end":return f.stop()}},su,null,[[14,28,32,40],[33,,35,39]])}function hu(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,c=e[Symbol.iterator]();!(r=(o=c.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(i)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var du=regeneratorRuntime.mark(Au),mu=regeneratorRuntime.mark(ku),bu=regeneratorRuntime.mark(Cu),vu=regeneratorRuntime.mark(Tu),yu=regeneratorRuntime.mark(Mu),gu=regeneratorRuntime.mark($u),Ou=regeneratorRuntime.mark(Hu),wu=regeneratorRuntime.mark(Bu),ju=regeneratorRuntime.mark(Yu),_u=regeneratorRuntime.mark(Wu),Eu=regeneratorRuntime.mark(qu);function Au(){var e;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(cr.l)(Sc);case 2:e=t.sent,Object(hr.e)(A.b.SEARCH_RESULTS,e);case 4:case"end":return t.stop()}},du)}var Su=io()(L()(["dev"])),xu=L()("channel");function ku(e,t){var n;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Object(cr.l)(bc);case 2:n=r.sent,Pa(kt,(i={},a=n.channel,o={query:e,forms:t},a in i?Object.defineProperty(i,a,{value:o,enumerable:!0,configurable:!0,writable:!0}):i[a]=o,i));case 4:case"end":return r.stop()}var i,a,o},mu)}var Pu=_e()([wc,Oc]);function Cu(){var e,t,n,r,i;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Object(cr.l)(Pu);case 2:if(e=a.sent,t=hu(e,2),n=t[0],r=t[1],i=Qa()([[Io("auto"),Ho],[Io("face"),Bo],[Io("fragments"),Yo],[Io("heatmap"),Uo],[Io(["zone","line","transition","multiple","loitering"]),Vo],[Io("events"),Wo]])(n),i){a.next=10;break}return v.a.search("no search type"),a.abrupt("return");case 10:return a.next=12,Object(cr.j)(i);case 12:return a.delegateYield(ku(n,r),"t0",13);case 13:case"end":return a.stop()}},bu)}function Tu(e){var t,n,r;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(t=e.payload,n=t.path,r=t.value,!n.includes("queryType")){i.next=4;break}return i.next=4,Object(cr.j)(Go({queryType:r}));case 4:case"end":return i.stop()}},vu)}function Mu(){var e,t;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(cr.l)(Sc);case 2:if(e=n.sent,t=tt()(e),t){n.next=6;break}return n.abrupt("return");case 6:return n.next=8,Object(cr.j)(Object(hr.e)(A.b.ARCH_TIME,t.timestamp));case 8:case"end":return n.stop()}},yu)}var Du=L()("dev"),Iu=no()(function(e,t){return e.reduce(function(e,t){return e.concat(t instanceof h.a?t:new h.a(t))},t)}),Ru=mo()(Du),Lu=Y()(Du),Nu=no()(function(e,t){return fo()(Du,Lu(e),Lu(t))}),zu=_e()([Ac,Ec,bc]),Fu=M()(lo()(mo()(Du)),f.a,q()(0));function $u(){var e,t,n,r,i,a,o,c,s;return regeneratorRuntime.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,Object(cr.k)([Object(cr.f)(ke.h),Object(cr.n)(ht)]);case 2:return u.next=4,Object(cr.l)(zu);case 4:if(e=u.sent,t=hu(e,3),n=t[0],r=t[1],i=t[2],a=Array.from(n.values()),o=Su(a,r),c=Su(r,a),s=M()(Iu(o),Ru(c),Nu(Za()(i)))(r),v.a.search("cameras selected %d",f()(s)),Fu([r,s])){u.next=17;break}return u.next=17,Object(cr.j)(sc(s));case 17:case"end":return u.stop()}},gu)}function Hu(){var e,t,n,r,i;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.delegateYield(vr(A.b.CAM_ARCH),"t0",1);case 1:if(e=a.t0,t=ka(kt),n=xu(e),!oo()(n,t)){a.next=13;break}return r=Mc(L()([n,"query"],t)),i=L()([n,"forms"],t),a.next=9,Object(cr.j)(Go(r));case 9:return a.next=11,Object(cr.j)(Xo(i));case 11:return a.next=13,Object(cr.j)(sc([e]));case 13:case"end":return a.stop()}},Ou)}function Bu(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(cr.j)(ac());case 2:case"end":return e.stop()}},wu)}function Yu(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(cr.h)(Hu);case 2:return e.next=4,Object(cr.p)([ze,Object(hr.a)(A.b.CAM_ARCH)],$u);case 4:return e.next=6,Object(cr.o)(ht,Cu);case 6:return e.next=8,Object(cr.o)(it,us,Jc);case 8:return e.next=10,Object(cr.o)(at,vs,Jc);case 10:return e.next=12,Object(cr.o)(ot,Ls,Jc);case 12:return e.next=14,Object(cr.o)(At,Ns);case 14:return e.next=16,Object(cr.o)(ct,Vs,Jc);case 16:return e.next=18,Object(cr.o)(st,nu,Jc);case 18:return e.next=20,Object(cr.o)(ut,fu);case 20:return e.next=22,Object(cr.o)([mt,dt],Au);case 22:return e.next=24,Object(cr.o)(wt,Tu);case 24:return e.next=26,Object(cr.o)(ft,Mu);case 26:return e.next=28,Object(cr.o)(xt,Bu);case 28:case"end":return e.stop()}},ju)}var Uu=Object(dr.d)(pr()({type:Object(hr.a)(A.b.APP_MODE),payload:b.a.ARCH_SEARCH})),Vu=Object(dr.d)(eo()({type:q()(Object(hr.a)(A.b.APP_MODE)),payload:so()(q()(b.a.ARCH_SEARCH))}));function Wu(){var e;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return v.a.search("starting"),t.next=3,Object(cr.h)(Yu);case 3:return e=t.sent,t.prev=4,t.next=7,Object(cr.n)(Vu);case 7:return t.next=9,Object(cr.j)(ac());case 9:return t.prev=9,t.next=12,Object(cr.d)(e);case 12:return v.a.search("stopping"),t.finish(9);case 14:case"end":return t.stop()}},_u,null,[[4,,9,14]])}function qu(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(cr.p)(Uu,Wu);case 2:case"end":return e.stop()}},Eu)}var Gu=n(228),Xu=n.n(Gu),Zu=n(259),Ku=n.n(Zu),Qu=n(195),Ju=n.n(Qu),el=n(43),tl=n(229),nl=n.n(tl);n(821);function rl(e){return e.protocol=e.protocol.replace("http","ws"),e.toString()}function il(e){var t,n,r=new URL(location),i=r.searchParams,a=i.get("authToken");return r.pathname="".concat(r.pathname.replace(/(\/)[^/]*$/,""),"/").concat(e),function(){return n&&n>Date.now()?Promise.resolve(t):a?(i.set("authToken",a),Promise.resolve(rl(r))):/^(?!.*chrome).*safari/i.test(navigator.userAgent)?(i.set("enable_token_auth","1"),i.set("valid_token_hours","24"),function(e){return new Promise(function(t,n){var r=new XMLHttpRequest;r.open("GET",e.href,!0),r.onload=function(){200!==r.status?n(new Error(r.statusText)):t(r.responseText)},r.onerror=function(){n(new Error(r.statusText))},r.send()})}(r).then(JSON.parse).then(function(a){return r.search=a.path.replace("/".concat(e),""),r.protocol=r.protocol.replace("http","ws"),t=r.toString(),n=Object(ke.l)(i.get("exp")).getTime(),t})):Promise.resolve(rl(r))}}var al=3*ke.h,ol=4e3;function cl(){var e,t,n,r,i,a,o,c,s,u;return regeneratorRuntime.async(function(l){for(;;)switch(l.prev=l.next){case 0:return c=function(){var e,s,u,l,p;return regeneratorRuntime.async(function(f){for(;;)switch(f.prev=f.next){case 0:return p=function(e){t.removeEventListener("open",l),t.removeEventListener("message",o),t.removeEventListener("close",p),t.removeEventListener("error",p),window.removeEventListener("unload",u),t=null,e.code!==ol&&setTimeout(c,al),r.fn=i},l=function(){t.addEventListener("message",o),n.length&&t.send(JSON.stringify({include:n,exclude:[]})),r.fn=a},u=function(){t.close(ol)},e=il("events"),f.next=6,regeneratorRuntime.awrap(e());case 6:s=f.sent;try{t=new WebSocket(s)}catch(e){setTimeout(c,al)}t.addEventListener("open",l),t.addEventListener("close",p),t.addEventListener("error",p),window.addEventListener("unload",u);case 12:case"end":return f.stop()}})},o=function(t){e(t)},a=function(e){var r=nl()(n,e),i=nl()(e,n),a=r.length||i.length;a&&t.send(JSON.stringify({include:i,exclude:r})),n=e},i=function(e){n=e},e=Ic.a,t=null,n=[],r={fn:Ic.a},r.fn=i,s=function(){return t&&t.close(ol)},u=Object(H.d)(function(t){return e=function(e){var n=L()("objects",JSON.parse(e.data));t(n)},function(){e=Ic.a,t(H.a),s()}}),c(),l.abrupt("return",{channel:u,watch:r,close:s});case 13:case"end":return l.stop()}})}function sl(){return{type:ne}}function ul(){return{type:ie}}function ll(e){return{type:re,payload:e}}function pl(e){return{type:ae,payload:e}}function fl(e){return{type:oe,payload:e}}var hl=n(70),dl=n.n(hl),ml=M()([L()(["topic"]),dl()([A.b.CAM_STATES])]),bl=regeneratorRuntime.mark(Ml),vl=regeneratorRuntime.mark(Dl),yl=regeneratorRuntime.mark(Il),gl=regeneratorRuntime.mark(Ll),Ol=regeneratorRuntime.mark(Nl),wl=regeneratorRuntime.mark(zl),jl=regeneratorRuntime.mark(Fl),_l=regeneratorRuntime.mark(Hl),El=regeneratorRuntime.mark(Bl);function Al(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Sl(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Al(n,!0).forEach(function(t){xl(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Al(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function xl(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function kl(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,c=e[Symbol.iterator]();!(r=(o=c.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(i)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var Pl=new Set(["connected","signal restored"]),Cl={DEVICE_STATE_CHANGED:"devicestatechanged",ALERT:"alert",ALERT_STATE:"alert_state"},Tl=Ku()(L()("type"));function Ml(e){var t,n,r,i,a,o,c,s,u,l,p;return regeneratorRuntime.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return t=e.archive,n=e.phase,r=e.source,i=e.states,a=e.timestamp,o=tt()(i),f.next=4,Object(cr.b)({wsPkt:Object(cr.c)(Fc.c,{endpoint:r,archive:t,beginTime:a,format:el.a.JPEG,width:m.a.settings.alertFrameWidth}),camList:Object(cr.c)(Ee.c,r)});case 4:return c=f.sent,s=c.wsPkt.payload,u=kl(c.camList,1),l=u[0],p=new Blob([s],{type:"image/jpeg"}),f.next=11,Object(cr.j)(pl([Sl({},o,{archive:t,camera:l,imgBlob:p,phase:n,source:r,timestamp:Object(ke.l)(a)})]));case 11:case"end":return f.stop()}},bl)}function Dl(e){var t,n,r;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,Object(cr.l)(ml);case 2:return t=i.sent,n=t.camStates,r=J()(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.name,r=t.state;return Sl({},e,xl({},n,Pl.has(r)))},n,e),v.a.events("Received %d camera state updates",e.length),i.next=8,Object(cr.j)(Object(hr.e)(A.b.CAM_STATES,r));case 8:case"end":return i.stop()}},vl)}function Il(e){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(cr.j)(fl(e));case 2:case"end":return t.stop()}},yl)}var Rl=Ku()(M()([L()(["phase"]),q()("started"),Qa()([[Ao.a,go()("started")],[Ju.a,go()("rest")]])]));function Ll(e){var t,n,r,i,a;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:t=Rl(e),n=t.started,r=t.rest,i=Xu()(L()("states"),r),a=0;case 3:if(!(a<n.length)){o.next=9;break}return o.next=6,Object(cr.h)(Ml,n[a]);case 6:a+=1,o.next=3;break;case 9:if(!(i.length>0)){o.next=11;break}return o.delegateYield(Il(i),"t0",11);case 11:case"end":return o.stop()}},gl)}function Nl(e){var t,n,r,i,a;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=3,Object(cr.n)(e);case 3:if(t=o.sent,n=Tl(t),r=n[Cl.DEVICE_STATE_CHANGED],i=n[Cl.ALERT],a=n[Cl.ALERT_STATE],!r){o.next=8;break}return o.next=8,Object(cr.h)(Dl,r);case 8:if(!i){o.next=11;break}return o.next=11,Object(cr.h)(Ll,i);case 11:if(!a){o.next=14;break}return o.next=14,Object(cr.h)(Il,a);case 14:o.next=0;break;case 16:case"end":return o.stop()}},Ol)}function zl(e,t){var n;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(n=t.payload,!n.length){r.next=4;break}return r.next=4,Object(cr.f)(ke.h);case 4:return r.next=6,Object(cr.c)(e.fn,n);case 6:case"end":return r.stop()}},wl)}function Fl(){var e,t,n;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Object(cr.c)(cl);case 2:return e=r.sent,t=e.channel,n=e.watch,r.next=7,Object(cr.j)(sl());case 7:return v.a.events("channel opened"),r.next=10,Object(cr.h)(Nl,t);case 10:return r.next=12,Object(cr.p)(re,zl,n);case 12:case"end":return r.stop()}},jl)}var $l=z()(L()("origin"));function Hl(e){var t,n;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return t=e.payload,n=$l(t),r.next=4,Object(cr.j)(ll(n));case 4:case"end":return r.stop()}},_l)}function Bl(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(cr.h)(Fl);case 2:return e.next=4,Object(cr.o)(Object(hr.a)(A.b.LAYOUT_CELLS),Hl);case 4:case"end":return e.stop()}},El)}var Yl=regeneratorRuntime.mark(ql),Ul=regeneratorRuntime.mark(Gl),Vl=regeneratorRuntime.mark(Xl),Wl=regeneratorRuntime.mark(Zl);function ql(){var e,t,n;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,Object(cr.c)(yi.w);case 3:return e=r.sent,t=e.data.items,n=t.map(function(e){var t=e.data,n=e.meta,r=t.position,i=t.zoom,a=t.image_meta,o=n.id,c=n.name,s=n.type;return{imageSize:a?a.size:{},position:r,zoom:i,id:o,name:c,type:s,cameraMarkers:[],mapImage:""}}),r.next=8,Object(cr.j)(Zn(n));case 8:r.next=15;break;case 10:return r.prev=10,r.t0=r.catch(0),v.a.maps("Maps fetch failed",r.t0),r.next=15,Object(cr.j)(Zn([]));case 15:case"end":return r.stop()}},Yl,null,[[0,10]])}function Gl(e){var t,n,r;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return t=e.mapId,i.next=3,Object(cr.c)(yi.u,{mapId:t});case 3:return n=i.sent,r=n.data.image,i.next=7,Object(cr.j)(Kn({mapId:t,image:r}));case 7:case"end":return i.stop()}},Ul)}function Xl(e){var t,n,r;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return t=e.mapId,i.next=3,Object(cr.c)(yi.v,{mapId:t});case 3:return n=i.sent,r=n.data.markers,i.next=7,Object(cr.j)(er({mapId:t,markers:r}));case 7:case"end":return i.stop()}},Vl)}function Zl(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(cr.p)(Yn,ql);case 2:return e.next=4,Object(cr.p)(Vn,Gl);case 4:return e.next=6,Object(cr.p)(qn,Xl);case 6:case"end":return e.stop()}},Wl)}var Kl=n(130),Ql=n(120),Jl={CREATE:"create",EDIT:"edit"};function ep(e,t){return{type:En,payload:{type:e,form:t}}}function tp(){return{type:Tn}}var np=Object(k.createStructuredSelector)({topic:function(e){var t=e.topic;return t}}),rp=function(e){return e.layoutEditor},ip=Object(k.createSelector)(rp,function(e){return e.form.displayName}),ap=Object(k.createSelector)(rp,function(e){return e.form}),op=Object(k.createSelector)(rp,function(e){return e.selectedCellIndex}),cp=Object(k.createSelector)(rp,function(e){return e.type}),sp=Object(k.createSelector)(np,L()([A.b.LAYOUT_LIST])),up=Object(k.createSelector)(np,L()([A.b.LAYOUT_SELECTED])),lp=Object(k.createSelector)(sp,up,function(e,t){var n=t.idx,r=void 0===n?0:n;return e[r]}),pp=Object(k.createStructuredSelector)({form:ap,selectedCellIndex:op,active:function(e){return e.topic[A.b.APP_MODE]===b.a.LAYOUT_EDITOR}});function fp(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function hp(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fp(n,!0).forEach(function(t){dp(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fp(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function dp(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var mp=regeneratorRuntime.mark(wp),bp=regeneratorRuntime.mark(jp),vp=regeneratorRuntime.mark(_p),yp=regeneratorRuntime.mark(Ep),gp=regeneratorRuntime.mark(Sp),Op=regeneratorRuntime.mark(kp);function wp(e){var t,n,r,i,a,o,c,s;return regeneratorRuntime.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return t=e.payload,n=void 0===t?{height:1,width:1}:t,r="",i=n.width*n.height,u.next=5,Object(cr.c)(br,r,i);case 5:return a=u.sent,u.next=8,Object(cr.n)(a);case 8:return o=u.sent,c=hn(n,Object(Ql.a)()),s=J()(function(e,t){var n=o[t.index]||o[0];return gn(e,t.index,n)},c)(c.cells),u.next=13,Object(cr.j)(ep("create",s));case 13:case"end":return u.stop()}},mp)}function jp(){var e,t;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(cr.l)(lp);case 2:return e=n.sent,t=bn(e),t.id=Object(Ql.a)(),n.next=7,Object(cr.j)(ep("create",t));case 7:case"end":return n.stop()}},bp)}function _p(){var e;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(cr.l)(lp);case 2:return e=t.sent,t.next=5,Object(cr.c)(yi.L,[e.id]);case 5:return t.next=7,Object(cr.j)(Object(hr.e)(d.b.key.LAYOUT_CELLS,[]));case 7:return t.next=9,Object(cr.c)(Kl.c);case 9:case"end":return t.stop()}},vp)}function Ep(){var e,t,n,r;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.t0=hp,i.t1={},i.next=4,Object(cr.l)(ap);case 4:return i.t2=i.sent,e=(0,i.t0)(i.t1,i.t2),i.next=8,Object(cr.l)(cp);case 8:if(t=i.sent,t!==Jl.EDIT){i.next=15;break}return n=Object(fr.f)(e),i.next=13,Object(cr.c)(yi.V,n);case 13:i.next=20;break;case 15:if(t!==Jl.CREATE){i.next=20;break}return i.next=18,Object(cr.c)(yi.d,Object(fr.e)(e));case 18:r=i.sent,r&&r.data||v.a.layout("Layout not created");case 20:return i.next=22,Object(cr.c)(Kl.c);case 22:return i.next=24,Object(cr.j)(tp());case 24:case"end":return i.stop()}},yp)}function Ap(){Object(d.b)(d.b.key.LAYOUT_CELLS).put([]),Object(d.b)(d.b.key.CAM_ACTIVE).put(void 0),Object(d.b)(d.b.key.APP_MODE).put(b.a.LAYOUT_EDITOR)}function Sp(){var e,t;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(cr.l)(lp);case 2:return e=n.sent,t=bn(e),n.next=6,Object(cr.j)(ep("edit",t));case 6:case"end":return n.stop()}},gp)}function xp(){Object(d.b)(d.b.key.APP_MODE).put(b.a.LIVE)}function kp(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(cr.o)(En,Ap);case 2:return e.next=4,Object(cr.o)(On,wp);case 4:return e.next=6,Object(cr.o)(jn,jp);case 6:return e.next=8,Object(cr.o)(wn,Sp);case 8:return e.next=10,Object(cr.o)(_n,_p);case 10:return e.next=12,Object(cr.o)(Tn,xp);case 12:return e.next=14,Object(cr.o)(Cn,Ep);case 14:case"end":return e.stop()}},Op)}var Pp=regeneratorRuntime.mark(Cp);function Cp(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(cr.h)(Nr);case 2:return e.next=4,Object(cr.h)(Br);case 4:return e.next=6,Object(cr.h)(Xr);case 6:return e.next=8,Object(cr.h)(Ti);case 8:return e.next=10,Object(cr.h)(mi);case 10:return e.next=12,Object(cr.h)(Ea);case 12:return e.next=14,Object(cr.h)(Ga);case 14:return e.next=16,Object(cr.h)(qu);case 16:return e.next=18,Object(cr.h)(Bl);case 18:return e.next=20,Object(cr.h)(Zl);case 20:return e.next=22,Object(cr.h)(kp);case 22:case"end":return e.stop()}},Pp)}var Tp=n(173),Mp=(n(622),Object(H.c)({onError:function(e){document.body.classList.add("unrecoverable-error"),v.a.common("saga",e)}})),Dp=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||y.d,Ip=Object(y.e)(or,{},Dp(Object(y.a)(Mp,Tp.b)));Mp.run(Cp);var Rp=Ip;function Lp(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,c=e[Symbol.iterator]();!(r=(o=c.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(i)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Np(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function zp(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Np(n,!0).forEach(function(t){Fp(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Np(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Fp(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var $p=Object.values(A.b),Hp=function(e){return"set".concat(C()(e))},Bp=$p.reduce(function(e,t){return zp({},e,Fp({},Hp(t),(n=t,function(e){return Object(hr.e)(n,e)})));var n},{});var Yp=M()($.a,z()(function(e){var t=Lp(e,2),n=(t[0],t[1]);return[n,L()(["topic",n])]}),I.a);function Up(e){var t=function(e){var t=Array.isArray(e)?e:[e];return t.some(function(e){return"*"===e})?$p:t}(e),n=t.reduce(function(e,t){return zp({},e,{},(n=t,r=Hp(n),i=Bp[r],Fp({},r,i)));var n,r,i},{}),r=Object(k.createStructuredSelector)(Yp(t)),i=function(e){return Object(y.b)(n,e)};return function(e){return Object(g.b)(r,i)(e)}}function Vp(e){return function(t){var n=Up(e)(t);return function(e){return c.createElement(g.a,{store:Rp},c.createElement(n,e))}}}var Wp=n(8),qp=n(88),Gp=n.n(qp),Xp=n(134);function Zp(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,c=e[Symbol.iterator]();!(r=(o=c.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(i)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var Kp=function(e){return function(t){var n=c.useState(null),r=Zp(n,2),i=r[0],a=r[1];return c.useEffect(function(){if(i)return Gp.a;var e=function(){a(Object(Xp.a)(m.a.locale))};return Object(d.b)(d.b.key.APP_LOADED).observe(e),function(){return Object(d.b)(d.b.key.APP_LOADED).unobserve(e)}}),i?c.createElement(Wp.c,{messages:i,locale:i.lang},c.createElement(e,t)):null}};Kp.displayName="LocaleProvider";var Qp=n(50),Jp=n.n(Qp),ef=n(523),tf=n.n(ef),nf=n(386),rf=n.n(nf),af=n(436),of=n.n(af),cf=n(57),sf=n.n(cf),uf=n(16);function lf(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,c=e[Symbol.iterator]();!(r=(o=c.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(i)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var pf=Object(y.d)(c.memo,Object(O.withStyles)(function(e){return{frame:{backgroundColor:e.palette.background.default,backgroundSize:"contain",backgroundRepeat:"no-repeat",backgroundPosition:"center",borderColor:e.palette.alert.main,borderWidth:1,borderStyle:"solid",objectFit:"contain",fontFamily:"'object-fit: contain;'",flexGrow:1}}}))(function(e){var t=e.blob,n=e.classes,r=c.useState(""),i=lf(r,2),a=i[0],o=i[1];return c.useEffect(function(){return t&&o(URL.createObjectURL(t)),function(){return URL.revokeObjectURL(a)}},[t]),c.createElement("div",{className:n.frame,style:{backgroundImage:"url(".concat(a,")")}})});var ff=Object(y.d)(s.a.memo,Object(O.withStyles)(function(e){return{item:{display:"inline-flex",height:18*e.spacing.unit,width:18*e.spacing.unit,cursor:"pointer","&:hover":{backgroundColor:e.palette.action.hover},"&:active":{border:[[1,"solid"]],borderColor:e.palette.action.active}},text:{overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",textIndent:e.spacing.unit}}}))(function(e){var t=e.archive,n=e.camera,r=e.classes,i=e.collapse,a=e.imgBlob,o=e.timestamp,c=e.selectCam,u=e.setAppmode,l=e.setCamarch,p=e.setArchtime,f=s.a.useCallback(function(){var e=new h.a(n);i(),c(e),u(b.a.ARCH),p(o),l(e),e.setArchSelectedByStorage(t)});return s.a.createElement(Jp.a,{alignItems:"stretch",className:r.item,container:!0,direction:"column",item:!0,onClick:f,wrap:"nowrap"},s.a.createElement(pf,{blob:a}),s.a.createElement(sf.a,{className:r.text},n.id,".",n.displayName),s.a.createElement(sf.a,{className:r.text},Object(uf.e)(o)))});function hf(){return hf=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},hf.apply(this,arguments)}function df(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function mf(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function bf(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var vf=tf()(Xe()(["timestamp","getTime"]),["desc"]),yf="alert_id";var gf=Object(y.d)(s.a.memo,Object(O.withStyles)(function(e){return{list:{margin:[[0,e.spacing.unit]]},collapse:{maxHeight:e.dimension.alertHeight,backgroundImage:"url(".concat(of.a,")"),borderBottom:[[1,"solid",e.palette.alert.main]],overflowY:"scroll",overflowX:"hidden"}}}))(function(e){var t=e.alerts,n=e.classes,r=e.open,i=e.coords,a=bf(e,["alerts","classes","open","coords"]);return s.a.createElement(rf.a,{collapsedHeight:r?"".concat(i,"px"):"0px",className:n.collapse,in:r},r&&s.a.createElement(Jp.a,{alignItems:"baseline",container:!0,spacing:8},M()([vf,z()(function(e){var t=e[yf],n=e.camera,r=e.imgBlob,i=e.timestamp,o=e.archive;return s.a.createElement(ff,hf({key:t},function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?df(n,!0).forEach(function(t){mf(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):df(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({archive:o,camera:n,imgBlob:r,timestamp:i},a)))})])(t)))}),Of=n(60),wf=n.n(Of);function jf(){return jf=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},jf.apply(this,arguments)}function _f(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var Ef=Object(O.withStyles)(function(e){return{btn:{alignSelf:"center",marginTop:-1,padding:[[0,e.spacing.unit]],background:e.palette.alert.dark,borderStyle:"solid",borderColor:e.palette.alert.light,borderRadius:[[0,0,e.shape.borderRadius,e.shape.borderRadius]],color:e.palette.alert.contrastText,cursor:"pointer",outline:"none","&:hover":{backgroundColor:e.palette.alert.main,borderColor:e.palette.alert.light},"&:active":{borderColor:e.palette.common.white}},noTopBorder:{borderTop:"none"}}})(function(e){var t=e.classes,n=e.onDragEnd,r=e.onDrag,i=e.setMaxHeightAlertPanel,a=_f(e,["classes","onDragEnd","onDrag","setMaxHeightAlertPanel"]);function o(e){e.stopImmediatePropagation(),n(),document.removeEventListener("mousemove",r),document.removeEventListener("mouseup",o,!0)}return s.a.createElement(wf.a,jf({onMouseDown:function(){i(),document.addEventListener("mousemove",r),document.addEventListener("mouseup",o,!0)},className:t.noTopBorder,classes:{root:t.btn},size:"small",variant:"outlined"},a),s.a.createElement(Wp.a,{id:"alertPanel.button"}))});function Af(e){return Af="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Af(e)}function Sf(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function xf(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function kf(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Pf(e){return Pf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Pf(e)}function Cf(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Tf(e,t){return Tf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Tf(e,t)}function Mf(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Df=function(e){function t(){var e,n,r,i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,o=new Array(a),c=0;c<a;c++)o[c]=arguments[c];return r=this,i=(e=Pf(t)).call.apply(e,[this].concat(o)),n=!i||"object"!==Af(i)&&"function"!=typeof i?Cf(r):i,Mf(Cf(n),"state",{open:!1,coords:0}),Mf(Cf(n),"resized",!1),Mf(Cf(n),"maxHeightAlertPanel",0),Mf(Cf(n),"alertPanelRef",s.a.createRef()),Mf(Cf(n),"handleClose",function(){return n.setState({open:!1})}),Mf(Cf(n),"handleToggleList",function(){n.setState(function(e){return{open:!e.open}})}),Mf(Cf(n),"onDragEnd",function(){n.resized?n.resized=!1:n.handleToggleList()}),Mf(Cf(n),"setMaxHeightAlertPanel",function(){var e=n.props.theme.dimension.alertHeight,t=n.alertPanelRef.current.offsetTop,r=document,i=r.documentElement.clientHeight,a=i-t;n.maxHeightAlertPanel=Math.floor(a/e)*e}),Mf(Cf(n),"onDrag",function(e){var t=n.props.theme.dimension.alertHeight,r=qe()(0,Math.round(e.clientY/t)*t,n.maxHeightAlertPanel),i=!0;n.resized=!0,0===r&&(i=!1),n.setState({open:i,coords:r})}),n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Tf(e,t)}(t,e),n=t,r=[{key:"render",value:function(){var e=this.state,t=e.open,n=e.coords,r=this.props,i=r.alerts,a=xf(r,["alerts"]);return 0===f()(i)?null:s.a.createElement("div",{ref:this.alertPanelRef},s.a.createElement(Jp.a,{container:!0,direction:"column"},s.a.createElement(gf,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Sf(n,!0).forEach(function(t){Mf(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Sf(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({alerts:i,collapse:this.handleClose,open:t,coords:n},a)),s.a.createElement(Ef,{onDrag:this.onDrag,onDragEnd:this.onDragEnd,setMaxHeightAlertPanel:this.setMaxHeightAlertPanel})))}}],r&&kf(n.prototype,r),i&&kf(n,i),t}(c.PureComponent),If=Object(O.withTheme)()(Df),Rf=Object(k.createStructuredSelector)({alerts:L()(["alertPanel","alerts"])}),Lf=Object(y.d)(Vp([A.b.APP_MODE,A.b.ARCH_TIME,A.b.CAM_ARCH]),Kp,_,x,Object(g.b)(Rf))(If);var Nf=Object(g.b)(ml,function(e){return Object(y.b)(o,e)}),zf=n(18),Ff=n.n(zf),$f=n(395),Hf=n.n($f),Bf=n(524),Yf=n.n(Bf),Uf=n(218),Vf=n.n(Uf),Wf=n(220),qf=n.n(Wf),Gf=n(140),Xf=n(105),Zf=n.n(Xf),Kf=n(316),Qf=n.n(Kf),Jf=n(315),eh=n.n(Jf);var th=function(e){var t=e.onClick,n=e.checked;return s.a.createElement(Zf.a,{onChange:t,icon:s.a.createElement(eh.a,null),checkedIcon:s.a.createElement(Qf.a,null),color:"default",checked:n})},nh=n(257),rh=n(438),ih=n.n(rh);function ah(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,c=e[Symbol.iterator]();!(r=(o=c.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(i)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var oh=5*ke.f,ch={abort:Ic.a},sh=function(e){return Math.floor(e/oh)};function uh(e){var t=e.cam,n=e.online,r=e.width,i=void 0===r?400:r,a=e.height,o=void 0===a?300:a,s=c.useState(),u=ah(s,2),l=u[0],p=u[1],f=c.useState(!n),h=ah(f,2),d=h[0],m=h[1],b=c.useRef(),v=!(l||d),y=t.name;function g(e){b.current&&e()}return c.useEffect(function(){var e=ch;return n&&!l&&(e=yi.B({vsid:Object(Ee.k)(t),w:i,h:o,timestamp:sh(Date.now())}).then(function(e){var t=e.data;g(function(){return p(Object(Bn.b)(t))})},function(){g(function(){return m(!0)})})),function(){e.abort(),l&&URL.revokeObjectURL(l)}},[l,t,o,n,i]),c.createElement("div",{ref:b,className:Ff()("camera-list__preview",{"camera-list__preview--loading":v})},!v&&c.createElement("img",{alt:y,className:Ff()("camera-list__img",{"camera-list__img--no":d}),src:l||ih.a}))}function lh(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function ph(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function fh(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function hh(){return hh=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},hh.apply(this,arguments)}function dh(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,c=e[Symbol.iterator]();!(r=(o=c.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(i)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function mh(e){e.stopPropagation()}function bh(e){var t=e.action,n=e.activate,r=e.cam,i=e.filter,a=e.forceShow,o=e.isGrid,s=e.hidePreview,u=e.initPreview,l=e.online,p=e.style,f=Ff()("camera-list__list__item",{"camera-list__list__item--offline":!l}),h="".concat(r.id,".").concat(r.displayName),d=c.useState(!1),m=dh(d,2),b=m[0],v=m[1],y=a?[Ic.a,Ic.a]:[function(){return v(!0)},function(){return v(!1)}],g=dh(y,2),O=g[0],w=g[1],j=o?[Ic.a,Ic.a]:[function(){return u(r)},s],_=dh(j,2),E=_[0],A=_[1],S=p.width,x=p.height;return c.createElement("div",{role:"none",ref:r.ref,className:f,onClick:n,onMouseEnter:function(){O(),E()},onMouseLeave:function(){w(),A()},style:p},o&&c.createElement(uh,hh({key:"".concat(r.origin,"-").concat(l)},{cam:r,online:l,width:S,height:x})),c.createElement("div",{className:"camera-list__list__item-hdr"},c.createElement("h5",{className:"camera-list__list__item-title"},c.createElement(nh.a,{string:h,rule:i})),r.comment&&c.createElement("div",{title:r.comment,className:"camera-list__list__item-comment"},r.comment),(a||b)&&c.createElement("div",{role:"none",className:"camera-list__list__item-actions",onClick:mh},t)))}var vh=function(e){var t=e.cols,n=e.height,r=e.width,i=fh(e,["cols","height","width"]),a=i.cam,o=a.idx,s=Math.floor(o/t)*n,u=o%t*r,l={top:s,left:u,height:n,width:r};return c.createElement(bh,hh({key:"".concat(a.origin,"-").concat(a.idx)},function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?lh(n,!0).forEach(function(t){ph(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):lh(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({style:l},i)))};function yh(){return yh=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},yh.apply(this,arguments)}function gh(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Oh(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function wh(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var jh=X()(["ref","idx"]);function _h(e){var t=e.camStates,n=e.favoriteItems,r=e.preselection,i=e.selectCam,a=e.selection,o=e.selectionMode,s=e.toggleFavorite,u=e.toggleSelection,l=e.visibleItems,p=wh(e,["camStates","favoriteItems","preselection","selectCam","selection","selectionMode","toggleFavorite","toggleSelection","visibleItems"]),f=Jr()(!1,K.a,t);return z()(function(e){var t,l=(t=e.dev,n.has(t)),h=function(e){return r.has(e)}(e.dev),d=h||function(e){return a.has(e)}(e.dev),m=f(e.origin),b=o?c.createElement(Zf.a,{checked:d,disabled:h,onClick:h?void 0:function(){return u(e)}}):c.createElement(th,{checked:l,onClick:function(){return s(e.dev)}}),v=o?d:l;return c.createElement(vh,yh({key:"".concat(e.origin,"-").concat(e.idx)},function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?gh(n,!0).forEach(function(t){Oh(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):gh(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({action:b,activate:function(){return i(jh(e))},cam:e,forceShow:v,online:m},p)))},l)}function Eh(){return Eh=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Eh.apply(this,arguments)}var Ah=c.forwardRef(function(e,t){var n=e.onChange,r=e.onClick,i=e.mode;return c.createElement("div",Eh({className:"camera-list__modes"},{onChange:n,onClick:r,ref:t}),c.createElement("input",{name:"mode",type:"radio",id:"list",value:Se,checked:i===Se,onChange:Ic.a}),c.createElement("label",{htmlFor:"list",className:"camera-list__modes-item camera-list__modes__list"}),c.createElement("input",{name:"mode",type:"radio",id:"grid",value:xe,checked:i===xe,onChange:Ic.a}),c.createElement("label",{htmlFor:"grid",className:"camera-list__modes-item camera-list__modes__grid"}))});function Sh(e){var t=e.cam,n=e.boxHeight,r=e.scrollTop;if(!t||!t.ref.current)return s.a.createElement("div",{className:"camera-list__pop-preview"});var i=t.ref.current,a=i.offsetTop,o=i.offsetWidth,c=Math.floor(o/Gf.a),u={top:qe()(0,n-c,a-r),left:o,width:o,height:c},l=Ff()(["camera-list__pop-preview","camera-list__pop-preview--active"]);return s.a.createElement("div",{className:l,style:u},s.a.createElement(uh,{cam:t,online:!0,width:o,height:c}))}var xh=n(76),kh=n.n(xh);var Ph=Object(O.withStyles)(function(e){return{checkbox:{"&:hover":{backgroundColor:e.palette.action.hover}}}})(function(e){var t=e.checked,n=e.onChange,r=e.classes,i=s.a.createElement(Zf.a,{className:r.checkbox,onChange:n,icon:s.a.createElement(eh.a,null),checkedIcon:s.a.createElement(Qf.a,null),color:"default",checked:t});return s.a.createElement(kh.a,{control:i,label:s.a.createElement(Wp.a,{id:"favorites"})})}),Ch=n(526),Th=n.n(Ch),Mh=n(525),Dh=n.n(Mh),Ih=n(74),Rh=n.n(Ih);var Lh=function(e){var t=e.onChangeSortDirection,n=e.directionSort,r=function(e){t(!n,e)};return s.a.createElement("span",null,s.a.createElement(Rh.a,{onClick:function(){return r(Ee.b)}},s.a.createElement(Dh.a,null)),s.a.createElement(Rh.a,{onClick:function(){return r(Ee.a)}},s.a.createElement(Th.a,null)))};function Nh(){return Nh=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Nh.apply(this,arguments)}function zh(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var Fh=Object(O.withStyles)(function(e){return{container:{position:"absolute"},toolbar:{display:"flex",height:6*e.spacing.unit,justifyContent:"center",overflow:"hidden",position:"relative"}}})(function(e){var t=e.classes,n=e.onChangeFavorites,r=e.checkedFavorites,i=e.onChangeSortDirection,a=e.directionSort,o=zh(e,["classes","onChangeFavorites","checkedFavorites","onChangeSortDirection","directionSort"]);return s.a.createElement("div",Nh({className:t.toolbar},o),s.a.createElement("div",{className:t.container},s.a.createElement(Ph,{checked:r,onChange:n}),s.a.createElement(Lh,{onChangeSortDirection:i,directionSort:a})))});n(643);function $h(e){return $h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$h(e)}function Hh(){return Hh=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Hh.apply(this,arguments)}function Bh(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Yh(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function Uh(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Vh(e){return Vh=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Vh(e)}function Wh(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function qh(e,t){return qh=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},qh(e,t)}function Gh(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Xh=Object(Gf.c)("camera-list__list__item-hdr"),Zh=296,Kh=z()(L()(["origin"]));function Qh(e){var t=e.children,n=e.isClosed,r=e.onClickAway;return c.createElement(n?c.Fragment:qf.a,n?null:{onClickAway:r},t)}var Jh=function(e){function t(){var e,n,r,i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];return r=this,i=(e=Vh(t)).call.apply(e,[this].concat(o)),n=!i||"object"!==$h(i)&&"function"!=typeof i?Wh(r):i,Gh(Wh(n),"state",{boxHeight:0,height:Xh,heightInRows:0,listWidth:0,listHeight:0,previewCam:null,scrollTop:0,visibleItems:[],width:0}),Gh(Wh(n),"boxRef",c.createRef()),Gh(Wh(n),"modeRef",c.createRef()),Gh(Wh(n),"adjustSize",function(){var e=n.props,t=e.cams,r=e.mode,i=r===xe,a=n.getCols(),o=window.innerWidth-n.modeRef.current.offsetWidth,c=i?Object(Gf.b)(a,o):{width:Zh,height:Xh},s=c.width,u=c.height,l=n.boxRef.current,p=l.offsetHeight,f=a*s,h=a?t.length/a*u:void 0;n.setState({boxHeight:p,listWidth:f,listHeight:h,height:u,heightInRows:Math.floor(p/u),width:s},n.updateVisibleItems)}),Gh(Wh(n),"adjustSizeD",Hf()($e,n.adjustSize)),Gh(Wh(n),"boundSetState",function(e){return n.setState(e)}),Gh(Wh(n),"changeMode",function(e){var t=e.target,r=n.props.setListMode,i=t.value,a=i===Ae,o=i===xe;r(i),n.setState(function(e){var t=e.previewCam,n=e.scrollTop,r=a||o?null:t,i=a?0:n;return{previewCam:r,scrollTop:i}})}),Gh(Wh(n),"filterClear",function(){var e=n.props.filterList;e(Fe)}),Gh(Wh(n),"filterUpdate",function(e){var t=n.props.filterList;t(e.currentTarget.value)}),Gh(Wh(n),"handleScroll",function(e){var t=e.target,r=t,i=r.scrollTop;n.setState({scrollTop:i},n.updateVisibleItems)}),Gh(Wh(n),"initPreview",function(e){n.previewDelayId=setTimeout(n.boundSetState,$e,{previewCam:e})}),Gh(Wh(n),"hidePreview",function(){var e=n.state.previewCam;clearTimeout(n.previewDelayId),e&&n.setState({previewCam:null})}),Gh(Wh(n),"getCols",function(){var e=n.props,t=e.colsGrid,r=e.colsList,i=e.mode;switch(i){case Se:return r;case xe:return t}return 0}),Gh(Wh(n),"getCam",function(e){var t=n.props.cams;return t[Number(e)]}),Gh(Wh(n),"previewDelayId",void 0),Gh(Wh(n),"open",function(){var e=n.props.mode;e===Ae&&n.changeMode({target:{value:Se}})}),Gh(Wh(n),"close",function(){return n.changeMode({target:{value:Ae}})}),Gh(Wh(n),"handleClose",function(e){var t=e.target.value,r=n.props.mode;t===r&&n.close()}),Gh(Wh(n),"updateVisibleItems",function(){var e=n.props.mode;if(e!==Ae){var t=n.state,r=t.height,i=t.heightInRows,a=t.scrollTop,o=n.props,c=o.cams,s=o.preRows,u=n.getCols(),l=Math.floor(a/r),p=qe()(0,c.length),f=l*u,h=f+(i+s)*u,d=Yf()(p(f),p(h),c);n.watch(Kh(d)),n.setState({visibleItems:d})}}),Gh(Wh(n),"favoritesToggle",function(){var e=n.props.favoritesChecked;e()}),Gh(Wh(n),"watch",Hf()(ke.h,n.props.stateWatch)),Gh(Wh(n),"handleClickAway",function(e){var t=e.target.parentElement,r=n.props.pinned;t===n.modeRef.current||r||n.close()}),n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&qh(e,t)}(t,e),n=t,r=[{key:"componentDidUpdate",value:function(e){var t=e.mode,n=e.cams,r=this.props,i=r.cams,a=r.mode;if(i!==n&&(this.updateVisibleItems(),this.adjustSize()),a!==t)switch(this.adjustSize(),a){case Se:case xe:t===Ae&&window.addEventListener("resize",this.adjustSizeD);break;case Ae:window.removeEventListener("resize",this.adjustSizeD)}}},{key:"render",value:function(){var e=this.state,t=e.height,n=e.boxHeight,r=e.listWidth,i=e.listHeight,a=e.previewCam,o=e.visibleItems,s=e.width,u=this.props,l=u.changeSortDirection,p=u.classes,f=u.directionSort,h=u.favorites,d=u.mode,m=u.pending,b=Yh(u,["changeSortDirection","classes","directionSort","favorites","mode","pending"]),v=this.hidePreview,y=this.initPreview,g=this.getCols(),O=d===Ae,w=d===Se,j=d===xe,_=Ff()("camera-list__box",{"camera-list__box--closed":O,"camera-list__box--list":w,"camera-list__box--grid":j}),E={width:r,height:i};return c.createElement(Qh,{isClosed:O,onClickAway:this.handleClickAway},c.createElement(c.Fragment,null,c.createElement("div",{className:p.listContainer},c.createElement(c.Fragment,null,m&&c.createElement(Vf.a,{className:p.progress}),c.createElement("div",{className:_,onScroll:this.handleScroll,onFocus:Ic.a,onBlur:Ic.a,ref:this.boxRef,role:"none"},c.createElement("div",{className:"camera-list__list",style:E},!O&&c.createElement(_h,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Bh(n,!0).forEach(function(t){Gh(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Bh(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({cols:g,height:t,hidePreview:v,initPreview:y,isGrid:j,listStyle:E,visibleItems:o,width:s},b)))),c.createElement(Fh,{checkedFavorites:h,onChangeFavorites:this.favoritesToggle,onChangeSortDirection:l,directionSort:f}))),c.createElement(Sh,Hh({scrollTop:null!==this.boxRef.current?this.boxRef.current.scrollTop:0,cam:a},{boxHeight:n})),c.createElement(Ah,{onChange:this.changeMode,onClick:this.handleClose,mode:d,ref:this.modeRef})))}}],r&&Uh(n.prototype,r),i&&Uh(n,i),t}(c.PureComponent);Gh(Jh,"defaultProps",{colsGrid:5,colsList:1,preRows:2});var ed=Object(y.d)(Object(O.withStyles)({listContainer:{height:"100%",display:"flex",flexDirection:"column"},progress:{zIndex:2}}),_)(Jh);function td(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function nd(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var rd=Object(g.b)(sa,function(e){return Object(y.b)(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?td(n,!0).forEach(function(t){nd(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):td(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({toggleFavorite:Ai},i),e)}),id=Object(y.d)(Vp([]),x,Kp,rd,Nf)(ed),ad=n(252),od=n.n(ad),cd=n(225),sd=n.n(cd),ud=n(198),ld=n.n(ud),pd=n(199),fd=n.n(pd);function hd(){return hd=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},hd.apply(this,arguments)}function dd(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var md=Object(O.withStyles)(function(e){return{root:{backgroundColor:e.palette.common.white,width:20*e.spacing.unit},input:{padding:[[.5*e.spacing.unit,0]]},adornmentStart:{paddingLeft:.5*e.spacing.unit},adornmentEnd:{marginLeft:0},icon:{fontSize:2.5*e.spacing.unit},iconButton:{"&:hover":{background:"none"}}}})(function(e){var t=e.classes,n=e.intl.formatMessage,r=e.onClear,i=e.searchTerms,a=dd(e,["classes","intl","onClear","searchTerms"]),o=s.a.useRef();return s.a.useEffect(function(){var e=function(){document.activeElement===document.body&&o.current.focus()};return window.addEventListener("keydown",e),function(){return window.removeEventListener("keydown",e)}}),s.a.createElement(od.a,hd({inputRef:o,classes:t,placeholder:n({id:"find"}),type:"search",value:i,startAdornment:s.a.createElement(sd.a,{classes:{root:t.adornmentStart},position:"start"},s.a.createElement(ld.a,{classes:{root:t.icon}})),endAdornment:i&&s.a.createElement(sd.a,{classes:{root:t.adornmentEnd},position:"end"},s.a.createElement(Rh.a,{classes:{root:t.iconButton},onClick:r,disableRipple:!0},s.a.createElement(fd.a,{classes:{root:t.icon}})))},a))}),bd={onClear:function(){return ji("")},onChange:function(e){return ji(e.currentTarget.value)}},vd=Object(y.d)(Kp,Wp.e,Object(g.b)(function(e){return{searchTerms:Yi(e)}},bd))(md),yd=n(349),gd=n.n(yd),Od=n(31),wd=n.n(Od),jd=n(347),_d=n.n(jd),Ed=n(258),Ad=n.n(Ed),Sd=n(346),xd=n.n(Sd),kd={anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},paperProps:{square:!0}};var Pd=wd()(function(e){return{label:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},chipRoot:{width:12*e.spacing.unit,borderRadius:0,height:3*e.spacing.unit}}})(function(e){var t=e.children,n=e.classes,r=e.value,i=e.open,a=e.toggle,o=Object(c.useRef)();return s.a.createElement(c.Fragment,null,s.a.createElement(xd.a,{rootRef:o},s.a.createElement(Ad.a,{onClick:a,classes:{root:n.chipRoot,label:n.label},label:r})),s.a.createElement(_d.a,{open:i,anchorEl:o.current,onClose:a,anchorReference:"anchorEl",anchorOrigin:kd.anchorOrigin,transformOrigin:kd.transformOrigin,PaperProps:kd.paperProps},t))}),Cd=n(193),Td=n.n(Cd),Md=n(348),Dd=n.n(Md),Id=n(112),Rd=n.n(Id);var Ld=function(e){var t=e.item;return s.a.createElement(sf.a,{component:"span",variant:t.root?"title":"body1"},t.name.join(" > "))};function Nd(e){return Nd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Nd(e)}function zd(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Fd(e){return Fd=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Fd(e)}function $d(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Hd(e,t){return Hd=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Hd(e,t)}function Bd(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Yd=function(e){function t(){var e,n,r,i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,o=new Array(a),c=0;c<a;c++)o[c]=arguments[c];return r=this,i=(e=Fd(t)).call.apply(e,[this].concat(o)),n=!i||"object"!==Nd(i)&&"function"!=typeof i?$d(r):i,Bd($d(n),"handleClick",function(){var e=n.props,t=e.onClick,r=e.item,i=r.id,a=r.name;t({id:i,name:Td()(a)})}),n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Hd(e,t)}(t,e),n=t,r=[{key:"render",value:function(){var e=this.props,t=e.item,n=e.selected,r=e.classes;return s.a.createElement(Dd.a,{className:Ff()(Bd({},r.active,n)),button:!0,onClick:this.handleClick},s.a.createElement(Rd.a,{primary:s.a.createElement(Ld,{item:t})}))}}],r&&zd(n.prototype,r),i&&zd(n,i),t}(c.PureComponent),Ud=Object(O.withStyles)(function(e){return{active:{backgroundColor:e.palette.action.selected}}})(Yd);function Vd(e){return Vd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Vd(e)}function Wd(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function qd(e){return qd=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},qd(e)}function Gd(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Xd(e,t){return Xd=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Xd(e,t)}function Zd(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Kd=function(e){function t(){var e,n,r,i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,o=new Array(a),c=0;c<a;c++)o[c]=arguments[c];return r=this,i=(e=qd(t)).call.apply(e,[this].concat(o)),n=!i||"object"!==Vd(i)&&"function"!=typeof i?Gd(r):i,Zd(Gd(n),"state",{open:!1}),Zd(Gd(n),"toggleOpen",function(){n.setState(function(e){return{open:!e.open}},n.openCameraList)}),Zd(Gd(n),"openCameraList",function(){var e=n.state.open,t=n.props,r=t.isCameraListClosed,i=t.cameraListOpen;e&&r&&i()}),Zd(Gd(n),"handleGroupClick",function(e){var t=n.props.setSelectedGroupData;t(e),n.toggleOpen()}),n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Xd(e,t)}(t,e),n=t,r=[{key:"componentDidMount",value:function(){var e=this.props.getAvailableGroups;e()}},{key:"render",value:function(){var e=this,t=this.props,n=t.classes,r=t.groupList,i=t.selectedGroup,a=this.state.open;return null===r||null===i?null:s.a.createElement(Pd,{value:i.name,open:a,toggle:this.toggleOpen},s.a.createElement(gd.a,{dense:!0,className:n.list},r.map(function(t){return s.a.createElement(Ud,{key:t.id,selected:t.id===i.id,item:t,onClick:e.handleGroupClick})})))}}],r&&Wd(n.prototype,r),i&&Wd(n,i),t}(c.Component),Qd=wd()(function(e){return{list:{maxHeight:40*e.spacing.unit,width:25*e.spacing.unit,overflow:"auto"}}})(Kd);var Jd=Object(g.b)(function(e){var t=e.filters,n=e.cameraList;return{groupList:t.list,selectedGroup:t.selectedGroup,isCameraListClosed:n.mode===Ae}},{getAvailableGroups:function(){return{type:de}},setSelectedGroupData:Ei,cameraListOpen:function(){return{type:Pe,payload:{mode:Se}}}})(Qd);var em=Object(y.d)(Vp([]),Object(O.withStyles)(function(e){return{root:{marginLeft:5*e.spacing.unit}}}))(function(e){var t=e.classes;return s.a.createElement(Jp.a,{container:!0,alignItems:"center",className:t.root,wrap:"nowrap"},s.a.createElement(Jd,null),s.a.createElement(vd,null))}),tm=n(48),nm=n.n(tm),rm=n(219),im=n.n(rm),am=n(255),om=n.n(am),cm=n(135);function sm(e){var t={error:{badSymbol:!1,badTransition:!1},history:{writeLog:!0,maxCount:100},initState:"init"};if(!(this instanceof sm))return new sm(e);void 0!==e?(void 0!==e.error?(e.error.badSymbol=e.error.badSymbol||t.error.badSymbol,e.error.badTransition=e.error.badTransition||t.error.badTransition):e.error=t.error,void 0!==e.history?(e.history.writeLog=e.history.writeLog||t.history.writeLog,e.history.maxCount=e.history.maxCount||t.history.maxCount):e.history=t.history,void 0!==e.initState&&(e.initState=e.initState||t.initState)):e=t,this._settings=e,this._transition={},this._states=[],this._alphavit=[],this._state=e.initState,this._pstate=e.initState,this._history=[],this._hash={},this._queue=new cm.a}sm.prototype={add:function(e,t){var n=e[0]+"-"+e[1];return this._transition[n]={s:e[2],f:t},-1===this._alphavit.indexOf(e[0])&&this._alphavit.push(e[0]),-1===this._states.indexOf(e[1])&&this._states.push(e[1]),-1===this._states.indexOf(e[2])&&this._states.push(e[2]),this},input:function(e,t){if(this._settings.error.badSymbol&&-1===this._alphavit.indexOf(e))throw new Error({message:"Bad symbol:"+e,name:"StateMachine Exception"});var n=e+"-"+this._state;if(n in this._transition)this._settings.history.writeLog&&(this._history.length>2*this._settings.history.maxCount&&(this._history=this._history.slice(0,this._settings.history.maxCount)),this._history.push({state:this._state,symbol:e,object:t})),this._pstate=this._state,this._state=this._transition[n].s,this._queue.push(this._transition[n].f,t);else if(this._settings.error.badTransition)throw new Error({message:"Bad transition:"+n,name:"StateMachine Exception"});return this},history:function(){return this._history},hash:function(e){var t=this._pstate+"-"+this._state;return void 0===e?this._hash[t]:(this._hash[t]=e,this)},del:function(e){var t=e[0]+"-"+e[1];delete this._transition[t]},settings:function(e){return e?(e.error?(e.error.badSymbol=e.error.badSymbol||defSettings.error.badSymbol,e.error.badTransition=e.error.badTransition||defSettings.error.badTransition):e.error=defSettings.error,e.history?(e.history.writeLog=e.historyr.writeLog||defSettings.history.writeLog,e.history.maxCount=e.history.maxCount||defSettings.history.maxCount):e.history=defSettings.history):e=defSettings,this}};var um=sm,lm=n(145),pm=n.n(lm),fm=n(131),hm=n.n(fm),dm=hm()(function(e){return hc()("timestamp")(e)});dm.cache=new dr.a;var mm=new Image,bm=new Image,vm=new Image,ym=new Image,gm=new Image,Om=new Image;mm.src=n(649),bm.src=n(650),vm.src=n(651),ym.src=n(652),gm.src=n(653),Om.src=n(654);var wm={alarmFlag:vm,warningFlag:ym,falseFlag:gm,unclassifiedFlag:Om};function jm(e){var t;this.scale=e.scale,this.size=e.size,this.zoomStep=e.zoomStep,this.$el=e.$el,this.maxHeight=e.maxHeight||Number.POSITIVE_INFINITY,this.canvas=e.$el[0],this.ctx=this.canvas.getContext("2d"),this.canvas.width=e.$el.parent().width(),this.cHeight=e.cHeight||this.$el.parent().height(),this.canvas.height=e.cHeight,this.height=this.size*this.scale,this.funcRender=[],this.setOfTags=[],this.scaleTags=e.scaleTags,this.afterMouseWheel=e.afterMouseWheel||l.a.noop,this.funcParam=[],this.patterns={piece:this.ctx.createPattern(mm,"repeat")},this.top=0,this.setTop(e.top),this.$el.off(),this.offscreenCanvas=function(){var e=document.createElement("canvas");return e.height=this.canvas.height,e.width=this.canvas.width,e}.call(this),this.offscreenCtx=this.offscreenCanvas.getContext("2d");var n=function(e){t=e.pageY,this.$el.addClass("dragging")}.bind(this),r=function(e,n){if(n&&this.$el.removeClass("dragging"),this.$el.hasClass("dragging")){var r=e.pageY-t;Math.abs(r)>1&&(r>0&&this.top+r<0||r<0&&this.height+this.top+r>this.cHeight)&&(this.$el.addClass("moving"),this.top+=r,this.ctx.translate(0,r),this.canvasRender(),t=e.pageY),this.afterMouseWheel()}}.bind(this),i=function(e){this.$el.removeClass("dragging"),this.$el.hasClass("moving")&&this.$el.removeClass("moving")}.bind(this);this.zoom=function(e,t){t.originalEvent.preventDefault();var n=Math.sign(t.deltaY)*e;if(!(this.height>=this.maxHeight&&n>0)){var r=nm()(t.pageY-this.$el.offset().top-this.top,0,this.height),i=(e-1)*this.height,a=n*i,o=this.height+a,c=-r/this.height*n*i,s=this.top+c,u=s+o-this.cHeight;n<0&&(s>0&&(c=0,s=this.top),u<0&&(s=this.cHeight-o,c=s-this.top),u=s+o-this.cHeight),o<this.cHeight&&(o=this.cHeight,s=0,c=-this.top),this.height=o,this.top=s,this.ctx.translate(0,c),this.scale=this.height/this.size,this.canvasRender(),this.afterMouseWheel(t,n)}}.bind(this),this.$el.on({mousedown:n,mousemove:r,mouseup:i,wheel:pm()(this.zoom.bind(null,e.zoomStep),dr.p),touchstart:pm()(n,dr.o),touchmove:pm()(r,dr.o),touchend:pm()(i,dr.o)});var a=0,o=0,c=function(e){var t=e.originalEvent.touches;return t[0].pageY-t[1].pageY},s=function(e){var t=e,n=c(e);t.deltaY=n-a,t.pageY=o,a=n,zoom(t)};this.$el.on({touchstart:function(e){var t=e.originalEvent.touches;t.length>1&&(a=c(e),o=a/2+Math.min(t[0].pageY,t[1].pageY),Object(l.a)(window).on("touchmove",s))},touchend:function(e){a=0,o=0,Object(l.a)(window).off("touchmove",s)}});for(var u=0;u<this.scaleTags.length;u++)this.addTags(this.scaleTags[u]);this.addFuncRender(function(e){var t,n,r,i=this.height,a=this.setOfTags.length,o={},c={},s=0,u=[],l=0,p=0,f=0,h=0,d=0;for(e.beginPath();a--;)if(o=this.setOfTags[a],o.min<i&&i<=o.max)for(h=c=this.setOfTags[a].tags.length;h--;){for(c=this.setOfTags[a].tags[h],s=Math.round(this.size/c.step)+1,t=0,f=0,n=c.step*this.scale,e.fillStyle=c.textColor||"#00f",e.strokeStyle=c.color||"#00f",e.lineWidth=c.lineWidth||1,e.font=c.font||"12px san-serif",e.textBaseline=c.textBaseline||"bottom",d=c.xbase||0;s--;){for(r=!0,l=u.length;r&&l--;)p=f/u[l],r=Math.abs(p-Math.round(p))>1e-5;r&&(c.textOut&&e.fillText(c.format(f),d+c.padding,t),e.moveTo(d,Math.round(t)),e.lineTo(d+c.width,Math.round(t))),t+=n,f+=c.step}u.push(c.step)}e.stroke()},"indexRender"),this.addFuncRender(function(e){e.clearRect(0,0,this.canvas.height,this.canvas.width),e.lineWidth=1,e.strokeStyle="#000",e.beginPath(),e.moveTo(63,0),e.lineTo(63,this.height),e.stroke()},"scaleRender"),this.addFuncRender(function(e,t){if(t.events){var n,r,i,a,o,c,s,l,p=Object.keys(t.events).sort(),f=p.length;for(i=0;i<f;i+=1){for(c=t.events[p[i]],s=c.length,e.beginPath(),e.fillStyle=(l=p[i],"alerts"===l?"#FF1919":"dodgerblue");s--;)u=c[s],n=u.begin-t.t0,r=u.end-u.begin,a=n*this.scale,o=Math.ceil(r*this.scale),e.rect(26,a,10,o);e.fill()}}},"eventRender"),this.addFuncRender(function(e,t){if(t.alerts)for(var n,r,i,a=0,o=0;o<t.alerts.length;o++){i=t.alerts[o];var c=L()("reaction.severity",i);n=i.begin-t.t0,r=n*this.scale,c&&(Math.abs(r-a)>10&&(e.drawImage(wm["".concat(c,"Flag")],15,r-6),a=r))}},"alertFlagsRender"),this.addFuncRender(function(e,t){if(t.results){var n,r,i,a,o=0,c=dm(t.results);e.beginPath(),e.fillStyle="rgb(0, 224, 162)";for(var s=0;s<c.length;s++)a=c[s],n=a.timestamp-t.t0,i=Math.ceil(1*this.scale),r=n*this.scale,r-o>10&&(e.rect(26,r,10,i),e.arc(26,r,5,0,2*Math.PI,!1),o=r);e.fill()}},"resultRender"),this.addFuncRender(function(e,t){var n=this;if(t.comments.length){var r,i,a,o,c,s,u,l;e.beginPath(),e.fillStyle="#319b35",l=t.comments,l.filter(function(e){return null!==e}).forEach(function(l){r=Object(ke.l)(l.begins_at).getTime(),c=Object(ke.l)(l.ends_at).getTime(),i=r-t.t0,a=c-r,o=Math.ceil(a*n.scale),s=i*n.scale,u=o,e.rect(26,s,10,u)}),e.fill(),e.drawImage(bm,26,s)}},"commentRender"),this.addFuncRender(function(e,t){if(t.archive){m.a.scale=this.scale;var n,r,i,a,o,c,s=t.archive.length;for(e.fillStyle=this.patterns.piece,e.beginPath();s--;)n=t.archive[s],r=n.time.begin-t.t0,i=n.time.end-n.time.begin||1,a=Math.ceil(i*this.scale),o=r*this.scale,c=a,e.rect(26,o,10,c);e.fill()}},"archiveRender"),this.funcParam.archiveRender={composite:"copy",alpha:1},this.funcParam.eventRender={composite:"source-over",alpha:.5},this.funcParam.alertFlagsRender={composite:"source-over",alpha:1},this.funcParam.resultRender={composite:"source-over",alpha:1},this.funcParam.commentRender={composite:"source-atop",alpha:.5},this.funcParam.indexRender={composite:"source-over",alpha:1},this.funcParam.scaleRender={composite:"destination-over",alpha:1}}jm.prototype={addTags:function(e){var t={};return t.tags=e.tags.sort(function(e,t){return e.step-t.step}),t.min=e.min,t.max=e.max,this.setOfTags.push(t),this},scale:function(){return this.scale},height:function(){return this.canvas.height},_onRendered:function(){this.$el.trigger("rendered")},canvasRender:function(){return window.requestAnimationFrame(function(){var e,t,n,r,i=this.funcRender.length,a=this.offscreenCanvas,o=this.offscreenCtx,c=this.ctx;for(c.save(),c.setTransform(1,0,0,1,0,0),c.clearRect(0,0,this.canvas.width,this.canvas.height),c.restore();i--;)e=this.funcRender[i],this.funcParam.hasOwnProperty(e.hash)?(t=this.funcParam[e.hash],n=t.alpha,r=t.composite):t={},a.height=this.cHeight,o.clearRect(0,0,a.width,a.height),o.translate(0,this.top),e.func.call(this,o,t),c.globalAlpha=n||1,c.globalCompositeOperation=r||"source-atop",a.width&&a.height&&c.drawImage(a,0,-this.top);this._onRendered()}.bind(this)),this},setTop:function(e){isFinite(e)&&(this.top+=e,this.ctx.translate(0,e),this.canvasRender())},addFuncRender:function(e,t){return this.funcRender.push({func:e,hash:t}),this}};var _m=jm;n(847),n(849),n(850),n(655),n(242),n(656);function Em(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var Am=V()(K.a,["mp4","avi"]);l.a.widget("app.exportForm",{options:{start:new Date,stop:new Date,submit:l.a.noop},defaultElement:"<form>",_create:function(){var e=this,t=this.element.addClass("export-form"),n=Object(l.a)("<input>").attr({class:"export-form__input-start hidden",name:"start"}).appendTo(Object(l.a)("<label>").appendTo(t)),r=Object(l.a)("<input>").attr({class:"export-form__input-stop hidden",name:"stop"}).appendTo(Object(l.a)("<label>").appendTo(t)),i=Object(l.a)("<label>").text(m.a.locale.exportComp).append(Object(l.a)('\n\t\t\t\t\t<select name="vc">\n\t\t\t\t\t\t<option value="4">'.concat(m.a.locale.exportCompRatio.low,'</option>\n\t\t\t\t\t\t<option value="5" selected>').concat(m.a.locale.exportCompRatio.medium,'</option>\n\t\t\t\t\t\t<option value="6">').concat(m.a.locale.exportCompRatio.high,"</option>\n\t\t\t\t\t</select>\n\t\t\t\t")).addClass("export-form__compression")),a=Object(l.a)("<label>").text(m.a.locale.exportFormat).appendTo(t),o=Object(l.a)("<select>").attr({class:"export-form__select-format",name:"format"}).on({change:function(e){var n=e.target.value;Am(n)?(i.insertAfter(a),t.css({top:Math.min(t.offset().top,window.innerHeight-t.height())})):i.remove(),localStorage.setItem("exportFormat",n)}});a.append(o),Object(l.a)("<textarea>").attr({class:"export-form__text-comment",name:"comment",placeholder:m.a.locale.exportComment}).appendTo(Object(l.a)("<label>").appendTo(t)),Object(l.a)("<button>").addClass("export-form__submit").text(m.a.locale.export).appendTo(t);var c=this.options.parent,s=Object(l.a)(["mkv","mp4","avi","exe"]).sort().map(function(e,t){return Object(l.a)("<option>").text(t)}),u=localStorage.getItem("exportFormat");o.append.apply(o,Em(s)),u&&o.val(u).trigger("change"),n.val(this.options.start.valueOf()),r.val(this.options.stop.valueOf()),t.css({top:c.offset().top+c.height(),right:c.parent().width()}).on({click:function(e){e.stopPropagation()},submit:function(n){var r=t.serializeArray().reduce(function(e,t){switch(t.name){case"start":case"stop":e[t.name]=t.value;break;case"vc":e.extended[t.name]=parseInt(t.value,10)||void 0;break;default:e.extended[t.name]=t.value}return e},{extended:{}});n.stopPropagation(),n.preventDefault(),e.options.submit(r),e.destroy()}}),Object(l.a)(window).one({click:function(){return e.destroy()}}),this.mountForm()},mountForm:function(){this.element.appendTo("body"),this.element.css({top:Math.min(this.element.offset().top,window.innerHeight-this.element.height())})},_destroy:function(){this.element.empty(),this.element.remove()}});n(657),n(658),n(659),n(243);function Sm(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function xm(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Sm(n,!0).forEach(function(t){km(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Sm(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function km(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Pm=n(244),Cm=n(245),Tm=n(246),Mm=n(247),Dm=n(660),Im=n(661),Rm=Object(l.a)();function Lm(){var e=this;if(!(this instanceof Lm))return new Lm;var t='\n<div class="ArchivePane-box">\n\t<div class="ArchivePane-puller-container">\n\t\t<div class="ArchivePane-puller">\n\t\t\t'.concat(m.a.locale.archivePanel,'\n\t\t</div>\n\t</div>\n\t<div class="ArchivePane-container">\n\t\t<div class="ArchivePane-date gradient" id="ArchivePane-date">\n\t\t\t<input class="ArchivePane-calendar" id="ArchivePane-calendar">\n\t\t\t<div class="ArchivePane-val">').concat(m.a.locale.choseDate,'</div>\n\t\t</div>\n\t\t<div class="ArchivePane-timeline">\n\t\t\t<canvas class="ArchivePane-scale"></canvas>\n\t\t\t<div class="ArchivePane-export-select">\n\t\t\t\t<button class="ArchivePane-export-button clear"></button>\n\t\t\t\t<button class="ArchivePane-export-button execute"></button>\n\t\t\t</div>\n\t\t\t<div class="ArchivePane-pointer">\n\t\t\t\t<span class="ArchivePane-pointer-holder">\n\t\t\t\t\t<button class="ArchivePane-pointer-pin start"></button>\n\t\t\t\t\t<button class="ArchivePane-pointer-pin stop"></button>\n\t\t\t\t</span>\n\t\t\t\t<span class="ArchivePane-pointer-time"></span>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="ArchivePane-control gradient">\n\t\t\t<div class="ArchivePane-speedScale slider"></div>\n\t\t\t<button class="ArchivePane-play-pause Playback__play_forward" title="').concat(m.a.locale.play,'"></button>\n\t\t\t<div class="ArchivePane-buttonBar">\n\t\t\t\t<button\n\t\t\t\t\tclass="ArchivePane-button"\n\t\t\t\t\ttitle="').concat(m.a.locale.prevInt,'"\n\t\t\t\t\tdata-action="prevInt"\n\t\t\t\t>').concat(Pm,'</button>\n\t\t\t\t<button\n\t\t\t\t\tclass="ArchivePane-button"\n\t\t\t\t\ttitle="').concat(m.a.locale.prevFrame,'"\n\t\t\t\t\tdata-action="prevFrame"\n\t\t\t\t>').concat(Cm,'</button>\n\t\t\t\t<span class="ArchivePane-speedVal">1</span>\n\t\t\t\t<button\n\t\t\t\t\tclass="ArchivePane-button"\n\t\t\t\t\ttitle="').concat(m.a.locale.nextFrame,'"\n\t\t\t\t\tdata-action="nextFrame"\n\t\t\t\t>').concat(Tm,'</button>\n\t\t\t\t<button\n\t\t\t\t\tclass="ArchivePane-button"\n\t\t\t\t\ttitle="').concat(m.a.locale.nextInt,'"\n\t\t\t\t\tdata-action="nextInt"\n\t\t\t\t>').concat(Mm,"</button>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>");this.$location=Object(l.a)("#view"),this._div=Object(l.a)(t).appendTo(this.$location),this.$calendar=this._div.find(".ArchivePane-calendar"),this._timeline=this._div.find(".ArchivePane-timeline"),this._select=this._div.find(".ArchivePane-export-select"),this._warn=this._div.find(".ArchivePane-warn"),this._val=this._div.find(".ArchivePane-val"),this.archPaneMounted=!1,this.export={},this.sm=new um,this._hash={},this.updateArchPane=this.updateArchPane.bind(this),this.updateTimeline=this.updateTimeline.bind(this);var n=im()(function(){return e.refresh(e.camera.archive,e.camera.events)},m.a.settings.animationTime);Object(l.a)(window).off("resize.ap").on("resize.ap",function(t){e.camera&&n(t.target.innerHeight)});var r=this._div.find(".ArchivePane-play-pause"),i=Object(l.a)("<div>").addClass("ArchivePane-container-play").append(Im),a=Object(l.a)("<div>").addClass("ArchivePane-container-pause hidden").append(Dm),o=this._div.find(".ArchivePane-speedVal").data("speed",this.DEFAULT_SPEED),c=m.a.settings.playspeed.length-1,s=0;r.draggable({axis:"x",cancel:!1,containment:"parent",drag:function(){var e=r.position().left,t=m.a.settings.playspeed[Math.round(e/s*c)];o.html(t).data("speed",t),r.css({transform:"scaleX(".concat(Math.sign(t),")")})},start:function(){s=r.parent().width()-r.outerWidth()},stop:function(){return e.topic(e.topic.key.ARCH_SPEED).put(o.data("speed"))}}).on("click",function(){var t=r.hasClass("play");a.toggleClass("hidden",t),i.toggleClass("hidden",!t),e.sm.input("playToggle")}).append(i).append(a),Rm=Object(l.a)(".ArchivePane-pointer").css({top:"50%"}),Rm.draggable({cursorAt:{top:0},handle:".ArchivePane-pointer-time",start:function(){return e.sm.input("pause")},drag:function(t,n){var r=e.topToDate(n.offset.top);e.updateDate(r)},stop:function(t){e.movePointerOnClick(t)},axis:"y"}),Rm.height=Math.round(Rm.height()),Object.defineProperty(Rm,"top",{set:function(e){var t=Math.round(e);this.css({top:t}),this.cachedTop=t},get:function(){return this.cachedTop}});var u=function(t,n){return e.camera.getArchiveDays(t,n).then(function(t){e.archiveDays=t,e.$calendar.datetimepicker("refresh")})};this.archiveDays=[],this.$calendar.datetimepicker({showSecond:!0,timeInput:!0,useLocalTimezone:!0,onChangeMonthYear:u,buttonText:m.a.locale.choseDate,beforeShow:function(e,t){var n=t.input.datepicker("getDate");t.dpDiv.css({"margin-left":-t.input.width()}),u(n.getFullYear(),n.getMonth()+1)},beforeShowDay:function(t){return e.archiveDays[t]?[!0,""]:[!1]},onSelect:function(t){var n=new Date(t),r=e.topic(e.topic.key.ARCH_TIME).get();n.toDateString()!==r.toDateString()&&e.topic(e.topic.key.ARCH_TIME).put(n)},onClose:function(t){e.topic(e.topic.key.PLAYBACK).assign({beginTime:new Date(t),speed:0})}}),Object(l.a)(".ArchivePane-pointer-pin").on({click:function(t){var n=t.target,r=e.topic(e.topic.key.ARCH_TIME).get();Object(l.a)(n).hasClass("start")?e.setExportDates(r,null):e.setExportDates(null,r)}}),Object(l.a)(".ArchivePane-export-button.clear").on({click:function(){return e.setExportDates(null,null)}}),Object(l.a)(".ArchivePane-export-button.execute").on({click:function(t){t.stopPropagation();var n=l.a.app.exportForm({parent:e._select,start:e.export.start,stop:e.export.stop,submit:function(t){var r=new Date(Number(t.start)),i=new Date(Number(t.stop));e.topic(e.topic.key.EXPORT_TASK).put([e.camera,r,i,t.extended]),n.destroy()}})}});var p,f,h=(p=!1,f=Object(l.a)(".ArchivePane-box"),function(){p=!p,f.toggleClass("ArchivePane--closed",p)});Object(l.a)(".ArchivePane-puller").on({click:h}),Object(l.a)(".ArchivePane-date").on({click:function(){var t=e.topic(e.topic.key.ARCH_TIME).get();e.$calendar.datepicker("setDate",t).datepicker("show"),e.sm.input("pause")}}),Object(l.a)(".ArchivePane-button").on({click:function(t){var n=Object(l.a)(t.target);n.hasClass("disabled")||e.sm.input(n.data("action"))}});var d=requestAnimationFrame.bind(null,function(){e.movePointer(e.topic(e.topic.key.ARCH_TIME).get()),e.exportMarker()});this.updateArchBounds=function(){var t=e.heightToDate(),n=t.begin,r=t.end;e.topic(e.topic.key.ARCH_BOUNDS).put({begin:n,end:r})},this._initScale=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.scale,r=t.top,i=t.cHeight,a=e._timeline.height(),o=a,c=0,s=a/ke.a;if(n&&i){var u=a/i;s=n*u,c=r*u}e.as=new _m({$el:e._div.find(".ArchivePane-scale"),scale:s,top:c,size:ke.a,scaleTags:m.a.settings.scaleTags,zoomStep:m.a.settings.zoomScaleStep,maxHeight:m.a.settings.maxScaleHeight,cHeight:o,afterMouseWheel:e.updateArchBounds.bind(e)});var l=0;e.as.$el.on({mousedown:function(e){var t=e.pageY;l=t},mouseup:function(t){t.pageY===l&&(e.movePointerOnClick(t),l=0)},touchstart:function(e){var t=e.originalEvent.changedTouches[0].pageY;l=t},touchend:function(t){var n=t.originalEvent.changedTouches[0];if(n.pageY===l){var r=t;r.pageY=n.pageY,e.movePointerOnClick(r)}},rendered:d}),e.as.canvasRender()},Rm.on({wheel:function(t){t.pageY=Rm.offset().top+Rm.height/2,e.as.$el.trigger(t)}}),this.sm.add(["nextFrame","init","step"],function(){return e.sm.input("nextFrame")}),this.sm.add(["prevFrame","init","step"],function(){return e.sm.input("prevFrame")}),this.sm.add(["nextFrame","step","step"],function(){return e.camera.stepForward()}),this.sm.add(["prevFrame","step","step"],function(){return e.camera.stepBack()}),this.sm.add(["nextInt","step","init"],function(){return e.sm.input("nextInt")}),this.sm.add(["prevInt","step","init"],function(){return e.sm.input("prevInt")}),this.sm.add(["nextInt","init","init"],function(){return e.camera.nextInterval()}),this.sm.add(["prevInt","init","init"],function(){return e.camera.prevInterval()}),this.sm.add(["playToggle","step","init"],function(){e.camera.frames.clear(),e.sm.input("playToggle")}),this.sm.add(["playToggle","init","playing"],function(){e.topic(e.topic.key.PLAYBACK).assign({speed:e.topic(e.topic.key.ARCH_SPEED).get()}),r.removeClass("play").addClass("pause"),Object(l.a)(".ArchivePane-button").addClass("disabled")}),this.sm.add(["playToggle","playing","init"],function(){e.topic(e.topic.key.PLAYBACK).assign({beginTime:e.topic(e.topic.key.ARCH_TIME).get(),speed:0}),r.removeClass("pause").addClass("play"),Object(l.a)(".ArchivePane-button").removeClass("disabled")}),this.sm.add(["pause","playing","playing"],function(){e.sm.input("playToggle")}),this.sm.add(["pause","init","init"],l.a.noop)}Lm.prototype={DEFAULT_SPEED:1,dateFormatted:function(e){return"".concat(m.a.locale.calendar.dayNamesShort[e.getDay()],", ").concat(Object(uf.i)(e.getDate())," ").concat(m.a.locale.calendar.monthNamesShort[e.getMonth()]," ").concat(e.getFullYear())},timeFormatted:uf.e,updateDate:function(e){Object(l.a)(".ArchivePane-val").text(this.dateFormatted(e)),Object(l.a)(".ArchivePane-pointer-time").text(this.timeFormatted(e))},topToDate:function(e){var t=e-this.as.top-this._timeline.offset().top;return new Date(t/this.as.scale+this.begin)},heightToDate:function(){var e=Math.abs(this.as.top);return{begin:new Date(e/this.as.scale+this.begin),end:new Date((e+this.as.cHeight)/this.as.scale+this.begin)}},dateToTop:function(e){return this.as.scale*(e-this.begin)+this.as.top},movePointer:function(e){if(this.as){var t=this.dateToTop(nm()(e,this.begin,this.end));Rm.top=t}},movePointerOnClick:function(e){var t=new Date(nm()(this.topToDate(e.pageY),this.begin,this.end));this.handleDate(t),this.sm.input("pause"),this.topic(this.topic.key.PLAYBACK).assign({beginTime:t,speed:0})},framePointer:function(){var e=Rm.height,t=Rm.top+e/2,n=this.as.cHeight,r=0;r-=nm()(t-e,-1/0,0),r-=nm()(t+e-n,0,1/0),0!==r&&this.as.setTop(r)},exportMarker:function(){if(this.export.start||this.export.stop){this._select.removeClass("hidden"),this.export.start&&this.export.stop?this._select.find(".execute").removeClass("hidden"):this._select.find(".execute").addClass("hidden");var e=this.dateToTop(om()(this.export,"start",this.begin)),t=this.dateToTop(om()(this.export,"stop",this.end));this._select.css({top:e,height:t-e})}else this._select.addClass("hidden")},setExportDates:function(e,t){e||t||(v.a.export("Clear export selection"),this.export={}),null!==e&&e!==t&&(v.a.export("Set start",e),this.export.start=e),null!==t&&e!==t&&(v.a.export("Set stop",t),this.export.stop=t),!t&&this.export.start>this.export.stop&&(this.export.stop=ke.g),!e&&this.export.stop<this.export.start&&(this.export.start=ke.g),this.exportMarker()},clear:function(){return this.archPaneMounted&&this.refresh([],{}),this._div.addClass("ArchivePane--loading"),this},refresh:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];n&&(this.first=$c.a(e),this.last=$c.e(e),this.begin=new Date(this.first).setHours(0,0,0,0),this.end=new Date(this.last).setHours(23,59,59,999)),this._initScale(this.as);var r=this.topic(this.topic.key.COMMENTS).get()||[];return this.as.funcParam.commentRender=xm({},this.as.funcParam.commentRender,{comments:r,t0:this.begin}),this.as.funcParam.archiveRender=xm({},this.as.funcParam.archiveRender,{archive:e,t0:this.begin}),this.as.funcParam.alertFlagsRender=xm({},this.as.funcParam.alertFlagsRender,{alerts:t.alerts,t0:this.begin}),this.as.funcParam.eventRender=xm({},this.as.funcParam.eventRender,{events:t,t0:this.begin}),this.as.funcParam.resultRender=xm({},this.as.funcParam.resultRender,{results:this.topic(this.topic.key.SEARCH_RESULTS).get(),t0:this.begin}),this.as.canvasRender(),this._div.removeClass("ArchivePane--loading"),this},setCamera:function(e){return e===this.camera?this:(this.camera&&this.camera.archSelected.unobserve(this.updateArchPane),e&&(this.camera=e,this.camera.archSelected.observe(this.updateArchPane)),this)},subscribe:function(e){var t=this;this.topic=e,this.topic(this.topic.key.ARCH_SPEED).put(this.DEFAULT_SPEED),this.topic(this.topic.key.ARCH_TIME).observe(this.handleDate.bind(this)),this.topic(this.topic.key.ARCH_SPEED).observe(this.handleSpeed.bind(this)),this.topic(this.topic.key.ARCH_SPEED).observe(function(e){Object(l.a)(".ArchivePane-speedVal").html(e).data("speed",e);var t=Object(l.a)(".ArchivePane-speedScale").width(),n=t/m.a.settings.playspeed.length,r=n*m.a.settings.playspeed.indexOf(e);Object(l.a)(".ArchivePane-play-pause").css({transform:"scaleX(".concat(Math.sign(e),")"),left:"".concat(r,"px")})}),this.topic(this.topic.key.SEARCH_RESULTS).observe(this.updateArchPane),this.topic(this.topic.key.COMMENTS).observe(function(){return t.refresh(t.camera.archive,t.camera.events)}),this.topic(this.topic.key.ARCH_BOUNDS).observe(this.updateTimeRange.bind(this)),this.topic(this.topic.key.MOVE_SCALE).observe(this.moveScaleTo.bind(this)),this.topic(this.topic.key.PLAYBACK).observe(function(e){var t=e.speed;Object(l.a)(".ArchivePane-container-play").toggleClass("hidden",Boolean(t)),Object(l.a)(".ArchivePane-container-pause").toggleClass("hidden",!t)})},moveScaleTo:function(e){var t=e.begin,n=e.end;this.updateTimeRange({begin:t,end:n}),this.as.canvasRender(),this.updateArchBounds()},updateTimeRange:function(e){var t=e.end-e.begin,n=e.begin;this.as.scale=this.as.cHeight/t,this.as.height=this.as.scale*this.as.size,e.end>this.end&&(n=this.end-t),this.as.setTop(this.dateToTop(this.begin)-this.dateToTop(n)-this.as.top)},handleSpeed:function(e){var t=this.topic(this.topic.key.PLAYBACK).get().speed,n=this.topic(this.topic.key.ARCH_TIME).get();t&&this.topic(this.topic.key.PLAYBACK).assign({speed:e,beginTime:n})},updateArchPane:function(){var e;return regeneratorRuntime.async(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,regeneratorRuntime.awrap(this.camera.archPromise);case 2:if(t.t0=this.topic(this.topic.key.ARCH_TIME).get(),t.t0){t.next=7;break}return t.next=6,regeneratorRuntime.awrap(this.camera.getArchEnd());case 6:t.t0=t.sent;case 7:e=t.t0,this.updateTimeline(e);case 9:case"end":return t.stop()}},null,this)},updateTimeline:function(e){var t,n,r=this;return regeneratorRuntime.async(function(i){for(;;)switch(i.prev=i.next){case 0:if(this.camera||this.archPaneMounted){i.next=2;break}return i.abrupt("return");case 2:return this.clear(),this.camera.archClear(),t=Object(ke.o)(e),i.next=7,regeneratorRuntime.awrap(this.camera.getIntervals(t));case 7:if(this.refresh(this.camera.archive,this.camera.events,!0),this.topic(this.topic.key.PLAYBACK).assign({beginTime:e,speed:0}),this.archPaneMounted){i.next=11;break}return i.abrupt("return");case 11:this.updateArchBounds(),n=function(){r.archPaneMounted&&r.refresh(r.camera.archive,r.camera.events)},this.camera.getDetectors(t).then(n),this.camera.getAlerts(t).then(n);case 15:case"end":return i.stop()}},null,this)},handleDate:function(e,t){e&&!iu()(this.begin,this.end,e.getTime())&&this.updateTimeline(e),e&&this.as&&(this.updateDate(e),this.movePointer(e),this.framePointer()),this.camera&&this.camera.archTime.put(e||t)},mount:function(){return document.body.contains(this._div.get(0))||(this.archPaneMounted=!0,this._div.appendTo(this.$location)),this},unmount:function(){return this.archPaneMounted=!1,this._div.detach(),this}};var Nm=Lm,zm=n(527),Fm=n.n(zm),$m=n(528),Hm=n.n($m);var Bm=hm()(M()(Hm()(function(e){return Fm()(["set",e])}),Dt()(function(e){return qo(e)})));function Ym(e){return Object(g.b)(_c(e),function(t){return Object(y.b)(Bm(e),t)})}var Um=Object(g.b)(kc,function(e){return Object(y.b)(a,e)}),Vm=Object(g.b)(Pc,function(e){return Object(y.b)({setForms:Zo,replaceForms:Xo},e)}),Wm=n(443),qm=n.n(Wm),Gm=n(444),Xm=n.n(Gm),Zm=n(445),Km=n.n(Zm),Qm=n(535),Jm=n.n(Qm),eb=n(440),tb=n.n(eb),nb=n(533),rb=n.n(nb),ib=n(441),ab=n.n(ib),ob=n(442),cb=n.n(ob),sb=n(534),ub=n.n(sb),lb=n(439),pb=n.n(lb),fb=n(530),hb=n.n(fb),db=n(531),mb=n.n(db),bb=n(532),vb=n.n(bb),yb=n(529),gb=n.n(yb),Ob=Dt()(function(e){return"".concat(100*e,"%")});function wb(e,t){var n=function(e){var t=e.left,n=e.right,r=e.top,i=e.bottom;return{left:t,right:1-n,top:r,bottom:1-i}}(e),r=m.a.settings.searchFaces.redSquareMargin,i=1-n.top-n.bottom,a=1-n.left-n.right,o=i/2,c=a/2,s={},u=1,l=0,p=0;if(t){var f=a<i,h=(1-2*r)/(f?i:a);u=Math.max(h,1);var d=a*u,b=i*u;l=(d-a)/2,p=(b-i)/2}var v=n.top-p,y=n.bottom-p,g=n.left-l,O=n.right-l,w=(v+y)/2,j=(g+O)/2,_=(j-g)/u,E=(w-v)/u,A=(n.top-o)/u+o,S=(o-n.bottom)/u-o,x=(n.left-c)/u+c,k=(c-n.right)/u-c,P=qe()(k,x,_),C=qe()(S,A,E);return s=t?{left:g+P*u,right:O-P*u,top:v+C*u,bottom:y-C*u}:{left:g,right:O,top:v,bottom:y},{scale:u,area:Ob(s),origin:{x:100*(n.left+a/2),y:100*(n.top+i/2)},translate:{x:100*P,y:100*C}}}function jb(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function _b(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Eb(e,t,n){var r,i,a,o,c,s,u,l,p,f,h,d,m,b,v,y,g,O;return regeneratorRuntime.async(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,regeneratorRuntime.awrap(Object(Bn.g)(e));case 2:return r=w.sent,i=document.createElement("canvas"),i.width=r.width,i.height=r.height,a=i.getContext("2d"),a.clearRect(0,0,i.width,i.height),o=wb(t[0],n),c=o.scale,s=o.area,u=o.origin,l=o.translate,p=l.x,f=l.y,h=Dt()(function(e){return Number(gb()(e,"%"))}),d=h(s),m=d.left,b=d.right,v=d.top,y=d.bottom,g=(u.x-p)/100*r.width,O=(u.y-f)/100*r.height,a.translate(g,O),a.scale(c,c),a.translate(-g,-O),a.drawImage(r,0,0,r.width,r.height,0,0,i.width,i.height),a.setTransform(1,0,0,1,0,0),a.beginPath(),a.lineWidth=2,a.strokeStyle="red",a.rect(i.width*(m/100),i.height*(v/100),i.width*((100-m-b)/100),i.height*((100-v-y)/100)),a.stroke(),a.save(),w.abrupt("return",i.toDataURL("image/png"));case 25:case"end":return w.stop()}})}function Ab(e,t){var n=e.reduce(function(e,n){var r=Object(ke.n)(n.timestamp,t),i=e[r]||{value:0};return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?jb(n,!0).forEach(function(t){_b(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):jb(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},e,_b({},r,{key:r,value:i.value+1}))},{});return Object.values(n)}function Sb(e,t,n){var r;return regeneratorRuntime.async(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,regeneratorRuntime.awrap(Promise.all(e.map(function(e){var r,i,a,o,c,s,u,l,p,f;return regeneratorRuntime.async(function(h){for(;;)switch(h.prev=h.next){case 0:if(h.prev=0,r=e.image,i=e.timestamp,a=e.plates,o=e.positions,c=e.heatmapImage,s=Object(ke.n)(i),u=a?"".concat(a.join(", "),"\n"):"",l={timestamp:i,image:r,description:"".concat(u).concat(s)},!o){h.next=9;break}return h.next=8,regeneratorRuntime.awrap(Eb(r,o,n));case 8:l.image=h.sent;case 9:if(!c){h.next=15;break}return h.next=12,regeneratorRuntime.awrap(Object(Bn.e)({layers:[r,c],opacity:t}));case 12:p=h.sent,f=URL.createObjectURL(p),l.image=f;case 15:return h.abrupt("return",l);case 18:return h.prev=18,h.t0=h.catch(0),h.abrupt("return",e);case 21:case"end":return h.stop()}},null,null,[[0,18]])})));case 2:return r=i.sent,i.abrupt("return",r.filter(Boolean).slice(0,60));case 4:case"end":return i.stop()}})}var xb=n(221),kb=n.n(xb),Pb=n(39);function Cb(e){return Cb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Cb(e)}function Tb(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Mb(e){return Mb=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Mb(e)}function Db(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ib(e,t){return Ib=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Ib(e,t)}function Rb(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Lb=function(e){function t(){var e,n,r,i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,o=new Array(a),c=0;c<a;c++)o[c]=arguments[c];return r=this,i=(e=Mb(t)).call.apply(e,[this].concat(o)),n=!i||"object"!==Cb(i)&&"function"!=typeof i?Db(r):i,Rb(Db(n),"state",{height:600,inProgress:!0}),Rb(Db(n),"instance",void 0),Rb(Db(n),"interval",void 0),Rb(Db(n),"ref",void 0),Rb(Db(n),"handleReady",function(){var e,t,r;return regeneratorRuntime.async(function(i){for(;;)switch(i.prev=i.next){case 0:return e=n.props,t=e.reportObject,r=e.data,n.instance=n.ref.contentWindow,i.next=4,regeneratorRuntime.awrap(n.instance.createViewer());case 4:return i.next=6,regeneratorRuntime.awrap(n.instance.loadReport(t,r));case 6:n.setState({inProgress:!1}),n.handleUpdateHeight(),n.interval=setInterval(n.handleUpdateHeight,1e3);case 9:case"end":return i.stop()}})}),Rb(Db(n),"handleUpdateHeight",function(){var e=n.instance.document.body.scrollHeight;n.setState({height:e<600?600:e})}),Rb(Db(n),"handleMessage",function(e){var t=e.message?"message":"data",r=e[t];"onReady"===r&&n.handleReady()}),Rb(Db(n),"handleRef",function(e){n.ref=e}),n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ib(e,t)}(t,e),n=t,r=[{key:"componentDidMount",value:function(){window.addEventListener("message",this.handleMessage,!1)}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.reportObject,r=t.data;!this.instance||n===e.reportObject&&r===e.data||(this.instance.showProcessIndicator(),this.instance.loadReport(n,r))}},{key:"componentWillUnmount",value:function(){window.removeEventListener("message",this.handleMessage,!1),this.interval&&clearInterval(this.interval)}},{key:"render",value:function(){var e=this.props.classes,t=this.state,n=t.inProgress,r=t.height;return s.a.createElement("div",{className:e.root},s.a.createElement("iframe",{className:e.root,style:{visibility:n?"hidden":"visible"},width:"100%",height:r,title:"Reports",ref:this.handleRef,src:Object(Pb.a)("reports/"),frameBorder:0,allowFullScreen:!0}),n&&s.a.createElement("div",{className:e.progress},s.a.createElement(kb.a,{size:50})))}}],r&&Tb(n.prototype,r),i&&Tb(n,i),t}(c.PureComponent),Nb=Object(y.d)(wd()(function(){return{root:{position:"relative",flexGrow:1,minHeight:"100%"},progress:{position:"absolute",left:0,right:0,top:0,bottom:0,display:"flex",justifyContent:"center",alignItems:"center",flexGrow:1}}}))(Lb);function zb(e){return zb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},zb(e)}function Fb(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function $b(e){return $b=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},$b(e)}function Hb(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Bb(e,t){return Bb=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Bb(e,t)}function Yb(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ub={1:function(){return n.e(6).then(n.bind(null,1633))},2:function(){return n.e(7).then(n.bind(null,1634))},3:function(){return n.e(8).then(n.bind(null,1635))},4:function(){return n.e(9).then(n.bind(null,1636))},5:function(){return n.e(10).then(n.bind(null,1637))}},Vb={results:function(e){var t=e.columns;return(Ub[t]||Ub[1])()},statisticsByHour:function(){return n.e(11).then(n.bind(null,1638))},statisticsByMinutes:function(){return n.e(12).then(n.bind(null,1639))}},Wb=[{title:s.a.createElement(Wp.a,{id:"searchReports.searchResults"}),icon:hb.a,name:"results"},{title:s.a.createElement(Wp.a,{id:"searchReports.countEvents.hour"}),icon:mb.a,name:"statisticsByHour"},{title:s.a.createElement(Wp.a,{id:"searchReports.countEvents.minutes"}),icon:vb.a,name:"statisticsByMinutes"}],qb=function(e){function t(e){var n,r,i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,i=$b(t).call(this,e),n=!i||"object"!==zb(i)&&"function"!=typeof i?Hb(r):i,Yb(Hb(n),"QUERY_TYPE_TITLE",void 0),Yb(Hb(n),"state",{inProgress:!0,error:null,data:null,reportObject:null,reportObjectName:"results"}),Yb(Hb(n),"handleSelectReport",function(e,t){var r=n.props.info;return Vb[e](t||r).then(function(t){n.setState({reportObject:t.default,reportObjectName:e})}).catch(function(e){console.error(e),n.setState({error:String(e)})})});var a=e.intl;return n.QUERY_TYPE_TITLE={zone:a.formatMessage({id:"searchConfiguratorType.zone"}),line:a.formatMessage({id:"searchConfiguratorType.line"}),transition:a.formatMessage({id:"searchConfiguratorType.transition"}),multiple:a.formatMessage({id:"searchConfiguratorType.multiple"}),loitering:a.formatMessage({id:"searchConfiguratorType.loitering"}),face:a.formatMessage({id:"searchConfiguratorType.face"}),auto:a.formatMessage({id:"searchConfiguratorType.auto"})},n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Bb(e,t)}(t,e),n=t,r=[{key:"componentWillReceiveProps",value:function(e){var t,n,r,i,a;return regeneratorRuntime.async(function(o){for(;;)switch(o.prev=o.next){case 0:if(t=this.props,n=t.open,r=t.results,i=t.info,a=e.open&&n!==e.open,!(a||n&&e.info!==i)){o.next=7;break}return this.setState({inProgress:!0}),o.next=6,regeneratorRuntime.awrap(this.handleSelectReport("results",e.info));case 6:this.setState({inProgress:!1});case 7:if(!(a||n&&e.results!==r)){o.next=10;break}return o.next=10,regeneratorRuntime.awrap(this.calculateSearchData(e.results,e.info));case 10:case"end":return o.stop()}},null,this)}},{key:"calculateSearchData",value:function(e,t){var n,r;return regeneratorRuntime.async(function(i){for(;;)switch(i.prev=i.next){case 0:return n=this.props.opacity,i.prev=1,this.setState({inProgress:!0}),i.next=5,regeneratorRuntime.awrap(Sb(e,n,t.zoomToArea));case 5:i.t0=i.sent,i.t1=Ab(e,"yyyy.mm.dd HH"),i.t2=Ab(e,"yyyy.mm.dd HH:mm"),i.t3={camName:t.camName,userName:t.userName,timeBegin:Object(ke.n)(t.time.begin),timeEnd:Object(ke.n)(t.time.end),query:this.QUERY_TYPE_TITLE[t.query]},r={results:i.t0,statisticsByHour:i.t1,statisticsByMinutes:i.t2,info:i.t3},this.setState({inProgress:!1,data:r}),i.next=17;break;case 13:i.prev=13,i.t4=i.catch(1),console.error(i.t4),this.setState({inProgress:!1,error:String(i.t4)});case 17:case"end":return i.stop()}},null,this,[[1,13]])}},{key:"renderContent",value:function(){var e=this,t=this.state,n=t.inProgress,r=t.error,i=t.reportObject,a=t.reportObjectName,o=t.data,c=this.props.classes;return r?s.a.createElement(rb.a,{color:"error"},r):i&&o&&!n?s.a.createElement("div",{className:c.report},s.a.createElement(ab.a,{className:c.reportMenu},Wb.map(function(t){var n=t.title,r=t.icon,i=t.name;return s.a.createElement(cb.a,{key:i,onClick:function(){return e.handleSelectReport(i)},selected:a===i},s.a.createElement(ub.a,null,s.a.createElement(r,null)),s.a.createElement(pb.a,{inset:!0,primary:n}))})),s.a.createElement(Nb,{reportObject:i,data:o})):s.a.createElement("div",{className:c.progress},s.a.createElement(tb.a,{size:50}))}},{key:"render",value:function(){var e=this.props,t=e.classes,n=e.open,r=e.onClose;return s.a.createElement(qm.a,{fullScreen:!0,open:n,onClose:r},s.a.createElement("div",{className:t.root},s.a.createElement(Rh.a,{className:t.exit,onClick:r},s.a.createElement(Jm.a,null)),s.a.createElement(Xm.a,null,s.a.createElement(Wp.a,{id:"searchReports.searchReports"})),s.a.createElement(Km.a,{className:t.content},this.renderContent())))}}],r&&Fb(n.prototype,r),i&&Fb(n,i),t}(c.PureComponent),Gb=Object(y.d)(wd()(function(e){return{root:{position:"relative",display:"flex",flexDirection:"column",height:"100%",minHeight:"100%"},content:{display:"flex",flexDirection:"column"},progress:{display:"flex",justifyContent:"center",alignItems:"center",flexGrow:1},exit:{position:"absolute",top:2*e.spacing.unit,right:3*e.spacing.unit},report:{display:"flex"},reportMenu:{marginRight:2*e.spacing.unit}}}),Wp.e)(qb),Xb=n(437),Zb=n.n(Xb),Kb=n(119),Qb=n.n(Kb),Jb=n(392),ev=n.n(Jb),tv=n(200),nv=n.n(tv),rv=n(536),iv=n.n(rv);function av(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,c=e[Symbol.iterator]();!(r=(o=c.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(i)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function ov(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function cv(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ov(n,!0).forEach(function(t){sv(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ov(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function sv(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var uv={default:1,maxZoom:2.5,minZoom:1,step:.5},lv=function(e){return{minWidth:2*e,height:6*e,padding:[[e/4,e/2]],boxShadow:"none"}};var pv=ev()(Object(O.withStyles)(function(e){return{zoomPanel:{position:"absolute",zIndex:1,marginTop:-12*e.spacing.unit,display:"flex",flexDirection:"column",transition:e.transitions.create(["left"]),boxShadow:e.shadows[3],top:18*e.spacing.unit},btnZoomIn:cv({},lv(e.spacing.unit),{borderRadius:[[0,e.spacing.unit/2,0,0]]}),btnZoomOut:cv({},lv(e.spacing.unit),{borderRadius:[[0,0,e.spacing.unit/2,0]]}),icon:{fontSize:2*e.spacing.unit}}}),_)(function(e){var t=e.width,n=e.classes,r=e.options,i=void 0===r?uv:r,a=e.onChange,o=Object(c.useState)(i.default),u=av(o,2),l=u[0],p=u[1];Object(c.useEffect)(function(){a(l)},[a,l]);var f=Object(c.useCallback)(function(){p(function(e){return Math.min(e+i.step,i.maxZoom)})},[i]),h=Object(c.useCallback)(function(){p(function(e){return Math.max(e-i.step,i.minZoom)})},[i]);return s.a.createElement("div",{className:n.zoomPanel,style:{left:t}},s.a.createElement(wf.a,{disableRipple:!0,size:"small",variant:"contained",className:n.btnZoomIn,disabled:l===i.maxZoom,onClick:f},s.a.createElement(nv.a,{className:n.icon})),s.a.createElement(wf.a,{disableRipple:!0,size:"small",variant:"contained",className:n.btnZoomOut,disabled:l===i.minZoom,onClick:h},s.a.createElement(iv.a,{className:n.icon})))});function fv(e){return fv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fv(e)}function hv(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function dv(e){return dv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},dv(e)}function mv(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function bv(e,t){return bv=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},bv(e,t)}function vv(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var yv=400,gv=Jr()(b.b,"aspect"),Ov=M()(L()("cells"),tt.a,Lc()("getDecoratorsHeight"),Qb()(1)),wv=function(e){function t(){var e,n,r,i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,o=new Array(a),c=0;c<a;c++)o[c]=arguments[c];return r=this,i=(e=dv(t)).call.apply(e,[this].concat(o)),n=!i||"object"!==fv(i)&&"function"!=typeof i?mv(r):i,vv(mv(n),"state",{zoom:uv.default,width:yv}),vv(mv(n),"camContainer",s.a.createRef()),vv(mv(n),"camContainer",s.a.createRef()),vv(mv(n),"handleZoomChange",function(e){n.setState({zoom:e})}),n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&bv(e,t)}(t,e),n=t,r=[{key:"componentDidMount",value:function(){var e=this.props.multiCam;this.camContainer.current.appendChild(e.element[0])}},{key:"render",value:function(){var e=this.props,t=e.children,n=e.camArchImageInfo,r=e.multiCam,i=this.state,a=i.width,o=i.zoom,c=gv(n),u=Ov(r),l=a/c+u,p={width:Math.round(a*o),height:Math.round(l*o)};return s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{ref:this.camContainer,className:"archsearch-container__camera",style:p},t),s.a.createElement(pv,{width:p.width,onChange:this.handleZoomChange}))}}],r&&hv(n.prototype,r),i&&hv(n,i),t}(c.PureComponent),jv=wv,_v=n(109),Ev=n.n(_v);function Av(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,c=e[Symbol.iterator]();!(r=(o=c.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(i)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var Sv=Object(O.withStyles)(function(){return{svgWrapper:{position:"absolute",top:0,left:0,width:"100%",height:"100%",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",zIndex:1}}})(function(e){var t=e.selectedResult,n=e.multiCam,r=e.viewport,i=e.classes,a=Av(n.element,1),o=a[0],c=o.getElementsByClassName("VideoCell__box"),l=Av(c,1),p=l[0];if(!t.positions||!p||!r)return null;var f=r.width,h=r.height,d=Ev()(t.positions);if(!d)return null;var m="".concat(100*d.left,"%"),b="".concat(100*d.top,"%"),v="".concat(100*(d.right-d.left),"%"),y="".concat(100*(d.bottom-d.top),"%");return Object(u.createPortal)(s.a.createElement("div",{className:i.svgWrapper},s.a.createElement("svg",{viewBox:"0 0 ".concat(f," ").concat(h)},s.a.createElement("rect",{x:m,y:b,height:y,width:v,fill:"transparent",stroke:"red",strokeWidth:"2"}))),p)}),xv=n(167),kv=n.n(xv),Pv=n(396),Cv=n.n(Pv);var Tv=function(e,t){var n=t.width,r=t.height;return[e[0]*n,e[1]*r]},Mv=function(e,t){var n=t.width,r=t.height;return[e[0]/n,e[1]/r]},Dv=function(e,t){return e.map(function(e){return e.map(function(e){return Tv(e,t)})})};var Iv=L()(0),Rv=L()(1),Lv=M()([z()(Iv),Cv.a]),Nv=M()([z()(Iv),kv.a]),zv=M()([z()(Rv),Cv.a]),Fv=M()([z()(Rv),kv.a]),$v=function(e){return{minX:Lv(e),maxX:Nv(e),minY:zv(e),maxY:Fv(e)}},Hv=function(e){var t=$v(e),n=t.minX,r=t.maxX,i=t.minY,a=t.maxY;return[n+(r-n)/2,i+(a-i)/2]},Bv=function(e,t){return[(Iv(e)+Iv(t))/2,(Rv(e)+Rv(t))/2]},Yv={line:[[[.5,.2],[.5,.8]]],zone:[[[.3,.3],[.7,.3],[.7,.7],[.3,.7]]],loitering:[[[.3,.3],[.7,.3],[.7,.7],[.3,.7]]],multiple:[[[.3,.3],[.7,.3],[.7,.7],[.3,.7]]],transition:[[[.2,.4],[.4,.4],[.4,.6],[.2,.6]],[[.6,.4],[.8,.4],[.8,.6],[.6,.6]]],face:[],auto:[]},Uv={line:["left","right"],transition:["right"]};n(662);function Vv(e){return Vv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Vv(e)}function Wv(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,c=e[Symbol.iterator]();!(r=(o=c.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(i)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function qv(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Gv(e){return Gv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Gv(e)}function Xv(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Zv(e,t){return Zv=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Zv(e,t)}function Kv(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Qv=50,Jv=!0,ey=function(e){function t(){var e,n,r,i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,o=new Array(a),c=0;c<a;c++)o[c]=arguments[c];return r=this,i=(e=Gv(t)).call.apply(e,[this].concat(o)),n=!i||"object"!==Vv(i)&&"function"!=typeof i?Xv(r):i,Kv(Xv(n),"state",{dragInitialX:null,dragInitialY:null,shapeIndex:null,pointIndex:null,shapePoint:null,minDX:null,maxDX:null,minDY:null,maxDY:null,dragInitialShapes:[]}),Kv(Xv(n),"handleMouseDown",function(e,t){return function(r){var i=r.clientX,a=r.clientY,o=r.button,c=n.props,s=c.figures,u=c.viewport;if(0===o){var l=u.width,p=u.height,f=void 0!==t,h=Dv(s,u),d=f?[h[e][t]]:h[e],m=$v(d),b=m.minX,v=m.maxX,y=m.minY,g=m.maxY,O=-b,w=l-v,j=-y,_=p-g;n.setState({dragInitialX:i,dragInitialY:a,shapeIndex:e,pointIndex:t,shapePoint:f?s[e][t]:null,minDX:O,maxDX:w,minDY:j,maxDY:_,dragInitialShapes:s}),document.addEventListener("mousemove",n.handleMove,Jv),document.addEventListener("mouseup",n.handleStopMove,Jv)}}}),Kv(Xv(n),"handleDivide",function(e,t,r){return function(i){var a=n.props,o=a.figures,c=a.setFigures,s=Ke()(e,function(e){return e.splice(r+1,0,t),e},o);c(s),n.handleMouseDown(e,r+1)(i)}}),Kv(Xv(n),"handleStopMove",function(){document.removeEventListener("mousemove",n.handleMove,Jv),document.removeEventListener("mouseup",n.handleStopMove,Jv)}),Kv(Xv(n),"handleMove",function(e){var t=e.clientX,r=e.clientY,i=n.state,a=i.dragInitialX,o=i.dragInitialY,c=i.shapeIndex,s=i.pointIndex,u=i.shapePoint,l=i.minDX,p=i.maxDX,f=i.minDY,h=i.maxDY,d=i.dragInitialShapes,m=n.props,b=m.viewport,v=m.setFigures,y=nm()(t-a,l,p),g=nm()(r-o,f,h),O=d.slice();if(u){var w=Tv(u,b);O[c][s]=Mv([w[0]+y,w[1]+g],b)}else{var j=O[c].map(function(e){return Tv(e,b)});O[c]=j.map(function(e){return Mv([e[0]+y,e[1]+g],b)})}v(O)}),Kv(Xv(n),"toggleDirection",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Uv.line;return function(){var t=n.props,r=t.direction,i=t.setDirection,a=[].concat(e);i(Je()(r,a))}}),Kv(Xv(n),"handleDelete",function(e,t){return function(r){var i=n.props,a=i.figures,o=i.setFigures,c=L()(e,a);c.length>3&&o(Ke()(e,function(e){return e.splice(t,1),e},a)),r.preventDefault()}}),Kv(Xv(n),"renderResizer",function(e,t){var r=n.props,i=r.figures,a=r.viewport,o=Tv(i[e][t],a),c=Wv(o,2),u=c[0],l=c[1];return s.a.createElement("g",{key:"".concat(e,"_").concat(t),className:"editable-mask__resizer",onMouseDownCapture:n.handleMouseDown(e,t),onContextMenuCapture:n.handleDelete(e,t)},s.a.createElement("pattern",{id:"resizer",viewBox:"0 0 10 10",width:"1",height:"1"},s.a.createElement("marker",{id:"resizerArrowStart",viewBox:"0 0 2 3",refX:"1",refY:"1.5",markerUnits:"strokeWidth",markerWidth:"2",markerHeight:"3",orient:"auto"},s.a.createElement("path",{d:"M 2 0 L 0 1.5 L 2 3z",className:"editable-mask__resizer-icon-marker"})),s.a.createElement("marker",{id:"resizerArrowEnd",viewBox:"0 0 2 3",refX:"1",refY:"1.5",markerUnits:"strokeWidth",markerWidth:"2",markerHeight:"3",orient:"auto"},s.a.createElement("path",{d:"M 0 0 L 2 1.5 L 0 3z",className:"editable-mask__resizer-icon-marker"})),s.a.createElement("rect",{x:"0",y:"0",width:"10",height:"10",className:"editable-mask__control"}),s.a.createElement("line",{x1:"2",y1:"2",x2:"8",y2:"8",className:"editable-mask__resizer-icon-path",markerStart:"url(#resizerArrowStart)",markerEnd:"url(#resizerArrowEnd)"}),s.a.createElement("line",{x1:"8",y1:"2",x2:"2",y2:"8",className:"editable-mask__resizer-icon-path",markerStart:"url(#resizerArrowStart)",markerEnd:"url(#resizerArrowEnd)"})),s.a.createElement("rect",{x:u-7,y:l-7,width:"14",height:"14",fill:"url(#resizer)"}))}),Kv(Xv(n),"renderDivider",function(e,t){var r=n.props,i=r.figures,a=r.viewport,o=L()(e,i),c=t===o.length-1,u=o[t],l=o[c?0:t+1];if(!l)return null;var p=[u[0]+(l[0]-u[0])/2,u[1]+(l[1]-u[1])/2],f=Tv(p,a),h=Wv(f,2),d=h[0],m=h[1];return s.a.createElement("g",{key:"".concat(e,"_").concat(t,"_").concat(t+1),onMouseDownCapture:n.handleDivide(e,p,t),className:"editable-mask__divider"},s.a.createElement("pattern",{id:"divider",viewBox:"0 0 10 10",width:"1",height:"1"},s.a.createElement("circle",{cx:5,cy:5,r:5,className:"editable-mask__control"}),s.a.createElement("path",{d:"M 3 3 L 7 7 M 7 3 L 3 7",className:"editable-mask__divider-icon"})),s.a.createElement("circle",{cx:d,cy:m,r:"6",fill:"url(#divider)"}))}),Kv(Xv(n),"renderShape",function(e,t){var r=n.props.viewport,i=e.length>2,a=i?"polygon":"polyline",o=e.map(function(e){return String(Tv(e,r))}).join(" ");return s.a.createElement("g",{key:t,onMouseDownCapture:n.handleMouseDown(t),className:"editable-mask__shape"},s.a.createElement(a,{points:o,className:"editable-mask__path"}),s.a.createElement(a,{points:o,className:"editable-mask__path-pattern"}),e.map(function(e,r){return n.renderResizer(t,r)}),i&&e.map(function(e,r){return n.renderDivider(t,r)}))}),Kv(Xv(n),"renderTransitionLine",function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:["right"],i="right"===r[0]?e:t,a="right"===r[0]?t:e;return s.a.createElement("g",null,s.a.createElement("marker",{id:"arrow",viewBox:"0 0 10 10",refX:"10",refY:"5",markerUnits:"strokeWidth",markerWidth:"10",markerHeight:"5",orient:"auto"},s.a.createElement("path",{d:"M 0 0 L 10 5 L 0 10",className:"editable-mask__path"}),s.a.createElement("path",{d:"M 0 0 L 10 5 L 0 10",className:"editable-mask__path-pattern"})),s.a.createElement("line",{x1:i[0],y1:i[1],x2:a[0],y2:a[1],className:"editable-mask__path",markerEnd:"url(#arrow)"}),s.a.createElement("line",{x1:i[0],y1:i[1],x2:a[0],y2:a[1],className:"editable-mask__path-pattern",markerEnd:"url(#arrow)"}),s.a.createElement("circle",{cx:i[0],cy:i[1],r:7,className:"editable-mask__direction-checkbox",onMouseUpCapture:n.toggleDirection()}))}),Kv(Xv(n),"renderCrossLineArrow",function(e,t,r){var i=n.props.direction,a=Bv(e,t),o=V()(r,i);return s.a.createElement("g",{opacity:o?1:.5},s.a.createElement("marker",{id:"arrow",viewBox:"0 0 10 10",refX:"10",refY:"5",markerUnits:"strokeWidth",markerWidth:"10",markerHeight:"5",orient:"auto"},s.a.createElement("path",{d:"M 0 0 L 10 5 L 0 10",className:"editable-mask__path"}),s.a.createElement("path",{d:"M 0 0 L 10 5 L 0 10",className:"editable-mask__path-pattern"})),s.a.createElement("line",{x1:e[0],y1:e[1],x2:t[0],y2:t[1],className:"editable-mask__path",markerEnd:"url(#arrow)"}),s.a.createElement("line",{x1:e[0],y1:e[1],x2:t[0],y2:t[1],className:"editable-mask__path-pattern",markerEnd:"url(#arrow)"}),s.a.createElement("circle",{cx:a[0],cy:a[1],r:6,className:"editable-mask__direction-checkbox",onMouseUpCapture:n.toggleDirection(r)}))}),Kv(Xv(n),"renderPolygonTransition",function(){var e=n.props,t=e.direction,r=e.figures,i=e.viewport,a=Dv(r,i),o=Wv(a,2),c=o[0],s=o[1],u=Hv(c),l=Hv(s);return n.renderTransitionLine(u,l,t)}),Kv(Xv(n),"renderCrossLineTransition",function(){var e=n.props,t=e.figures,r=e.viewport,i=Dv(t,r),a=Wv(i,1),o=Wv(a[0],2),c=Wv(o[0],2),u=c[0],l=c[1],p=Wv(o[1],2),f=p[0],h=p[1],d=(u+f)/2,m=(l+h)/2,b=Math.atan2(h-l,f-u),v=[10*-Math.sin(b)+d,10*Math.cos(b)+m],y=[-Math.sin(b)*Qv+v[0],Math.cos(b)*Qv+v[1]],g=[10*Math.sin(b)+d,10*-Math.cos(b)+m],O=[Math.sin(b)*Qv+g[0],-Math.cos(b)*Qv+g[1]];return s.a.createElement("g",null,n.renderCrossLineArrow(v,y,"left"),n.renderCrossLineArrow(g,O,"right"))}),n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Zv(e,t)}(t,e),n=t,r=[{key:"componentDidMount",value:function(){this.componentDidUpdate({})}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.queryType,r=t.setDirection,i=t.setFigures;if(n!==e.queryType){var a=L()(n,Uv),o=Jr()([],n,Yv);i(o),r(a)}}},{key:"componentWillUnmount",value:function(){var e=this.props,t=e.setDirection,n=e.setFigures;n(void 0),t(void 0)}},{key:"render",value:function(){var e=this.props,t=e.figures,n=e.queryType,r=e.viewport,i=void 0===r?{}:r,a=i.width,o=i.height,c="line"===n,u="transition"===n,l=a&&o&&t;return s.a.createElement("svg",{width:"100%",height:"100%",viewBox:"0 0 ".concat(a," ").concat(o)},l&&s.a.createElement("g",null,t.map(this.renderShape),u&&this.renderPolygonTransition(),c&&this.renderCrossLineTransition()))}}],r&&qv(n.prototype,r),i&&qv(n,i),t}(c.Component),ty=ey;function ny(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,c=e[Symbol.iterator]();!(r=(o=c.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(i)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function ry(e){e.stopPropagation(),e.preventDefault()}var iy=Ym({direction:["queryProperties","direction"],figures:["figures"],queryType:["queryType"]})(function(e){var t=e.queryType,n=ny(e.multiCam.element,1),r=n[0],i=s.a.useRef(),a=r.getElementsByClassName("VideoCell__box"),o=ny(a,1),c=o[0],l=c&&t;return s.a.useEffect(function(){if(i.current){var e=i.current;return e.addEventListener("click",ry),function(){return e.removeEventListener("click",ry)}}return Ic.a},[]),l?Object(u.createPortal)(s.a.createElement("div",{ref:i,className:"archsearch-container__mask"},s.a.createElement(ty,e)),c):null}),ay=n(434),oy=n.n(ay),cy=n(435),sy=n.n(cy),uy=n(96),ly=n.n(uy),py=n(41),fy=n.n(py),hy=n(155),dy=n.n(hy),my=(n(663),n(222)),by=n.n(my),vy=n(142),yy=n.n(vy),gy=n(537),Oy=n.n(gy),wy=n(538),jy=n.n(wy),_y=n(64),Ey=n.n(_y),Ay=Ym({count:["conditions","count"]})(function(e){var t=e.count,n=void 0===t?3:t,r=e.setCount,i=c.useCallback(function(e){var t=e.target.value,n=qe()(0,99,Number(t));r(n)},[r]);return c.useEffect(function(){r(n)},[]),c.createElement("div",{className:"search-form"},c.createElement("div",{className:"search-form__field"},c.createElement(Ey.a,{label:c.createElement(Wp.a,{id:"searchCountForm"}),value:n,type:"number",onChange:i})))}),Sy=Ym({duration:["conditions","duration"]})(function(e){var t=e.duration,n=void 0===t?1:t,r=e.setDuration,i=c.useCallback(function(e){var t=e.target.value,n=qe()(0,3599,Number(t));r(n)},[r]);return c.useEffect(function(){r(n)},[n,r]),c.createElement("div",{className:"search-form"},c.createElement("div",{className:"search-form__field"},c.createElement(Ey.a,{label:c.createElement(Wp.a,{id:"searchDurationForm"}),value:n,type:"number",onChange:i})))}),xy=n(194),ky=n.n(xy),Py=n(188),Cy=n.n(Py);function Ty(e){return Ty="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ty(e)}function My(){return My=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},My.apply(this,arguments)}function Dy(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Iy(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ry(e){return Ry=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Ry(e)}function Ly(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ny(e,t){return Ny=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Ny(e,t)}function zy(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Fy(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,c=e[Symbol.iterator]();!(r=(o=c.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(i)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var $y=.01,Hy=1,By={width:[$y,Hy],height:[$y,Hy]},Yy=.01,Uy=function(e){return Cy()(e,2)};function Vy(e){var t=e.classes,n=e.dim,r=e.onChange,i=e.type,a=Fy(e.value,2),o=a[0],s=a[1],u=c.useCallback(function(e){var t=e.currentTarget.value;return r(n,t)},[r,n]),l="min"===i?o:s;return c.createElement("div",{className:"search-form__field"},c.createElement(Ey.a,{className:t.textField,label:c.createElement(Wp.a,{id:"searchSizeForm.".concat(i).concat(C()(n))}),value:l,type:"range",inputProps:{min:$y,max:Hy,step:Yy},onChange:u}),c.createElement("span",{className:t.valueSize},l))}var Wy=function(e){function t(){var e,n,r,i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,o=new Array(a),c=0;c<a;c++)o[c]=arguments[c];return r=this,i=(e=Ry(t)).call.apply(e,[this].concat(o)),n=!i||"object"!==Ty(i)&&"function"!=typeof i?Ly(r):i,zy(Ly(n),"onChange",function(e,t){var r=n.props,i=r.setSize,a=r.size,o=r.type,c=Fy(a[e],2),s=c[0],u=c[1],l=Number(t),p="min"===o?l:Math.min(l,s),f="max"===o?l:Math.max(l,u),h=zy({},e,[Uy(Math.min(p,Hy-Yy)),Uy(Math.max(f,$y+Yy))]);i(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Dy(n,!0).forEach(function(t){zy(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Dy(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},a,{},h))}),n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ny(e,t)}(t,e),n=t,r=[{key:"componentDidMount",value:function(){var e=this.props,t=e.setSize,n=e.size;ky()(n)&&t(By)}},{key:"render",value:function(){var e=this.props,t=e.type,n=e.classes,r=e.size,i=void 0===r?{}:r,a=this.onChange;return c.createElement("div",{className:"search-form"},Object.entries(i).map(function(e){var r=Fy(e,2),i=r[0],o=r[1];return c.createElement(Vy,My({key:i},{classes:n,dim:i,onChange:a,type:t,value:o}))}))}}],r&&Iy(n.prototype,r),i&&Iy(n,i),t}(c.Component),qy=Object(O.withStyles)(function(e){return{textField:{paddingTop:e.spacing.unit,maxWidth:"70%"},valueSize:{paddingLeft:e.spacing.unit,verticalAlign:"bottom"}}})(Wy);function Gy(){return Gy=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Gy.apply(this,arguments)}var Xy=Ym({size:["objectProperties","size"]})(function(e){return c.createElement(qy,Gy({type:"max"},e))});function Zy(){return Zy=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Zy.apply(this,arguments)}var Ky=Ym({size:["objectProperties","size"]})(function(e){return c.createElement(qy,Zy({type:"min"},e))}),Qy=n(196),Jy=n.n(Qy);n(666);function eg(e){return eg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},eg(e)}function tg(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function ng(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function rg(e){return rg=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},rg(e)}function ig(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ag(e,t){return ag=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},ag(e,t)}function og(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function cg(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,c=e[Symbol.iterator]();!(r=(o=c.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(i)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var sg=[0,1],ug={hue:sg,saturation:sg,brightness:sg},lg=function(e){var t=e.left,n=void 0===t?0:t,r=e.right,i=void 0===r?0:r,a=e.top,o=void 0===a?0:a,c=e.bottom,s=void 0===c?0:c;return{hue:[n/100*360,(100-i)/100*360],saturation:[o/100,(100-s)/100]}},pg=function(e){var t=e.top,n=void 0===t?0:t,r=e.bottom,i=void 0===r?0:r;return{brightness:[n/100,(100-i)/100]}},fg=function(e){function t(){var e,n,r,i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,o=new Array(a),c=0;c<a;c++)o[c]=arguments[c];return r=this,i=(e=rg(t)).call.apply(e,[this].concat(o)),n=!i||"object"!==eg(i)&&"function"!=typeof i?ig(r):i,og(ig(n),"dragInitialX",void 0),og(ig(n),"dragInitialY",void 0),og(ig(n),"minDX",void 0),og(ig(n),"maxDX",void 0),og(ig(n),"minDY",void 0),og(ig(n),"maxDY",void 0),og(ig(n),"width",void 0),og(ig(n),"height",void 0),og(ig(n),"handleChange",function(){var e=n.props,t=e.value,r=e.onChange,i=ig(n),a=i.colorRange,o=void 0===a?{}:a,c=i.brightnessRange,s=void 0===c?{}:c;r(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?tg(n,!0).forEach(function(t){og(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):tg(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},t,{},lg(o),{},pg(s)))}),og(ig(n),"handleMouseDown",function(e){return function(t){var r=t.clientX,i=t.clientY,a=t.currentTarget.getBoundingClientRect(),o=a.left,c=a.top,s=a.width,u=a.height;n.minDY=(i-c)/u*100,n.maxDY=100-n.minDY,n.minDX=(r-o)/s*100,n.maxDX=100-n.minDX,n.width=s,n.height=u,n.dragInitialX=r,n.dragInitialY=i,n[e]=void 0;var l=n.handleMouseMove(e);document.addEventListener("mousemove",l),document.addEventListener("mouseup",function e(){document.removeEventListener("mousemove",l),document.removeEventListener("mouseup",e),n.handleChange()}),t.stopPropagation(),t.preventDefault()}}),og(ig(n),"handleMouseMove",function(e){return function(t){var r=t.clientX,i=t.clientY,a=ig(n),o=a.dragInitialX,c=a.dragInitialY,s=a.minDX,u=a.maxDX,l=a.minDY,p=a.maxDY,f=a.width,h=a.height;if(!o)throw new Error("dragInitialX is not defined");if(!c)throw new Error("dragInitialY is not defined");if(!f)throw new Error("width is not defined");if(!s)throw new Error("minDX is not defined");if(!h)throw new Error("height is not defined");if(!l)throw new Error("minDY is not defined");var d=nm()((r-o)/f*100,-s,u),m=nm()((i-c)/h*100,-l,p),b=d>0?s:s+d,v=100-(d>0?s+d:s),y=m>0?l:l+m,g=100-(m>0?l+m:l);n[e]={left:b,right:v,top:y,bottom:g},n.throttledChange()}}),og(ig(n),"throttledChange",Jy()(ke.c,n.handleChange)),n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ag(e,t)}(t,e),n=t,r=[{key:"componentDidMount",value:function(){var e=this.props,t=e.value,n=e.onChange;t||n(ug)}},{key:"render",value:function(){var e=this.props.value,t=void 0===e?{}:e,n=function(e){var t=e.hue;t=void 0===t?sg:t;var n=cg(t,2),r=n[0],i=n[1],a=e.saturation;a=void 0===a?sg:a;var o=cg(a,2),c=o[0],s=o[1];return{left:100*r/360,right:100-100*i/360,top:100*c,bottom:100-100*s}}(t),r=function(e){var t=e.brightness;t=void 0===t?sg:t;var n=cg(t,2),r=n[0],i=n[1];return{top:100*r,bottom:100-100*i}}(t);return s.a.createElement("div",{className:"color-range-picker"},s.a.createElement("div",{className:"color-range-picker__color",onMouseDown:this.handleMouseDown("colorRange")},s.a.createElement("div",{className:"color-range-picker__color_palette"}),n&&s.a.createElement("div",{className:"color-range-picker__color__range",style:{left:"".concat(n.left,"%"),right:"".concat(n.right,"%"),top:"".concat(n.top,"%"),bottom:"".concat(n.bottom,"%")}})),s.a.createElement("div",{className:"color-range-picker__brightness",onMouseDown:this.handleMouseDown("brightnessRange")},r&&s.a.createElement("div",{className:"color-range-picker__brightness__range",style:{top:"".concat(r.top,"%"),bottom:"".concat(r.bottom,"%")}})))}}],r&&ng(n.prototype,r),i&&ng(n,i),t}(s.a.Component),hg=fg;var dg=Ym({color:["objectProperties","color"]})(function(e){var t=e.color,n=e.setColor;return c.createElement("div",{className:"search-form"},c.createElement(hg,{onChange:n,value:t}))}),mg=n(211),bg=n.n(mg),vg=n(61),yg=n.n(vg),gg=n(351),Og=n.n(gg);function wg(e){return wg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},wg(e)}function jg(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function _g(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Eg(e){return Eg=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Eg(e)}function Ag(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Sg(e,t){return Sg=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Sg(e,t)}function xg(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var kg=["human","group","vehicle"],Pg=[].concat(kg,["abandoned"]),Cg=[],Tg=function(e){function t(){var e,n,r,i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];return r=this,i=(e=Eg(t)).call.apply(e,[this].concat(o)),n=!i||"object"!==wg(i)&&"function"!=typeof i?Ag(r):i,xg(Ag(n),"onChange",function(e){var t=n.props.setCategory;t(e)}),xg(Ag(n),"handleChange",function(e){var t=n.props.category,r=e.target,i=r.value,a=r.checked;n.onChange(a?[].concat(jg(t),[i]):t.filter(function(e){return e!==i}))}),xg(Ag(n),"renderItem",function(e){var t=n.props.category,r=t.includes(e);return c.createElement(kh.a,{key:e,control:c.createElement(Zf.a,{color:"primary",checked:r,onChange:n.handleChange,value:e}),label:c.createElement(Wp.a,{id:"searchObjectTypeForm.categoryOptions.".concat(e)})})}),n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Sg(e,t)}(t,e),n=t,r=[{key:"componentDidMount",value:function(){var e=this.props,t=e.setCategory,n=e.category;n||t(Cg)}},{key:"render",value:function(){var e=this.props.onlyMoving,t=e?kg:Pg;return c.createElement("div",{className:"search-form"},c.createElement(yg.a,{component:"fieldset"},c.createElement(bg.a,{component:"legend"},c.createElement(Wp.a,{id:"searchObjectTypeForm.category"})),c.createElement(Og.a,null,t.map(this.renderItem))))}}],r&&_g(n.prototype,r),i&&_g(n,i),t}(c.Component);xg(Tg,"defaultProps",{onlyMoving:!1,category:Cg});var Mg=Ym({category:["objectProperties","category"]})(Tg),Dg=n(317),Ig=n.n(Dg),Rg=n(387),Lg=n.n(Rg);function Ng(e){return Ng="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ng(e)}function zg(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Fg(e){return Fg=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Fg(e)}function $g(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Hg(e,t){return Hg=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Hg(e,t)}var Bg=function(e){function t(){var e,n,r,i,a,o,c;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var s=arguments.length,u=new Array(s),l=0;l<s;l++)u[l]=arguments[l];return r=this,i=(e=Fg(t)).call.apply(e,[this].concat(u)),n=!i||"object"!==Ng(i)&&"function"!=typeof i?$g(r):i,a=$g(n),o="handleChange",c=function(e){var t=e.currentTarget.value,r=n.props.setEnterExit;r(t)},o in a?Object.defineProperty(a,o,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[o]=c,n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Hg(e,t)}(t,e),n=t,r=[{key:"componentDidMount",value:function(){var e=this.props,t=e.setEnterExit,n=e.enterExit;n||t("enter")}},{key:"render",value:function(){var e=this.props.enterExit;return c.createElement("div",{className:"search-form"},c.createElement(yg.a,{component:"fieldset"},c.createElement(Lg.a,{name:"enterExit",value:e,onChange:this.handleChange},c.createElement(kh.a,{value:"enter",control:c.createElement(Ig.a,{color:"primary"}),label:c.createElement(Wp.a,{id:"searchEnterExitForm.enter"})}),c.createElement(kh.a,{value:"exit",control:c.createElement(Ig.a,{color:"primary"}),label:c.createElement(Wp.a,{id:"searchEnterExitForm.exit"})}))))}}],r&&zg(n.prototype,r),i&&zg(n,i),t}(c.Component),Yg=Ym({enterExit:["queryProperties","action"]})(Bg),Ug=n(539),Vg=n.n(Ug);n(667);function Wg(e){return Wg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Wg(e)}function qg(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Gg(e){return Gg=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Gg(e)}function Xg(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Zg(e,t){return Zg=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Zg(e,t)}function Kg(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Qg(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,c=e[Symbol.iterator]();!(r=(o=c.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(i)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var Jg=8,eO=Vg()(q.a),tO=M()(f.a,q()(1)),nO=function(e){for(var t=360/e,n=360-t/2,r=[],i=0;i<e;i+=1)r.push([(n+i*t)%360,(n+(i+1)*t)%360]);return r},rO=function(e,t,n,r){var i=r*Math.PI/180;return{x:e+n*Math.cos(i),y:t+n*Math.sin(i)}},iO=function(e,t){var n=Qg(e,2),r=n[0],i=n[1],a=t/2,o=t/6,c=t/2,s=t/2,u=i-r<=180?"0":"1",l=rO(c,s,a,i),p=rO(c,s,a,r),f=rO(c,s,o,i),h=rO(c,s,o,r),d=["M",l.x,l.y,"A",a,a,0,u,0,p.x,p.y,"L",h.x,h.y,"A",o,o,0,u,1,f.x,f.y,"Z"].join(" ");return d};function aO(e){var t=e.size,n=t/2,r=t/2,i=t/2;return s.a.createElement("g",{className:"directions-picker__gradient"},s.a.createElement("defs",null,s.a.createElement("linearGradient",{id:"gradient",gradientTransform:"rotate(45)"},s.a.createElement("stop",{offset:"0%",stopColor:"black",stopOpacity:"0"}),s.a.createElement("stop",{offset:"100%",stopColor:"black",stopOpacity:"0.3"}))),s.a.createElement("circle",{cx:n,cy:r,r:i,fill:"url(#gradient)"}))}var oO=function(e){function t(){var e,n,r,i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,o=new Array(a),c=0;c<a;c++)o[c]=arguments[c];return r=this,i=(e=Gg(t)).call.apply(e,[this].concat(o)),n=!i||"object"!==Wg(i)&&"function"!=typeof i?Xg(r):i,Kg(Xg(n),"handleToggleSection",hm()(function(e){return function(){var t=n.props,r=t.directions,i=t.onChange;i(eO(r,[e]))}})),Kg(Xg(n),"renderSection",function(e,t){var r=n.props,i=r.size,a=r.directions,o=void 0===a?[]:a,c=iO(e,i),u=V()(e,o),l=u&&tO(o),p=l?void 0:n.handleToggleSection(e);return s.a.createElement("path",{key:t,d:c,className:Ff()("directions-picker__section",{"directions-picker__section_selected":u}),onClick:p})}),Kg(Xg(n),"sections",nO(Jg)),n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Zg(e,t)}(t,e),n=t,r=[{key:"componentDidMount",value:function(){var e=this.props,t=e.directions,n=e.onChange;t||n(this.sections)}},{key:"render",value:function(){var e=this.props.size,t=this.sections;return s.a.createElement("div",{className:"directions-picker",style:{width:e,height:e}},s.a.createElement("svg",{viewBox:"0 0 ".concat(e," ").concat(e)},t.map(this.renderSection),s.a.createElement(aO,{size:e})),s.a.createElement("div",{className:"directions-picker__arrows"},s.a.createElement("div",{className:"directions-picker__arrow_left"}),s.a.createElement("div",{className:"directions-picker__arrow_right"}),s.a.createElement("div",{className:"directions-picker__arrow_top"}),s.a.createElement("div",{className:"directions-picker__arrow_bottom"})))}}],r&&qg(n.prototype,r),i&&qg(n,i),t}(s.a.Component);Kg(oO,"defaultProps",{size:150});var cO=oO;var sO=Ym({directions:["conditions","directions"]})(function(e){var t=e.directions,n=e.setDirections;return c.createElement("div",{className:"search-form"},c.createElement(bg.a,{className:"search-form__field-label"},c.createElement(Wp.a,{id:"searchDirectionForm"})),c.createElement(cO,{onChange:n,directions:t}))});function uO(e){return uO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},uO(e)}function lO(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,c=e[Symbol.iterator]();!(r=(o=c.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(i)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function pO(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function fO(e){return fO=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},fO(e)}function hO(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function dO(e,t){return dO=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},dO(e,t)}function mO(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var bO=.01,vO=[.01,1],yO=function(e){function t(){var e,n,r,i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,o=new Array(a),c=0;c<a;c++)o[c]=arguments[c];return r=this,i=(e=fO(t)).call.apply(e,[this].concat(o)),n=!i||"object"!==uO(i)&&"function"!=typeof i?hO(r):i,mO(hO(n),"handleChange",function(e){var t=n.props,r=t.type,i=t.speed,a=Number(e.target.value),o=lO(i,2),c=o[0],s=o[1],u="min"===r?a:Math.min(c,s-bO),l="max"===r?a:Math.max(s,c+bO);n.onChange([u,l])}),n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&dO(e,t)}(t,e),n=t,r=[{key:"componentDidMount",value:function(){var e=this.props.speed;e||this.onChange(vO)}},{key:"onChange",value:function(e){var t=this.props.setSpeed;t(e)}},{key:"render",value:function(){var e=this.props,t=e.type,n=e.speed,r=lO(n,2),i=r[0],a=r[1];return c.createElement("div",{className:"search-form"},c.createElement("div",{className:"search-form__field"},c.createElement(Ey.a,{label:c.createElement(Wp.a,{id:"searchSpeedForm.".concat(t)}),value:"min"===t?i:a,type:"number",onChange:this.handleChange,inputProps:{step:bO,min:.01,max:1}})))}}],r&&pO(n.prototype,r),i&&pO(n,i),t}(c.Component);mO(yO,"defaultProps",{type:"min",speed:vO});var gO=yO;function OO(){return OO=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},OO.apply(this,arguments)}var wO=Ym({speed:["objectProperties","conditions","speed"]})(function(e){return c.createElement(gO,OO({type:"min"},e))});function jO(){return jO=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},jO.apply(this,arguments)}var _O=Ym({speed:["objectProperties","conditions","speed"]})(function(e){return c.createElement(gO,jO({type:"max"},e))});n(668);function EO(e){return EO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},EO(e)}function AO(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function SO(e){return SO=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},SO(e)}function xO(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function kO(e,t){return kO=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},kO(e,t)}function PO(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var CO=10*ke.h,TO=(new Date(CO),function(e){function t(){var e,n,r,i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,o=new Array(a),c=0;c<a;c++)o[c]=arguments[c];return r=this,i=(e=SO(t)).call.apply(e,[this].concat(o)),n=!i||"object"!==EO(i)&&"function"!=typeof i?xO(r):i,PO(xO(n),"minutesRef",s.a.createRef()),PO(xO(n),"secondsRef",s.a.createRef()),PO(xO(n),"handleChange",function(){var e=n.props.setIntrvl;e(n.getFormTime())}),PO(xO(n),"toggleUserInt",function(e){var t=e.currentTarget.checked,r=n.props.setIntrvl;r(t?n.getFormTime():void 0)}),n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&kO(e,t)}(t,e),n=t,r=[{key:"componentWillUnmount",value:function(){var e=this.props.setIntrvl;e(void 0)}},{key:"getFormTime",value:function(){var e=Number(this.minutesRef.current.value),t=Number(this.secondsRef.current.value),n=new Date(Math.max(CO,e*ke.f+t*ke.h));return n}},{key:"render",value:function(){var e=this.props,t=e.classes,n=e.intrvl,r=e.preferences.searchDefaultInterval,i=Boolean(n),a=n||new Date(r),o=a.getMinutes(),c=a.getSeconds();return s.a.createElement(Jp.a,{classes:{container:t.container},container:!0,direction:"column",justify:"center",alignItems:"center"},s.a.createElement(Jp.a,{container:!0,justify:"space-between",alignItems:"center"},s.a.createElement(sf.a,null,s.a.createElement(Wp.a,{id:"searchIntervalIsCustom"})),s.a.createElement(Zf.a,{checked:i,value:"isCustom",onChange:this.toggleUserInt})),s.a.createElement(Jp.a,{container:!0,justify:"space-between",alignItems:"baseline",onChange:this.handleChange},s.a.createElement(sf.a,null,s.a.createElement(Wp.a,{id:"searchIntervalDurationLabel"})),s.a.createElement(Ey.a,{inputRef:this.minutesRef,disabled:!i,InputProps:{className:t.input},type:"number",value:Object(uf.i)(o),name:"minutes"}),s.a.createElement(Ey.a,{inputRef:this.secondsRef,disabled:!i,InputProps:{className:t.input},type:"number",value:Object(uf.i)(c),name:"seconds"})))}}],r&&AO(n.prototype,r),i&&AO(n,i),t}(c.Component)),MO=Object(y.d)(Ym({intrvl:["interval"]}),Vp(A.b.PREFS),Object(O.withStyles)(function(e){return{container:{padding:e.spacing.unit},input:{textAlign:"center",width:4*e.spacing.unit,marginLeft:e.spacing.unit,marginRight:e.spacing.unit}}}))(TO),DO=n(189),IO=n.n(DO),RO=["searchEventsTypes.detectionTriggers"];var LO=Object(y.d)(Ym({eventType:["eventType"],eventInitiator:["eventInitiator"]}),Object(O.withStyles)(function(e){return{root:{display:"flex",flexDirection:"column",padding:e.spacing.unit}}}),Vp([A.b.CAM_ARCH]))(function(e){var t=e.classes,n=e.camArch,r=e.setEventType,i=e.setEventInitiator,a=e.eventType,o=void 0===a?"":a,u=e.eventInitiator,l=void 0===u?"":u,p=Object(c.useMemo)(function(){return Jr()([],["detectors"],n)},[n]),f=Object(c.useCallback)(function(e){r(e.target.value)},[r]),h=Object(c.useCallback)(function(e){i(e.target.value)},[i]);return s.a.createElement("div",{className:t.root},s.a.createElement(yg.a,null,s.a.createElement(IO.a,{htmlFor:"even-type"},s.a.createElement(Wp.a,{id:"searchEvents.type"})),s.a.createElement(ly.a,{value:o,onChange:f,inputProps:{id:"even-type"}},RO.map(function(e){return s.a.createElement(fy.a,{key:e,value:e},s.a.createElement(Wp.a,{id:e}))}))),s.a.createElement(yg.a,null,s.a.createElement(IO.a,{htmlFor:"initiator-type"},s.a.createElement(Wp.a,{id:"searchEvents.initiator"})),s.a.createElement(ly.a,{disabled:""===o,value:l,onChange:h,inputProps:{id:"initiator-type"}},s.a.createElement(fy.a,{value:"all"},s.a.createElement(Wp.a,{id:"searchEvents.allEvents"})),p.map(function(e){var t=e.accessPoint,n=e.displayName;return s.a.createElement(fy.a,{key:t,value:t},n)}))))});function NO(e){return NO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},NO(e)}function zO(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function FO(e){return FO=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},FO(e)}function $O(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function HO(e,t){return HO=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},HO(e,t)}function BO(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var YO=function(e){switch(e){case"count":return 1;case"duration":return 2;case"durationCombo":return 3;case"maxSize":return 4;case"minSize":return 5;case"color":return 6;case"objectType":return 7;case"enterExit":return 8;case"direction":return 9;case"maxSpeed":return 10;case"minSpeed":return 11;case"event":return 12;default:return 1/0}},UO={count:Ay,duration:Sy,durationCombo:MO,maxSize:Xy,minSize:Ky,color:dg,objectType:Mg,enterExit:Yg,direction:sO,maxSpeed:_O,minSpeed:wO,event:LO},VO=function(e){function t(e){var n,r,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,i=FO(t).call(this,e),n=!i||"object"!==NO(i)&&"function"!=typeof i?$O(r):i,BO($O(n),"addForm",hm()(function(e){return function(){n.toggleForm(e),n.handleCloseMenu()}})),BO($O(n),"handleOpenMenu",function(e){n.setState({open:!0,anchorEl:e.currentTarget,menuWidth:e.currentTarget.clientWidth})}),BO($O(n),"handleCloseMenu",function(){n.setState({open:!1,anchorEl:null,menuWidth:null})}),BO($O(n),"removeForm",hm()(function(e){return function(){n.toggleForm(e)}})),BO($O(n),"renderFormMenuItem",function(e){return s.a.createElement(fy.a,{key:e,onClick:n.addForm(e)},s.a.createElement(Wp.a,{id:"searchFormGroup.".concat(e)}))}),BO($O(n),"renderForm",function(e){var t=n.props,r=t.defaultForms,i=t.onlyMoving,a=!r.includes(e),o=UO[e];return s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{className:"search-form-group__item"},s.a.createElement("div",{className:"search-form-group__item-form"},s.a.createElement(o,{key:e,onlyMoving:i})),a&&s.a.createElement(Rh.a,{className:"search-form-group__item-remove",onClick:n.removeForm(e)},s.a.createElement(fd.a,null))),s.a.createElement(yy.a,null))}),BO($O(n),"toggleForm",function(e){var t=n.props,r=t.setForms,i=t.forms,a=Je()([e],i);r(a)}),n.state={open:!1,anchorEl:null},n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&HO(e,t)}(t,e),n=t,r=[{key:"componentDidMount",value:function(){var e=this.props,t=e.forms,n=e.defaultForms,r=e.additionalForms,i=e.replaceForms,a=M()(Oy()(r),jy()(n),hc()(YO))(t);i(a)}},{key:"render",value:function(){var e=this.state,t=e.open,n=e.anchorEl,r=e.menuWidth,i=this.props,a=i.additionalForms,o=i.forms,u=nl()(a,o),l=u.length>0;return s.a.createElement("div",null,s.a.createElement("div",null,c.Children.map(o,this.renderForm)),l&&s.a.createElement("div",{className:"search-form-group__add"},s.a.createElement(wf.a,{mini:!0,fullWidth:!0,onClick:this.handleOpenMenu},s.a.createElement(nv.a,null)),s.a.createElement(by.a,{anchorEl:n,open:t,PaperProps:{style:{minWidth:r}},onClose:this.handleCloseMenu},u.sort().map(this.renderFormMenuItem))))}}],r&&zO(n.prototype,r),i&&zO(n,i),t}(s.a.Component);BO(VO,"defaultProps",{onlyMoving:!1});var WO=Vm(VO),qO=[],GO=["minSize","maxSize","color","objectType","enterExit","direction","minSpeed","maxSpeed"];var XO=function(){return c.createElement(WO,{defaultForms:qO,additionalForms:GO})};function ZO(){return ZO=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ZO.apply(this,arguments)}var KO=[],QO=["minSize","maxSize","color","objectType","minSpeed","maxSpeed"];var JO=function(){return c.createElement(WO,ZO({defaultForms:KO,additionalForms:QO},{onlyMoving:!0}))},ew=[],tw=["minSize","maxSize","color","objectType","minSpeed","maxSpeed"];var nw=function(e){var t=e.camArch,n=e.onChange;return c.createElement(WO,{camArch:t,defaultForms:ew,additionalForms:tw,onChange:n,onlyMoving:!0})},rw=["count"],iw=["minSize","maxSize","color","objectType"];var aw=function(e){var t=e.camArch,n=e.onChange;return c.createElement(WO,{camArch:t,defaultForms:rw,additionalForms:iw,onChange:n})},ow=["duration"],cw=["minSize","maxSize","color","objectType"];var sw=function(){return s.a.createElement(WO,{defaultForms:ow,additionalForms:cw})},uw=n(540),lw=n.n(uw);n(432);function pw(e){return pw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pw(e)}function fw(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function hw(e){return hw=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},hw(e)}function dw(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mw(e,t){return mw=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},mw(e,t)}function bw(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var vw=100,yw=function(e){function t(){var e,n,r,i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,o=new Array(a),c=0;c<a;c++)o[c]=arguments[c];return r=this,i=(e=hw(t)).call.apply(e,[this].concat(o)),n=!i||"object"!==pw(i)&&"function"!=typeof i?dw(r):i,bw(dw(n),"handleChangeSimilarity",function(e){var t=n.props.setAccuracy,r=Number(e.currentTarget.value),i=Math.min(r,vw);t(i/vw)}),bw(dw(n),"handleChangeSort",function(e){var t=n.props.setSort;t(e.target.value)}),bw(dw(n),"handleChangePhoto",function(e){var t=e.target.files[0],r=new FileReader;r.onload=n.handleOnloadPhoto,r.readAsDataURL(t)}),bw(dw(n),"handleOnloadPhoto",function(e){var t=n.props.setImage;t(e.currentTarget.result)}),n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&mw(e,t)}(t,e),n=t,r=[{key:"componentDidMount",value:function(){var e=this.props,t=e.sort,n=e.accuracy,r=e.image,i=e.setAccuracy,a=e.setImage,o=e.setSort;i(n),a(r),o(t)}},{key:"render",value:function(){var e=this.props,t=e.accuracy,n=e.image,r=e.sort,i=Math.round(t*vw);return c.createElement("div",{className:"search-faces"},c.createElement("div",{className:Ff()("search-faces__photo",{"search-faces__photo_hasImage":!!n})},c.createElement("img",{src:n,className:"search-faces__photo-image",alt:""}),c.createElement("div",{className:"search-faces__photo-add"},c.createElement(lw.a,{className:"search-faces__photo-add-icon"}),c.createElement("div",{className:"search-faces__photo-add-tip"},c.createElement(Wp.a,{id:"searchFaces.imageFormatTip"})),c.createElement("input",{className:"search-faces__photo-add-input",type:"file",accept:"image/jpeg, image/png",onChange:this.handleChangePhoto}))),c.createElement("div",{className:"search-faces__form"},n&&c.createElement("div",{className:"search-faces__field"},c.createElement(Ey.a,{value:i,label:c.createElement(Wp.a,{id:"searchFaces.similarity"}),id:"similarity",type:"number",inputProps:{min:0,max:vw},onChange:this.handleChangeSimilarity,fullWidth:!0})),c.createElement("div",{className:"search-faces__field"},c.createElement(yg.a,{fullWidth:!0},c.createElement(IO.a,{htmlFor:"sort"},c.createElement(Wp.a,{id:"searchFaces.sortBy"})),c.createElement(ly.a,{value:r,onChange:this.handleChangeSort,inputProps:{id:"sort"}},c.createElement(fy.a,{value:"similarity"},c.createElement(Wp.a,{id:"searchFaces.sortBySimilarity"})),c.createElement(fy.a,{value:"time"},c.createElement(Wp.a,{id:"searchFaces.sortByTime"})))))))}}],r&&fw(n.prototype,r),i&&fw(n,i),t}(c.Component);bw(yw,"defaultProps",{sort:"similarity",accuracy:75/vw,image:""});var gw=Ym({accuracy:["accuracy"],image:["image"],sort:["sort"]})(yw);function Ow(e){return Ow="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ow(e)}function ww(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function jw(e){return jw=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},jw(e)}function _w(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ew(e,t){return Ew=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Ew(e,t)}var Aw=function(e){function t(){var e,n,r,i,a,o,c;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var s=arguments.length,u=new Array(s),l=0;l<s;l++)u[l]=arguments[l];return r=this,i=(e=jw(t)).call.apply(e,[this].concat(u)),n=!i||"object"!==Ow(i)&&"function"!=typeof i?_w(r):i,a=_w(n),o="handleChange",c=function(e){var t=e.target.value,r=n.props.setPlate;r(t)},o in a?Object.defineProperty(a,o,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[o]=c,n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ew(e,t)}(t,e),n=t,r=[{key:"render",value:function(){var e=this.props.plate;return c.createElement("div",{className:"search-form-group__item"},c.createElement("div",{className:"search-form-group__item-form"},c.createElement("div",{className:"search-form"},c.createElement("div",{className:"search-form__field"},c.createElement(Ey.a,{label:c.createElement(Wp.a,{id:"searchPlatesForm.enterPlate"}),value:e,type:"text",onChange:this.handleChange})))))}}],r&&ww(n.prototype,r),i&&ww(n,i),t}(c.Component),Sw=Ym({plate:["plate"]})(Aw);var xw=function(){return s.a.createElement("div",{className:"search-form-group__item"},s.a.createElement("div",{className:"search-form-group__item-form"}))},kw=["durationCombo"],Pw=["durationCombo"];var Cw=function(){return s.a.createElement(WO,{availableForms:Pw,defaultForms:kw})},Tw=["event"];var Mw=function(){return s.a.createElement(WO,{defaultForms:Tw})},Dw=sy()({zone:XO,line:JO,transition:nw,multiple:aw,loitering:sw,face:gw,auto:Sw,heatmap:xw,fragments:Cw,events:Mw},["events","zone","line","transition","multiple","loitering","face","auto","heatmap","fragments"]),Iw=Object.keys(Dw);function Rw(e){return c.createElement(wf.a,{classes:{label:"search-configurator__select-label"},variant:"contained",fullWidth:!0},e?c.createElement("div",{className:"search-configurator__select-title"},c.createElement(ld.a,{className:"search-configurator__select-icon"}),c.createElement(Wp.a,{id:"searchConfiguratorType.".concat(e)})):c.createElement(nv.a,null))}function Lw(){return null}function Nw(e){var t=e.queryType,n=Dw[t];return n?c.createElement(dy.a,null,c.createElement(n,null)):null}var zw=Object(y.d)(Ym({queryType:["queryType"]}),Object(O.withStyles)({select:{paddingRight:0}},{name:"SearchConfigurator"}))(function(e){var t=e.classes,n=e.queryType,r=void 0===n?"":n,i=e.setQueryType,a=c.useCallback(function(e){var t=e.target.value;return i(t)},[i]);return c.createElement("div",{className:"search-configurator"},c.createElement(ly.a,{autoFocus:!0,classes:t,displayEmpty:!0,disableUnderline:!0,fullWidth:!0,onChange:a,renderValue:Rw,value:r,IconComponent:Lw},Iw.map(function(e){return c.createElement(fy.a,{key:e,disabled:oy()(e,r),value:e},c.createElement(Wp.a,{id:"searchConfiguratorType.".concat(e)}))})),c.createElement(Nw,{queryType:r}))});function Fw(e){return Fw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Fw(e)}function $w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Hw(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Bw(e){return Bw=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Bw(e)}function Yw(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Uw(e,t){return Uw=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Uw(e,t)}function Vw(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ww={NONE:"none",AFTER:"after"},qw=function(e){function t(){var e,n,r,i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,o=new Array(a),c=0;c<a;c++)o[c]=arguments[c];return r=this,i=(e=Bw(t)).call.apply(e,[this].concat(o)),n=!i||"object"!==Fw(i)&&"function"!=typeof i?Yw(r):i,Vw(Yw(n),"state",{value:Ww.NONE}),Vw(Yw(n),"handleChange",function(e){var t=e.target.value,r=n.props,i=r.archBounds,a=r.setArchbounds,o=Number(t),c=new Date(i.begin);c.setMinutes(c.getMinutes()+o);var s=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$w(n,!0).forEach(function(t){Vw(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$w(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},i,{end:c});a(s),n.setState({value:t,archBounds:s})}),n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Uw(e,t)}(t,e),n=t,r=[{key:"render",value:function(){var e=this.props,t=e.classes,n=e.archBounds,r=this.state.value;return n?s.a.createElement("div",{className:t.root},s.a.createElement("div",{className:t.column},s.a.createElement("div",null,s.a.createElement(Wp.a,{id:"searchTimeRangeTitle"})),s.a.createElement(ly.a,{value:r,onChange:this.handleChange},s.a.createElement(fy.a,{value:"none",disabled:!0},s.a.createElement(Wp.a,{id:"searchTimeRangeSelect"})),s.a.createElement(fy.a,{value:"5"},s.a.createElement(Wp.a,{id:"searchTimeRangeSelectNext5min"})),s.a.createElement(fy.a,{value:"15"},s.a.createElement(Wp.a,{id:"searchTimeRangeSelectNext15min"})),s.a.createElement(fy.a,{value:"30"},s.a.createElement(Wp.a,{id:"searchTimeRangeSelectNext30min"})),s.a.createElement(fy.a,{value:"60"},s.a.createElement(Wp.a,{id:"searchTimeRangeSelectNext1h"})),s.a.createElement(fy.a,{value:"180"},s.a.createElement(Wp.a,{id:"searchTimeRangeSelectNext3h"})))),s.a.createElement("div",{className:t.column},s.a.createElement("div",{className:t.date},Object(ke.n)(n.begin)),s.a.createElement("div",{className:t.date},Object(ke.n)(n.end)))):null}}],i=[{key:"getDerivedStateFromProps",value:function(e,t){return e.archBounds&&t.archBounds&&(e.archBounds.end!==t.archBounds.end||e.archBounds.begin!==t.archBounds.begin)?{value:Ww.NONE}:null}}],r&&Hw(n.prototype,r),i&&Hw(n,i),t}(c.PureComponent),Gw=Object(y.d)(Object(O.withStyles)({root:{display:"flex",width:"80%",color:"#fff",marginBottom:"1em",lineHeight:"30px"},column:{flexGrow:1,display:"flex",flexDirection:"column",alignItems:"flex-start"},date:{fontWeight:"700"}}))(qw);function Xw(e){return Xw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xw(e)}function Zw(){return Zw=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Zw.apply(this,arguments)}function Kw(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Qw(e){return Qw=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Qw(e)}function Jw(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ej(e,t){return ej=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},ej(e,t)}function tj(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var nj=function(e){return e.element.children().first().get(0)},rj=(L()(["stream"]),L()(["origin"])),ij=function(e){function t(){var e,n,r,i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,o=new Array(a),c=0;c<a;c++)o[c]=arguments[c];return r=this,i=(e=Qw(t)).call.apply(e,[this].concat(o)),n=!i||"object"!==Xw(i)&&"function"!=typeof i?Jw(r):i,tj(Jw(n),"state",{showArea:!1,viewport:void 0}),tj(Jw(n),"handleShowArea",function(e){var t=e.speed,r=n.props.needTrackerFrame;n.setState({showArea:!t&&r})}),tj(Jw(n),"calcCameraViewport",function(){var e=n.props,t=e.multiCam,r=e.camArch,i=e.camArchImageInfo;i=void 0===i?{}:i;var a=i.aspect,o=nj(t);if(r&&o){var c=o.getBoundingClientRect(),s=c.width,u=a?s/a:c.height,l={width:s,height:u};n.setState({viewport:l})}else n.setState({viewport:void 0})}),n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ej(e,t)}(t,e),n=t,r=[{key:"componentDidMount",value:function(){Object(d.b)(d.b.key.PLAYBACK).observe(this.handleShowArea),window.addEventListener("resize",im()(this.calcCameraViewport,m.a.settings.animationTime)),this.calcCameraViewport()}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.camArch,r=t.camArchImageInfo;Object(Ee.m)(n,e.camArch)&&r===e.camArchImageInfo||this.calcCameraViewport()}},{key:"componentWillUnmount",value:function(){Object(d.b)(d.b.key.PLAYBACK).unobserve(this.handleShowArea)}},{key:"render",value:function(){var e=this.props,t=e.archBounds,n=e.camArch,r=e.camArchImageInfo,i=e.multiCam,a=e.onChangeMask,o=e.onSearch,c=e.onSearchStop,u=e.pending,l=e.selectedResult,p=e.setArchbounds,f=this.state,h=f.showArea,d=f.viewport;return s.a.createElement("div",{className:"archsearch-container__form"},s.a.createElement(jv,{camArchImageInfo:r,multiCam:i},h&&l&&s.a.createElement(Sv,{multiCam:i,viewport:d,selectedResult:l}),s.a.createElement(iy,Zw({key:rj(n)},{multiCam:i,onChangeMask:a,viewport:d}))),s.a.createElement("div",{className:"archsearch-container__input"},s.a.createElement(Gw,{archBounds:t,setArchbounds:p}),s.a.createElement(zw,null),s.a.createElement("div",{className:"archsearch-container__search-button"},s.a.createElement(Zb.a,{onClick:u?c:o,variant:"contained",disabled:u&&!1},u?s.a.createElement(Wp.a,{id:"stopSearch"}):s.a.createElement(Wp.a,{id:"search"})))))}}],r&&Kw(n.prototype,r),i&&Kw(n,i),t}(c.PureComponent),aj=ij,oj=n(166),cj=n.n(oj),sj=Ff()("exportBtn","VideoCell-button","VideoCell-button--blank"),uj=M()(vo.a,f.a,ur()(K.a,0));var lj=function(e){var t=e.layers,n=e.fileName,r=e.opacity;return uj(t)?s.a.createElement("button",{type:"button",className:sj,onClick:function(){var e,i,a;return regeneratorRuntime.async(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,regeneratorRuntime.awrap(Object(Bn.e)({layers:t,opacity:r}));case 2:e=o.sent,window.navigator&&window.navigator.msSaveBlob?window.navigator.msSaveBlob(e,"".concat(n,".png")):(i=document.createElement("a"),a=URL.createObjectURL(e),i.href=a,i.download="".concat(n,".png"),document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(a));case 4:case"end":return o.stop()}})}}):null};var pj=Object(y.d)(Wp.e,Object(O.withStyles)(function(){return{svgTextStyle:{fontFamily:"Open Sans",fontSize:"1.5em"},svgStyle:{width:"100%",height:"5em",marginTop:"2em",position:"relative"}}}))(function(e){var t=e.classes,n=e.intl;return s.a.createElement("svg",{className:t.svgStyle},s.a.createElement("defs",null,s.a.createElement("linearGradient",{id:"Gradient"},s.a.createElement("stop",{offset:"0%",stopColor:"#0000ff"}),s.a.createElement("stop",{offset:"25%",stopColor:"#00ffff"}),s.a.createElement("stop",{offset:"50%",stopColor:"#00ff00"}),s.a.createElement("stop",{offset:"75%",stopColor:"#ffff00"}),s.a.createElement("stop",{offset:"100%",stopColor:"#ff0000"}))),s.a.createElement("rect",{x:"0",y:"0",width:"100%",height:"15",fill:"url(#Gradient)",stroke:"#000000"}),s.a.createElement("text",{className:t.svgTextStyle,x:"0",y:"50"},n.formatMessage({id:"searchLowActivity"})),s.a.createElement("text",{className:t.svgTextStyle,textAnchor:"end",x:"100%",y:"50"},n.formatMessage({id:"searchHighActivity"})))});var fj=Object(y.d)(Wp.e,Object(O.withStyles)(function(e){return{sliderRoot:{display:"inline-block",transition:e.transitions.create(["opacity"]),textAlign:"center",position:"relative",width:50*e.spacing.unit,margin:[[0,"auto"]]},root:{padding:e.spacing.unit,width:"auto"},track:{height:.75*e.spacing.unit},thumb:{width:2*e.spacing.unit,height:2*e.spacing.unit}}}))(function(e){var t=e.classes,n=e.opacity,r=e.show,i=e.results,a=e.setHeatmapOpacity,o=e.intl.formatMessage,s=r?tt()(i):{},u=s.image,l=s.heatmapImage,p=[u,l],f=c.useCallback(function(e,t){a(t)},[a]);return r?c.createElement(c.Fragment,null,c.createElement(Jp.a,{container:!0,direction:"row"},c.createElement("div",{className:t.sliderRoot},c.createElement(sf.a,{variant:"h6"},o({id:"opacity"})),c.createElement(cj.a,{classes:t,value:n,min:0,max:1,step:.1,onChange:f})),c.createElement(lj,{fileName:"Heatmap",layers:p,opacity:n})),c.createElement(pj,null)):null}),hj=n(174);function dj(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,c=e[Symbol.iterator]();!(r=(o=c.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(i)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var mj=Object(y.d)(Vp([A.b.ZOOM]),Object(O.withStyles)(function(e){return{containImageShadow:{flex:1,position:"relative",overflow:"hidden"},image:{position:"absolute",width:"100%",height:"100%",backgroundPosition:"center",backgroundRepeat:"no-repeat",backgroundSize:"contain",transition:e.transitions.create(["transform"])},heatmap:{position:"absolute",width:"100%",height:"100%",backgroundPosition:"center",backgroundRepeat:"no-repeat",backgroundSize:[["100%","100%"]],flex:[[1,1,"auto"]]}}}),_)(function(e){var t=e.background,n=e.heatmapImage,r=e.className,i=e.classes,a=e.fallbackAspect,o=e.positions,c=e.zoom,u=e.zoomToArea,l=e.opacity,p=s.a.useState(0),f=dj(p,2),h=f[0],d=f[1],m=s.a.useRef(null),b=function(e,t){if(!e)return{areaStyle:{},geometry:{},areaPathStyle:{}};var n=wb(e,t),r=n.area,i=n.origin,a=n.scale,o=n.translate;return{areaStyle:{transform:"scale(".concat(a,") translate(").concat(o.x,"%, ").concat(o.y,"%)"),transformOrigin:"".concat(i.x,"% ").concat(i.y,"%")},areaPathStyle:r,geometry:{origin:i,scale:a,translate:o},scale:a}}(Ev()(o),u),v=b.areaStyle,y=b.areaPathStyle,g=(b.geometry,Boolean(t)),O=Ff()([i.containImageShadow,r],{"search-results__item__image--loading":!g}),w=h||a,j={paddingBottom:"".concat(Math.round(100/w),"%")},_={backgroundImage:"url(".concat(t,")"),transform:"translate(".concat(100*c.x,"%, ").concat(100*c.y,"%) scale(").concat(c.scale,")")};return u&&(_=Object.assign(_,v)),s.a.useEffect(function(){t&&Object(Bn.g)(t).then(function(e){var t=e.width,n=e.height;return m.current&&d(t/n)})},[t,d]),s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{ref:m,className:O,style:j},g&&s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{className:i.image,style:_}),o&&s.a.createElement("div",{className:"search-results__item__area-path",style:y}),n&&s.a.createElement("div",{className:i.heatmap,style:{backgroundImage:"url(".concat(n,")"),opacity:l}}))))});function bj(e){return bj="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},bj(e)}function vj(){return vj=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},vj.apply(this,arguments)}function yj(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function gj(e){return gj=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},gj(e)}function Oj(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function wj(e,t){return wj=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},wj(e,t)}function jj(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var _j=function(e){function t(){var e,n,r,i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];return r=this,i=(e=gj(t)).call.apply(e,[this].concat(o)),n=!i||"object"!==bj(i)&&"function"!=typeof i?Oj(r):i,jj(Oj(n),"itemRef",c.createRef()),jj(Oj(n),"handleCopy",Object(hj.a)(function(){var e=n.props,t=e.setClipboard,r=e.result.timestamp,i=Object(uf.d)(r);t({text:i})})),jj(Oj(n),"handleDblClick",function(){var e=n.props,t=e.onDoubleClick,r=e.result;t(r)}),jj(Oj(n),"handleSelect",function(){var e=n.props,t=e.onSelect,r=e.result;t(r)}),jj(Oj(n),"handleHideMenu",function(e){return e.preventDefault()}),n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&wj(e,t)}(t,e),n=t,r=[{key:"render",value:function(){var e=this.props,t=e.className,n=e.camArchImageInfo,r=e.result,i=e.selected,a=e.zoomToArea,o=e.opacity,s=r.accuracy,u=r.heatmapImage,l=r.image,p=r.plates,f=r.positions,h=r.timestamp,d=Jr()(b.b,"aspect",n),m=Ff()("search-results__item",t,{"search-results__item_selected":i});return c.createElement("div",{ref:this.itemRef,className:m,onClick:this.handleSelect,onDoubleClick:this.handleDblClick,onMouseDown:this.handleCopy,onContextMenu:this.handleHideMenu},c.createElement(mj,vj({background:l,className:"search-results__item__image",fallbackAspect:d},{heatmapImage:u,positions:f,zoomToArea:a,opacity:o})),c.createElement("div",{className:"search-results__item__data_block"},!u&&c.createElement(sf.a,null,Object(uf.d)(h)),s&&c.createElement(sf.a,null,"".concat(Math.ceil(100*s),"%")),p&&p.map(function(e){return c.createElement(sf.a,{key:e},e,"  ")})))}}],r&&yj(n.prototype,r),i&&yj(n,i),t}(c.PureComponent),Ej=_j,Aj=n(397),Sj=n.n(Aj),xj=n(541),kj=n.n(xj),Pj=n(65);function Cj(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Tj(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Cj(n,!0).forEach(function(t){Mj(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Cj(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Mj(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Dj={cols:1,rowHeight:0,scroll:0,winHeight:0,wasReset:!0},Ij="measurements",Rj="set/scroll",Lj="reset",Nj={reset:function(){return{type:Lj}},measurements:function(e){return{type:Ij,payload:e}},setScroll:function(e){return{type:Rj,payload:e}}};function zj(e,t){switch(t.type){case Ij:var n=t.payload,r=n.cols,i=n.rowHeight,a=n.winHeight;return Tj({},e,{wasReset:!1,cols:r,rowHeight:i,winHeight:a});case Rj:return Tj({},e,{scroll:t.payload});case Lj:return Tj({},e,{wasReset:Dj.wasReset});default:return e}}var Fj=n(542),$j=n.n(Fj),Hj=M()(Lc()(["current","childElementCount"]),ur()(K.a,0));L()(["current","children",1]);var Bj=Object(O.withStyles)({measure:{width:"100%",visibility:"hidden",position:"absolute"}})(function(e){var t=e.children,n=e.classes,r=e.container,i=e.dispatch,a=e.measure,o=c.useRef(),s=Hj(o);return c.useEffect(function(){if(s&&r){var e=r.clientHeight,t=r.offsetWidth,n=o.current.firstChild,a=n.offsetWidth,c=n.offsetHeight;i({cols:$j()(t/a),rowHeight:c,winHeight:e})}},[s,r,i]),a?c.createElement("div",{ref:o,className:n.measure},t):null});function Yj(){return Yj=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Yj.apply(this,arguments)}function Uj(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Vj(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Wj(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,c=e[Symbol.iterator]();!(r=(o=c.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(i)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function qj(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var Gj=M()(Qb()(0),kj.a),Xj=M()(Qb()(0),Sj.a),Zj=M()(z()(L()("key")),z()(Pj.b),J()(Pj.a,0));var Kj=Object(O.withStyles)({list:{height:"100%"},measure:{width:"100%",visibility:"hidden",position:"absolute"}})(function(e){var t=e.autoScroll,n=e.children,r=e.className,i=e.classes,a=e.CtElm,o=void 0===a?"div":a,s=e.ItElm,u=void 0===s?"div":s,l=e.focus,p=e.buf,f=void 0===p?1:p,h=qj(e,["autoScroll","children","className","classes","CtElm","ItElm","focus","buf"]),d=c.useReducer(zj,Dj),m=Wj(d,2),b=m[0],v=m[1],y=c.useRef(),g=c.useRef(),O=c.useRef(),w=b.cols,j=b.scroll,_=b.rowHeight,E=b.wasReset,A=b.winHeight,S=qe()(0,Math.ceil(n.length/w)),x=Xj(j/_),k=S(x-f),P=Math.max(0,k*w),C=Xj(A/_),T=S(k+C+f),M=T*w,D=k*_,I=Zj(n),R={height:Gj(_*(n.length/w))},L=c.useCallback(function(e){var t=e.currentTarget.scrollTop;return v(Nj.setScroll(t))},[]),N=c.useCallback(function(){v(Nj.reset())},[v]),z=c.useCallback(function(e){return v(Nj.measurements(e))},[v]),F=c.useCallback(function(){g.current=void 0,N(),y.current&&(y.current.scrollTop=0)},[N]);return c.useEffect(F,[I]),c.useEffect(function(){if(y.current){var e=new MutationObserver(F);return e.observe(y.current,{attributes:!0}),function(){return e.disconnect()}}return!1},[F,A]),c.useEffect(function(){return window.addEventListener("resize",N),function(){return window.removeEventListener("resize",N)}}),c.useEffect(function(){t&&l!==g.current&&y.current&&(g.current=l,y.current.scrollTo({top:Sj()(l/w*_-A/2),behavior:"smooth"}))},[t,w,l,g,_,A]),c.createElement("div",Yj({ref:y,className:r},function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Uj(n,!0).forEach(function(t){Vj(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Uj(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},h,{onScroll:L})),c.createElement(Bj,{container:y.current,dispatch:z,measure:E},c.Children.toArray(n).slice(0,1)),c.createElement(o,{ref:O,className:i.list,style:R},c.createElement(u,{style:{height:D}}),c.Children.toArray(n).slice(P,M)))});n(669);var Qj=Object(O.withStyles)({placeholder:{flexGrow:1}},{name:"SearchResults"})(function(e){var t=e.autoScroll,n=e.children,r=e.classes,i=e.columns,a=e.firstSearch,o=e.selected,c=e.singleResult,u=e.pending,l=Ff()("search-results","search-results--cols-".concat(i)),p=s.a.Children.count(n)>0;return s.a.createElement(s.a.Fragment,null,!p&&s.a.createElement("div",{className:r.placeholder}),p&&c&&s.a.createElement("div",{className:"search-results--heatmap"},n),p&&!c&&s.a.createElement(Kj,{className:l,focus:o,autoScroll:t},n),!p&&!a&&!u&&s.a.createElement("div",{className:"search-results__noresults"},s.a.createElement(Wp.a,{id:"searchNoResults"})))}),Jj=n(388),e_=n.n(Jj),t_=n(543),n_=n.n(t_),r_=n(544),i_=n.n(r_),a_=n(546),o_=n.n(a_),c_=n(545),s_=n.n(c_),u_={trackBefore:"search-results__slider__track-before",trackAfter:"search-results__slider__track-after",thumb:"search-results__slider__thumb"},l_=(Ff()("search-results__toolbar__button","search-results__toolbar__button-icon","search-results__toolbar__button__change_cam"),Object(O.withStyles)(function(e){return{progress:{margin:[[0,2*e.spacing.unit]]}}},{name:"ResultToolbar"})(function(e){var t=e.columns,n=e.classes,r=e.singleResult,i=e.handleExportOpen,a=e.pending,o=e.resultsCount,c=e.setColumns,u=e.setSearchIdx,l=e.searchCount,p=e.searchIdx,f=e.toggleZoom,h=e.zoomToArea,d=s.a.useCallback(function(e,t){return c(t)},[c]),m=p-1<0,b=l-1-(p+1)<0,v=s.a.useCallback(function(){return u(p+1)},[p,u]),y=s.a.useCallback(function(){return u(p-1)},[p,u]);return s.a.createElement("div",{className:"search-results__toolbar"},!r&&s.a.createElement("div",{className:"search-results__slider-container"},s.a.createElement(cj.a,{classes:u_,value:t,min:1,max:5,step:1,onChange:d})),!r&&s.a.createElement("button",{type:"button",className:Ff()("search-results__toolbar__button",{"search-results__toolbar__button_selected":h}),onClick:f},s.a.createElement(n_.a,{className:"search-results__toolbar__button-icon"})),!a&&Boolean(o)&&s.a.createElement("button",{type:"button",className:"search-results__toolbar__button",onClick:i},s.a.createElement(i_.a,{className:"search-results__toolbar__button-icon"})),Boolean(o)&&s.a.createElement("div",{className:"search-results-count"},s.a.createElement(Wp.a,{id:"searchFound"}),o),s.a.createElement(e_.a,{variant:"dots",position:"static",activeStep:p,steps:l,nextButton:s.a.createElement(wf.a,{size:"small",onClick:v,disabled:b},s.a.createElement(s_.a,null)),backButton:s.a.createElement(wf.a,{size:"small",onClick:y,disabled:m},s.a.createElement(o_.a,null))}),s.a.createElement(kb.a,{classes:{root:n.progress},color:"secondary",size:24,variant:a?"indeterminate":"static"}))}));n(248),n(670);function p_(e){return p_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},p_(e)}function f_(){return f_=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f_.apply(this,arguments)}function h_(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function d_(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function m_(e){return m_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},m_(e)}function b_(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function v_(e,t){return v_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},v_(e,t)}function y_(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var g_=L()("timestamp"),O_=M()(tt.a,g_),w_=M()(Tt.a,g_),j_=function(e){function t(){var e,n,r,i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,o=new Array(a),c=0;c<a;c++)o[c]=arguments[c];return r=this,i=(e=m_(t)).call.apply(e,[this].concat(o)),n=!i||"object"!==p_(i)&&"function"!=typeof i?b_(r):i,y_(b_(n),"state",{offset:0,showReports:!1,zoomToArea:!1}),y_(b_(n),"handleExportOpen",function(){n.setState({showReports:!0})}),y_(b_(n),"handleExportClose",function(){n.setState({showReports:!1})}),y_(b_(n),"toggleZoom",function(){n.setState(function(e){return{zoomToArea:!e.zoomToArea}})}),y_(b_(n),"handleSelect",function(e){var t=e.camera,r=e.timestamp,i=n.props,a=i.playback,o=i.selectCam,c=i.setArchtime,s=i.setPlayback;c(r),o(t),s(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h_(n,!0).forEach(function(t){y_(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h_(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},a,{beginTime:r,speed:0}))}),n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&v_(e,t)}(t,e),n=t,r=[{key:"componentWillUnmount",value:function(){var e=this.props.searchAbort;e()}},{key:"render",value:function(){var e=this,t=this.props,n=t.archBounds,r=t.archTime,i=t.camArch,a=t.camArchImageInfo,o=t.columns,s=t.firstSearch,u=t.multiCam,l=t.opacity,p=t.pending,f=t.playback.speed,h=t.preferences.searchAutoScroll,d=t.query,m=t.results,b=t.searchAbort,v=t.searchExpand,y=t.searchInit,g=t.searchCount,O=t.searchIdx,w=t.selected,j=t.setArchbounds,_=t.setColumns,E=t.setClipboard,A=t.setSearchIdx,S=t.setHeatmapOpacity,x=t.classes,k=this.state,P=k.offset,C=k.showReports,T=k.zoomToArea,M={camName:Jr()("unknown",["fullname"],i),query:d.queryType,time:{begin:O_(m),end:w_(m)},userName:"unknown user",columns:o,zoomToArea:T},D=this.handleExportOpen,I=this.handleExportClose,R=this.toggleZoom,L=d.queryType===Pt,N=m.length,z=0!==f,F=Boolean(L&&N);return c.createElement("div",{className:Ff()("archsearch-container",{hidden:!i})},c.createElement(aj,f_({onSearchDisabled:this.handleSearchDisabled,onSearch:y,onSearchStop:b,onChangeMask:this.handleChangeMask,needTrackerFrame:!L},{selectedResult:w.item,archBounds:n,camArch:i,camArchImageInfo:a,multiCam:u,query:d,pending:p,setArchbounds:j})),c.createElement(Jp.a,{container:!0,direction:"column",wrap:"nowrap",classes:{container:x.root}},c.createElement(Qj,f_({onSelect:this.handleSelectSearchResultItem,onSearch:this.handleSearch,singleResult:L},{columns:o,firstSearch:s,offset:P,resultsCount:N,pending:p,selected:w.idx,autoScroll:z||h}),m.map(function(t){return c.createElement(Ej,f_({key:[t.camera.dev,t.timestamp.getTime()].join(" ")},{archTime:r,camArchImageInfo:a,onDoubleClick:v,onSelect:e.handleSelect,opacity:l,result:t,searchAutoScroll:h,selected:q()(t,w.item),setClipboard:E,zoomToArea:T}))})),c.createElement(fj,f_({show:F},{opacity:l,results:m,setHeatmapOpacity:S})),c.createElement(l_,{columns:o,handleExportOpen:D,pending:p,resultsCount:N,searchCount:g,searchIdx:O,setColumns:_,setSearchIdx:A,singleResult:L,toggleZoom:R,zoomToArea:T})),c.createElement(Gb,{open:C,onClose:I,results:m,info:M,opacity:l}))}}],r&&d_(n.prototype,r),i&&d_(n,i),t}(c.PureComponent),__=Object(O.withStyles)(function(e){return{root:{position:"relative",marginLeft:4*e.spacing.unit}}})(j_);function E_(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var A_=Object(y.d)(Vp([A.b.APP_MODE,A.b.ARCH_BOUNDS,A.b.ARCH_TIME,A.b.CAM_ARCH,A.b.CAM_ARCH_IMAGE_INFO,A.b.CLIPBOARD,A.b.MOVE_SCALE,A.b.PLAYBACK,A.b.PREFS,A.b.SEARCH_RESULTS]),Um,x,Kp,_)(function(e){var t=e.appMode,n=E_(e,["appMode"]);return"search"!==t?null:s.a.createElement(__,n)}),S_=n(10),x_=n.n(S_);n(671);function k_(){var e=this;if(!(this instanceof k_))return new k_;var t='\n<div class="PresetsPane-box" id="PresetsPane-box"> \n\t<div class="PresetsPane-header gradient"> \n\t\t'.concat(m.a.locale.presets,'\n\t</div> \n\t<div class="PresetsPane-control ptz-control"></div> \n\t<ul class="PresetsPane-list" id="PresetsPane-list"> \n\t\t<li><input id="PresetsPane-input" class="PresetsPane-input" style="display:none"></li>\n\t</ul> \n</div>'),n='\n<div class="ControlPane-box" id="ControlPane-box"> \n\t<div class="ControlPane-header gradient"> \n\t\t'.concat(m.a.locale.ptzControl,'\n\t</div> \n\t<div class="ControlPane-controls ptz-control"> \n\t\t<div class="ControlPane-group">\n\t\t\t<div class="ControlPane-zoom"> \n\t\t\t\t<div class="ControlPane-caption">zoom</div> \n\t\t\t\t<div class="ControlPane-up" data-delta="1"></div> \n\t\t\t\t<div class="ControlPane-val" id="ControlPane-zoomVal">&emsp;</div> \n\t\t\t\t<div class="ControlPane-down" data-delta="-1"></div> \n\t\t\t</div> \n\t\t\t<div class="ControlPane-move"> \n\t\t\t\t<div class="ControlPane-caption">speed</div> \n\t\t\t\t<div class="ControlPane-up" data-delta="1"></div> \n\t\t\t\t<div class="ControlPane-val" id="ControlPane-speedVal"></div> \n\t\t\t\t<div class="ControlPane-down" data-delta="-1"></div> \n\t\t\t</div> \n\t\t</div>\n\t\t<div class="ControlPane-rose-box"> \n\t\t\t<div class="ControlPane-rose" id="ControlPane-rose"> \n\t\t\t\t<svg width="124" height="124">\n\t\t\t\t\t<path\n\t\t\t\t\t\tid="n"\n\t\t\t\t\t\tdata-tilt="1"\n\t\t\t\t\t\td="m 62.5,1 a 60,60 0 0 0 -42,18 l 18,18 a 34,34 0 0 1 24,-10 34,34 0 0 1 24,10 l 17,-18 A 60,60 0 0 0 61.5,1 Z"\n\t\t\t\t\t/>\n\t\t\t\t\t<path\n\t\t\t\t\t\tid="e"\n\t\t\t\t\t\tdata-pan="1"\n\t\t\t\t\t\td="M 124,62 A 60,60 0 0 0 106,20 L 88,38 A 34,34 0 0 1 98,62 34,34 0 0 1 88,86 l 18,18 a 60,60 0 0 0 18,-42 z"\n\t\t\t\t\t/>\n\t\t\t\t\t<path\n\t\t\t\t\t\tid="s"\n\t\t\t\t\t\tdata-tilt="-1"\n\t\t\t\t\t\td="m 62,123 a 60,60 0 0 0 42,-18 L 86,87 A 34,34 0 0 1 62,97 34,34 0 0 1 38,87 l -18,18 a 60,60 0 0 0 42,18 z"\n\t\t\t\t\t/>\n\t\t\t\t\t<path\n\t\t\t\t\t\tid="w"\n\t\t\t\t\t\tdata-pan="-1"\n\t\t\t\t\t\td="m 1,62 a 60,60 0 0 0 18,42 L 37,86 A 34,34 0 0 1 27,62 34,34 0 0 1 37,38 L 19,20 A 60,60 0 0 0 1,60 Z"\n\t\t\t\t\t/>\n\t\t\t\t\t<path\n\t\t\t\t\t\tid="nw"\n\t\t\t\t\t\tdata-tilt="1"\n\t\t\t\t\t\tdata-pan="-1"\n\t\t\t\t\t\td="M 29,62 A 33,33 0 0 1 62,29 v 33 z"\n\t\t\t\t\t/>\n\t\t\t\t\t<path\n\t\t\t\t\t\tid="ne"\n\t\t\t\t\t\tdata-tilt="1"\n\t\t\t\t\t\tdata-pan="1"\n\t\t\t\t\t\td="M 63,29 A 33,33 0 0 1 96,62 H 63 Z"\n\t\t\t\t\t/>\n\t\t\t\t\t<path\n\t\t\t\t\t\tid="se"\n\t\t\t\t\t\tdata-tilt="-1"\n\t\t\t\t\t\tdata-pan="1"\n\t\t\t\t\t\td="M 96,63 A 33,33 0 0 1 63,96 V 63 Z"\n\t\t\t\t\t/>\n\t\t\t\t\t<path\n\t\t\t\t\t\tid="sw"\n\t\t\t\t\t\tdata-tilt="-1"\n\t\t\t\t\t\tdata-pan="-1"\n\t\t\t\t\t\td="M 62,96 A 33,33 0 0 1 29,63 h 33 z"\n\t\t\t\t\t/>\n\t\t\t\t</svg>\n\t\t\t</div> \n\t\t</div> \n\t</div> \n\t<div class = "ControlPane-pointMove" id="ControlPane-pointMove" style="display:none"></div> \n\t<div class = "ControlPane-areaZoom" id="ControlPane-areaZoom" style="display:none;"></div> \n</div>'),r=Object(l.a)(n),i=Object(l.a)(t);this.$speed=r.find("#ControlPane-speedVal"),this.$rose=r.find("#ControlPane-rose"),this.PresetsListTmpl=x_()('<% presets.forEach(function (preset) { %>\n\t\t\t<li class="PresetsPane-item" data-id="<%- preset.id %>"><%- preset.id %>. <%- preset.label %></li>\n\t\t<% });%>'),this.div=Object(l.a)("<div>").addClass("TelemetryPane").append(i).append(r),this.queue=new cm.a,this.queue.onUpdate(function(t){return e.div.find("#ControlPane-box").toggleClass("ptz--pending",t.pending)}),this.hide(),r.find(".ControlPane-zoom").on({mousedown:function(t){var n=Object(l.a)(t.target).data("delta");n&&e.ptz.zoom(n)}}),r.find(".ControlPane-move").on({click:function(t){var n=Object(l.a)(t.target).data("delta");n&&e.ptz.speed(n)}}),this.$rose.find("path").on({mouseover:function(t){return e.$rose.addClass(t.target.id)},mouseout:function(t){return e.$rose.removeClass(t.target.id)},mousedown:function(t){var n={pan:Number(Object(l.a)(t.target).data("pan"))||0,tilt:Number(Object(l.a)(t.target).data("tilt"))||0};e.ptz.move(n),e.$rose.addClass("click")},mouseup:function(){return e.$rose.removeClass("click")}}),i.on("click",".PresetsPane-item",function(t){var n=Object(l.a)(t.currentTarget),r=n.data("id");Object(l.a)(".PresetsPane-item").removeClass("check"),Object(l.a)(".PresetsPane-remove, .PresetsPane-edit-save").removeClass("disable"),n.addClass("check"),e.ptz.goToPreset(r),t.preventDefault()}),this.refreshPresets=this.refreshPresets.bind(this)}k_.prototype={refreshControls:function(e){return this.$speed.text(e.ptzSpeed),this},refreshPresets:function(e){var t=this,n=Object(l.a)(this.PresetsListTmpl({presets:e}));return Object(l.a)(".PresetsPane-list").empty().append(n),Object(l.a)("#PresetsPane-add").click(function(e){Object(l.a)("#PresetsPane-input").show(),Object(l.a)("#PresetsPane-edit-save").addClass("save").removeClass("disable").text("сохранить"),Object(l.a)("#PresetsPane-list").scrollTop(1e4),e.preventDefault()}),Object(l.a)("#PresetsPane-edit-save").click(function(e){var n,r=Object(l.a)(e.currentTarget);r.hasClass("disable")||(r.hasClass("save")?(n=Object(l.a)("#PresetsPane-input-now"),0===n.length&&(n=Object(l.a)("#PresetsPane-input"),n.hide()),Object(l.a)("#PresetsPane-input-now").replaceWith('<div class="PresetsPane-item" data-id="'.concat(n.attr("data-id"),'">').concat(n.val(),"</div>")),Object(l.a)("#PresetsPane-edit-save").text("редактировать"),t.ptz.savePreset({id:n.attr("data-id"),label:n.val()}),r.removeClass("save")):(n=Object(l.a)(".check"),n.replaceWith('<input class="PresetsPane-input" id="PresetsPane-input-now"  data-id="'.concat(n.attr("data-id"),'" value="').concat(n.text(),'">')),Object(l.a)("#PresetsPane-edit-save").text("сохранить"),r.addClass("save"))),e.preventDefault()}),Object(l.a)("#PresetsPane-remove").click(function(e){var n=Object(l.a)(".check"),r=n.attr("data-id");t.ptz.removePreset({id:r}),n.remove(),Object(l.a)(".PresetsPane-remove, .PresetsPane-edit-save").addClass("disable"),e.preventDefault()}),this},setCamera:function(e){var t=this;return this.queue.clear(),this.ptz={goToPreset:function(n){return t.queue.push(function(){return e.goPreset(n)})},savePreset:function(n){return t.queue.push(function(){return e.setPreset(n)})},removePreset:function(n){return t.queue(function(){return e.removePreset(n)})},zoom:function(n){t.queue.push(function(){return e.zoom(n)}),e.mode.zoom===e.CONTINUOUS&&Object(l.a)(window).one({mouseup:function(){return t.queue.push(function(){return e.zoom(0)})}})},speed:function(t){e.ptzSpeed+=t},move:function(n){t.queue.push(function(){return e.move(n)}),e.mode.move===e.CONTINUOUS&&Object(l.a)(window).one({mouseup:function(){return t.queue.push(function(){return e.move(0)})}})},pointMove:function(n){return t.queue.push(function(){return e.pointMove(n)})},areaZoom:function(n){return t.queue.push(function(){return e.areaZoom(n)})}},e.ptzPresets.observe(this.refreshPresets),e.ptzSpeedT.observe(function(e){return Object(l.a)("#ControlPane-speedVal").text(e)}),this.refreshControls(e),this},show:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.hide(!e)},hide:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.div.toggleClass("hidden",e),this},setEnabled:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.div.find(".ptz-control").toggleClass("ptz--disabled",!e),this},remove:function(){return this.div.remove(),this}};var P_=k_;n(672);function C_(e){return C_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},C_(e)}function T_(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function M_(e){return M_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},M_(e)}function D_(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function I_(e,t){return I_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},I_(e,t)}var R_=function(e){return e},L_=function(e){return"".concat(e.desc.id,".").concat(e.desc.displayName)},N_=[{key:"connection",getVal:R_},{key:"playback",getVal:R_},{key:"layoutList",getVal:function(e){return e.map(function(e){return e.displayName})}},{key:"camActive",getVal:L_},{key:"camArch",getVal:L_}],z_=function(e){function t(){var e,n,r,i,a,o,s;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var u=arguments.length,l=new Array(u),p=0;p<u;p++)l[p]=arguments[p];return r=this,i=(e=M_(t)).call.apply(e,[this].concat(l)),n=!i||"object"!==C_(i)&&"function"!=typeof i?D_(r):i,a=D_(n),o="renderItem",s=function(e){var t=e.key,r=e.getVal,i=n.props[t],a=void 0!==i?JSON.stringify(r(i)):"undefined";return c.createElement("div",{className:"store-panel__item",key:t},c.createElement("span",{className:"store-panel__item__key"},t,":"),c.createElement("span",null,a))},o in a?Object.defineProperty(a,o,{value:s,enumerable:!0,configurable:!0,writable:!0}):a[o]=s,n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&I_(e,t)}(t,e),n=t,r=[{key:"render",value:function(){var e=this.props.statistics;return e?c.createElement("div",{className:"store-panel__item-container"},N_.map(this.renderItem)):null}}],r&&T_(n.prototype,r),i&&T_(n,i),t}(c.Component),F_=(Vp(["*"])(z_),n(547)),$_=n.n(F_),H_=Object(g.b)(function(){return{}},{changePref:function(e){return{type:Da,payload:e}}}),B_=n(276),Y_=n.n(B_),U_=n(277),V_=n.n(U_),W_=n(389),q_=n.n(W_),G_=n(393),X_=n.n(G_),Z_=n(125),K_=n.n(Z_),Q_=n(190),J_=n.n(Q_);function eE(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function tE(e){var t=e.list,n=eE(e,["list"]);return c.createElement(ly.a,n,c.createElement(fy.a,{value:-1},c.createElement(Wp.a,{id:"preferences.layout.none"})),t.map(function(e,t){var n=e.displayName;return c.createElement(fy.a,{key:n,value:t},n)}))}var nE="defaultLayout";function rE(e){var t=e.handleChange,n=(e.handleToggle,e.prefs),r=n.layoutList,i=n.layout;return c.createElement(c.Fragment,null,c.createElement(K_.a,null,c.createElement(Wp.a,{id:"preferences.layout"})),c.createElement(yg.a,{fullWidth:!0,margin:"normal"},c.createElement(tE,{list:r,onChange:t(nE),value:i}),c.createElement(J_.a,null,c.createElement(Wp.a,{id:"preferences.layout.default"}))))}var iE=n(143),aE=n.n(iE);function oE(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,c=e[Symbol.iterator]();!(r=(o=c.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(i)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var cE="searchAutoScroll",sE="searchDefaultInterval",uE=10*ke.h;var lE=Object(O.withStyles)(function(e){return{input:{textAlign:"center",width:4*e.spacing.unit},label:{"&:after":{content:"':'"}}}})(function(e){var t=e.handleChange,n=e.handleToggle,r=e.prefs,i=r.searchAutoScroll,a=r.searchDefaultInterval,o=e.classes,u=Object(c.useRef)(null),l=Object(c.useRef)(null),p=Object(c.useState)(new Date(a)),f=oE(p,2),h=f[0],d=f[1],m=t(sE),b=h.getMinutes(),v=h.getSeconds();return s.a.createElement(s.a.Fragment,null,s.a.createElement(K_.a,null,s.a.createElement(Wp.a,{id:"preferences.search"})),s.a.createElement(yg.a,{fullWidth:!0,margin:"normal"},s.a.createElement(kh.a,{label:s.a.createElement(Wp.a,{id:"preferences.searchAutoScroll"}),control:s.a.createElement(aE.a,{onChange:n(cE),checked:i})})),s.a.createElement(Jp.a,{container:!0,alignItems:"baseline",onChange:function(){var e,t,n,r=(e=Number(u.current.value),t=Number(l.current.value),n=new Date(Math.max(uE,e*ke.f+t*ke.h)),d(n),n);m({target:{value:r}})}},s.a.createElement(Jp.a,{item:!0,xs:6},s.a.createElement(sf.a,null,s.a.createElement(Wp.a,{id:"preferences.searchDefaultInterval"}))),s.a.createElement(Jp.a,{item:!0,xs:6},s.a.createElement(Jp.a,{container:!0,alignItems:"baseline",justify:"space-around"},s.a.createElement(sf.a,{color:"textSecondary",classes:{root:o.label}},s.a.createElement(Wp.a,{id:"preferences.searchDefaultInterval.min"})),s.a.createElement(Ey.a,{inputRef:u,InputProps:{className:o.input},type:"number",value:b,name:"minutes"}),s.a.createElement(sf.a,{color:"textSecondary",classes:{root:o.label}},s.a.createElement(Wp.a,{id:"preferences.searchDefaultInterval.sec"})),s.a.createElement(Ey.a,{inputRef:l,InputProps:{className:o.input},type:"number",value:v,name:"seconds"})))))});function pE(e){return c.createElement(ly.a,e,c.createElement(fy.a,{value:-1},c.createElement(Wp.a,{id:"preferences.stream.auto"})),c.createElement(fy.a,{value:0},c.createElement(Wp.a,{id:"preferences.stream.high"})),c.createElement(fy.a,{value:1},c.createElement(Wp.a,{id:"preferences.stream.low"})))}var fE="archFastMjpeg",hE="disconnectInactive",dE="defaultStream",mE="noKeyFrames";function bE(e){var t=e.handleChange,n=e.handleToggle,r=e.prefs,i=r.archFastMjpeg,a=r.disconnect,o=r.noKeyFrames,s=r.stream;return c.createElement(c.Fragment,null,c.createElement(K_.a,null,c.createElement(Wp.a,{id:"preferences.video"})),c.createElement(yg.a,{fullWidth:!0,margin:"normal"},c.createElement(kh.a,{label:c.createElement(Wp.a,{id:"preferences.stream.disconnectInactive"}),control:c.createElement(aE.a,{onChange:n(hE),checked:a})})),c.createElement(yg.a,{fullWidth:!0,margin:"normal"},c.createElement(kh.a,{label:c.createElement(Wp.a,{id:"preferences.stream.noKeyFrames"}),control:c.createElement(aE.a,{onChange:n(mE),checked:o})}),o&&c.createElement(J_.a,null,c.createElement(Wp.a,{id:"preferences.stream.warning"}))),c.createElement(yg.a,{fullWidth:!0,margin:"normal"},c.createElement(kh.a,{label:c.createElement(Wp.a,{id:"preferences.stream.archFastMjpeg"}),control:c.createElement(aE.a,{onChange:n(fE),checked:i})})),c.createElement(yg.a,{fullWidth:!0,margin:"normal"},c.createElement(pE,{onChange:t(dE),value:s}),c.createElement(J_.a,null,c.createElement(Wp.a,{id:"preferences.stream.default"}))))}var vE="pinned";function yE(e){var t=e.prefs.pinned,n=e.handleToggle;return c.createElement(c.Fragment,null,c.createElement(K_.a,null,c.createElement(Wp.a,{id:"preferences.camList"})),c.createElement(yg.a,{fullWidth:!0,margin:"normal"},c.createElement(kh.a,{label:c.createElement(Wp.a,{id:"preferences.camList.pinned"}),control:c.createElement(aE.a,{onChange:n(vE),checked:t})})))}function gE(){return gE=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},gE.apply(this,arguments)}function OE(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function wE(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?OE(n,!0).forEach(function(t){jE(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):OE(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function jE(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _E(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,c=e[Symbol.iterator]();!(r=(o=c.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(i)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var EE="archFastMjpeg",AE="disconnectInactive",SE="defaultLayout",xE="noKeyFrames",kE="searchAutoScroll",PE="defaultStream",CE="pinned",TE="searchDefaultInterval",ME=dl()([EE,AE,SE,PE,kE,xE,CE,TE]);var DE=Object(y.d)(Vp([A.b.PREFS,A.b.LAYOUT_LIST]),H_)(function(e){var t=e.changePref,n=e.open,r=e.onClose,i=e[A.b.LAYOUT_LIST],a=e[A.b.PREFS],o=c.useState(ME(a)),s=_E(o,2),u=s[0],l=s[1];function p(e){return c.useCallback(function(t){return l(function(n){return wE({},n,jE({},e,t.target.checked))})},[e])}function f(e){return c.useCallback(function(t){var n=t.target.value;l(function(t){return wE({},t,jE({},e,Number(n)))})},[e])}var h=u[EE],d=u[AE],m=u[SE],b=u[PE],v=u[kE],y=u[xE],g=u[CE],O=u[TE];return c.createElement(Y_.a,{maxWidth:"xs",open:n,onClose:r},c.createElement(q_.a,null,c.createElement(Jp.a,{container:!0,direction:"column",spacing:24},c.createElement(Jp.a,{item:!0},c.createElement(bE,gE({prefs:{archFastMjpeg:h,disconnect:d,noKeyFrames:y,stream:b}},{handleChange:f,handleToggle:p}))),c.createElement(yy.a,null),c.createElement(Jp.a,{item:!0},c.createElement(lE,gE({prefs:{searchAutoScroll:v,searchDefaultInterval:O}},{handleChange:f,handleToggle:p}))),c.createElement(yy.a,null),c.createElement(Jp.a,{item:!0},c.createElement(rE,gE({prefs:{layout:m,layoutList:i}},{handleChange:f,handleToggle:p}))),c.createElement(yy.a,null),c.createElement(Jp.a,{item:!0},c.createElement(yE,gE({prefs:{pinned:g}},{handleToggle:p}))))),c.createElement(V_.a,null,c.createElement(Rh.a,{color:"inherit",onClick:r},c.createElement(fd.a,null)),c.createElement(Rh.a,{color:"secondary",onClick:function(){t(u),r()}},c.createElement(X_.a,null))))}),IE=Object(y.d)(Vp(A.b.PREFS),H_)(DE);function RE(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,c=e[Symbol.iterator]();!(r=(o=c.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(i)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var LE=Object(y.d)(E,Kp)(function(){var e=c.useState(null),t=RE(e,2),n=t[0],r=t[1],i=Pb.b.authToken;function a(){r(null)}function o(e){return function(){a(),window.location=e}}var s=c.useState(!1),u=RE(s,2),l=u[0],p=u[1];return c.createElement(c.Fragment,null,c.createElement(Rh.a,{onClick:function(e){r(e.currentTarget)}},c.createElement($_.a,null)),c.createElement(by.a,{anchorEl:n,open:Boolean(n),onClose:a},c.createElement(fy.a,{onClick:o(yi.R)},c.createElement(Rd.a,null,c.createElement(Wp.a,{id:"statistics.hint"}))),c.createElement(fy.a,{onClick:o(yi.c)},c.createElement(Rd.a,null,c.createElement(Wp.a,{id:"bookmark.hint"}))),c.createElement(fy.a,{onClick:function(){a(),p(!0)}},c.createElement(Rd.a,null,c.createElement(Wp.a,{id:"preferences.hint"}))),!i&&c.createElement(fy.a,{onClick:function(){a(),Object(yi.H)()}},c.createElement(Rd.a,null,c.createElement(Wp.a,{id:"logout"})))),c.createElement(IE,{open:l,onClose:function(){p(!1)}}))}),NE=n(549),zE=n.n(NE);function FE(e){return FE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},FE(e)}function $E(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function HE(e){return HE=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},HE(e)}function BE(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function YE(e,t){return YE=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},YE(e,t)}var UE=function(e){function t(){var e,n,r,i,a,o,c;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var s=arguments.length,u=new Array(s),l=0;l<s;l++)u[l]=arguments[l];return r=this,i=(e=HE(t)).call.apply(e,[this].concat(u)),n=!i||"object"!==FE(i)&&"function"!=typeof i?BE(r):i,a=BE(n),o="handleMove",c=function(){var e=n.props,t=e.direction,r=e.onClick;r(t)},o in a?Object.defineProperty(a,o,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[o]=c,n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&YE(e,t)}(t,e),n=t,r=[{key:"render",value:function(){var e=this.props.direction;return s.a.createElement("button",{className:"layout-editor-arrow layout-editor-arrow_".concat(e),onClick:this.handleMove,type:"button"},s.a.createElement("figure",{className:"icon"}))}}],r&&$E(n.prototype,r),i&&$E(n,i),t}(c.PureComponent),VE=UE,WE=n(548),qE=n.n(WE);function GE(e){var t=e.origin,n=e.camera;return t?n?s.a.createElement(uh,{cam:n}):null:s.a.createElement("div",{className:"layout-editor-cell__cam-off"},s.a.createElement(qE.a,null))}function XE(e){return XE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},XE(e)}function ZE(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,c=e[Symbol.iterator]();!(r=(o=c.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(i)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function KE(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function QE(e){return QE=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},QE(e)}function JE(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function eA(e,t){return eA=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},eA(e,t)}function tA(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var nA=function(e){function t(){var e,n,r,i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,o=new Array(a),c=0;c<a;c++)o[c]=arguments[c];return r=this,i=(e=QE(t)).call.apply(e,[this].concat(o)),n=!i||"object"!==XE(i)&&"function"!=typeof i?JE(r):i,tA(JE(n),"state",{camera:null}),tA(JE(n),"handleFetchCamera",function(e){Object(Ee.e)(e).then(function(e){var t=ZE(e,1),r=t[0];return n.setState({camera:r})},function(){return n.setState({camera:null})})}),tA(JE(n),"handleSelect",function(){var e=n.props,t=e.index,r=e.onSelect,i=e.active;i&&r(t)}),tA(JE(n),"handleAdjust",function(e){var t=n.props,r=t.onAdjust,i=t.index;r(i,e.split("-"))}),tA(JE(n),"handleCollapse",function(e){var t=n.props,r=t.onCollapse,i=t.index;r(i,e)}),tA(JE(n),"handleRemoveCamera",function(){var e=n.props,t=e.onRemoveCamera,r=e.index;t(r)}),n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&eA(e,t)}(t,e),n=t,r=[{key:"componentDidMount",value:function(){var e=this.props.origin;e&&this.handleFetchCamera(e)}},{key:"componentDidUpdate",value:function(e){var t=this.props.origin;e.origin!==t&&(t?this.handleFetchCamera(t):this.setState({camera:null}))}},{key:"renderControls",value:function(){var e=this.props,t=e.size,n=e.pos,r=t.width>1,i=t.height>1,a=0!==n.top,o=0!==n.left,c=0!==n.right,u=0!==n.bottom;return s.a.createElement("div",{className:"layout-editor-controls"},s.a.createElement("div",{className:"layout-editor-controls__top-left"},a&&o&&s.a.createElement(VE,{onClick:this.handleAdjust,direction:"top-left"})),s.a.createElement("div",{className:"layout-editor-controls__top-right"},a&&c&&s.a.createElement(VE,{onClick:this.handleAdjust,direction:"top-right"})),s.a.createElement("div",{className:"layout-editor-controls__bottom-left"},u&&o&&s.a.createElement(VE,{onClick:this.handleAdjust,direction:"bottom-left"})),s.a.createElement("div",{className:"layout-editor-controls__bottom-right"},u&&c&&s.a.createElement(VE,{onClick:this.handleAdjust,direction:"bottom-right"})),s.a.createElement("div",{className:"layout-editor-controls__left"},o&&s.a.createElement(VE,{onClick:this.handleAdjust,direction:"left"}),r&&s.a.createElement(VE,{onClick:this.handleCollapse,direction:"right"})),s.a.createElement("div",{className:"layout-editor-controls__right"},c&&s.a.createElement(VE,{onClick:this.handleAdjust,direction:"right"}),r&&s.a.createElement(VE,{onClick:this.handleCollapse,direction:"left"})),s.a.createElement("div",{className:"layout-editor-controls__top"},a&&s.a.createElement(VE,{onClick:this.handleAdjust,direction:"top"}),i&&s.a.createElement(VE,{onClick:this.handleCollapse,direction:"bottom"})),s.a.createElement("div",{className:"layout-editor-controls__bottom"},u&&s.a.createElement(VE,{onClick:this.handleAdjust,direction:"bottom"}),i&&s.a.createElement(VE,{onClick:this.handleCollapse,direction:"top"})))}},{key:"render",value:function(){var e=this.props,t=e.pos,n=e.origin,r=e.active,i=this.state.camera;return s.a.createElement("div",{className:Ff()("layout-editor-cell",{"layout-editor-cell_active":r}),style:{left:Object(uf.a)(t.left),right:Object(uf.a)(t.right),top:Object(uf.a)(t.top),bottom:Object(uf.a)(t.bottom)}},s.a.createElement("div",{className:"layout-editor-cell__wrapper",onClick:this.handleSelect},n&&s.a.createElement("div",{className:"layout-editor-cell__header"},s.a.createElement(sf.a,{className:"layout-editor-cell__name",variant:"subheading"},i?"".concat(i.id,". ").concat(i.displayName):n),r&&s.a.createElement("button",{onClick:this.handleRemoveCamera,className:"layout-editor-cell__cancel-button",type:"button"},s.a.createElement(zE.a,null))),s.a.createElement("div",{className:"layout-editor-cell__frame"},s.a.createElement(GE,{origin:n,camera:i}))),r&&this.renderControls())}}],r&&KE(n.prototype,r),i&&KE(n,i),t}(c.PureComponent),rA=nA,iA=Object(y.d)(Object(O.withStyles)(function(){return{button:{marginLeft:8,marginRight:8}}}),Object(g.b)(function(e){return{displayName:ip(e)}},function(e){return{onSave:function(){return e({type:Cn})},onCancel:function(){return e(tp())},onSetName:function(t){return e((n=t.target.value,{type:Mn,payload:n}));var n}}}))(function(e){var t=e.classes,n=e.displayName,r=e.onCancel,i=e.onSave,a=e.onSetName;return s.a.createElement("div",{className:"layout-editor-toolbar"},s.a.createElement(Ey.a,{autoFocus:!0,id:"name",label:"Name 4",onChange:a,value:n}),s.a.createElement("div",{className:"layout-editor-toolbar__actions"},s.a.createElement(wf.a,{className:t.button,size:"small",variant:"outlined",color:"primary",onClick:i},s.a.createElement(Wp.a,{id:"layoutEditor.save"})),s.a.createElement(wf.a,{className:t.button,color:"secondary",onClick:r},s.a.createElement(Wp.a,{id:"layoutEditor.cancel"}))))});n(673);function aA(e){return aA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},aA(e)}function oA(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function cA(e){return cA=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},cA(e)}function sA(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function uA(e,t){return uA=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},uA(e,t)}var lA=function(e){function t(){var e,n,r,i,a,o,c;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var u=arguments.length,l=new Array(u),p=0;p<u;p++)l[p]=arguments[p];return r=this,i=(e=cA(t)).call.apply(e,[this].concat(l)),n=!i||"object"!==aA(i)&&"function"!=typeof i?sA(r):i,a=sA(n),o="renderCell",c=function(e){var t=e.index,r=e.size,i=e.origin,a=n.props,o=a.form,c=a.selectedCellIndex,u=a.onAdjustCell,l=a.onCollapseCell,p=a.onSelectCell,f=a.onRemoveCameraCell,h=c===t,d=vn(o,e);return s.a.createElement(rA,{key:t,index:t,pos:d,origin:i,active:h,size:r,onSelect:p,onAdjust:u,onCollapse:l,onRemoveCamera:f})},o in a?Object.defineProperty(a,o,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[o]=c,n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&uA(e,t)}(t,e),n=t,r=[{key:"render",value:function(){var e=this.props,t=e.form.cells,n=e.active;return n&&s.a.createElement("div",{className:"layout-editor"},s.a.createElement(iA,null),s.a.createElement("div",{className:"layout-editor__list"},z()(this.renderCell)(t)))}}],r&&oA(n.prototype,r),i&&oA(n,i),t}(c.PureComponent),pA=lA,fA=n(550),hA=n.n(fA),dA=n(551),mA=n.n(dA),bA=n(350),vA=n.n(bA),yA=n(181),gA=n.n(yA);var OA=wd()(function(){return{root:{position:"relative",margin:2,padding:0,height:"2em",width:"3em"},cell:{position:"absolute",border:"1px solid rgba(51, 51, 51, 0.7)",backgroundColor:"currentColor"}}})(function(e){var t=e.classes,n=e.width,r=e.height,i={width:1/n,height:1/r},a=on({width:n,height:r},function(e){var n=e.x,r=e.y;return s.a.createElement("div",{key:"".concat(n,".").concat(r),className:t.cell,style:{top:Object(uf.a)(r*i.height),left:Object(uf.a)(n*i.width),width:Object(uf.a)(i.width),height:Object(uf.a)(i.height)}})});return s.a.createElement("figure",{className:t.root},gA()(a))});function wA(e){return wA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},wA(e)}function jA(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _A(e){return _A=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},_A(e)}function EA(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function AA(e,t){return AA=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},AA(e,t)}var SA=function(e){function t(){var e,n,r,i,a,o,c;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var s=arguments.length,u=new Array(s),l=0;l<s;l++)u[l]=arguments[l];return r=this,i=(e=_A(t)).call.apply(e,[this].concat(u)),n=!i||"object"!==wA(i)&&"function"!=typeof i?EA(r):i,a=EA(n),o="handleClick",c=function(){var e=n.props,t=e.width,r=e.height,i=e.onClick;i({width:t,height:r})},o in a?Object.defineProperty(a,o,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[o]=c,n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&AA(e,t)}(t,e),n=t,r=[{key:"render",value:function(){var e=this.props,t=e.classes,n=e.width,r=e.height;return s.a.createElement("button",{onClick:this.handleClick,className:t.root,title:"".concat(r,"x").concat(n),type:"button"},s.a.createElement(OA,{width:n,height:r}))}}],r&&jA(n.prototype,r),i&&jA(n,i),t}(c.PureComponent),xA=wd()(function(){return{root:{color:"#fff",border:"none",background:"none",outline:"none",padding:8,cursor:"pointer","&:hover":{backgroundColor:"orange"}}}})(SA);function kA(e){return kA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},kA(e)}function PA(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function CA(e){return CA=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},CA(e)}function TA(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function MA(e,t){return MA=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},MA(e,t)}function DA(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var IA=function(e){function t(){var e,n,r,i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,o=new Array(a),c=0;c<a;c++)o[c]=arguments[c];return r=this,i=(e=CA(t)).call.apply(e,[this].concat(o)),n=!i||"object"!==kA(i)&&"function"!=typeof i?TA(r):i,DA(TA(n),"state",{showMenu:!1}),DA(TA(n),"handleToggleShow",function(){n.setState(function(e){return{showMenu:!e.showMenu}})}),DA(TA(n),"handleClose",function(){n.setState({showMenu:!1})}),n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&MA(e,t)}(t,e),n=t,r=[{key:"render",value:function(){var e=this.props,t=e.classes,n=e.show,r=e.onStartEdit,i=e.onCreate,a=e.onCopyCurrent,o=e.onRemove,c=e.active,u=e.layoutSelected,l=this.state.showMenu;return n?s.a.createElement(qf.a,{onClickAway:this.handleClose},s.a.createElement("div",{className:t.root},s.a.createElement("button",{className:Ff()(t.button,DA({},t.buttonActive,l||c)),"aria-label":"Layout editor menu",onClick:this.handleToggleShow,type:"button"},s.a.createElement(mA.a,null)),l&&s.a.createElement("div",{className:t.menuBox},s.a.createElement(vA.a,{onClick:this.handleClose},s.a.createElement("div",{className:t.grids},hA()(1,8).map(function(e){return s.a.createElement(xA,{key:e,onClick:i,width:e,height:e})})),u&&!c&&[s.a.createElement(yy.a,null),s.a.createElement(fy.a,{onClick:a},s.a.createElement(Rd.a,{primary:s.a.createElement(Wp.a,{id:"layoutEditor.menu.copy"}),classes:{primary:t.menuItemPrimary}})),s.a.createElement(fy.a,{onClick:r},s.a.createElement(Rd.a,{primary:s.a.createElement(Wp.a,{id:"layoutEditor.menu.edit"}),classes:{primary:t.menuItemPrimary}})),s.a.createElement(fy.a,{onClick:o},s.a.createElement(Rd.a,{primary:s.a.createElement(Wp.a,{id:"layoutEditor.menu.remove"}),classes:{primary:t.menuItemPrimary}}))])))):null}}],r&&PA(n.prototype,r),i&&PA(n,i),t}(c.PureComponent);DA(IA,"defaultProps",{show:!0,active:!0});var RA={onStartEdit:function(){return{type:wn}},onCreate:function(e){return{type:On,payload:e}},onCopyCurrent:function(){return{type:jn}},onRemove:function(){return{type:_n}}},LA=Object(g.b)(function(e){return{active:e.topic[A.b.APP_MODE]===b.a.LAYOUT_EDITOR,layoutSelected:e.topic.layoutSelected}},RA),NA=(Object(y.d)(Vp(A.b.APP_MODE),Kp,LA,wd()(function(e){return{root:{position:"relative",marginLeft:"1em"},button:{height:40,width:60,cursor:"pointer",color:e.palette.common.white,backgroundColor:"transparent",outline:"none",border:"none","&:hover":{color:"#333"}},buttonActive:{color:"white",backgroundColor:"dodgerblue"},menuBox:{position:"absolute",top:"100%",left:0,zIndex:6,backgroundColor:"var(--LayoutBgColor)",minWidth:285},grids:{display:"flex",flexWrap:"wrap",paddingLeft:8,paddingRight:8},menuItemPrimary:{color:e.palette.common.white}}}))(IA),{onAdjustCell:function(e,t){return{type:kn,payload:{id:e,directions:t}}},onCollapseCell:function(e,t){return{type:Pn,payload:{id:e,direction:t}}},onSelectCell:function(e){return{type:Sn,payload:e}},onRemoveCameraCell:function(e){return{type:xn,payload:e}}}),zA=Object(g.b)(pp,NA),FA=Object(y.d)(Vp(),Kp,zA)(pA);n(187);function $A(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function HA(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$A(n,!0).forEach(function(t){BA(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$A(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function BA(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var YA=Object.values(A.b),UA=function(e){return"set".concat(C()(e))},VA=YA.reduce(function(e,t){return HA({},e,BA({},UA(t),(n=t,function(e){return{type:n,value:e}})));var n},{});function WA(e){var t=function(e){var t=Array.isArray(e)?e:[e];return t.some(function(e){return"*"===e})?YA:t}(e),n=t.reduce(function(e,t){return HA({},e,{},(n=t,r=UA(n),i=VA[r],BA({},r,i)));var n,r,i},{}),r=function(e){return t.reduce(function(t,n){return HA({},t,BA({},n,e[n]))},{})},i=function(e){return Object(y.b)(n,e)};return function(e){return Object(g.b)(r,i)(e)}}var qA=Object(k.createStructuredSelector)({maps:function(e){return e.map.maps||[]}});var GA=Object(g.b)(qA,function(e){return Object(y.b)(r,e)}),XA=n(552),ZA=n.n(XA),KA=n(553),QA=n.n(KA);n(674);function JA(e){return JA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},JA(e)}function eS(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function tS(e){return tS=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},tS(e)}function nS(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function rS(e,t){return rS=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},rS(e,t)}function iS(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var aS=function(e){function t(){var e,n,r,i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];return r=this,i=(e=tS(t)).call.apply(e,[this].concat(o)),n=!i||"object"!==JA(i)&&"function"!=typeof i?nS(r):i,iS(nS(n),"state",{}),iS(nS(n),"handleLoadVideoMetaData",function(){var e=n.video,t=e.videoWidth,r=e.videoHeight;n.setState({videoRatio:r>0?t/r:1})}),iS(nS(n),"handleSelect",function(){n.props.onSelect(n.props.cameraMarker.cameraId)}),iS(nS(n),"handleEnterImmerseMode",function(){n.props.onEnterImmerseMode(n.props.cameraMarker)}),iS(nS(n),"renderMarker",function(){var e=n.props,t=e.rotateAngle,r=e.selected,i=e.cameraMarker,a=e.displayMarkerTitle,o={transform:"translate(-50%, -100%) rotateX(".concat(-t,"deg)"),transformOrigin:"50% 100%"},s=Ff()("map-camera__marker",{"map-camera__marker_selected":r});return c.createElement("div",{className:s,style:o,onClick:n.handleSelect},a&&c.createElement("span",{className:"map-camera__marker__title",title:i.title},i.title))}),iS(nS(n),"renderVideo",function(){var e=n.props,t=e.cameraMarker,r=e.videoOpacity,i=n.state,a=i.viewSector,o=i.videoRatio,s=t.videoFrameArrangement,u=s.distance,l=s.angle,p=s.incline,f=2*a.distance*u*Math.sin(l),h=f/o,d=(a.end.x-a.begin.x)*u,m=(a.end.y-a.begin.y)*u,b=zn(3*Math.PI/2-a.directionAngle),v=["translate(".concat(d-f/2,"px, ").concat(m-h,"px)"),"rotateX(-90deg)","rotateY(".concat(b,"deg)"),"rotateX(".concat(zn(p),"deg)")].join(" "),y={transform:v,transformOrigin:"50% 100%",width:f,height:h,opacity:r};return c.createElement("div",{className:"map-camera__video-container",style:y})}),iS(nS(n),"renderViewSector",function(){var e=n.state.viewSector,t=e.distance,r=e.startAngle,i=e.endAngle,a=2*t,o=2*t,s=r-i<=Math.PI?"0":"1",u=t+t*Math.cos(r),l=t+t*Math.sin(r),p=t+t*Math.cos(i),f=t+t*Math.sin(i),h={position:"absolute",width:a,height:o,transform:"translate(-50%, -50%)",transformStyle:"preserve-3d"},d=["M",t,t,"L",u,l,"A",t,t,0,s,0,p,f,"Z"].join(" ");return c.createElement("div",{style:h},c.createElement("svg",{width:a,height:a},c.createElement("path",{d:d,fill:"green",className:"map-camera__sector",onDoubleClick:n.handleEnterImmerseMode})))}),n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&rS(e,t)}(t,e),n=t,r=[{key:"componentDidMount",value:function(){this.video=document.createElement("video"),this.video.addEventListener("loadedmetadata",this.handleLoadVideoMetaData)}},{key:"componentWillUnmount",value:function(){this.video=null}},{key:"render",value:function(){var e=this.props.immerseMode,t=this.state,n=t.position,r=t.videoRatio,i={transform:"translate(".concat(n.x,"px, ").concat(n.y,"px)")};return c.createElement("div",{className:"map-camera__container",style:i},!e&&this.renderMarker(),this.renderViewSector(),r&&this.renderVideo())}}],i=[{key:"getDerivedStateFromProps",value:function(e,t){var n=e.cameraMarker,r=e.fromPointMapToLocal,i=r(n.position);return t.position&&i.x===t.position.x&&i.y===t.position.y?null:{position:i,viewSector:Fn(i,r(n.field_of_view.direction),n.field_of_view.angle)}}}],r&&eS(n.prototype,r),i&&eS(n,i),t}(c.PureComponent),oS=aS;function cS(e){return cS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},cS(e)}function sS(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function uS(e){return uS=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},uS(e)}function lS(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pS(e,t){return pS=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},pS(e,t)}function fS(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var hS={minX:-1,maxX:1,minY:-1,maxY:1},dS=function(e){return Math.pow(1.1,e)},mS=function(e,t,n){return{x:(1+e.x)*t/2,y:(1+e.y)*n/2}},bS=function(e,t,n){return{x:e.x/(t/2)-1,y:e.y/(n/2)-1}},vS=function(e){function t(){var e,n,r,i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,o=new Array(a),c=0;c<a;c++)o[c]=arguments[c];return r=this,i=(e=uS(t)).call.apply(e,[this].concat(o)),n=!i||"object"!==cS(i)&&"function"!=typeof i?lS(r):i,fS(lS(n),"state",{}),fS(lS(n),"getScale",dS),fS(lS(n),"getWidth",function(){return n.state.width}),fS(lS(n),"getHeight",function(){return n.state.height}),fS(lS(n),"getBounds",function(){return hS}),fS(lS(n),"fromPointMapToLocal",function(e){var t=n.state,r=t.width,i=t.height;return mS(e,r,i)}),fS(lS(n),"fromPointLocalToMap",function(e){var t=n.state,r=t.width,i=t.height;return bS(e,r,i)}),n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&pS(e,t)}(t,e),n=t,r=[{key:"componentDidMount",value:function(){var e=this.props,t=e.map,n=e.fetchMapImage,r=e.onReady;n(t.id),r()}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.map,r=t.fetchMapImage,i=t.onReady;e.map!==n&&(r(n.id),i())}},{key:"render",value:function(){var e=this.state,t=e.width,n=e.height,r=e.scale,i=e.offsetX,a=e.offsetY,o=this.props.map.mapImage,s={width:t*r,height:n*r,transform:"translate3d(".concat(i,"px, ").concat(a,"px, 0)"),backgroundImage:"url(".concat(o,")")};return c.createElement("div",{className:"map-image",style:s})}}],i=[{key:"getDerivedStateFromProps",value:function(e,t){var n=e.map,r=e.viewport,i=e.position,a=e.zoom,o=n!==t.map,c=r!==t.viewport,s=a!==t.zoom,u=i!==t.position;if(o||c||s||u){var l=o||c?function(e,t){var n=t.width,r=t.height,i=n/r,a=e.width,o=e.height,c=a/o,s=c>i,u=s?n/a:r/o;return{width:a*u,height:o*u}}(n.imageSize,r):t,p=l.width,f=l.height,h=dS(a),d=mS(i,p,f),m=r.width/2-d.x*h,b=r.height/2-d.y*h;return{map:n,viewport:r,position:i,zoom:a,scale:h,width:p,height:f,offsetX:m,offsetY:b,image:{},url:""}}return null}}],r&&sS(n.prototype,r),i&&sS(n,i),t}(c.Component),yS=vS;function gS(e){return gS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},gS(e)}function OS(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function wS(e){return wS=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},wS(e)}function jS(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _S(e,t){return _S=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},_S(e,t)}function ES(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var AS="pk.eyJ1IjoidnJhdHNldiIsImEiOiJjamszcnp1bGgxMndnM2xrYzZoZnpranI1In0.FtvUVeh62l8Q9rNxUWtx2g",SS=2,xS=256,kS=20037508.34,PS={minX:-85,maxX:85,minY:-180,maxY:180},CS=function(e){function t(){var e,n,r,i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,o=new Array(a),c=0;c<a;c++)o[c]=arguments[c];return r=this,i=(e=wS(t)).call.apply(e,[this].concat(o)),n=!i||"object"!==gS(i)&&"function"!=typeof i?jS(r):i,ES(jS(n),"getScale",function(e){return Math.pow(SS,e)}),ES(jS(n),"getWidth",function(){return xS}),ES(jS(n),"getHeight",function(){return xS}),ES(jS(n),"getBounds",function(){return PS}),ES(jS(n),"initMap",function(){var e=n.props,t=e.position,r=e.zoom;n.map=window.L.mapbox.map("mapbox-map","mapbox.streets",{accessToken:AS,zoomControl:!1}),n.map.dragging.disable(),n.map.touchZoom.disable(),n.map.doubleClickZoom.disable(),n.map.scrollWheelZoom.disable(),n.map.keyboard.disable(),n.projection=window.L.Projection.Mercator,n.map.setView(window.L.latLng(t.y,t.x),r,{animate:!1}),n.props.onReady()}),ES(jS(n),"fromPointMapToLocal",function(e){var t=n.projection.project(window.L.latLng(e.y,e.x)),r=t.x,i=t.y;return{x:(r+kS)/(2*kS)*xS,y:(kS-i)/(2*kS)*xS}}),ES(jS(n),"fromPointLocalToMap",function(e){var t=n.projection.unproject({x:e.x/xS*(2*kS)-kS,y:kS-e.y/xS*(2*kS)});return{y:t.lat,x:t.lng}}),n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_S(e,t)}(t,e),n=t,r=[{key:"componentDidMount",value:function(){Hn().then(this.initMap)}},{key:"componentDidUpdate",value:function(){if(this.map){var e=this.props,t=e.position,n=e.zoom;this.map.setView(window.L.latLng(t.y,t.x),n,{animate:!1})}}},{key:"render",value:function(){return c.createElement("div",{id:"mapbox-map",className:"map-geo-container"})}}],r&&OS(n.prototype,r),i&&OS(n,i),t}(c.PureComponent),TS=CS;function MS(e){return MS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},MS(e)}function DS(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function IS(e){return IS=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},IS(e)}function RS(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function LS(e,t){return LS=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},LS(e,t)}function NS(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var zS=2e3,FS=200,$S={MAP_TYPE_RASTER:yS,MAP_TYPE_GEO:TS},HS={root:"map-zoom-slider__root",trackBefore:"map-zoom-slider__track-before",trackAfter:"map-zoom-slider__track-after",thumb:"map-zoom-slider__thumb"},BS=function(e,t,n){return e+(t-e)*n},YS=function(e){function t(){var e,n,r,i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];return r=this,i=(e=IS(t)).call.apply(e,[this].concat(o)),n=!i||"object"!==MS(i)&&"function"!=typeof i?RS(r):i,NS(RS(n),"state",{isReady:!1,position:{x:0,y:0},zoom:0}),NS(RS(n),"setViewportRef",function(e){n.viewportRef=e}),NS(RS(n),"setMapRef",function(e){n.map=e}),NS(RS(n),"getViewportStyle",function(){var e=n.props,t=e.visibleHeight,r=e.immerseToCamera;return{perspective:zS,perspectiveOrigin:r?"50% 50%":"50% ".concat(100-t,"%")}}),NS(RS(n),"getSceneStyle",function(){var e=n.props.immerseToCamera,t=n.state,r=t.isReady,i=t.rotateAngle,a={transform:"rotateX(".concat(i,"deg)"),transformOrigin:"50% 100%"},o=r&&e?n.calcImmersionTransform(e):a,c=o.transform,s=o.transformOrigin;return{transform:c,transformOrigin:s}}),NS(RS(n),"scrollToPosition",function(e){n.setState({scrollStartTime:+new Date,scrollStartPosition:n.state.position,scrollEndPosition:e}),n.scrollAnimFrameDescriptor=requestAnimationFrame(n.scrollAnimFrame)}),NS(RS(n),"scrollAnimFrame",function(){var e=n.state,t=e.scrollStartTime,r=e.scrollStartPosition,i=e.scrollEndPosition,a=Date.now(),o=a-t;o>=FS?(n.setState({position:i}),n.scrollAnimFrameDescriptor=null):(n.setState({position:{x:BS(r.x,i.x,o/FS),y:BS(r.y,i.y,o/FS)}}),n.scrollAnimFrameDescriptor=requestAnimationFrame(n.scrollAnimFrame))}),NS(RS(n),"updateViewport",function(){n.setState({viewport:n.viewportRef.getBoundingClientRect()})}),NS(RS(n),"adjustPosition",function(){var e=n.state.position,t=n.map.getBounds(),r=t.minX,i=t.minY,a=t.maxX,o=t.maxY;n.setState({position:{x:nm()(e.x,r,a),y:nm()(e.y,i,o)}})}),NS(RS(n),"fromPointMapToLocal",function(e){var t=n.state,r=t.position,i=t.zoom,a=t.viewport,o=n.map.getScale(i),c=n.map.fromPointMapToLocal(r),s=n.map.fromPointMapToLocal(e);return{x:a.width/2+(s.x-c.x)*o,y:a.height/2+(s.y-c.y)*o}}),NS(RS(n),"isOutsideViewport",function(e){var t=n.state.viewport,r=n.fromPointMapToLocal(e),i=r.x,a=r.y;return i<0||i>t.width||a<0||a>t.height}),NS(RS(n),"calcImmersionTransform",function(){return{}}),NS(RS(n),"handleMapReady",function(){n.setState({isReady:!0},n.initPosition)}),NS(RS(n),"handleStartDrag",function(e){var t=e.clientX,r=e.clientY,i=n.state,a=i.position,o=i.zoom;n.setState({initialClientX:t,initialClientY:r,initialPosition:n.map.fromPointMapToLocal(a),initialScale:n.map.getScale(o)}),document.addEventListener("mousemove",n.handleDrag),document.addEventListener("mouseup",n.handleStopDrag),e.stopPropagation&&(e.stopPropagation(),e.preventDefault())}),NS(RS(n),"handleStopDrag",function(){document.removeEventListener("mousemove",n.handleDrag),document.removeEventListener("mouseup",n.handleStopDrag),n.adjustPosition()}),NS(RS(n),"handleDrag",function(e){var t=e.clientX,r=e.clientY,i=n.state,a=i.initialClientX,o=i.initialClientY,c=i.initialPosition,s=i.initialScale,u=t-a,l=r-o,p={x:c.x-u/s,y:c.y-l/s};n.setState({position:n.map.fromPointLocalToMap(p)})}),NS(RS(n),"handleZoomWheel",function(e){e.preventDefault();var t=n.state,r=t.zoom,i=t.viewport,a=t.position,o=e.clientX,c=e.clientY,s=e.deltaY,u=n.props,l=u.minZoom,p=u.maxZoom,f=s>0?-1:1,h=nm()(r+f,l,p),d=n.map.getScale(r),m=n.map.getScale(h),b=o-i.left,v=c-i.top,y=n.map.getWidth(),g=n.map.getHeight(),O=y*d,w=g*d,j=y*m,_=g*m,E=j-O,A=_-w,S=n.map.fromPointMapToLocal(a),x=i.width/2-S.x*d,k=i.height/2-S.y*d,P=(b-x)/O,C=(v-k)/w,T=x-P*E,M=k-C*A,D={x:(i.width/2-T)/m,y:(i.height/2-M)/m};n.setState({zoom:h,position:n.map.fromPointLocalToMap(D)},n.adjustPosition)}),NS(RS(n),"handleZoomSlider",function(e,t){n.setState({zoom:t})}),NS(RS(n),"handleStartZoomViaSlider",function(e){e.preventDefault(),e.stopPropagation()}),NS(RS(n),"renderZoomSlider",function(){var e=n.props,t=e.minZoom,r=e.maxZoom,i=e.visibleHeight,a=n.state.zoom;return 0===i?null:c.createElement("div",{className:"map-zoom-slider__container",style:{height:"".concat(i,"%")},onMouseDown:n.handleStartZoomViaSlider},c.createElement("div",{className:"map-zoom-slider"},c.createElement(cj.a,{classes:HS,value:a,min:t,max:r,step:1,vertical:!0,onChange:n.handleZoomSlider})))}),NS(RS(n),"renderCameraMarker",function(e){var t=n.props,r=t.map,i=t.videoOpacity,a=t.immerseToCamera,o=t.onSelectCamera,s=t.onEnterImmerseMode,u=t.selectedCameraId,l=t.displayMarkerTitle,p=n.state.rotateAngle,f=e.cameraId;return"MAP_GEO"===r.type&&n.isOutsideViewport(e.position)?null:c.createElement(oS,{key:f,selected:f===u,fromPointMapToLocal:n.fromPointMapToLocal,rotateAngle:p,onSelect:o,onEnterImmerseMode:s,immerseMode:!!a,videoOpacity:i,displayMarkerTitle:l})}),NS(RS(n),"renderObjects",function(){var e=n.props,t=e.visibleHeight,r=e.map;return c.createElement("div",{style:{display:t>0?"block":"none"}},r.cameraMarkers.map(n.renderCameraMarker))}),n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&LS(e,t)}(t,e),n=t,r=[{key:"componentDidMount",value:function(){var e=this.props,t=e.fetchMapMarkers,n=e.map;window.addEventListener("resize",this.updateViewport),t(n.id),this.updateViewport()}},{key:"componentDidUpdate",value:function(e,t){var n=this.state,r=n.selectedCamera,i=n.visibleHeight,a=this.props,o=a.fetchMapMarkers,c=a.map;if(c.id!==e.map.id&&o(c.id),i!==t.visibleHeight&&this.updateViewport(),r!==t.selectedCamera&&r){var s=r.position;this.isOutsideViewport(s)&&this.scrollToPosition(s)}}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.updateViewport),this.scrollAnimFrameDescriptor&&cancelAnimationFrame(this.scrollAnimFrameDescriptor)}},{key:"render",value:function(){var e=this.props,t=e.map,n=e.immerseToCamera,r=e.onCancelImmerseMode,i=e.fetchMapImage,a=this.state,o=a.isReady,s=a.position,u=a.zoom,l=a.viewport,p=$S[t.type],f=n?null:this.handleZoomWheel,h=n?r:this.handleStartDrag,d=this.getSceneStyle();return c.createElement("div",{className:"map-viewport",ref:this.setViewportRef,onMouseDown:h,onWheel:f,style:this.getViewportStyle()},o&&this.renderZoomSlider(),c.createElement("div",{className:"map-scene",style:d},l&&c.createElement(p,{ref:this.setMapRef,map:t,viewport:l,position:s,zoom:u,onReady:this.handleMapReady,fetchMapImage:i})))}}],i=[{key:"getDerivedStateFromProps",value:function(e,t){var n=e.map,r=e.visibleHeight,i=e.selectedCameraId,a={};return n!==t.map&&(a.map=n,a.zoom=n.zoom,a.position=n.position,a.isReady=n&&t.map&&n.type===t.map.type),r!==t.visibleHeight&&(a.visibleHeight=r,a.rotateAngle=function(e){return zn(Math.acos(e/100))}(r)),i!==t.selectedCameraId&&(a.selectedCameraId=i,a.selectedCamera=n.cameraMarkers.find(function(e){return e.cameraId===i})),a}}],r&&DS(n.prototype,r),i&&DS(n,i),t}(c.Component);NS(YS,"defaultProps",{minZoom:0,maxZoom:17});var US=YS;function VS(e){return VS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},VS(e)}function WS(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function qS(e){return qS=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},qS(e)}function GS(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function XS(e,t){return XS=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},XS(e,t)}function ZS(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var KS={root:"map-opacity-slider__root",trackBefore:"map-opacity-slider__track-before",trackAfter:"map-opacity-slider__track-after",thumb:"map-opacity-slider__thumb"},QS=function(e){function t(){var e,n,r,i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];return r=this,i=(e=qS(t)).call.apply(e,[this].concat(o)),n=!i||"object"!==VS(i)&&"function"!=typeof i?GS(r):i,ZS(GS(n),"state",{mapIndex:0,displayMarkerTitle:!0,videoOpacity:.5,visibleHeight:0,immerseToCamera:null}),ZS(GS(n),"handleToggl",function(){var e=n.state.visibleHeight,t=e>0&&e<=50?0:50;n.setState({visibleHeight:t})}),ZS(GS(n),"handleMinimize",function(){n.setState({visibleHeight:0})}),ZS(GS(n),"handleMaximize",function(){n.setState({visibleHeight:100})}),ZS(GS(n),"handleEnterImmerseMode",function(e){n.setState({immerseToCamera:e})}),ZS(GS(n),"handleCancelImmerseMode",function(){n.setState({immerseToCamera:null})}),ZS(GS(n),"handleSelectMap",function(e){var t=e.currentTarget.dataset.index;n.setState({mapIndex:+t,immerseToCamera:null})}),ZS(GS(n),"handleChangeVideoOpacity",function(e,t){n.setState({videoOpacity:t})}),ZS(GS(n),"handleToggleDisplayMarkerTitle",function(){n.setState({displayMarkerTitle:!n.state.displayMarkerTitle})}),ZS(GS(n),"renderSwitchButtons",function(){var e=n.state.visibleHeight,t=Ff()("map-switch",{"map-switch_top":e>50});return c.createElement("div",{className:t},c.createElement("button",{onClick:n.handleMinimize,className:"map-switch__button"},c.createElement(ZA.a,{width:16,height:16})),c.createElement("button",{onClick:n.handleToggl,className:"map-switch__button"},"Карта"),c.createElement("button",{onClick:n.handleMaximize,className:"map-switch__button"},c.createElement(QA.a,{width:16,height:16})))}),ZS(GS(n),"renderTab",function(e,t){var r=n.state.mapIndex,i=Ff()("map-toolbar-tab",{"map-toolbar-tab_selected":t===r});return c.createElement("button",{key:t,className:i,"data-index":t,onClick:n.handleSelectMap},e.name)}),ZS(GS(n),"renderOpacitySlider",function(){var e=n.state.videoOpacity;return c.createElement("div",{className:"map-opacity-slider"},c.createElement(cj.a,{classes:KS,value:e,min:0,max:1,step:.1,onChange:n.handleChangeVideoOpacity}))}),ZS(GS(n),"renderDisplayMarkerTitleButton",function(){var e=n.state.displayMarkerTitle,t=Ff()("map-toolbar-title-button",{"map-toolbar-title-button_selected":e});return c.createElement("button",{className:t,onClick:n.handleToggleDisplayMarkerTitle})}),n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&XS(e,t)}(t,e),n=t,r=[{key:"render",value:function(){var e=this.props,t=e.maps,n=e.selectedCameraId,r=e.onSelectCamera,i=e.fetchMapImage,a=e.fetchMapMarkers,o=this.state,s=o.mapIndex,u=o.videoOpacity,l=o.visibleHeight,p=o.immerseToCamera,f=o.displayMarkerTitle,h=l>0?25:0,d={height:p?"100%":"calc(".concat(l,"% + ").concat(h/2,"px)")},m={height:"calc(".concat(100-l,"% - ").concat(h/2,"px)")};return c.createElement("div",{className:"map-manager",style:d},!p&&c.createElement("div",{className:"map-cover",style:m}),c.createElement("div",{className:"map-wrapper"},c.createElement("div",{className:"map-container",ref:this.setContainerRef},!p&&c.createElement("div",{className:"map-controls-container",style:{height:"".concat(l,"%")}},this.renderSwitchButtons()),c.createElement(US,{map:t[s],selectedCameraId:n,visibleHeight:l,videoOpacity:u,displayMarkerTitle:f,immerseToCamera:p,onSelectCamera:r,onEnterImmerseMode:this.handleEnterImmerseMode,onCancelImmerseMode:this.handleCancelImmerseMode,fetchMapImage:i,fetchMapMarkers:a})),c.createElement("div",{className:"map-toolbar",style:{height:h}},c.createElement("div",{className:"map-toolbar-tabs"},t.map(this.renderTab)),this.renderDisplayMarkerTitleButton())))}}],r&&WS(n.prototype,r),i&&WS(n,i),t}(c.Component),JS=QS;function ex(e){return ex="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ex(e)}function tx(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function nx(e){return nx=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},nx(e)}function rx(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ix(e,t){return ix=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},ix(e,t)}var ax,ox=function(e){function t(){var e,n,r,i,a,o,c;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var s=arguments.length,u=new Array(s),l=0;l<s;l++)u[l]=arguments[l];return r=this,i=(e=nx(t)).call.apply(e,[this].concat(u)),n=!i||"object"!==ex(i)&&"function"!=typeof i?rx(r):i,a=rx(n),o="handleSelectCamera",c=function(e){var t=n.props,r=t.layoutCells,i=t.setCamactive,a=r&&r.find(function(t){return t.camera&&t.camera.desc.id===e}),o=a&&a.camera;o&&i(o)},o in a?Object.defineProperty(a,o,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[o]=c,n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ix(e,t)}(t,e),n=t,r=[{key:"componentDidMount",value:function(){this.props.requestMaps()}},{key:"render",value:function(){var e=this.props,t=e.maps,n=e.camActive,r=e.fetchMapImage,i=e.fetchMapMarkers,a=n&&n.desc.id;return t&&0!==t.length?c.createElement(JS,{maps:t,fetchMapImage:r,fetchMapMarkers:i,selectedCameraId:a,onSelectCamera:this.handleSelectCamera}):null}}],r&&tx(n.prototype,r),i&&tx(n,i),t}(c.Component),cx=Object(y.d)((ax=["*"],function(e){var t=WA(ax)(e);return function(e){return c.createElement(g.a,{store:Rp},c.createElement(t,e))}}),GA)(ox);function sx(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function ux(){var e=Object(l.a)("#splash");e.on({dblclick:function(){var t=!Object(d.b)(d.b.key.STATS).get();Object(d.b)(d.b.key.STATS).put(t),e.toggleClass("splash--debug",t),localStorage.setItem("debug",t?"*":"")}}),Object(d.b)(d.b.key.APP_LOADED).observe(e.addClass.bind(e,"splash--mini"))}function lx(){var e=l.a.app.rateIndicator();e.element.appendTo("body"),v.a.common("mount","RateIndicator")}function px(){var e=document.getElementById("view"),t=document.createElement("div");t.classList.add("camera-list"),e.appendChild(t),u.render(c.createElement(id,null),t)}function fx(){var e=document.createElement("div"),t=document.querySelector(".topbar");t&&t.appendChild(e),u.render(c.createElement(em,null),e)}function hx(){var e=l.a.app.multiCam(),t=Object(l.a)("<span>").appendTo("#view"),n=Object(l.a)("<div>").insertAfter(t).addClass("archsearch-view-container");Object(d.b)(d.b.key.APP_MODE).observe(function(r){switch(r){case b.a.LIVE:e.element.insertAfter(t),v.a.common("mount %cLayout","font: bold");break;case b.a.ARCH:e.element.insertAfter(t);break;case b.a.ARCH_SEARCH:u.render(c.createElement(A_,{multiCam:e}),n.get(0));break;case b.a.LAYOUT_EDITOR:u.render(c.createElement(FA,null),document.getElementsByClassName("layout")[0])}}),v.a.common("mount %cArchSearch","font: bold")}function dx(){var e=Object(l.a)('<div class="layout-container" />');u.render(c.createElement(cx,null),e[0]),e.appendTo("#view")}function mx(){}function bx(){l.a.app.layoutShowcase().element.appendTo(".topbar"),v.a.common("mount %cLayoutShowcase","font: bold")}function vx(){l.a.app.fscreen({target:Object(l.a)("body")}).element.addClass("topbar__btn").appendTo(".topbar")}function yx(){var e=l.a.app.selectMode();e.element.appendTo(".topbar")}function gx(){var e=Object(l.a)("<div>").appendTo(".topbar");u.render(c.createElement(LE,null),e.get(0))}function Ox(){var e=Object(l.a)("<div>").addClass("alert-panel").insertBefore("#view");u.render(c.createElement(Lf,null),e.get(0))}function wx(){var e=new P_;function t(t){e.setEnabled(t)}function n(n){n.releasePtz(),e.hide(),Object(d.b)(d.b.key.PTZ_READY).unobserve(t)}function r(n){n.initPtz(),e.setCamera(n).show(),Object(d.b)(d.b.key.PTZ_READY).observe(t)}function i(){var e=Object(d.b)(d.b.key.CAM_ACTIVE).get(),t=Object(d.b)(d.b.key.APP_MODE).get(),i="live"===t;i||d.a.push(n,e),e&&e.ptzExist&&i&&d.a.push(r,e)}e.div.appendTo("#view"),Object(d.b)(d.b.key.CAM_ACTIVE).observe(function(e,t){t&&d.a.push(n,t)}),Object(d.b)(d.b.key.CAM_ACTIVE).observe(i),Object(d.b)(d.b.key.CAM_ARCH).observe(i),v.a.common("mount","PTZ pane")}function jx(){var e=new Nm;e.unmount(),e.subscribe(d.b),Object(d.b)(d.b.key.CAM_ARCH).observe(function(t){e.setCamera(t),t?(e.sm.input("pause"),e.mount()):e.unmount()}),Object(d.b)(d.b.key.PLAYBACK).observe(function(e){e.beginTime&&Object(d.b)(d.b.key.ARCH_TIME).put(e.beginTime)})}function _x(){var e=l.a.app.exportMgr({pollInterval:m.a.settings.pollInterval});e.element.insertBefore("#view"),Object(d.b)(d.b.key.EXPORT_TASK).observe(function(t){return e.addTask.apply(e,sx(t))})}function Ex(){l.a.app.offlineSign().element.appendTo("body")}n.d(t,"o",function(){return ux}),n.d(t,"l",function(){return lx}),n.d(t,"c",function(){return px}),n.d(t,"m",function(){return fx}),n.d(t,"f",function(){return hx}),n.d(t,"i",function(){return dx}),n.d(t,"g",function(){return mx}),n.d(t,"h",function(){return bx}),n.d(t,"e",function(){return vx}),n.d(t,"n",function(){return yx}),n.d(t,"p",function(){return gx}),n.d(t,"a",function(){return Ox}),n.d(t,"k",function(){return wx}),n.d(t,"b",function(){return jx}),n.d(t,"d",function(){return _x}),n.d(t,"j",function(){return Ex})},13:function(e,t,n){"use strict";n.d(t,"a",function(){return G}),n.d(t,"e",function(){return Z}),n.d(t,"f",function(){return K}),n.d(t,"b",function(){return Q}),n.d(t,"g",function(){return te}),n.d(t,"q",function(){return re}),n.d(t,"m",function(){return ie}),n.d(t,"k",function(){return ae}),n.d(t,"p",function(){return oe}),n.d(t,"o",function(){return ce}),n.d(t,"j",function(){return se}),n.d(t,"l",function(){return ue}),n.d(t,"h",function(){return le}),n.d(t,"c",function(){return fe}),n.d(t,"n",function(){return he}),n.d(t,"i",function(){return de}),n.d(t,"d",function(){return me});var r=n(72),i=n.n(r),a=n(102),o=n.n(a),c=n(108),s=n.n(c),u=n(6),l=n.n(u),p=n(24),f=n.n(p),h=n(84),d=n.n(h),m=n(42),b=n.n(m),v=n(223),y=n.n(v),g=n(194),O=n.n(g),w=n(21),j=n.n(w),_=n(224),E=n.n(_),A=n(283),S=n.n(A),x=n(7),k=n.n(x),P=n(53),C=n.n(P),T=n(33),M=n.n(T),D=n(284),I=n.n(D),R=n(56),L=n.n(R),N=n(47),z=n.n(N),F=n(126),$=n.n(F),H=n(39),B=n(43);function Y(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function U(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function V(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,c=e[Symbol.iterator]();!(r=(o=c.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(i)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function W(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function q(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var G=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),q(this,"cacheKey",void 0),q(this,"cacheValue",void 0),this.cacheKey=void 0,this.cacheValue=void 0}var t,n,r;return t=e,n=[{key:"clear",value:function(){return this.cacheKey=void 0,this.cacheValue=void 0,this}},{key:"delete",value:function(){return this.clear(),this}},{key:"get",value:function(){return this.cacheValue}},{key:"has",value:function(e){return this.cacheKey===e}},{key:"set",value:function(e,t){return this.cacheKey=e,this.cacheValue=t,this}}],n&&W(t.prototype,n),r&&W(t,r),e}();function X(e,t){var n=t[t.length-1],r=t[0],i=t.length,a=i-1,o=-1,c=0;if(e>n)return[n,t.length-1];if(e<r)return[r,0];for(;1!==i;){if(i=Math.ceil(i/2),a+=i*o,c=t[a],c===e)return[c,a];o=c>e?-1:1}var s=Math.abs(t[a]-e),u=Math.abs(t[a+o]-e);return s>u&&(a+=o),[t[a],a]}var Z=l()([X,function(e){var t=V(e,2),n=t[1];return n}]),K=l()([X,function(e){var t=V(e,1),n=t[0];return n}]);function Q(e,t,n){var r="",i=n;if(void 0===t){var a=new RegExp(".*".concat(e,"=([^;]+).*"));r=a.test(document.cookie)?document.cookie.replace(a,"$1"):void 0}else{if(r="".concat(e,"=").concat(t),null===t&&(i=-1),i){var o=new Date(Date.now()+i).toUTCString();r+="; expires=".concat(o)}document.cookie=r}return r}var J="MediaSource"in window&&MediaSource.isTypeSupported('video/mp4; codecs="avc1.42c00d, mp4a.40.2"'),ee="MediaSource"in window&&MediaSource.isTypeSupported('video/mp4; codecs="hvc1.1.6.L120.80, mp4a.40.2"');function te(e){var t=window,n=t.disableMse;switch(!0){case!n&&J&&j()(e,B.b.H264):case!n&&ee&&j()(e,B.b.H265):return B.a.MP4;default:return B.a.JPEG}}var ne=function(e){return Promise.resolve(e)};function re(e){var t=e.map(function(e){return e.then(b.a,ne)});return Promise.all(t)}function ie(e,t){var n=new XMLHttpRequest;n.open("GET","languages",!0,e,t),n.send()}var ae=function(e){return function(t){return l()([s.a,k()(function(t){var n=V(t,2),r=n[0],i=n[1];return{tcid:e,id:r,label:i}})])(t)}};function oe(e,t){var n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?U(n,!0).forEach(function(t){q(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):U(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},t,{deltaY:-t.deltaY||-t.originalEvent.deltaY,pageX:t.pageX||t.originalEvent.pageX,pageY:t.pageY||t.originalEvent.pageY});return e(n)}function ce(e,t){return t.preventDefault(),e.apply(void 0,Y(t.originalEvent.changedTouches))}var se=l()([z.a,d.a.convert({rearg:!0})(1)]),ue=function(){var e=Object(H.a)(window.location.href.replace(/[^/]*$/,""));window.location.href=e},le=l()(y()(["getResponseHeader"],["Location"]),L()(/^\//,"")),pe=function(e){return i()([e,[$.a,b.a]])},fe=function e(t){return pe([S.a,l()(C()(e),I()(E.a),pe([O.a,M.a]))])(t)},he=o()(function(e,t){var n=0,r=t;for(t>e&&(n=-e),t<0&&(n=e);r>e||r<0;r+=n);return r});function de(e){return C.a.convert({cap:!1})(function(t,n){return f()(b.a,[n],e)(t)})}function me(e){return delete e.toString,e}},130:function(e,t,n){"use strict";n.d(t,"b",function(){return b}),n.d(t,"d",function(){return v}),n.d(t,"c",function(){return y}),n.d(t,"a",function(){return g});var r=n(1),i=n(3),a=n.n(i),o=n(15),c=n(11),s=n(171),u=n(101),l=n(4),p=(n(37),n(59)),f=n(5),h=n(9);function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function b(){var e,t;return regeneratorRuntime.async(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,regeneratorRuntime.awrap(c.s());case 3:e=n.sent,t=e.data.version,l.a.common("host version",t),n.next=12;break;case 8:return n.prev=8,n.t0=n.catch(0),n.next=12,regeneratorRuntime.awrap(c.H());case 12:case"end":return n.stop()}},null,null,[[0,8]])}function v(){return l.a.common("fetch locale"),c.G().then(a()(["data","languages"]),function(){return Promise.resolve(window.navigator.userLanguage||window.navigator.language)}).then(function(e){var t=e.substr(0,2).toLowerCase();return new Promise(function(e){Object(s.a)(t,function(n){e(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(n,!0).forEach(function(t){m(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({lang:t},n))})})}).then(function(e){return l.a.common("fetch locale %cdone","{color: green}"),h.a.locale=e,r.a.datepicker&&r.a.datepicker.setDefaults(h.a.locale.calendar),r.a.timepicker&&r.a.timepicker.setDefaults(h.a.locale.calendar),e})}function y(){return c.t().then(a()("data"),r.a.noop).then(p.h).then(function(e){return Object(o.b)(o.b.key.LAYOUT_LIST).put(e)}).then(function(){return Object(o.b)(o.b.key.APP_LOADED).put(!0)},r.a.noop)}function g(){var e=new u.c({fails:h.a.settings.errorThreshold,heartbeat:c.I.bind(null,f.i),interval:f.i,topic:Object(o.b)(o.b.key.CONNECTION)});e.heartbeat()}},134:function(e,t,n){"use strict";n.d(t,"a",function(){return h}),n.d(t,"b",function(){return m});var r=n(108),i=n.n(r),a=n(161),o=n.n(a),c=n(34),s=n.n(c);function u(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function p(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,c=e[Symbol.iterator]();!(r=(o=c.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(i)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function h(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return o()(e)?s()(function(e,n){var r=p(n,2),i=r[0],a=r[1];return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(n,!0).forEach(function(t){f(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},e,{},h(a,[].concat(u(t),[i])))},[],i()(e)):f({},t.join("."),e)}var d=window.navigator.language||window.navigator.userLanguage,m="string"==typeof d?d.slice(0,2):"en"},135:function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e){return"function"==typeof e}n.d(t,"a",function(){return a});var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.queue=[],this.pending=!1,this.callback=Function.prototype,this.next=this.next.bind(this)}var t,n,a;return t=e,n=[{key:"getState",value:function(){return{pending:this.pending,length:this.queue.length}}},{key:"onUpdate",value:function(e){return"function"==typeof e&&(this.callback=e),this}},{key:"clear",value:function(){return this.pending=!1,this.queue.length=0,this}},{key:"next",value:function(){if(this.pending=!0,0===this.queue.length)return this.pending=!1,void this.callback(this.getState());var e,t=this.queue.shift(),n=i(t)?t():t;this.callback(this.getState()),Promise.resolve(n).then(this.next,(e=this.next,function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return console.error("job failed: %o",n),e.apply(void 0,n)}))}},{key:"push",value:function(e){if(a=e,a&&"function"==typeof a.then)this.queue.push(e);else{if(!i(e))throw new Error("Not a function nor a Promise");for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];this.queue.push(e.bind.apply(e,[null].concat(n)))}var a;return this.pending||this.next(),this}}],n&&r(t.prototype,n),a&&r(t,a),e}()},136:function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,"a",function(){return a});var a=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),i(this,"cache",void 0),i(this,"cacheTime",void 0),i(this,"validTime",void 0),this.cache=new Map,this.cacheTime=new Map,this.validTime=t}var t,n,a;return t=e,n=[{key:"valid",value:function(e){var t=this.cacheTime.get(e)||0;return!(Date.now()-t>this.validTime)||(this.delete(e),!1)}},{key:"has",value:function(e){return this.cacheTime.has(e)&&this.valid(e)}},{key:"set",value:function(e,t){var n=this;return t instanceof Promise&&t.then(void 0,function(){return n.delete(e)}),this.cacheTime.set(e,Date.now()),this.cache.set(e,t),this}},{key:"get",value:function(e){return this.valid(e)&&this.cache.get(e)}},{key:"delete",value:function(e){return this.cacheTime.delete(e),this.cache.delete(e),this}},{key:"clear",value:function(){return this.cacheTime.clear(),this.cache.clear(),this}}],n&&r(t.prototype,n),a&&r(t,a),e}()},137:function(e,t,n){"use strict";function r(e,t){if(!(this instanceof r))return new r(e,t);this.time={begin:e.getTime(),end:t.getTime()},this.date={begin:e,end:t}}r.prototype={inner:function(e){var t=e.getTime();return this.time.begin<=t&&this.time.end>=t},more:function(e){var t=e.getTime();return this.time.begin>t&&this.time.end>t},less:function(e){var t=e.getTime();return this.time.begin<t&&this.time.end<t}},t.a=r},138:function(e,t,n){"use strict";n.d(t,"c",function(){return X}),n.d(t,"b",function(){return Z});var r=n(51),i=n(9),a=n(165),o=n.n(a),c=n(132),s=n.n(c),u=n(46),l=n.n(u),p=n(21),f=n.n(p),h=n(201),d=n.n(h),m=n(139),b=n.n(m),v=n(34),y=n.n(v),g=n(47),O=n.n(g),w=n(69),j=n.n(w),_=n(43),E=n(39),A=n(115),S=n(136),x=n(65),k=n(4),P=n(73),C=n(5);function T(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function M(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function D(e,t,n){return t&&M(e.prototype,t),n&&M(e,n),e}function I(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function R(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function L(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?R(n,!0).forEach(function(t){N(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):R(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function N(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function z(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var F=s()({method:f()("batch")}),$=s()({method:f()("play"),speed:f()(0),beginTime:d.a,archive:d.a}),H=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.endpoint,n=e.beginTime,r=e.archive;return[t,n,r].join(" ")},B=function(e){var t=e.timestampList,n=z(e,["timestampList"]),r=L({},n);return 1===O()(t)?(r.method="play",r.beginTime=l()(t)):(r.method="batch",r.timestampList=t),r},Y=function(e){return function(t){var n=t.beginTime,r=t.timestampList,i=z(t,["beginTime","timestampList"]);return j()(["cmd"],B,y.a.convert({cap:!1})(function(e){return function(t,n,r){var i=t.buffer,a=t.cmd,o=H(L({},a,{beginTime:n})),c=a,s=i;return e.has(o)?s[r]=e.get(o):c=j()(["timestampList"],function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return[].concat(I(e),[n])},c),{buffer:s,cmd:c}}}(e))({buffer:[],cmd:i},o()([n].concat(r))))}};var U=function(){function e(t,n){var r=this;T(this,e),N(this,"key",void 0),N(this,"conn",void 0),N(this,"mediaState",void 0),N(this,"pending",void 0),N(this,"resolve",void 0),N(this,"width",void 0),N(this,"catchMedia",function(e){var t=e.data,n=t;n.key===r.key&&(r.resolve(n),r.mediaState=r.mediaState.stop())});var i=Object(P.b)(),a=i.promise,o=i.resolve;this.key=-1,this.conn=t,this.mediaState=Object(A.a)(this),this.pending=a,this.resolve=o,this.width=n}return D(e,[{key:"request",value:function(e){var t=this;return this.mediaState=this.mediaState.play(e),this.pending.abort=function(){t.mediaState=t.mediaState.stop()},this.pending}},{key:"updateIndex",value:function(e){var t=this;this.key=Object(x.b)(e),this.pending=new Promise(function(e){t.resolve=e,t.conn.addEventListener("message",t.catchMedia)})}},{key:"clearIndex",value:function(){this.conn.removeEventListener("message",this.catchMedia)}},{key:"setType",value:function(){}}]),e}(),V=function(){function e(t,n){var i=this;T(this,e),N(this,"key",void 0),N(this,"buffer",void 0),N(this,"conn",void 0),N(this,"count",void 0),N(this,"mediaState",void 0),N(this,"catchMedia",function(e){var t=e.data,n=t,r=n.key===i.key;r&&i.count>0&&(i.count-=1,i.emit(n)),0===i.count&&i.stop()}),N(this,"stop",function(){i.mediaState=i.mediaState.stop(),i.emit(r.a)}),this.key=-1,this.conn=t,this.count=0,this.emit=n,this.mediaState=Object(A.a)(this)}return D(e,[{key:"request",value:function(e){return this.count=e.timestampList.length,this.mediaState=this.mediaState.batch(e),this.stop}},{key:"updateIndex",value:function(e){this.key=Object(x.b)(e),this.conn.addEventListener("message",this.catchMedia)}},{key:"clearIndex",value:function(){this.conn.removeEventListener("message",this.catchMedia)}},{key:"setType",value:function(){}}]),e}(),W=new Worker(Object(E.a)("conn.js")),q=i.a.settings.frameWidthList[2],G=function(e){var t=regeneratorRuntime.mark(u),n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:C.d,r=new S.a(n),i=Y(r),a=new MessageChannel,o=a.port1,c=a.port2,s=new Map;function u(e,n){var r,i,a,o,u,l;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:r=!0,i=!1,a=void 0,t.prev=3,o=n[Symbol.iterator]();case 5:if(r=(u=o.next()).done){t.next=16;break}if(l=u.value,void 0!==l){t.next=11;break}return void(t.next=10);case 10:return t.abrupt("continue",13);case 11:l.key=e,c.postMessage(l);case 13:r=!0,t.next=5;break;case 16:t.next=22;break;case 18:t.prev=18,t.t0=t.catch(3),i=!0,a=t.t0;case 22:t.prev=22,t.prev=23,r||null==o.return||o.return();case 25:if(t.prev=25,!i){t.next=28;break}throw a;case 28:return t.finish(25);case 29:return t.finish(22);case 30:s.delete(e);case 31:case"end":return t.stop()}},t,null,[[3,18,22,30],[23,,25,29]])}return o.start(),c.start(),c.addEventListener("message",function(t){var n=t.data,a=n,o=$(a)||F(a),c=o?i(a):{cmd:a,buffer:[]},l=c.cmd,p=c.buffer,f=F(l)?O()(l.timestampList):1;if(0!==p.length){var h=Object(x.b)(l.streamId),d=u(h,p);d.next(),s.set(h,d)}0!==f&&(o&&function(e,t,n){var r=Object(x.b)(n.streamId),i=O()(n.timestampList),a=0;t.addEventListener("message",function o(c){var s=c.data,u=s,l=F(n)?b()(a,n.timestampList):n.beginTime;if(u.key===r){var p=H(L({},n,{beginTime:l}));e.set(p,u),k.a.ws("cache","cached new frame for ".concat(p," ").concat(u.checksum)),a+=1}a===i&&t.removeEventListener("message",o)})}(r,e,l),e.postMessage(l))}),e.addEventListener("message",function(e){var t=e.data;c.postMessage(t),s.has(t.key)&&s.get(t.key).next()}),o}(W);function X(e){var t=e.endpoint,n=e.format,r=void 0===n?_.a.JPEG:n,i=e.beginTime,a=e.archive,o=void 0===a?"":a,c=e.speed,s=void 0===c?0:c,u=e.width,l=void 0===u?q:u,p=e.keyFrames,f=void 0!==p&&p;return new U(G).request({endpoint:t,format:r,beginTime:i,archive:o,speed:s,width:l,keyFrames:f})}function Z(e,t){var n=e.endpoint,r=e.format,i=void 0===r?_.a.JPEG:r,a=e.keyFrames,o=void 0!==a&&a,c=e.timestampList,s=void 0===c?[]:c,u=e.archive,l=void 0===u?"":u,p=e.width,f=void 0===p?q:p;return new V(G,t).request({endpoint:n,format:i,keyFrames:o,timestampList:s,archive:l,width:f})}window.addEventListener("unload",function(){return W.terminate()}),t.a=G},140:function(e,t,n){"use strict";function r(e){var t=document.createElement("div"),n=document.body;t.style.visibility="hidden",t.innerHTML="&nbsp;",t.classList.add(e),n.appendChild(t);var r=t.offsetHeight;return n.removeChild(t),r}n.d(t,"c",function(){return r}),n.d(t,"a",function(){return i}),n.d(t,"b",function(){return a}),n.d(t,"d",function(){return o});var i=16/9;function a(e,t){var n=Math.floor(t/e),r=Math.floor(n/i);return{width:n,height:r}}function o(e,t){var n=[],r=e.toLowerCase(),i=t.toLowerCase(),a=i.length,o=0,c=r.indexOf(i);if(!t)return[{match:!1,substr:e}];for(;-1!==c;){var s=e.slice(o,c);s.length&&n.push({match:!1,substr:s}),n.push({match:!0,substr:e.slice(c,c+a)}),o=c+a,c=r.indexOf(i,o)}return n.push({match:!1,substr:e.slice(o)}),n}},15:function(e,t,n){"use strict";var r=n(1),i=n(135),a=n(173),o=n(12),c=n(67),s=n(127),u=n.n(s),l=n(156),p=n.n(l),f=n(4),h=n(16);n(330);function d(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function m(e){var t=e.pos;return Object(r.a)("<div>").addClass("layout-showcase__layout__cell").css({left:Object(h.a)(t.left),right:Object(h.a)(t.right),top:Object(h.a)(t.top),bottom:Object(h.a)(t.bottom)})}function b(e,t){var n,i=r.a.map(e.cells,m),a=(n=Object(r.a)("<div>").addClass("layout-showcase__layout-overview")).append.apply(n,d(i)),o=Object(r.a)("<span>").addClass("layout-showcase__layout-name").text(e.displayName);return Object(r.a)("<li>").data({idx:t}).attr({title:e.displayName}).addClass("layout-showcase__layout").append(a).append(o)}var v=p()(u()("idx"));r.a.widget("app.layoutShowcase",{_create:function(){var e=this;this.disable=this.setEnable.bind(this,!1),this.enable=this.setEnable.bind(this,!0),this.waitUntilDone=this.waitUntilDone.bind(this),this.updateList=this.updateList.bind(this),this.updateSelect=this.updateSelect.bind(this),this.handleSelect=this.handleSelect.bind(this),this.closeListClickOut=this.closeListClickOut.bind(this),this.handleToggleOpenList=this.handleToggleOpenList.bind(this),this.$list=Object(r.a)("<ul>").addClass("layout-showcase__layout-list"),this.$label=Object(r.a)("<label>").addClass("layout-showcase__arrow"),this.$checkbox=Object(r.a)("<input>").attr({type:"checkbox",hidden:"hidden"}).addClass("layout-showcase__arrow-checkbox"),this.$input=Object(r.a)("<input>").addClass("layout-showcase__input"),this.$label.on({click:function(){document.body.addEventListener("click",e.closeListClickOut,!0),e.handleToggleOpenList()}}),this.topic(this.topic.key.LAYOUT_LIST).observe(this.updateList),this.topic(this.topic.key.LAYOUT_SELECTED).observe(this.updateSelect);var t=function t(n){n.stopPropagation(),Object(r.a)(window).off({keydown:t}),e.$input.appendTo(e.element).on({keyup:function(){var t=e.$input.val(),n=e.$list.get(0),r=n.querySelector("li[title*='".concat(t,"' i]"));r&&r.scrollIntoView({behavior:"smooth"})}}).focus()};this.element.addClass("layout-showcase").append(this.$list).append(this.$checkbox).append(this.$label),this.element.on({click:this.handleSelect,transitionend:function(){var t=e.topic(e.topic.key.LAYOUT_SELECTED).get();if(t){var n=e.$list.children().eq(t.idx);e.$list.scrollTop(e.$list.scrollTop()+n.offset().top+n.height()-e.$list.outerHeight())}},mouseenter:function(){Object(r.a)(window).on({keydown:t})},mouseleave:function(){Object(r.a)(window).off({keydown:t}),e.$input.remove().val("")}})},closeListClickOut:function(e){var t=e.target.classList.contains("layout-showcase__layout");t||(e.preventDefault(),e.stopPropagation(),this.handleToggleOpenList()),document.body.removeEventListener("click",this.closeListClickOut,!0)},handleToggleOpenList:function(){var e=this.$checkbox.prop("checked");this.$list.toggleClass("layout-showcase__layout-list--opened",!e),this.$checkbox.prop({checked:!e})},updateList:function(e){var t,n=r.a.map(e,b);(t=this.$list.empty()).append.apply(t,d(n))},updateSelect:function(e){var t=e.idx;this.$list.children().removeClass("layout-showcase__layout--selected").eq(t).addClass("layout-showcase__layout--selected")},setEnable:function(e){this.element.toggleClass("layout-showcase--disabled",!e),this.enabled=e,f.a.layout("showcase","is enabled: ".concat(e))},waitUntilDone:function(e){e||this.enable()},handleSelect:function(e){var t=Object(r.a)(e.target).data(),n=this.$checkbox.prop("checked");v(t)||(n&&this.handleToggleOpenList(),this.topic(this.topic.key.LAYOUT_SELECTED).put(t))}});n(207);var y=n(9),g=n(11);n(332);r.a.widget("app.logout",{options:{target:Object(r.a)()},defaultElement:"<a>",_create:function(){this.element.addClass("logout").text(y.a.locale.logout).on({click:g.H}).appendTo(this.options.target)}});var O=n(164),w=n.n(O),j=n(144),_=n.n(j),E=n(3),A=n.n(E),S=n(291),x=n.n(S),k=n(68),P=n.n(k),C=n(111),T=n.n(C),M=n(138),D=n(101),I=n(5);n(275),n(248);function R(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,c=e[Symbol.iterator]();!(r=(o=c.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(i)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function L(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var N=function(e){return e.element},z=A()(["origin"]),F=w()(z),$=x()(z),H=P()(["origin"]);r.a.widget("app.multiCam",{options:{rows:2,cols:2},CSS_LAYOUT:"layout",CSS_ROW:"layout__row",INTERVAL:I.i,_init:function(){var e=this;this.cells=[],this.rows=0,this.cols=0,this.recvBytes=0,this.setCells=this.setCells.bind(this),this.updateCells=this.updateCells.bind(this),this.distributeData=this.distributeData.bind(this),this.initIndex=this.initIndex.bind(this),this.handleConn=this.handleConn.bind(this),this.videoSuspend=this.videoSuspend.bind(this),this.stats=this.stats.bind(this),this.conn=M.a,this.conn.addEventListener("message",this.distributeData),this.topic(this.topic.key.LAYOUT_CELLS).observe(this.setCells),this.topic(this.topic.key.STATS).observe(this.stats),this.initIndex(),Object(r.a)(document).on({visibilitychange:function(t){var n=t.target.hidden;return e.videoSuspend(n)}}),this.topic(this.topic.key.CONNECTION).observe(this.handleConn)},_create:function(){this.element.addClass(this.CSS_LAYOUT)},_destroy:function(){this.topic(this.topic.key.LAYOUT_CELLS).unobserve(this.setCells),this.topic(this.topic.key.STATS).unobserve(this.stats),this.topic(this.topic.key.CONNECTION).unobserve(this.handleConn),this.conn.removeEventListener("message",this.distributeData),this.element.remove()},setCells:function(e){var t,n,r=e.length-this.cells.length,i=this.createCells(r),a=(t=this.cells).splice.apply(t,L([this.cells.length+r,-r].concat(i)));f.a.video("MultiCam +%d -%d =%d",i.length,a.length,this.cells.length),a.forEach(this.destroyCell),(n=this.element).append.apply(n,L(i.map(N))),this.updateCells(e)},_setCells:function(e){var t;this.cells.forEach(this.destroyCell),this.cells=this.createCells(e.length),(t=this.element).append.apply(t,L(this.cells.map(N))),this.updateCells(e)},updateCells:function(e){var t=F(e,this.cells),n=F(this.cells,e),r=T()(n,t);_()(function(e){var t=R(e,2),n=t[0],r=t[1];return n.option(r)},r);var i=H($(e,this.cells)),a=H($(this.cells,e)),o=T()(a,i);_()(function(e){var t=R(e,2),n=t[0],r=t[1],i=r.origin,a=r.pos;return n.option({origin:i,pos:a})},o)},setSize:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[this.options.cols,this.options.rows];f.a.deprecated();var n=t[0],r=t[1],i=r*n,a=this.cells.length,o=a-i,c=this.createCells(-o),s=[];s=(e=this.cells).splice.apply(e,L([a-o,o].concat(c))),s.forEach(this.destroyCell),this.topic(this.topic.key.VIEW_COUNT).put(this.rows*this.cols)},createCells:function(e){for(var t=[],n=this.cells.length,i=n+e,a=n;a<i;a+=1)t.push(r.a.app.videoCell({key:a,conn:this.conn}));return t},destroyCell:function(e){e.destroy(),e.element.remove()},setRows:function(e){var t=-(this.rows-e),n=this.element.find(".".concat(this.CSS_ROW)),i=[],a=0;for(a=0;a<t;a+=1)i.push(Object(r.a)("<div>").addClass(this.CSS_ROW));this.element.append(i),t<0&&n.slice(t).each(this.removeRow),this.rows=e},removeRow:function(e,t){t.remove()},reorderByCols:function(e,t){var n=this.element.find(".".concat(this.CSS_ROW)),r=e.length,i=0,a=0;for(i=0;i<r;i+=1)a=Math.floor(i/t),n.eq(a).append(e[i].element);this.cols=t},getRecvBytes:function(){var e=this.recvBytes;return this.recvBytes=0,{bytes:e,streams:this.topic(this.topic.key.CELL_IDX).get().size}},publishRate:function(e){e.topic(e.topic.key.BITRATE).put(e.getRecvBytes())},stats:function(e){e?this.rateTimer=setInterval(this.publishRate,this.INTERVAL,this):clearInterval(this.rateTimer)},initIndex:function(){var e=this,t=new Map;t.toString=function(){return Object.keys(e).slice(-1).join(" ")},this.topic(this.topic.key.CELL_IDX).put(t)},distributeData:function(e){var t=e.data,n=this.topic(this.topic.key.CELL_IDX).get().get(t.key);n&&(this.recvBytes+=t.payload.byteLength,n.push(t))},handleConn:function(e){var t=e===D.a;this.videoSuspend(t)},videoSuspend:function(e){var t,n=this.topic(this.topic.key.ARCH_TIME).get(),r=this.topic(this.topic.key.PREFS).get(),i=r.disconnectInactive;i&&(!e&&Number.isFinite(this.keptSpeed)&&(t=this.keptSpeed,this.keptSpeed=void 0),e&&(t=0,this.keptSpeed=this.topic(this.topic.key.PLAYBACK).get().speed),(t||n)&&this.topic(this.topic.key.PLAYBACK).assign({speed:t,beginTime:n}))}}),r.a.widget("app.rateIndicator",{_create:function(){this.element.addClass("rate-indicator").addClass("hidden"),this.stats=this.stats.bind(this),this.render=this.render.bind(this),this.topic(this.topic.key.STATS).observe(this.stats)},_destroy:function(){this.topic(this.topic.key.STATS).unobserve(this.stats)},render:function(e){var t=e.bytes,n=e.streams,r=Date.now(),i=r-this.lastTime;this.element.text("".concat(Object(h.h)(t,i).toFixed(2)," KB/s (").concat(n,")")),this.lastTime=r},stats:function(e){e?(this.topic(this.topic.key.BITRATE).observe(this.render),this.lastTime=Date.now()):(this.element.text(""),this.topic(this.topic.key.BITRATE).unobserve(this.render)),this.element.toggleClass("hidden",!e)}});var B=n(24),Y=n.n(B),U=n(7),V=n.n(U),W=n(95),q=n(13);function G(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var X=V.a.convert({cap:!1});Y()({});r.a.widget("app.selectArch",{options:{idx:-1},defaultElement:"<div>",_create:function(){this.update=this.update.bind(this),this.updateSelected=this.updateSelected.bind(this),this.setArch=this.setArch.bind(this),this.toggleShow=this.toggleShow.bind(this),this.$select=Object(r.a)("<select>").addClass("VideoCell-opts__selector").on({change:this.setArch}),this.element.addClass("VideoCell-opts").addClass("hidden").append(this.$select),this.topic(this.topic.key.CAM_ARCH).observe(this.toggleShow)},setCamera:function(e){this.camera&&this.camera.archSelected.unobserve(this.updateSelected),e&&(this.camera=e,this.camera.archSelected.observe(this.updateSelected),this.update())},setArch:function(e){var t=e.target.value;this.camera.setArchSelectedByIdx(t)},update:function(){var e;if(this.camera){var t=this.camera.archList,n=X(function(e,t){var n=Object(W.a)(e.storage)?y.a.locale.embeddedStorage:e.storageDisplayName;return Object(r.a)("<option>").attr({value:t}).data(e).text(n)}),i=n(t);(e=this.$select.empty()).append.apply(e,G(i)),this.element.toggleClass("VideoCell-opts--active",Object(q.j)(i))}else this.$select.empty()},updateSelected:function(e){var t=this.camera.getArchIdx(e);this.$select.val(t)},toggleShow:function(e){this.element.toggleClass("hidden",Boolean(!e))},_destroy:function(){this.topic(this.topic.key.CAM_ARCH).unobserve(this.toggleShow)}});n(342);r.a.widget("app.notify",{options:{text:""},_create:function(){var e=this;this.$notify=Object(r.a)("<div>").addClass("notify").text(this.options.text).appendTo(document.body),this.$notify.fadeIn().delay(I.h).fadeOut().queue(function(){return e.destroy()})},_destroy:function(){this.$notify.remove(),this.$notify=void 0}});n(343);r.a.widget("app.offlineSign",{_create:function(){var e=Object(r.a)("<div>").text(y.a.locale.serverOffline);this.handleConn=this.handleConn.bind(this),this.topic(this.topic.key.CONNECTION).observe(this.handleConn),this.element.addClass("offline-sign").addClass("hidden").append(e)},_destroy:function(){this.topic(this.topic.key.CONNECTION).unobserve(this.handleConn)},handleConn:function(e){var t=e===D.b;this.element.toggleClass("hidden",t)}}),n.d(t,"b",function(){return Z}),n.d(t,"a",function(){return K});var Z=Object.assign(a.a,o.a),K=new i.a;Object.values(r.a.app).forEach(function(e){e.prototype.topic=Z}),c.a.prototype.topic=Z},16:function(e,t,n){"use strict";n.d(t,"l",function(){return j}),n.d(t,"h",function(){return _}),n.d(t,"e",function(){return A}),n.d(t,"f",function(){return S}),n.d(t,"i",function(){return x}),n.d(t,"m",function(){return k}),n.d(t,"k",function(){return P}),n.d(t,"j",function(){return C}),n.d(t,"g",function(){return T}),n.d(t,"a",function(){return M}),n.d(t,"b",function(){return D}),n.d(t,"d",function(){return I}),n.d(t,"c",function(){return R});var r=n(106),i=n.n(r),a=n(6),o=n.n(a),c=n(32),s=n.n(c),u=n(159),l=n.n(u),p=n(7),f=n.n(p),h=n(169),d=n.n(h),m=n(290),b=n.n(m),v=n(170),y=n.n(v),g=n(110),O=n.n(g),w=n(5);function j(e){return"".concat((e/1e6).toFixed(2),"Mbps")}function _(e,t){var n=e>>10;return n/(t*w.e)}var E=Intl.DateTimeFormat("en",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"}),A=E.format;function S(e){var t=Math.floor(e/w.d),n=Math.floor(e%w.d/w.f),r=Math.floor(e%w.f/w.h);return[x(t),x(n),x(r)].join(":")}function x(e,t){return isFinite(e)?e.toString(t).padStart(2,"0"):""}var k=o()([l.a,f()(function(e){var t=e;return t=(240&t)>>4|(15&t)<<4,t=(204&t)>>2|(51&t)<<2,t=(170&t)>>1|(85&t)<<1,t}),f()(function(e){return e.toString(16)}),f()(d()("0")(2)),y()(""),b()("0"),O.a]),P=o()([s()(Boolean),f()(function(e){return e.toString(16)}),f()(d()("0")(2)),y()("")]),C=o()([f()(function(e){return e.toString(16)}),f()(d()("0",2)),y()(""),O.a]);function T(e){var t=x(e.getDate()),n=x(e.getMonth()+1),r=e.getFullYear(),i=x(e.getHours()),a=x(e.getMinutes()),o=x(e.getSeconds());return"".concat(r,"-").concat(n,"-").concat(t,"--").concat(i,"-").concat(a,"-").concat(o)}function M(e){return"".concat(Math.round(100*e),"%")}var D=function(e){return e.toFixed(3)},I=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return i()(new Date(e),"HH:MM:ss dd.mm.yyyy")},R=function(e){return(e/1e6).toFixed(2)}},1601:function(e,t,n){},1602:function(e,t,n){e.exports=n.p+"favicon.ico"},171:function(e,t,n){"use strict";n.d(t,"b",function(){return G});var r=n(1),i=n(8),a=n(293),o=n.n(a),c=n(294),s=n.n(c),u=n(295),l=n.n(u),p=n(296),f=n.n(p),h=n(297),d=n.n(h),m=n(298),b=n.n(m),v=n(299),y=n.n(v),g=n(300),O=n.n(g),w=n(301),j=n.n(w),_=n(302),E=n.n(_),A=n(303),S=n.n(A),x=n(304),k=n.n(x),P=n(305),C=n.n(P),T=n(306),M=n.n(T),D=n(307),I=n.n(D),R=n(308),L=n.n(R),N=n(309),z=n.n(N),F=n(310),$=n.n(F),H=n(311),B=n.n(H),Y=n(312),U=n.n(Y);function V(e){return V="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},V(e)}function W(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function q(e,t){for(var n=q.lang.length,i=!0,a={};n--&&i;)-1!==q.lang[n].langCode.indexOf(e)&&(i=!1,n+=1);for(var o in-1===n&&(n=1),q.loc)q.loc.hasOwnProperty(o)&&(a[o]=q.loc[o][n]);function c(e,t){Object(r.a)(t).find("resources").children().each(function(){var t=Object(r.a)(this),n=t.attr("name").split("-"),i=e;n.forEach(function(e,t,n,r){function a(e,t){return"array"===e?Array.isArray(t):V(t)===e}if(e===r)if(a("string",n))void 0===i[n]&&(i[n]=t);else{if(!a("number",n))throw TypeError;a("array",i)?void 0===i[n]&&(i[n]=t):(i=[],i[n]=t)}else{if(!a("string",n))throw TypeError;n in i||(i[n]={}),i=i[n]}}.bind(void 0,n.length-1,t.text()))})}var s={},u="".concat("locale/","strings-").concat(e,".xml"),l="".concat("locale/","strings.xml");return r.a.get(u,c.bind(void 0,s)).always(function(){r.a.get(l,c.bind(void 0,s)).always(function(){t(s)})}),a}function G(e){var t={};return function e(t,n,r){for(var i in n)if(n.hasOwnProperty(i)){var a=i,o=n[i];t.length>0&&(a="".concat(t,".").concat(i)),"object"===V(o)?e(a,o,r):r[a]=o}}("",e,t),t}Object(i.d)([].concat(W(o.a),W(s.a),W(l.a),W(f.a),W(d.a),W(b.a),W(y.a),W(O.a),W(j.a),W(E.a),W(S.a),W(k.a),W(C.a),W(M.a),W(I.a),W(L.a),W(z.a),W($.a),W(B.a),W(U.a))),q.lang=[{langCode:["ru","ru-RU"],langName:"Русский"},{langCode:["en","en-US"],langName:"English"}],q.loc={enter:["Войти","Enter"],find:["Имя камеры","Cameras name"],findTitle:["Поиск по имени: ","Search by Name: "],live:["Живой","Live"],archive:["Архив","Archive"],edit:["Редавтировать","Edit"],presets:["Предустановки","Presets"],ptzControl:["Управление PTZ","PTZ control"],calendar:[{closeText:"Установить",timeOnlyTitle:"Выберите время",timeText:"Время",hourText:"Часы",minuteText:"Мин.",secondText:"Сек.",millisecText:"Миллисекунды",timezoneText:"Часовой пояс",currentText:"Сейчас",dateFormate:"dd/mm/yy",dayNames:["Воскресенье","Понедельник","Вторник","Среда","Четверг","Пятница","Суббота"],dayNamesMin:["Вс","Пн","Вт","Ср","Чт","Пт","Сб"],dayNamesShort:["Вос","Пон","Втр","Срд","Чтв","Пят","Суб"],monthNames:["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],monthNamesShort:["Янв","Фев","Мар","Апр","Май","Июн","Июл","Авг","Сен","Окт","Нояб","Дек"],nextText:"Следующий",prevText:"Предыдущий"},{closeText:"Set",currentText:"Today",dateFormate:"mm/dd/yy",dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],nextText:"Next",prevText:"Prev"}],prevFrame:["Предыдущий кадр","Prev frame"],nextFrame:["Следующий кадр","Next frame"],prevInt:["Предыдущий интервал","Prev interval"],nextInt:["Следующий интервал","Next interval"],error:["Ошибка","Error:"],warn:["Предупреждение:","Warning:"],info:["Информация:","Info:"],escapePress:["Нажат Esc, возможно не все объекты загрузились, пожалуйста повторите попытку.","Pressed Esc, maybe not all objects are loaded, please try again."],running:["Запуск клиента ITV","Running ITV client"],logged:["Выполнен вход","Logged"],notAllPresetsRecieved:["Не все предустановки получены, пожалуйста повторите попытку","Not all presets received, please try again"],notAllDegreesRecieved:["Не все степени свободы получены, пожалуйста повторите попытку","Not all degrees of freedom are obtained, please try again"],notTelemetryRecieved:["Не получено устройство телеметрии, пожалуйста повторите попытку","Not received telemetry device, please try again"],timeoutException:["Сервер удержал соединение выше таймаута. Возможно команда не выполнена, пожалуйста повторите попытку.","The server connection is kept above the timeout. Perhaps the team failed, please try again."],notGetArchive:["Не удалось получить архив, пожалуйста повторите попытку.","Could not get archive, please try again."],cameraNotFound:["Камера не найдена:","Camera not found:"],notGetUUID:["Не получен UUID","Do not get the UUID"],archiveNotFound:[" Позиционирование на архив невозможно.","Positioning of the archive is not possible."],cameraWithNameNotFound:["Камера с таким именем не найдена:","Unable to find specified camera:"],choseDate:["Выбрать дату","Select date"],badDate:["Архив не найден на данную дату: ","Archive not found: "]},t.a=q},173:function(e,t,n){"use strict";n.d(t,"a",function(){return y}),n.d(t,"b",function(){return g});var r=n(150),i=n.n(r),a=n(281),o=n.n(a),c=n(3),s=n.n(c),u=n(88),l=n.n(u),p=n(23);function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var d={},m=l.a,b=l.a,v=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),h(this,"key",void 0),h(this,"handlers",void 0),h(this,"mustFireCount",void 0),h(this,"unsubscribe",void 0),this.key=t,this.handlers=[],this.mustFireCount=0}var t,n,r;return t=e,n=[{key:"observe",value:function(e){if("function"!=typeof e)throw new Error("No handler provided");this.handlers.push(e);var t=this.get();return t&&e(t),this}},{key:"unobserve",value:function(e){var t=this.handlers.findIndex(function(t){return t===e});return-1!==t&&this.handlers.splice(t,1),this}},{key:"put",value:function(e,t){return t&&(this.mustFireCount=this.handlers.length),b(Object(p.e)(this.key,e)),this}},{key:"assign",value:function(e){var t=this.get(),n=i()(t,e);return this.mustFireCount=this.handlers.length,b(Object(p.e)(this.key,n)),this}},{key:"get",value:function(){return m(this.key).val}},{key:"getPromise",value:function(){return Promise.resolve(this.value)}},{key:"notifyHandlers",value:function(){var e=m(this.key),t=e.val,n=e.old,r=this.mustFireCount>0;(t!==n||r)&&this.handlers.forEach(function(e){return e(t,n)})}}],n&&f(t.prototype,n),r&&f(t,r),e}();function y(e){return d[e]||(d[e]=new v(e)),d[e]}function g(e){return m=function(t){var n=e.getState();return{val:s()(["topic",t],n),old:s()(["topic",Object(p.d)(t)],n)}},b=e.dispatch.bind(e),y.dump=function(){return{values:e.getState().topic,topics:d}},function(e){return function(t){var n=t.type,r=t.payload,i=Object(p.b)(n)?Object(p.c)(n):"";i&&y(i)&&o()(function(){return d[i].notifyHandlers(r)}),e(t)}}}},174:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=function(e){return function(t){2===t.button&&e(t)}}},187:function(e,t){},207:function(e,t,n){"use strict";var r=n(1);n(331);r.a.widget("app.fscreen",{options:{target:Object(r.a)()},defaultElement:"<div>",_create:function(){var e=this,t=Object(r.a)("<label>").addClass("fscreen"),n=Object(r.a)("<div>").addClass("fscreen__full fscreen__state"),i=Object(r.a)("<div>").addClass("fscreen__norm fscreen__state"),a=Object(r.a)("<span>").addClass("fscreen__arrow"),o=Object(r.a)("<input>").addClass("fscreen__chk").attr({type:"checkbox",hidden:!0});t.append(o).append(a).append(n).append(i),this.element.append(t).on({change:function(){Object(r.a)(this.options.target).fullScreen(o.prop("checked"))}.bind(this)}),Object(r.a)(document).on({fullscreenchange:function(){var t=e.options.target,n=t.get(0),r=t.fullScreen(),i=n===r;t.toggleClass("VideoCell--fullscreen",i),o.prop("checked",i)}})}})},209:function(e,t,n){},23:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(100);n.d(t,"a",function(){return r.a}),n.d(t,"b",function(){return r.b}),n.d(t,"c",function(){return r.c}),n.d(t,"d",function(){return r.d});var i=function(e,t){return{type:Object(r.a)(e),payload:t}}},242:function(e,t,n){"use strict";var r=n(1),i=n(111),a=n.n(i),o=n(11),c=n(16),s=n(5),u=n(4),l=n(13);n(334);function p(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function f(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,c=e[Symbol.iterator]();!(r=(o=c.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(i)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}r.a.widget("app.exportMgr",{options:{pollInterval:5e3},exportState:{PENDING:1,DONE:2,FAILED:3,NOSPACE:4},exportClass:{1:"export-task--pending",2:"export-task--done",3:"export-task--error",4:"export-task--error"},_create:function(){var e=this,t=Object(r.a)("<div>").addClass("export-task__button-bar"),n=Object(r.a)("<button>").addClass("export-task__button export-task__button-prev"),i=Object(r.a)("<button>").addClass("export-task__button export-task__button-next"),a=Object(r.a)("<button>").addClass("export-task__button export-task__button-stop"),o=Object(r.a)("<button>").addClass(["export-task__button","export-task__button-stop","export-task__button-stop--all"].join(" ")),c=Object(r.a)("<span>").addClass("export-task__progress"),s=Object(r.a)("<span>").addClass("export-task__caption"),u=Object(r.a)("<ul>").addClass("export-task__links"),l=Object(r.a)("<span>"),p=this.element.addClass("export-task");return p.append(s).append(s).append(c).append(u).append(t),t.append(a).append(n).append(l).append(i).append(o),n.on({click:function(){var t=e.tasks.length,n=e.idx,r=(n+t-1)%t;e.renderTask(r)}}),i.on({click:function(){var t=e.tasks.length,n=e.idx,r=(n+1)%t;e.renderTask(r)}}),a.on({click:function(){var t;e.stopTask(e.idx),t=Math.min(e.idx,e.tasks.length-1),e.renderTask(t)}}),o.on({click:this.stopAllTasks.bind(this)}),this.$task=p,this.$progress=c,this.$caption=s,this.$links=u,this.$index=l,this},addTask:function(e,t,n,r){var i,a=this,p=Object.create(null),f=this.exportState;p.caption="".concat(e.id," ").concat(e.name," ").concat(Object(c.e)(t)," +").concat(Object(c.f)(n-t)),p.state=f.PENDING,u.a.export("Exporting","from",t,"to",n);var h=e.isLive,d=e.activeSource,m=e.archiveDesc,b=void 0===m?{}:m,v=b.accessPoint,y=b.storage;p.postXhr=o.K({isLive:h,vsid:h?d:v,archive:y,begintime:t===s.g?"past":t,endtime:n===s.g?"future":n,extended:r}),p.postXhr.then(function(e){var t=e.jqXhr;p.location=Object(l.h)(t),u.a.export("Export at",p.location)},function(){u.a.export("Export post","failed"),p.state=f.FAILED,a.renderTask(i)}),i=this.tasks.push(p)-1,this.statusQueue.push(i),this.renderTask(i),this.pollStatus()},tasks:[],idx:-1,getStatus:function(e){var t=this,n=r.a.ajax.prototype;return n=o.p({location:this.tasks[e].location}),this.tasks[e].statusXhr=n,n.then(function(n){var i=n.data;return u.a.export("Export status",i.id,i.progress,i.state,i.error),t.tasks[e]=r.a.extend(t.tasks[e],i),i.state===t.exportState.PENDING&&t.statusQueue.push(e),{idx:e,state:i.state}},function(){return t.statusQueue.push(e),{idx:-1,state:t.exportState.PENDING}})},statusTimerId:0,statusQueue:[],pollStatus:function(){var e=this;this.statusTimerId=setTimeout(function(){var t="";e.statusQueue.length>0&&(t=e.statusQueue.shift(),e.getStatus(t).then(function(t){t.state===e.exportState.PENDING&&t.idx!==e.idx||e.renderTask(t.idx),e.pollStatus()}))},this.options.pollInterval)},renderTask:function(e){var t;if(this.idx=e,-1!==e){var n=this.tasks[e],i=a()(n.files,n.filesFriendly).map(function(e){var t=f(e,2),i=t[0],a=t[1],c=Object(r.a)("<li>"),s=Object(r.a)("<a>").addClass("export-task__links-item").attr({download:a,href:o.W({location:n.location,file:i})}).text(a);return c.append(s)});this.$caption.text(n.caption),this.$progress.text(n.progress?Math.floor(100*n.progress):0),this.$task.attr({class:"export-task export-task--active"}).addClass(this.exportClass[n.state]),this.$links.empty(),(t=this.$links).append.apply(t,p(i)),this.$index.text([e+1,this.tasks.length].join("/"))}else this.$task.removeClass(["export-task--active","export-task--done"])},stopTask:function(e){var t=this.tasks.splice(e,1)[0];t.postXhr&&t.postXhr.abort(),this.statusQueue=this.statusQueue.filter(function(t){return t!==e}),t.statusXhr&&t.statusXhr.abort(),o.S({location:t.location}),u.a.export("Export clear",t.location)},stopAllTasks:function(){for(var e=this.tasks.length-1;e>=0;e-=1)this.stopTask(e);this.$task.removeClass(["export-task--active","export-task--done"]),this.idx=-1},_destroy:function(){this.stopAllTasks(),this.element.removeAttr("class").empty()}})},243:function(e,t,n){},244:function(e,t){e.exports='<svg class="Playback__icon" viewBox="0 0 19 13"><g><polygon points="7,6.5 13.8,13 13.8,0"></polygon><polygon points="0.2,6.5 7,13 7,0"></polygon><rect x="17" y="0" width="2" height="13"></rect></g></svg>'},245:function(e,t){e.exports='<svg class="Playback__icon" viewBox="0 0 13 13"><g><polygon points="0,6.5 6.8,13 6.8,0"></polygon><rect x="10" y="0" width="2" height="13"></rect></g></svg>'},246:function(e,t){e.exports='<svg class="Playback__icon" viewBox="0 0 13 13"><g><polygon points="12,6.5 5.2,13 5.2,0 "></polygon><rect x="0" y="0" width="2" height="13"></rect></g></svg>'},247:function(e,t){e.exports='<svg class="Playback__icon" viewBox="0 0 19 13"><g><polygon points="12.2,6.5 5.3,13 5.3,0 "></polygon><polygon points="19,6.5 12.2,13 12.2,0 "></polygon><rect x="0" y="0" width="2" height="13"></rect></g></svg>'},248:function(e,t,n){},25:function(e,t,n){"use strict";n.d(t,"c",function(){return r}),n.d(t,"a",function(){return i}),n.d(t,"b",function(){return a});var r="common/CAM_SELECT",i={ARCH:"arch",LIVE:"live",ARCH_SEARCH:"search",LAYOUT_EDITOR:"layoutEditor"},a=16/9},257:function(e,t,n){"use strict";var r=n(0),i=n.n(r),a=n(17),o=n(18),c=n.n(o),s=n(7),u=n.n(s),l=n(140);var p=u.a.convert({cap:!1});t.a=Object(a.withStyles)(function(e){return{selected:{textDecoration:"underline",textDecorationColor:e.palette.accent}}})(function(e){var t=e.string,n=e.rule,r=e.classes;return i.a.createElement(i.a.Fragment,null,p(function(e,t){var n,a,o,s=e.substr,u=e.match;return i.a.createElement("span",{key:"".concat(s,"-").concat(t),className:c()((n={},a=r.selected,o=u,a in n?Object.defineProperty(n,a,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[a]=o,n))},s)})(Object(l.d)(t,n)))})},27:function(e,t,n){"use strict";n.d(t,"h",function(){return X}),n.d(t,"l",function(){return K}),n.d(t,"o",function(){return J}),n.d(t,"f",function(){return ee}),n.d(t,"g",function(){return te}),n.d(t,"k",function(){return ie}),n.d(t,"e",function(){return ue}),n.d(t,"c",function(){return le}),n.d(t,"n",function(){return fe}),n.d(t,"a",function(){return he}),n.d(t,"b",function(){return de}),n.d(t,"p",function(){return be}),n.d(t,"j",function(){return ve}),n.d(t,"i",function(){return ye}),n.d(t,"m",function(){return ge}),n.d(t,"d",function(){return Oe});var r,i=n(285),a=n.n(i),o=n(6),c=n.n(o),s=n(32),u=n.n(s),l=n(108),p=n.n(l),f=n(3),h=n.n(f),d=n(24),m=n.n(d),b=n(84),v=n.n(b),y=n(127),g=n.n(y),O=n(42),w=n.n(O),j=n(21),_=n.n(j),E=n(158),A=n.n(E),S=n(85),x=n.n(S),k=n(7),P=n.n(k),C=n(92),T=n.n(C),M=n(70),D=n.n(M),I=n(56),R=n.n(I),L=n(159),N=n.n(L),z=n(43),F=n(11),$=n(136),H=n(95),B=n(73),Y=n(93),U=n(5);function V(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,c=e[Symbol.iterator]();!(r=(o=c.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(i)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function W(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function q(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?W(n,!0).forEach(function(t){G(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):W(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function G(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var X=c()(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e.match(/^(hosts\/)?([^/]+)/)},h()(2)),Z=R()(/[^/]*$/,""),K=R()(/:\d{1,}$/,""),Q=R()(/video:\d+/,"video:1"),J=/DeviceIpint\.(.+)\/SourceEndpoint\.video:(\d+):(\d+)/;function ee(e){var t=J.exec(e);return t?[t[1],t[2]]:[]}function te(e){return"0"===e[1]?e[0]:e.join(".")}var ne=h()("videoStreams[0].accessPoint"),re=h()("origin"),ie=c()([h()("videoStreams"),x.a,h()("accessPoint")]),ae=c()([h()("videoStreams.length"),v.a.convert({rearg:!0})(0)]);var oe=P()(D()("accessPoint"));var ce=h()(["data","nextPageToken"]),se=c()([h()(["data","cameras"]),P()(function(e){var t=e;return ae(e)||(t.videoStreams=oe(e.archives)),t}),u()(ae),A()(ne),P.a.convert({cap:!1})(function(e,t,n){var r=ne(e),i=ee(r),a="0"===i[1],o=g()(Q(r),n);return q({dev:Z(r),host:X(r),id:a&&!o?i[0]:i.join("."),channel:K(r),origin:r},e)})]);function ue(e,t){var n=[],r=F.i({filter:e,limit:t}),i=[],o=Object(B.b)(),s=o.promise,u=o.resolve,l=o.reject,p={abort:function(){r.abort()},progress:function(e){return"function"==typeof e&&i.push(e),this},then:function(e,t){return this.promise=this.promise.then(e,t),this},promise:s};return r.then(function o(s){var l=ce(s);return n=a()(n)(se(s)),c()(i)(n),l?(r=F.i({filter:e,limit:t,next:l}),r.then(o,w.a),p.abort=r.abort,p):(u(n),n)},function(e){return l(e),e}),p}var le=T()(function(e){return F.i({filter:e}).then(se)});le.cache=new $.a(U.d);var pe=m()(0,"streamType"),fe=c()(h()(["data"]),p.a,P()(function(e){var t=V(e,2),n=t[0],r=t[1];return q({format:Object(H.b)(pe(r)),accessPoint:n},r)}),u()(h()("streamType"))),he="ALPHABET",de="ID",me=(r={},G(r,he,function(e){return Object(Y.c)(["displayName","id"],[Y.a,Y.b],e)}),G(r,de,function(e){return Object(Y.c)(["id"],[Y.b],e)}),r),be=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:de;return c()([me[t],e?N.a:w.a])},ve=h()("ptzs[0].accessPoint"),ye=h()("ptzs[0]"),ge=(c()(ye,D()(["move","zoom"])),function(e,t){return _()(re(e),re(t))}),Oe=P()(function(e){return q({format:z.b.MJPG},e)})},275:function(e,t,n){"use strict";var r=n(1),i=n(151),a=n.n(i),o=n(3),c=n.n(o),s=n(24),u=n.n(s),l=n(97),p=n.n(l),f=n(21),h=n.n(f),d=n(92),m=n.n(d),b=n(121),v=n.n(b),y=n(9),g=n(115),O=n(44);function w(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function j(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var _=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),j(this,"handleLoad",void 0),j(this,"handleError",void 0),j(this,"handleLoad",Function.prototype),j(this,"handleError",Function.prototype),j(this,"handleStop",Function.prototype)}var t,n,r;return t=e,n=[{key:"clean",value:function(){}},{key:"play",value:function(){}},{key:"stop",value:function(){}},{key:"push",value:function(){}},{key:"stats",value:function(){}},{key:"setAudio",value:function(){}},{key:"getImageData",value:function(){return O.d}},{key:"getImageInfo",value:function(){return{}}}],n&&w(t.prototype,n),r&&w(t,r),e}(),E=_,A=n(40),S=n.n(A),x=n(188),k=n.n(x),P=n(4),C=8;function T(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=0,i=0;i<e;i+=1)r+=t[n+i]<<(e-1-i)*C;return r}function M(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return e[n+(t=r,t/C|0)]>>C-1-r%C&1}function D(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,c=e[Symbol.iterator]();!(r=(o=c.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(i)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var I={tags:[null,null,null,"ES_DescrTag","DecoderConfigDescrTag","DecoderSpecificInfo"],DecoderSpecificInfo:function(e){var t={};return t.objectType=e[1]>>3,t},DecoderConfigDescrTag:function(e){var t={},n=1;t.objectTypeIndication=e[n++],t.streamType=127&e[n],t.upStream=2&e[n++],t.bufferSizeDB=T(3,e,n+=3),t.maxBitrate=T(4,e,n),n+=4,t.avgBitrate=T(4,e,n),n+=4;var r=this.tags[e[n++]],i=R(e,n);return this[r]&&(t[r]=this[r](i)),t},ES_DescrTag:function(e){var t={},n=1;t.ES_ID=T(2,e,n),n+=2,t.streamDependenceFlag=256&e[n],t.URL_Flag=128&e[n],t.OCRstreamFlag=64&e[n],t.streamPriority=63&e[n],n+=1,t.streamDependenceFlag&&(t.dependsOn_ES_ID=T(2,e,n),n+=2),t.URL_Flag&&(t.URLlength=e[n++],t.URLstring=e.subarray(n,n+=t.URLlength)),t.OCRstreamFlag&&(t.OCR_ES_Id=T(2,e,n),n+=2);var r=this.tags[e[n++]],i=R(e,n);return this[r]&&(t[r]=this[r](i)),t}};function R(e,t){var n=function(e,t){for(var n=t,r=128&e[n],i=127&e[n],a=i;r;)r=128&e[++n],i=127&e[n],a=a<<7|i;return[n,a]}(e,t),r=D(n,2),i=r[0],a=r[1];return e.subarray(i,i+a)}var L=function(e){var t={},n=0;t.version=e[n++],t.flags=e.subarray(n,n+=3);var r=I.tags[e[n++]],i=R(e,n);return I[r]&&(t[r]=I[r](i)),t},N=n(16),z=["n/s","nonIDR","partA","partB","partC","IDR","SEI","SPS","PPS","AUD","EOSq","EOS","FD"],F=["I","I P","I P B","SI","SI SP","I SI","I SI P SP","I SI P SP B"],$=["P","B","I","SP","SI","P","B","I","SP","SI"];function H(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=t%C,r=t-n,i=(t-n)/C,a=-1,o=n,c=0;!c;o+=1,a+=1)c=M(e,i,o);for(var s=(1<<a)-1,u=0;u<a;u+=1){var l=M(e,i,o+u);s+=l<<a-u-1}return{codeNum:s,offsetBits:r+o+a}}function B(e){for(var t=0,n=0,r=[];t+4<=e.byteLength;){if(n=T(4,e,t),n<0||n>e.byteLength)return r.push("invalid NALU"),r;t+=4;var i=31&e[t];switch(i){case 1:var a=H(e,(t+1)*C),o=a.offsetBits,c=H(e,o),s=c.codeNum;r.push($[s]?$[s]:s);break;case 5:r.push(z[i]);break;case 6:break;case 9:var u=(286261248&e[t+1])>>5;r.push(F[u])}t+=n}return r}function Y(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var U=new Uint8Array([109,100,97,116]),V=new Uint8Array([97,118,99,67]),W=new Uint8Array([104,118,99,67]),q=new Uint8Array([101,115,100,115]),G=new Uint8Array([116,102,100,116]),X=4,Z=4,K=Math.pow(2,32),Q=4,J=8;function ee(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=!1,i=n;i<e.byteLength-t.length;i++){r=!0;for(var a=0;a<t.length;a++)if(e[i+a]!=t[a]){r=!1;break}if(r)return i-X}return-1}function te(e){var t=function(e){var t=ee(e,V);if(-1===t)return"";t+=X+Z;var n=e[t++],r=Object(N.j)(e.subarray(t,t+3));return"avc".concat(n,".").concat(r)}(e)||function(e){var t=ee(e,W);if(t<0)return"";t+=X+Z;var n=e[t++],r=(192&e[t])>>6,i=["","A","B","C"][r],a=(32&e[t])>>5,o=["L","H"][a],c=31&e[t++],s=Object(N.m)(Y(e.subarray(t,t+=4))),u=Object(N.k)(e.subarray(t,t+=6)),l=e[t];return"hvc".concat(n)+".".concat(i).concat(c)+".".concat(s)+".".concat(o).concat(l)+".".concat(u)}(e),n=function(e){var t=ee(e,q);if(t<0)return"";var n=t+Z+X,r=e.subarray(n,t+T(X,e,t)),i=L(r),a=i.ES_DescrTag.DecoderConfigDescrTag,o=a.objectTypeIndication,c=a.DecoderSpecificInfo.objectType,s="mp4a.".concat(o.toString(16),".").concat(c);return s}(e),r=[],i=!1,a=!1;return t&&(i=!0,r.push(t)),n&&(a=!0,r.push(n)),{hasVideo:i,hasAudio:a,mime:'video/mp4; codecs="'.concat(r.join(),'"')}}function ne(e){for(var t=[],n=0,r=ee(e,U);-1!==r;){var i=T(4,e,r),a=r+X+Z,o=a+i;t.push(B(e.subarray(a,o))),n=o,r=ee(e,U,n)}return t.join("\n")}var re=n(5);function ie(e){return ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ie(e)}function ae(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,c=e[Symbol.iterator]();!(r=(o=c.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(i)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function oe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ce(e){return ce=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ce(e)}function se(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ue(e,t){return ue=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},ue(e,t)}function le(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var pe="n/a",fe="stalled",he="waiting",de="no buffer",me="in progress",be="playing",ve="paused",ye="seek",ge=re.i,Oe={leading:!0,trailing:!1},we=function(e){return S()(.5,16,k()((t=e,t+Math.pow(t,3)+1),1));var t};var je=function(e){function t(e,n){var i,a,o,c=n.handleLoad,s=n.handleError,u=n.handleStop;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,o=ce(t).call(this),i=!o||"object"!==ie(o)&&"function"!=typeof o?se(a):o,le(se(i),"buffer",void 0),le(se(i),"bufDiff",void 0),le(se(i),"pendingPlay",void 0),le(se(i),"remote0",void 0),le(se(i),"remoteT",void 0),le(se(i),"local0",void 0),le(se(i),"mse",void 0),le(se(i),"queue",void 0),le(se(i),"$videoTag",void 0),le(se(i),"video",void 0),le(se(i),"handleData",void 0),le(se(i),"codec",void 0),le(se(i),"bdmt",void 0),le(se(i),"state",void 0),P.a.video("videoCell","MSE player"),i.handleLoad=c,i.handleError=s,i.handleStop=u,i.bufDiff=0,i.pendingPlay=null,i.initBuffer=i.initBuffer.bind(se(i)),i.consume=i.consume.bind(se(i)),i.correctRate=v()(i.correctRate.bind(se(i)),re.h),i.free=v()(i.free.bind(se(i)),ge,Oe),i.mse=new MediaSource,i.queue=[],i.codec="…",i.bdmt=-1,i.state=pe,i.$videoTag=Object(r.a)("<video>").addClass("VideoCell__video").attr({src:URL.createObjectURL(i.mse)}).one({error:function(e){P.a.video("mse error %s\n%o",i.video.error,e),i.handleError(i.video.error)}}).on({stalled:function(){i.state=fe,P.a.video("mse %cstalled","color: crimson")},waiting:function(){i.state=he,P.a.video("mse %cwaiting","color: orange")},play:function(){return i.handleLoad()},playing:function(){i.state=be},paused:function(){i.state=ve},progress:function(e){var t=e.target,n=t;if(0===n.buffered.length)return i.state=de,void(i.video.currentTime=0);i.state=me;var r=n.buffered.start(n.buffered.length-1),a=n.buffered.end(n.buffered.length-1);if(!i.pendingPlay&&n.paused&&(i.pendingPlay=n.play(),i.pendingPlay)){var o=function(){i.pendingPlay=null};i.pendingPlay.then(o,o)}!n.paused&&(r>n.currentTime||n.currentTime>a)&&(i.state=ye,n.currentTime=a,P.a.video("mse seek to last TimeRange (%d)",n.buffered.length))}}).appendTo(e);var l=ae(i.$videoTag,1);return i.video=l[0],i.video.muted=!0,i.video.controls=!1,i.video.preload="none",i.handleData=i.initBuffer,i}var n,i,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ue(e,t)}(t,e),n=t,i=[{key:"getImageInfo",value:function(){return{width:this.video.videoWidth,height:this.video.videoHeight}}},{key:"start",value:function(){var e=this.remoteT-this.remote0,t=this.video.buffered,n=t.length-1;t.length>0&&(this.video.currentTime=t.start(n)+e,this.video.play(),P.a.video("mse start playing (at %fs)",this.video.currentTime),this.buffer.removeEventListener("updateend",this.start),this.remote0=this.remoteT)}},{key:"consume",value:function(){if(!this.buffer.updating){var e=this.queue[0];if(e){var t=this.bdmt;if(this.bdmt=function(e){var t=-1,n=ee(e,G);if(-1!==n){n+=X+Z;var r=e.slice(n,n+J),i=new DataView(r.buffer);t=i.getUint32(0)*K+i.getUint32(Q)}return t}(new Uint8Array(e.payload)),this.bdmt<t&&0===this.bdmt)this.buffer.remove(0,1/0);else{try{this.buffer.appendBuffer(e.payload)}catch(e){P.a.video("mse error %s\n%o",this.video.error,e),this.handleError(this.video.error)}this.queue.shift()}}}}},{key:"free",value:function(){if(this.video&&!this.video.paused&&!this.buffer.updating){var e=this.video.played.end(0)-8;e<0||this.buffer.remove(0,e)}}},{key:"initBuffer",value:function(){var e,t=this,n=this.queue,r={};do{var i=ae(n,1);e=i[0];var a=new Uint8Array(e.payload);if(r=te(a),r.hasVideo){P.a.video("mse","NALU",ne(a));break}n.shift()}while(n.length>0);if(!r.hasVideo)return P.a.video("mse %cno moov","font: bold; color: red"),void this.handleError("no moov");r.hasAudio&&this.$videoTag.trigger({type:"audioTrack"}),this.remote0=Object(re.p)(e.pts);var o,c,s;o="open"===this.mse.readyState,c=function(){P.a.video("videoCell","mse",r.mime),t.buffer=t.mse.addSourceBuffer(r.mime),t.buffer.mode="segments",t.buffer.addEventListener("update",t.consume),t.codec=r.mime,t.handleData=t.consume},s=this.mse.addEventListener.bind(this.mse,"sourceopen"),o?c():s(c)}},{key:"stop",value:function(){this.video.pause(),this.queue.length=0}},{key:"push",value:function(e){this.queue.push(e),this.handleData()}},{key:"clean",value:function(){this.free.cancel(),this.handleStop(),URL.revokeObjectURL(this.video.src),this.$videoTag.remove(),this.mse=void 0,this.$videoTag=void 0,this.video=void 0}},{key:"setAudio",value:function(e){this.video.muted=e}},{key:"setVolume",value:function(e){this.video.volume=e}},{key:"getImageData",value:function(){return Object(O.f)(this.video)}},{key:"stats",value:function(){var e=this.queue.length,t=this.video.currentTime,n=this.remote0,r=this.remoteT,i=r-n,a=i-t,o=["","state\t".concat(this.state),"codec\t".concat(this.codec),"queue\t".concat(e," pkts")," bdmt\t".concat(this.bdmt),"   Δt\t".concat(Object(N.b)(a)," s"),"mse t\t".concat(Object(N.b)(t)," s")];if(this.buffer&&this.buffer.buffered.length>0){var c=this.buffer.buffered,s=this.bufferEnd;o.push("buf t\t".concat(Object(N.b)(c.start(0)),"…").concat(Object(N.b)(s)," s"))}return o.join("\n")}},{key:"correctRate",value:function(){if(this.video&&!this.video.paused&&0!==this.video.played.length&&0!==this.buffer.buffered.length){var e=this.video.currentTime,t=this.bufferEnd-e;this.video.playbackRate=we(t-.1),this.bufDiff=t}}},{key:"bufferEnd",get:function(){var e=this.buffer.buffered;return e.end(e.length-1)}}],i&&oe(n.prototype,i),a&&oe(n,a),t}(E),_e=je,Ee=n(292),Ae=n.n(Ee);function Se(e){return Se="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Se(e)}function xe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,c=e[Symbol.iterator]();!(r=(o=c.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(i)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function ke(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Pe(e){return Pe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Pe(e)}function Ce(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Te(e,t){return Te=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Te(e,t)}function Me(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var De=function(e){function t(e,n){var i,a,o,c=n.handleLoad,s=n.handleError,u=n.handleStop;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,o=Pe(t).call(this),i=!o||"object"!==Se(o)&&"function"!=typeof o?Ce(a):o,Me(Ce(i),"blobFactory",void 0),Me(Ce(i),"inPkt",void 0),Me(Ce(i),"outPkt",void 0),Me(Ce(i),"last",void 0),Me(Ce(i),"key",void 0),Me(Ce(i),"videoTag",void 0),Me(Ce(i),"$videoTag",void 0),Me(Ce(i),"queuedPkt",void 0),Me(Ce(i),"oldUrl",void 0),Me(Ce(i),"renderId",void 0),P.a.video("videoCell","IMG player"),i.handleLoad=c,i.handleError=s,i.handleStop=u,i.inPkt=0,i.outPkt=0,i.last=performance.now(),i.renderBlob=i.renderBlob.bind(Ce(i)),i.queueRender=i.queueRender.bind(Ce(i)),i.queuedPkt={payload:[]},i.loading=!1,i.$videoTag=Object(r.a)("<img>").addClass("VideoCell__video").one({load:c,error:s}),i.$helpImg=Object(r.a)("<img>").on({load:function(){URL.revokeObjectURL(i.oldUrl),i.loading=!1}});var l=xe(i.$helpImg,1);i.helpImg=l[0];var p=xe(i.$videoTag,1);return i.videoTag=p[0],e.append(i.$videoTag),Ae()(i.$videoTag),i}var n,i,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Te(e,t)}(t,e),n=t,i=[{key:"getImageInfo",value:function(){return{width:this.videoTag.naturalWidth,height:this.videoTag.naturalHeight}}},{key:"queueRender",value:function(e){this.renderId||this.loading||(this.renderId=requestAnimationFrame(this.renderBlob)),this.queuedPkt=e}},{key:"renderBlob",value:function(){var e=URL.createObjectURL(new Blob([this.queuedPkt.payload],{type:"image/jpeg"}));this.oldUrl=this.helpImg.src,this.videoTag.src=e,this.helpImg.src=e,this.loading=!0,this.outPkt+=1,this.renderId=0}},{key:"push",value:function(e){this.key=e.key,this.inPkt+=1,this.queueRender(e)}},{key:"clean",value:function(){cancelAnimationFrame(this.renderId),this.handleStop(),URL.revokeObjectURL(this.videoTag.src),this.key=-1,this.$videoTag.remove(),this.$videoTag=null,this.videoTag=null}},{key:"getImageData",value:function(){return Object(O.f)(this.videoTag)}},{key:"stats",value:function(){var e=performance.now(),t=e-this.last,n=Math.floor(re.h*this.inPkt/t),r=Math.floor(re.h*this.outPkt/t);return this.inPkt=0,this.outPkt=0,this.last=e,"\n in ".concat(n," pkt/s\nout ").concat(r," pkt/s\n\t\t")}}],i&&ke(n.prototype,i),a&&ke(n,a),t}(E),Ie=De,Re=n(25),Le=n(43),Ne=n(27),ze=n(65),Fe=n(174),$e=n(13);n(333);r.a.widget("app.selectMode",{options:{},defaultElement:"<form>",_create:function(){var e=this,t=this.element,n=Object(r.a)("<label>").addClass("Mode-trigger__btn"),i=Object(r.a)("<input>").attr({type:"radio",name:"videoMode"}),a=Object(r.a)(this.iconLive).addClass("Mode-trigger__icon"),o=Object(r.a)(this.iconArch).addClass("Mode-trigger__icon"),c=Object(r.a)(this.iconSearch).addClass("Mode-trigger__icon"),s=i.clone().attr({value:"live",name:"mode"}).prop({checked:!0}).addClass("Mode-trigger__input_live"),u=i.clone().attr({value:"arch",name:"mode"}).addClass("Mode-trigger__input_arch"),l=i.clone().attr({value:"search",name:"mode"}).addClass("Mode-trigger__input_search"),p=n.clone().attr({title:y.a.locale.live}).addClass("Mode-trigger__btn_live").append(s).append(a),f=n.clone().attr({title:y.a.locale.archive}).addClass("Mode-trigger__btn_arch").append(u).append(o),h=n.clone().attr({title:y.a.locale.search}).addClass("Mode-trigger__btn_search").append(l).append(c);this.$arch=f,this.$search=h,this.$radioLive=s,this.$radioArch=u,this.$radioSearch=l,this.updateSelect=this.updateSelect.bind(this),t.append(p).append(f).append(h).appendTo(this.element).on({click:function(e){e.stopPropagation()},change:function(){var t=e.topic,n=e.getMode();t(t.key.APP_MODE).put(n)}}),this.element.addClass("Mode-trigger").append(t),this.topic(this.topic.key.APP_MODE).observe(this.updateSelect)},_destroy:function(){this.topic(this.topic.key.APP_MODE).unobserve(this.updateSelect),this.element.empty()},getMode:function(){return this.element.find(":checked").val()},disabled:function(e){e&&this.$radioLive.prop({checked:!0}),this.$radioArch.prop({disabled:e}),this.$arch.toggleClass("Mode-trigger--disabled",e),this.$radioSearch.prop({disabled:e}),this.$search.toggleClass("Mode-trigger--disabled",e)},updateSelect:function(e){switch(e){case Re.a.ARCH_SEARCH:this.$radioSearch.prop({checked:!0});break;case Re.a.ARCH:this.$radioArch.prop({checked:!0});break;case Re.a.LIVE:this.$radioLive.prop({checked:!0})}},iconLive:'\n<svg viewBox="0 0 32 32">\n\t<rect x="3" y="5" width="26" height="18" />\n\t<rect x="6" y="7" width="20" height="14"\n\t\tstyle="fill: currentColor"\n\t/>\n\t<path d="m 13,23 v 4 0 h -4 10 5 -5 v -4"\n\t\tstyle="fill: currentColor"\n\t/>\n<svg>',iconArch:'\n<svg viewBox="0 0 32 32">\n\t<rect width="26" height="22" y="5" x="3" />\n\t<path d="m 12,18 v -2 c 0,0 0,-2 -2,-2 -2,0 -2,2 -2,2 0,0 0,2 2,2\n\t\th 12 c 2,0 2,-2 2,-2 0,0 0,-2 -2,-2 -2,0 -2,2 -2,2 v 2" />\n\t<path id="p1" d="M 8,10 V 5 m 5,0 v 5 m 5,0 V 5 m 5,0 v 5"></path>\n\t<use height="100%" width="100%" xlink:href="#p1" y="17" x="0" />\n\t<path d="m 3,10 h 26 m 0,12 H 3" />\n</svg>',iconSearch:'\n\t<svg viewBox="0 0 32 32">\n\t <g>\n\t  <circle fill-opacity="0" id="svg_1" r="8" cy="14" cx="14" stroke-width="2" style="stroke: currentColor" />\n\t  <line id="svg_4" y2="21" x2="21" y1="28" x1="28" fill-opacity="0" stroke-width="4" style="stroke: currentColor" />\n\t </g>\n\t</svg>\n\t'});var He=n(6),Be=n.n(He);function Ye(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var Ue=u()(0),Ve=Ue("width"),We=Ue("height"),qe=Be()([Ue("bitrate"),N.l]);r.a.widget("app.selectStream",{options:{idx:-1},defaultElement:"<div>",_create:function(){this.update=this.update.bind(this),this.setStream=this.setStream.bind(this),this.toggleShow=this.toggleShow.bind(this),this.updateSelected=this.updateSelected.bind(this),this.topic(this.topic.key.CAM_ARCH).observe(this.toggleShow),this.$select=Object(r.a)("<select>").addClass("VideoCell-opts__selector").on("change",this.setStream),this.element.addClass("VideoCell-opts").append(this.$select)},setCamera:function(e){this.camera&&(this.camera.streams.unobserve(this.update),this.camera.streamActive.unobserve(this.updateSelected),this.camera=void 0,this.update([])),e&&(this.camera=e,e.streams.observe(this.update),this.camera.streamActive.observe(this.updateSelected))},setStream:function(e){var t=Number(e.target.value);this.camera.streamActive.put(t)},update:function(e){var t;if(this.camera){var n=r.a.map(e,function(e,t){return Object(r.a)("<option>").attr({value:t}).text("".concat(Ve(e),"⨯").concat(We(e),"\t").concat(qe(e)))});(t=this.$select.empty()).append.apply(t,Ye(n)),this.element.toggleClass("VideoCell-opts--active",Object($e.j)(n))}else this.$select.empty()},updateSelected:function(e){this.$select.val(e)},toggleShow:function(e){this.element.toggleClass("hidden",Boolean(e))},_destroy:function(){}});n(242);r.a.widget("app.exportNow",{options:{camera:null},defaultElement:"<button>",_create:function(){this.exportServer=this.exportServer.bind(this),this.element.addClass("exportBtn").on({click:this.exportServer})},_destroy:function(){this.element.off({click:this.exportServer})},exportServer:function(){var e=this.options.camera,t=this.topic;if(!e)return P.a.export("no camera selected"),this;var n=t(t.key.ARCH_TIME).get(),r=e.isLive,i=r?new Date:n;return t(t.key.EXPORT_TASK).put([e,i,i,{format:"jpg"}]),this},exportCanvas:function(e){var t=Object(r.a)(e.target).parents(".VideoCell").find(".VideoCell__video").get(0),n=this.getImageCanvas(t),i=this.options.camera,a=i.id,o=i.name,c=Object(N.g)(new Date),s="".concat(a,".").concat(o,"-").concat(c,".png").replace(" ","_");window.navigator&&window.navigator.msSaveBlob?window.navigator.msSaveBlob(n.msToBlob(),s):this.saveImage(n.toDataURL("image/png"),s)},getImageCanvas:function(e){var t=document.createElement("canvas"),n=t.getContext("2d",{alpha:!1});return t.width=e.videoWidth||e.naturalWidth,t.height=e.videoHeight||e.naturalHeight,n.drawImage(e,0,0),t},saveImage:function(e,t){var n=Object(r.a)("<a>").attr({download:t,href:e}).appendTo(document.body);n.get(0).click(),n.remove()}});n(207);var Ge=n(48),Xe=n.n(Ge),Ze=n(254),Ke=n.n(Ze),Qe=n(88),Je=n.n(Qe),et=n(145),tt=n.n(et),nt=n(196),rt=n.n(nt);r.a.widget("app.zoombar",{options:{min:1,max:1},_create:function(){var e=this.options.min,t=this.options.max,n=Object(r.a)("<span>").text(e).addClass("zoom-bar__val"),i=Object(r.a)("<span>").text(t).addClass("zoom-bar__val");this.$resetButton=Object(r.a)("<button>").addClass("zoom-bar__reset ").addClass("ui-button ui-priority-primary").html("&orarr;"),this.$scale=Object(r.a)("<span>").addClass("zoom-bar__scale"),this.$indicator=Object(r.a)("<span>").addClass("zoom-bar__indicator"),this.$scale.append(this.$indicator),this.element.addClass("zoom-bar").append(n).append(this.$scale).append(i).append(this.$resetButton)},setValue:function(e){var t=this.options.min,n=this.options.max,r=this.$scale.width()/(n-t),i=r*(e-t);return this.$indicator.css({transform:"translateX(".concat(i,"px)")}),this},onReset:function(){return r.a.prototype.on.apply(this.$resetButton,arguments)},_destroy:function(){this.element.remove()}});n(335);function it(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function at(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?it(n,!0).forEach(function(t){ot(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):it(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function ot(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}r.a.widget("app.zoomable",{options:{min:y.a.settings.zoomMin,max:y.a.settings.zoomMax,steps:y.a.settings.zoomSteps,delta:y.a.settings.zoomDelta},REF_SCALE:1,HALF_SCALE:.5,T_TIME:.1,NO_TRANSI:!0,NO_ZOOMABLE:Object(r.a)(),_init:function(){this.geom0={scale:this.options.min,x:0,y:0},this.drag0={x:0,y:0},this.dragS={},this.transition=!1,this.drag=this.drag.bind(this),this.dragBegin=this.dragBegin.bind(this),this.dragEnd=this.dragEnd.bind(this),this.dragInit=this.dragInit.bind(this),this.publishGeom=Je.a,this.publishTopic=rt()(re.c,this.publishTopic.bind(this)),this.reset=this.reset.bind(this),this.togglePublish=this.togglePublish.bind(this),this.transitionStart=this.transitionStart.bind(this),this.transitionStop=this.transitionStop.bind(this),this.updateGeom=this.updateGeom.bind(this),this.zoom=tt()(this.zoom.bind(this),$e.p)},_create:function(){this._init(),this.element.wrapAll(Object(r.a)("<div>").addClass("zoom")),this.$container=this.element.parent(),this.zoomBar=r.a.app.zoombar(this.options),this.topic(this.topic.key.APP_MODE).observe(this.togglePublish),this.element.on({wheel:this.zoom,mousedown:this.dragInit,transitionend:this.transitionStop}),this.zoomBar.onReset({click:this.reset}),this.zoomBar.widget().insertAfter(this.$container),this.reset(this.NO_TRANSI)},updateGeom:function(e,t){t||this.transitionStart(),this.element.css({transform:this.makeTransform(e)}),this.zoomBar.setValue(e.scale),this.publishGeom(e)},publishTopic:function(e){this.topic(this.topic.key.ZOOM).put(at({},e))},togglePublish:function(e){switch(e){case Re.a.LIVE:this.publishGeom=Je.a;break;case Re.a.ARCH:case Re.a.ARCH_SEARCH:this.publishGeom=this.publishTopic,this.reset(this.NO_TRANSI)}},dragged:function(e){return void 0!==e&&(this._dragged=Boolean(e)),this._dragged},reset:function(e){this.geom=Ke()(this.geom0),this.updateGeom(this.geom,e),this.$container.removeClass("zoom--transformed"),this.transitionStop(),this.publishGeom(this.geom0)},dragInit:function(e){e.preventDefault(e),this.dragged(!1),this.geom.scale>this.geom0.scale&&(this.dragBegin(e),Object(r.a)(window).on({mousemove:this.drag,mouseup:this.dragEnd,mouseleave:this.dragEnd}),this.$container.addClass("zoom--transformed"))},frameZoom:function(e){var t=this.element.get(0),n=t.offsetHeight,r=t.offsetWidth,i=this.$container.get(0),a=i.clientHeight,o=i.clientWidth,c=o/r,s=a/n,u=Math.abs((e.scale-c)/2),l=Math.abs((e.scale-s)/2);return at({},e,{x:Xe()(e.x,-u,u),y:Xe()(e.y,-l,l)})},drag:function(e){this.dragged(!0);var t=this.element.get(0),n=t.offsetHeight,r=t.offsetWidth,i={x:this.geom.x+(e.pageX-this.dragS.x)/r,y:this.geom.y+(e.pageY-this.dragS.y)/n,scale:this.geom.scale};this.geom=this.frameZoom(i),this.dragBegin(e),this.updateGeom(this.geom,this.NO_TRANSI)},dragBegin:function(e){this.dragS.x=e.pageX,this.dragS.y=e.pageY},dragEnd:function(){Object(r.a)(window).off({mousemove:this.drag,mouseup:this.dragEnd,mouseleave:this.dragEnd})},fit:function(e){this.$container.css({flexDirection:e})},zoom:function(e){var t=this.options.min,n=this.options.max,r=this.options.delta,i=r*Math.sign(e.deltaY),a=this.geom.scale,o=a*(this.REF_SCALE+i);if(e.originalEvent.preventDefault(),!(this.transition||o>n))if(o<t)this.reset();else{var c=this.element.get(0).getBoundingClientRect(),s=(e.pageX-c.left)/c.width,u=(e.pageY-c.top)/c.height,l={x:this.geom.x+(o-a)*(this.HALF_SCALE-s),y:this.geom.y+(o-a)*(this.HALF_SCALE-u),scale:o};this.geom=this.frameZoom(l),this.updateGeom(this.geom),this.$container.addClass("zoom--transformed")}},transitionStart:function(){this.transition=!0,this.element.css({transition:"transform ".concat(this.T_TIME,"s")})},transitionStop:function(){this.transition=!1,this.element.css({transition:"transform ".concat(0,"s")})},_destroy:function(){this.reset(),this.zoomBar.destroy(),this.element.off().unwrap(this.$container)},makeTransform:function(e){var t=e.x,n=e.y,r=e.scale;return"translate(".concat(100*t,"%,").concat(100*n,"%) scale(").concat(r,")")}});n(336);r.a.widget("app.speaker",{option:{target:Object(r.a)()},defaultElement:"<div>",_create:function(){var e=this;this.setVolume=this.setVolume.bind(this),this.setAudio=this.setAudio.bind(this);this.$label=Object(r.a)("<label>").addClass("speaker");var t=Object(r.a)("<div>").addClass("speaker__volume");this.$check=Object(r.a)("<input>").addClass("speaker__chk").prop({type:"checkbox",checked:!1,hidden:!0}),this.$track=Object(r.a)("<div>").addClass("speaker__volume-track"),this.$progress=Object(r.a)("<div>").addClass("speaker__volume-progress"),this.$handle=Object(r.a)("<div>").addClass("speaker__volume-handle").draggable({axis:"y",containment:"parent",drag:function(t,n){e.setVolume(n.position.top)}}),this.$track.on({click:function(t){t.preventDefault(),t.stopPropagation();var n=Xe()(t.pageY-e.$track.offset().top,0,e.$track.height()-e.$handle.height());e.$handle.css({top:n}),e.setVolume(n)}}),this.$track.append(this.$handle).append(this.$progress),this.$label.append(this.$check).append(t.append(this.$track)),this.element.append(this.$label).on({change:this.setAudio,layoutHidden:function(){e.$check.prop({checked:!1}),e.setAudio()}}).hide()},setVolume:function(e){var t=this.$track.height()-e-this.$handle.height(),n=Xe()(1-e/this.$track.height(),0,1);this.$progress.css({height:"".concat(t,"px")}),this.options.setVolume(n)},setAudio:function(){this.options.setAudio&&this.options.setAudio(this.$check.prop("checked")),this.$label.toggleClass("speaker--with_sound",this.$check.prop("checked"))}});n(243);var ct=n(337),st=n(338),ut=n(339),lt=n(340),pt=n(244),ft=n(245),ht=n(246),dt=n(247);r.a.widget("app.playbackPanel",{_create:function(){var e=this;this.handleSpeed=this.handleSpeed.bind(this),this.setCamera=this.setCamera.bind(this),this.show=this.show.bind(this),this.hide=this.hide.bind(this),this.$playPause=Object(r.a)("<div>").addClass("Playback__btn").on({click:function(){var t=e.topic(e.topic.key.ARCH_SPEED).get(),n=0===e.topic(e.topic.key.PLAYBACK).get().speed;e.topic(e.topic.key.PLAYBACK).assign({beginTime:e.topic(e.topic.key.ARCH_TIME).get(),speed:n?t:0}),n?e.$playPause.html(lt):e.$playPause.html(ut),e.$previousFrame.toggleClass("hidden",n),e.$nextFrame.toggleClass("hidden",n),e.$incSpeed.toggleClass("hidden",!n),e.$decSpeed.toggleClass("hidden",!n)}}).append(ut),this.$nextFrame=Object(r.a)("<div>").addClass("Playback__btn").on({click:function(){return e.camera.stepForward()}}).append(ht),this.$nextFragment=Object(r.a)("<div>").addClass("Playback__btn").on({click:function(){return e.camera.nextInterval()}}).append(dt),this.$previousFrame=Object(r.a)("<div>").addClass("Playback__btn").on({click:function(){return e.camera.stepBack()}}).append(ft),this.$previousFragment=Object(r.a)("<div>").addClass("Playback__btn").on({click:function(){return e.camera.prevInterval()}}).append(pt),this.$incSpeed=Object(r.a)("<div>").addClass("Playback__btn hidden").on({click:function(){return e.handleSpeed(1)}}).append(ct),this.$decSpeed=Object(r.a)("<div>").addClass("Playback__btn hidden").on({click:function(){return e.handleSpeed(-1)}}).append(st),this.element.append(this.$previousFragment).append(this.$decSpeed).append(this.$previousFrame).append(this.$playPause).append(this.$nextFrame).append(this.$incSpeed).append(this.$nextFragment).addClass("hidden VideoCell__playback").on({dblclick:function(e){return e.stopPropagation()}})},handleSpeed:function(e){var t=y.a.settings.playspeed,n=this.topic(this.topic.key.ARCH_TIME).get(),r=this.topic(this.topic.key.ARCH_SPEED).get(),i=y.a.settings.playspeed.indexOf(r),a=S()(0,t.length-1,i+e),o=t[a];this.topic(this.topic.key.PLAYBACK).assign({speed:o,beginTime:n}),this.topic(this.topic.key.ARCH_SPEED).put(o)},setCamera:function(e){this.camera&&(this.camera=void 0),e&&(this.camera=e)},show:function(){this.element.removeClass("hidden")},hide:function(){this.element.addClass("hidden")}});n(341);r.a.widget("app.timeCell",{_create:function(){var e=this;this.handleCLick=this.handleCLick.bind(this),this.setValue=this.setValue.bind(this),this.getValue=this.getValue.bind(this);var t=this.options,n=t.value,i=t.onChange;this.$timeInput=Object(r.a)("<input>").val(n).addClass("TimeCell__time-input").on({change:i});var a=Object(r.a)("<div>").addClass("TimeCell__timeBtn prev").on({click:function(){return e.handleCLick(e.$timeInput,-1)}}),o=Object(r.a)("<div>").addClass("TimeCell__timeBtn next").on({click:function(){return e.handleCLick(e.$timeInput,1)}});this.element.append(a).append(o).append(this.$timeInput).addClass("TimeCell__timeCell"),this.element.on("mousewheel",function(t){return e.handleCLick(e.$timeInput,Math.sign(t.originalEvent.wheelDelta))})},handleCLick:function(e,t){var n=this.options.onChange,r=Number(e.val())+t;e.val(r),n()},setValue:function(e){this.$timeInput.val(e)},getValue:function(){return Number(this.$timeInput.val())}});n(209);function mt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function bt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function vt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,c=e[Symbol.iterator]();!(r=(o=c.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(i)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}r.a.widget("app.selectTime",{_create:function(){this.handleChange=this.handleChange.bind(this),this.setTime=this.setTime.bind(this),this.show=this.show.bind(this),this.hide=this.hide.bind(this),this.hours=r.a.app.timeCell({onChange:this.handleChange}),this.minutes=r.a.app.timeCell({onChange:this.handleChange}),this.seconds=r.a.app.timeCell({onChange:this.handleChange}),this.element.append(this.hours.element).append(this.minutes.element).append(this.seconds.element).addClass("VideoCell__select-time hidden").on({click:function(e){return e.stopPropagation()},dblclick:function(e){return e.stopPropagation()}})},handleChange:function(){var e=this.options.onChange,t=this.hours.getValue(),n=this.minutes.getValue(),r=this.seconds.getValue();e(new Date(this.archTime.setHours(t,n,r)))},setTime:function(e){this.archTime=e;var t=e.getHours(),n=e.getMinutes(),r=e.getSeconds();return this.hours.setValue(t),this.minutes.setValue(n),this.seconds.setValue(r),this},show:function(){return this.element.removeClass("hidden"),document.addEventListener("click",this.hide),this.topic(this.topic.key.ARCH_TIME).observe(this.setTime),this},hide:function(){return this.element.addClass("hidden"),document.removeEventListener("click",this.hide),this.topic(this.topic.key.ARCH_TIME).unobserve(this.setTime),this},_destroy:function(){this.hide(),this.element.empty()}});var yt=u()("NULL","dev"),gt=u()(!1,"isLive");r.a.widget("app.videoCell",{options:{key:-1,conn:null},STYLE_ACTIVE:"VideoCell--active",STYLE_LOADING:"VideoCell--loading",STYLE_PLAYING:"VideoCell--playing",STYLE_EMPTY:"VideoCell--empty",STYLE_ERROR:"VideoCell--error",STYLE_NOVIDEO:"VideoCell--novideo",_init:function(){var e=this;this.handleActive=this.handleActive.bind(this),this.handleList=this.handleList.bind(this),this.handleLoad=this.handleLoad.bind(this),this.handleError=this.handleError.bind(this),this.handlePlaybackPanel=this.handlePlaybackPanel.bind(this),this.handleStop=this.handleStop.bind(this),this.updateState=this.updateState.bind(this),this.handleFullscreen=this.handleFullscreen.bind(this),this.handleVisibilityChange=this.handleVisibilityChange.bind(this),this.updatePlayer=this.updatePlayer.bind(this),this.updateIndex=this.updateIndex.bind(this),this.propagateTime=this.propagateTime.bind(this),this.publishImageInfo=this.publishImageInfo.bind(this),this.getDecoratorsHeight=m()(this.getDecoratorsHeight.bind(this)),this.debugInfo=v()(this.debugInfo.bind(this),re.c,{trailing:!1}),this.stats=this.stats.bind(this),this.gotFrame=function(){return e.element.trigger("frame")},this.renderStat=r.a.noop,this.showSpeaker=this.showSpeaker.bind(this),this.setCamera=this.setCamera.bind(this),this.setVolume=this.setVolume.bind(this),this.setAudio=this.setAudio.bind(this),this.setVisibleControls=this.setVisibleControls.bind(this),this.resetLiveStream=this.resetLiveStream.bind(this),this.videoMuted=!0,this.renderTime=m()(this.renderTime.bind(this),Object(re.q)(re.h)),this.renderTime.cache=new $e.a,this.pushTime=m()(this.pushTime.bind(this),Object(re.q)(re.h)),this.pushTime.cache=new $e.a,this.mediaState=Object(g.a)(this),this.meta={time:function(){return Object(N.d)(e.lastPts)},title:function(){return u()("",["camera","fullname"],e)}},this.topic(this.topic.key.STATS).observe(this.stats),this.topic(this.topic.key.APP_MODE).observe(this.handlePlaybackPanel),this.topic(this.topic.key.CAM_ARCH).observe(this.publishImageInfo);this.element.on({click:function(t){var n=t.ctrlKey;e.topic(e.topic.key.CAM_ACTIVE).get()!==e.camera&&e.topic(e.topic.key.UPDATE_CAM_ACTIVE).put(n?void 0:e.camera)},dblclick:function(){var t=e.element.fullScreen();e.element.fullScreen(!t),e.element.toggleClass("VideoCell--fullscreen")}}),Object(r.a)(document).on({fullscreenchange:this.handleFullscreen,visibilitychange:this.handleVisibilityChange})},_create:function(){var e=this,t=this.players.null,n=Object(r.a)("<div>").addClass("VideoCell__bar__fill"),i=Object(r.a)("<div>").addClass(["VideoCell__title","VideoCell__title__left"]).data("key","title"),a=Object(r.a)("<div>").addClass(["VideoCell__title","VideoCell__title__right"]).data("key","time"),o=Object(r.a)().add(i).add(a);if(o.on({mousedown:Object(Fe.a)(function(t){var n=Object(r.a)(t.currentTarget).data("key"),i=p()(["meta",n],e);e.topic(e.topic.key.CLIPBOARD).put({text:i})}),contextmenu:function(){return!1}}),!this.options.conn)throw new Error("No connection provided to VideoCell");this.$bar=Object(r.a)("<div>").addClass("VideoCell__bar"),this.$barContainer=Object(r.a)("<div>").addClass("VideoCell__bar-container").on({dblclick:function(e){return e.stopPropagation()}}),this.$frontLayer=Object(r.a)("<div>").addClass("VideoCell__front-layer"),this.$container=Object(r.a)("<div>").addClass("VideoCell__box"),this.$title=Object(r.a)("<span>").addClass("VideoCell__title__text"),this.$intermediateFrame=Object(r.a)("<canvas>").addClass("VideoCell__video-canvas"),this.$time=Object(r.a)("<span>").addClass("VideoCell__title__text").on({click:function(t){t.stopPropagation(),e.selectTime.show()}}),this.conn=this.options.conn,this.selectTime=r.a.app.selectTime({onChange:function(t){return e.topic(e.topic.key.PLAYBACK).assign({beginTime:t})}}),this.selectStream=r.a.app.selectStream(),this.selectArch=r.a.app.selectArch(),this.exportNow=r.a.app.exportNow(),this.fscreen=r.a.app.fscreen({target:this.element}),this.player=new t,this.speaker=r.a.app.speaker({target:this.$container}),this.playbackPanel=r.a.app.playbackPanel(),this.exportNow.element.addClass("VideoCell-button").addClass("VideoCell-button--blank"),this.fscreen.element.addClass("VideoCell-button"),this.speaker.element.addClass("VideoCell-button").addClass("VideoCell-button--blank"),this.$barContainer.append(i.append(this.$title)).append(n.clone()).append(a.append(this.$time)).append(this.selectStream.element).append(this.selectArch.element),this.$bar.append(this.$barContainer),this.$frontLayer.append(n.clone()).append(this.exportNow.element).append(this.speaker.element),this.element.addClass("VideoCell").addClass(this.STYLE_EMPTY).append(this.$bar).append(this.$frontLayer).append(this.$container).append(this.playbackPanel.element).append(this.selectTime.element),this.$container.append(this.$intermediateFrame).zoomable()},_destroy:function(){this.camera&&this.setCamera(void 0),this.topic(this.topic.key.STATS).unobserve(this.stats),this.topic(this.topic.key.APP_MODE).unobserve(this.handlePlaybackPanel),this.topic(this.topic.key.CAM_ARCH).unobserve(this.publishImageInfo),this.selectStream.destroy(),this.selectArch.destroy(),this.exportNow.destroy(),this.fscreen.destroy(),this.speaker.destroy(),this.$container.zoomable("destroy"),this.element.remove(),this.selectTime.destroy(),this.playbackPanel.destroy()},_setOptions:function(e){var t=e.camera,n=e.origin,r=e.pending,i=e.pos;i&&this.element.css({left:Object(N.a)(i.left),right:Object(N.a)(i.right),top:Object(N.a)(i.top),bottom:Object(N.a)(i.bottom)});var a=h()(this.origin,n);a||(this.origin=n),!a&&t&&this.setCamera(t),!a&&r&&r.then(this.setCamera)},setVisibleControls:function(e){this.$barContainer&&this.$frontLayer&&(e?(this.$barContainer.show(),this.$frontLayer.show()):(this.$barContainer.hide(),this.$frontLayer.hide()))},showSpeaker:function(){this.speaker.options.setAudio=this.setAudio,this.speaker.options.setVolume=this.setVolume,this.player.setAudio(this.videoMuted),Object(r.a)(this.speaker.element).show()},setVolume:function(e){this.player.setVolume(e)},setAudio:function(e){this.videoMuted=!e,this.player.setAudio(this.videoMuted)},setCamera:function(e){P.a.video("videoCell",this.options.key,"setting camera to",yt(e),"from",yt(this.camera)),Object(Ne.m)(e,this.camera)&&P.a.video("videoCell","same camera!"),this.camera&&(this.mediaState=this.mediaState.stop(),this.topic(this.topic.key.PLAYBACK).unobserve(this.updatePlayer),this.topic(this.topic.key.CAM_ACTIVE).unobserve(this.handleActive),this.topic(this.topic.key.CAM_ACTIVE).unobserve(this.updatePlayer),this.topic(this.topic.key.CAM_STATES).unobserve(this.updateState),this.camera.streamActive.unobserve(this.updatePlayer),this.camera.streams.unobserve(this.resetLiveStream),this.element.removeClass([this.STYLE_NOVIDEO,this.STYLE_PLAYING,this.STYLE_LOADING,this.STYLE_ERROR]).addClass(this.STYLE_EMPTY),this.$container.zoomable("reset"),this.exportNow.options.camera=void 0,this.playbackPanel.setCamera(void 0),this.selectStream.setCamera(void 0),this.selectArch.setCamera(void 0),this.camera=void 0,this.speaker.element.hide(),this.clearCell(),this.renderStat()),e?(this.setTitle(e),this.camera=e,this.topic(this.topic.key.CAM_STATES).observe(this.updateState),this.exportNow.options.camera=e,this.playbackPanel.setCamera(e),this.selectStream.setCamera(e),this.selectArch.setCamera(e),this.topic(this.topic.key.PLAYBACK).observe(this.updatePlayer),this.topic(this.topic.key.CAM_ACTIVE).observe(this.handleActive),this.topic(this.topic.key.CAM_ACTIVE).observe(this.updatePlayer),e.streamActive.observe(this.updatePlayer),e.streams.observe(this.resetLiveStream),this.element.removeClass([this.STYLE_EMPTY,this.STYLE_ERROR,this.STYLE_NOVIDEO]),this.renderStat()):this.element.addClass([this.STYLE_NOVIDEO]),this.canvasClear()},setTitle:function(e){var t="",n="";e&&(t=e.id,n=e.fullname),this.$title.text(n),this.$container.attr({"data-id":t})},setType:function(e){if(this.player.clean(),e in this.players){var t=this.players[e];this.player=new t(this.$container,{handleLoad:this.handleLoad,handleError:this.handleError,handleStop:this.handleStop}),this.resetStyle()}},clearCell:function(){this.key=0,this.setTitle(),this.setType(null),this.element.addClass(this.STYLE_NOVIDEO)},handleActive:function(e){var t=Object(Ne.m)(e,this.camera);this.element.toggleClass(this.STYLE_ACTIVE,t)},handleList:function(e){var t=e[this.options.key];Object(Ne.m)(t,this.camera)||this.setCamera(t)},resetStyle:function(){this.element.removeClass([this.STYLE_ERROR,this.STYLE_LOADING])},handleLoad:function(){this.resetStyle(),this.canvasClear(),this.publishImageInfo(this.camera)},handleError:function(){this.element.addClass(this.STYLE_ERROR),this.mediaState=this.mediaState.stop().play()},handleStop:function(){var e=this.player.getImageData();if(e){var t=vt(this.$intermediateFrame,1),n=t[0],r=n.getContext("2d");n.width=e.width,n.height=e.height,r.putImageData(e,0,0)}},updateState:function(e,t){var n,r,i,a,o;return regeneratorRuntime.async(function(s){for(;;)switch(s.prev=s.next){case 0:if(n=c()("origin",this.camera),r=c()([n],e),i=c()([n],t),n||!h()(r,i)){s.next=5;break}return s.abrupt("return");case 5:return s.next=7,regeneratorRuntime.awrap(this.camera.isReady);case 7:if(a=s.sent,o=r,!o||a){s.next=13;break}return s.next=12,regeneratorRuntime.awrap(this.camera.getStreamsMeta());case 12:this.setCamera(this.camera);case 13:o&&a&&this.updatePlayer(),o||(this.mediaState=this.mediaState.stop()),this.element.toggleClass(this.STYLE_NOVIDEO,!o);case 16:case"end":return s.stop()}},null,this)},handleFullscreen:function(){var e=this.topic(this.topic.key.PREFS).get(),t=e.disconnectInactive,n=Object(r.a)(document).fullScreen(),i=n===this.element[0]||n===document.body;n&&!i&&t&&(this.mediaState=this.mediaState.stop()),!n&&this.camera&&(this.mediaState=this.mediaState.play())},updateIndex:function(e){var t=this.topic(this.topic.key.CELL_IDX).get(),n=Object(ze.b)(e);t.set(n,this)},clearIndex:function(e){var t=this.topic(this.topic.key.CELL_IDX).get(),n=Object(ze.b)(e);t.delete(n)},handleVisibilityChange:function(){this.speaker.element.trigger("layoutHidden")},handlePlaybackPanel:function(e){e===Re.a.ARCH_SEARCH?this.playbackPanel.show():this.playbackPanel.hide()},updatePlayer:function(){if(this.camera){var e=this.camera,t=e.stream,n=e.isOnline,i=this.topic(this.topic.key.APP_MODE).get(),a=i===Re.a.LIVE&&!n;if(t.format){var o=Object(Ne.m)(this.topic(this.topic.key.CAM_ACTIVE).get(),this.camera),c=this.topic(this.topic.key.PREFS).get(),s=c.noKeyFrames,u=this.topic(this.topic.key.PLAYBACK).get(),l=0===u.speed&&!u.beginTime||a,p={endpoint:t.accessPoint,format:Object($e.g)(t.format),method:l?"stop":"play",speed:u.speed,keyFrames:!s&&!o};u.beginTime&&(p.beginTime=Object(re.m)(u.beginTime),p.archive=this.camera.archSelectedStorage,p.archFastMjpeg=this.topic(this.topic.key.PREFS).get().archFastMjpeg),p.format===Le.a.JPEG&&(p.width=Object($e.f)(this.element.width(),y.a.settings.frameWidthList),p.height=0,p.vc=y.a.settings.mjpegCompression),this.mediaState=this.mediaState[p.method](p),this.resetStyle(),this.element.toggleClass(this.STYLE_NOVIDEO,a),Object(r.a)(this.player.video).one("audioTrack",this.showSpeaker)}}},player:null,players:{null:E,mse:_e,img:Ie},push:function(e){this.pts0=this.pts0||e.pts,this.now0=this.now0||Date.now(),this.player.push(e),a()(this.propagateTime,e),a()(this.renderStat,e),a()(this.gotFrame)},updateTime:function(e,t){t(e)},renderTime:function(e){this.$time[0].innerText=Object(N.e)(e)},pushTime:function(e){this.topic(this.topic.key.ARCH_TIME).put(e)},propagateTime:function(e){var t=gt(this.camera);if(!t){var n=new Date(e.pts);this.pushTime(n)}this.renderTime(e.pts),this.lastPts=e.pts},debugInfo:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.pts-this.pts0,n=Date.now()-this.now0,r=t-n,i=this.camera?Object.entries(this.camera.state.get()):["n/a"],a=yt(this.camera);this.$debug[0].innerText="\nplr\t".concat(this.mediaState.state,"\ncam\t").concat(a,"\n\t").concat(i.join("\n\t"),"\n\nkey ").concat(e.key,"\npts ").concat(e.pts,"\nΔts ").concat(r,"\nlen ").concat(e.payload&&e.payload.byteLength,"\n").concat(this.player.stats(),"\n\t\t")},stats:function(e){e&&(this.$debug=Object(r.a)("<pre>").addClass("VideoCell__debug"),this.element.append(this.$debug),this.renderStat=this.debugInfo),e&&this.camera&&this.camera.state.observe(this.debugInfo),!e&&this.$debug&&(this.$debug.remove(),this.$debug=void 0,this.renderStat=r.a.noop),!e&&this.camera&&this.camera.state.unobserve(this.debugInfo)},getImageInfo:function(){var e=this.player.getImageInfo();return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?mt(n,!0).forEach(function(t){bt(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):mt(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},e,{aspect:Object(O.a)(e)})},publishImageInfo:function(e){var t=Object(Ne.m)(e,this.camera);t&&this.topic(this.topic.key.CAM_ARCH_IMAGE_INFO).put(this.getImageInfo())},canvasClear:function(){var e=vt(this.$intermediateFrame,1),t=e[0];t.getContext("2d").clearRect(0,0,t.width,t.height)},resetLiveStream:function(){var e=this.topic(this.topic.key.APP_MODE).get();e===Re.a.LIVE&&this.camera.resetLiveStream()},getDecoratorsHeight:function(){return this.$bar.height()+this.playbackPanel.element.height()}})},323:function(e,t,n){var r,i,a;i=[n(30)],r=function(e){var t,n,r=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],i="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],a=Array.prototype.slice;if(e.event.fixHooks)for(var o=r.length;o;)e.event.fixHooks[r[--o]]=e.event.mouseHooks;var c=e.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var t=i.length;t;)this.addEventListener(i[--t],s,!1);else this.onmousewheel=s;e.data(this,"mousewheel-line-height",c.getLineHeight(this)),e.data(this,"mousewheel-page-height",c.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var t=i.length;t;)this.removeEventListener(i[--t],s,!1);else this.onmousewheel=null;e.removeData(this,"mousewheel-line-height"),e.removeData(this,"mousewheel-page-height")},getLineHeight:function(t){var n=e(t),r=n["offsetParent"in e.fn?"offsetParent":"parent"]();return r.length||(r=e("body")),parseInt(r.css("fontSize"),10)||parseInt(n.css("fontSize"),10)||16},getPageHeight:function(t){return e(t).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};function s(r){var i=r||window.event,o=a.call(arguments,1),s=0,p=0,f=0,h=0,d=0,m=0;if(r=e.event.fix(i),r.type="mousewheel","detail"in i&&(f=-1*i.detail),"wheelDelta"in i&&(f=i.wheelDelta),"wheelDeltaY"in i&&(f=i.wheelDeltaY),"wheelDeltaX"in i&&(p=-1*i.wheelDeltaX),"axis"in i&&i.axis===i.HORIZONTAL_AXIS&&(p=-1*f,f=0),s=0===f?p:f,"deltaY"in i&&(f=-1*i.deltaY,s=f),"deltaX"in i&&(p=i.deltaX,0===f&&(s=-1*p)),0!==f||0!==p){if(1===i.deltaMode){var b=e.data(this,"mousewheel-line-height");s*=b,f*=b,p*=b}else if(2===i.deltaMode){var v=e.data(this,"mousewheel-page-height");s*=v,f*=v,p*=v}if(h=Math.max(Math.abs(f),Math.abs(p)),(!n||h<n)&&(n=h,l(i,h)&&(n/=40)),l(i,h)&&(s/=40,p/=40,f/=40),s=Math[s>=1?"floor":"ceil"](s/n),p=Math[p>=1?"floor":"ceil"](p/n),f=Math[f>=1?"floor":"ceil"](f/n),c.settings.normalizeOffset&&this.getBoundingClientRect){var y=this.getBoundingClientRect();d=r.clientX-y.left,m=r.clientY-y.top}return r.deltaX=p,r.deltaY=f,r.deltaFactor=n,r.offsetX=d,r.offsetY=m,r.deltaMode=0,o.unshift(r,s,p,f),t&&clearTimeout(t),t=setTimeout(u,200),(e.event.dispatch||e.event.handle).apply(this,o)}}function u(){n=null}function l(e,t){return c.settings.adjustOldDeltas&&"mousewheel"===e.type&&t%120==0}e.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}})},a="function"==typeof r?r.apply(t,i):r,void 0===a||(e.exports=a)},324:function(e,t,n){var r=n(30);n(362);
/*!
 * jQuery UI Touch Punch 0.2.3
 *
 * Copyright 2011–2014, Dave Furfero
 * Dual licensed under the MIT or GPL Version 2 licenses.
 *
 * Depends:
 *  jquery.ui.widget.js
 *  jquery.ui.mouse.js
 */
!function(e){if(e.support.touch="ontouchend"in document,e.support.touch){var t,n=e.ui.mouse.prototype,r=n._mouseInit,i=n._mouseDestroy;n._touchStart=function(e){!t&&this._mouseCapture(e.originalEvent.changedTouches[0])&&(t=!0,this._touchMoved=!1,a(e,"mouseover"),a(e,"mousemove"),a(e,"mousedown"))},n._touchMove=function(e){t&&(this._touchMoved=!0,a(e,"mousemove"))},n._touchEnd=function(e){t&&(a(e,"mouseup"),a(e,"mouseout"),this._touchMoved||a(e,"click"),t=!1)},n._mouseInit=function(){this.element.bind({touchstart:e.proxy(this,"_touchStart"),touchmove:e.proxy(this,"_touchMove"),touchend:e.proxy(this,"_touchEnd")}),r.call(this)},n._mouseDestroy=function(){this.element.unbind({touchstart:e.proxy(this,"_touchStart"),touchmove:e.proxy(this,"_touchMove"),touchend:e.proxy(this,"_touchEnd")}),i.call(this)}}function a(e,t){if(!(e.originalEvent.touches.length>1)){e.preventDefault();var n=e.originalEvent.changedTouches[0],r=document.createEvent("MouseEvents");r.initMouseEvent(t,!0,!0,window,1,n.screenX,n.screenY,n.clientX,n.clientY,!1,!1,!1,!1,0,null),e.target.dispatchEvent(r)}}}(r)},325:function(e,t,n){var r=n(30);
/**
 * @preserve jquery.fullscreen 1.1.5
 * https://github.com/kayahr/jquery-fullscreen-plugin
 * Copyright (C) 2012-2013 Klaus Reimer <k@ailis.de>
 * Licensed under the MIT license
 * (See http://www.opensource.org/licenses/mit-license)
 */
/**
 * @preserve jquery.fullscreen 1.1.5
 * https://github.com/kayahr/jquery-fullscreen-plugin
 * Copyright (C) 2012-2013 Klaus Reimer <k@ailis.de>
 * Licensed under the MIT license
 * (See http://www.opensource.org/licenses/mit-license)
 */
!function(e){function t(e){var t,n,r;return this.length?(t=this[0],t.ownerDocument?r=t.ownerDocument:(r=t,t=r.documentElement),null==e?r.exitFullscreen||r.webkitExitFullscreen||r.webkitCancelFullScreen||r.msExitFullscreen||r.mozCancelFullScreen?(e=!!(r.fullscreenElement||r.msFullscreenElement||r.webkitIsFullScreen||r.mozFullScreen),e&&(r.fullscreenElement||r.webkitFullscreenElement||r.webkitCurrentFullScreenElement||r.msFullscreenElement||r.mozFullScreenElement)||e):null:e?(n=t.requestFullscreen||t.webkitRequestFullscreen||t.webkitRequestFullScreen||t.msRequestFullscreen||t.mozRequestFullScreen,n&&n.call(t),this):(n=r.exitFullscreen||r.webkitExitFullscreen||r.webkitCancelFullScreen||r.msExitFullscreen||r.mozCancelFullScreen,n&&n.call(r),this)):this}function n(t){e(document).trigger(new e.Event("fullscreenchange"))}function r(t){e(document).trigger(new e.Event("fullscreenerror"))}var i,a,o;e.fn.fullScreen=t,e.fn.toggleFullScreen=function(){return t.call(this,!t.call(this))},i=document,i.webkitCancelFullScreen?(a="webkitfullscreenchange",o="webkitfullscreenerror"):i.msExitFullscreen?(a="MSFullscreenChange",o="MSFullscreenError"):i.mozCancelFullScreen?(a="mozfullscreenchange",o="mozfullscreenerror"):(a="fullscreenchange",o="fullscreenerror"),e(document).bind(a,n),e(document).bind(o,r)}(r)},330:function(e,t,n){},331:function(e,t,n){},332:function(e,t,n){},333:function(e,t,n){},334:function(e,t,n){},335:function(e,t,n){},336:function(e,t,n){},337:function(e,t){e.exports='<svg class="Playback__icon" viewBox="0 0 27 19"><polygon points="20,8 15,8 15,3 12,3 12,8 7,8 7,11 12,11 12,16 15,16 15,11 20,11 "></polygon></svg>'},338:function(e,t){e.exports='<svg class="Playback__icon" viewBox="0 0 27 19"><rect x="7" y="8" width="13" height="3"></rect></svg>'},339:function(e,t){e.exports='<svg class="Playback__icon" viewBox="0 0 27 19"><polygon points="11.5,2.5 9.5,2.5 9.5,16.5 11.5,16.5 18.5,9.5 18.5,8.5 "></polygon></svg>'},340:function(e,t){e.exports='<svg class="Playback__icon" viewBox="0 0 27 19"><rect x="7.5" y="2.5" width="4" height="14"></rect><rect x="15.5" y="2.5" width="4" height="14"></rect></svg>'},341:function(e,t,n){},342:function(e,t,n){},343:function(e,t,n){},37:function(e,t,n){"use strict";n.d(t,"a",function(){return P}),n.d(t,"e",function(){return C}),n.d(t,"h",function(){return T}),n.d(t,"g",function(){return M}),n.d(t,"f",function(){return D}),n.d(t,"b",function(){return I}),n.d(t,"c",function(){return R}),n.d(t,"d",function(){return L});var r=n(6),i=n.n(r),a=n(109),o=n.n(a),c=n(85),s=n.n(c),u=n(24),l=n.n(u),p=n(7),f=n.n(p),h=n(34),d=n.n(h),m=n(195),b=n.n(m),v=n(163),y=n.n(v),g=n(137),O=n(5);function w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function j(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?w(n,!0).forEach(function(t){_(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function _(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function E(e,t){var n=e.get(t.multiPhaseSyncId),r=n?n.timestamp:t.timestamp,i={begin:t.timestamp,end:t.timestamp,type:t.type,timestamp:t.timestamp,positions:t.rectangles,accessPoint:t.origin};switch(t.alertState){case"began":e.set(t.multiPhaseSyncId,j({},i,{end:r}));break;case"ended":e.set(t.multiPhaseSyncId,j({},i,{begin:r,timestamp:r,positions:n?n.rectangles:t.rectangles}));break;case"happened":e.set(t.id,{timestamp:t.timestamp,type:t.type,positions:t.rectangles,accessPoint:t.origin})}return e}var A=new Date(0);function S(e){var t=l()(A,["raisedAt"],e),n=l()(t,["reaction","reactedAt"],e);return j({},e,{begin:t,end:n})}function x(e){var t=j({},e);return e.begin&&e.end&&(t.begin=Object(O.l)(e.begin),t.end=Object(O.l)(e.end)),e.timestamp&&(t.begin=Object(O.l)(e.timestamp),t.end=new Date(t.begin.getTime()+1)),t}function k(e){return Object(g.a)(Object(O.l)(e.begin),Object(O.l)(e.end))}var P=i()([o.a,l()(new Date,"date.begin")]),C=i()([s.a,l()(new Date,"date.end")]),T=f()(k);function M(e){return i()([d()(E,new Map),function(e){return e.values()},Array.from,f()(x)])(e)}var D=i()([f()(S),f()(x)]),I=d()(function(e,t){for(var n=t.time,r=n.begin,i=n.end,a=j({},e),o=new Date(0),c=0;o.getTime()<i-O.a;c+=1)o=new Date(r+O.a*c),o.setHours(0,0,0,0),a[o]=!0;return a},{}),R=d()(function(e,t){return e||t.length>0},b()()),L=function(e){return function(t){for(var n=0;n<e.length;n+=1){var r=e[n].date,i=r.begin,a=r.end,o=y()(i,a);if(o(t))return!0}return!1}}},39:function(e,t,n){"use strict";n.d(t,"a",function(){return p});var r=n(3),i=n.n(r),a=n(6),o=n.n(a),c=n(157),s=n.n(c),u=o()([i()("data.type"),s()("authToken")]),l=function(e){var t=/authToken=([^&]+)/;if(!t.test(e))return;return t.exec(e)[1]}(location.search);function p(e){if(!l)return e;var t=/\?/.test(e)?"&":"?";return e+t+"authToken="+l}window.addEventListener("message",function(e){u(e)&&(l=e.data.token)}),t.b={get authToken(){return l}}},4:function(e,t,n){"use strict";n.d(t,"b",function(){return c});var r,i=n(35),a=n.n(i),o={arch:a()("arch"),bookmarks:a()("bookmarks"),cam:a()("camera"),camptz:a()("camera:ptz"),common:a()("common"),deprecated:(r=a()("deprecated"),function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.apply(void 0,t.concat([new Error]))}),embedded:a()("embedded"),events:a()("events"),export:a()("arch:export"),layout:a()("layout"),locomote:a()("video:locomote"),search:a()("arch:search"),topics:a()("topics"),video:a()("video"),player:a()("video:player"),ws:a()("video:ws"),pref:a()("preferences"),maps:a()("maps")};function c(e){e?a.a.enable("*"):a.a.disable()}t.a=o},427:function(e,t){},428:function(e,t){},43:function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"a",function(){return i});var r={H264:"H264",H265:"H265",MJPG:"MJPG"},i={JPEG:"jpeg",MP4:"mp4"}},432:function(e,t,n){},433:function(e,t){},436:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACABAMAAAAxEHz4AAAAHlBMVEV2dnZ5eXl3d3d7e3t6enp4eHh0dHRycnJ1dXVzc3M3oBetAAAOEElEQVR4Ae3ZMZuaWN/H8QMqkg4AkelAFUmnomg6UEdJJ6rqdIAKTKeOg6YDVCRdMpvMZt/tc2dnd5/kTF5C+s91UX4Pvz9ACo0xYQ644EmuSrPRsdJrP3J06/7C54wZTnyYCRRZFZYKGxAsDUQK9mA/1FCXMNuiVxFRRBJogGzK8gfATePzgtsJo2HSqaxqXnqXwuKmLcMenNaV5PGDYtaWPUw3s8uR8xxq+Kj8Zh5MXeKsovy+crAO9d5n5HmR3VRhD2ZYCtQjn8Kxb7bCzfrlrqd767xgRTmF0UoJJ9bMkrJVmqt9DVCNFuzBadsKbE9OmoDmuKfsIDo8dEo9am2nOnxGKF/xO7dW9ZVkuks79qx6gj0Y2CkML/b5ILrFqjtTT/cFLP88khrFymq5LoULvu65mhO92SXxspL1YQ8mYXOHc4Hd4PLRvIeQWoaeeTuE4cXC4OFUfV/qX/9E/VLV7ggcOrJbsAeFyFz58T3yPkRrG/3iYdeGXySoHc6zu4pcubk1Jxi1y0lkZumgrGXAHvAKgWfNWYbpna/Lu0Wo7lsPffUtnS9ihbhhaiayW6s72Yo5fD5ESkfYg5OqcarsdbsJXgSfFr1ZxzffPFLzqIlPJ1VLnPJimt0qx2JnGLUPrRD2QBmH1Tah8ntkVQ5DQzkDmigY2W+IjyLEmYvCoSqK+0qzoSAf9UktDXvQX/9ptL5ahKQJXj6NfuqfK0vXRgWs64FTI0+gQkcsawg46JxoWfsN7IGrToRalSCQO0TrX/h1PuPjYR1QYX2bpiynm2yeXUZsNFF1M63VeAT2wGZracf0s/Id+DA17AtefehjjrnmkdNEwF3JDRU6JMZcWz1zgzeOBntwnfu0ibM9HSlydgecmfn5q1jK5tfKanf93G2Uzi3xjyc7MG+rsn/UrrAH2+GJ2pKLekyfP/bjxuq5aK053XKqZG07Y6jC3clf1HeH9WDtzw91/QR7oJib1h5B3BPPGAbOqG6XN02yVygxM0GiJCcZXkgFhN3dYhUFxOQEe9Cx9n9x2fVGQdqVjWfYAectteNpuznutWUZYypxb6QTNHfoDiNGrY1hD3pHay3ydbpv+jIZDN9OdNlyq+ruG9A3iO0zgBmhPa6W3WnJ4EiRLdiDVZolO7f6KBqyiOul5wMQf3bEa6pVLbJgolkD8prKLsUj76wc+q0/gj0IV3JtKbh9r7QY1zPD5cAUkgjJd479gKyyaZ6qZJI/CGXaNYjdaGMgsAemPjtYnd2IalHsmRYnQyefaa5i/iyd0as3WrOWTmr2QNHzJady1CTYA01hA8os5QTnVhXSdL8wMlO2MNSopCE+DClTfBfNkvLOB1zFDnhpDHvgnwu8WlLB4pE9xp5VsgDR23OT+N5wEDpiPUTM2al2fg3sRtJJeQbsgSPPTEHj/IkDGLbAdwfmdtDpLgd91+HFKuFqKzQutI7jJlmRMWYXwR7QLTcklHnMxlXdK+fQCiqgckzTVRP1pkjWEQJ2KVyZtE+8NAf2QD7waR0zo/bMIW7HWeSoatvOYeXuuw8arm3TNybeiSrvKI59aQ7sAW6wkxaoYR8M2eSAz26vGM0Hg4N2/KoWBzGDg7RfzOS5ceWlObAHVsvv+bOP6FLGaOfm7Fp+ACQ6rhFIame7LhXJi56/V5I69tIc2IMuUYz33UXu3cdVa+stCmQpIuTDsUIzzXDDKmq3kLzNlDxZ+qc5sAe+0N6aMcA32VChTzFmF5ZOZMls4/OX6t1W86sbr9t6iP58/PTSHNiDzWX2Sf1sIBZGnswawrCO9WAFlKkn3cOm5h0phxrlJW9NWi/NgT1Q29zmqme89NapSxULv7RSjXOrQnbZ/HbrOmYNTZi6JZeu1ktzYA9UkVNUrxUkqfN11Vcc6tD1a26f3BRn+KP37ihUL9Rf3Tbn6y/NgT3Yt8DMuVXcZZyKanfyHbbrAS61+Aw6WeWLk00X8l4V061npP3SHNiDcrbh16NHR1wveDGPi4hf3DcLyytKOXcyAihK63YyJCMsJnr4vTmwB7aVN2IhXxu3T+U3oYUjPXxVPqhLPkfMCAHNFybtx/sTgX3hzT5yt3RhD9riSkrR9yvmCcd5Dx9jHV8SN2KAk+mmwZKeima988JZEyZ65Z0khD240DPQ2IWUhxXr1xKW3bYuaiaHTjBOuF+4N0XR4eTjh093NoMLhYmEwR6sCn9x/WU5Q5nMUQyZ3Ju7M5Uh3P4lTWX4+l62GZwtq1ZFGIXETH965YHGI0WZCU0vMGrDnU4aN5qBBpnvGb5g85RvBUSpJU6yRYWzgstjBvbg2UpUM/DNON1odU95dGdwPX4dfs/wPaLrqxZ2MCNTc2k3apTxSQB7MMr47XZlXbPQbIfzfD6w1Dgg/86wISB17EPVl5eo7XYexl2T+5KBPah8nZYcXR0EJBrmqbTCI8EJ/JNhBJh70mcouWBPCCK7D6NYgj1Ac5lgVQgaIYKqj8oE/Wh9bTL/ZjjxCmjnwl6ft51ld1jKZsYk7IFnxugqw0mY/SX3lANvvraH8X8Z3lGCEiPRyWqTmdrpjGvhDvYgCrptgeuPhHMuKGmfxCIgfswwE8ThY2N3/06UsPQ41YphD9CwZhU0towKWkjll7qU0D9k+I0dRxyXD0+Vij/x5+vDA+xBhpMS3HDLPJ9fZJpjR43IHzPcyeXA7ZsMbeJMqxzrEgJ7kBo1ZuzC5C+7A1aMk3Uiffwpw8OAZDiyFCK1676JCz3YA4FZsQlnSO36JuYtqh7SUIZtTLCjk3YiDiXufAhhD/5ci0TOIr1v2RurdpvJs9zPGaYa7WshaPt1N8KcvlWHPcgQHNttaPgXQU2JiWA6UIY7LC9xhY+11HrSJLPlCuzBmYrTFwer3Hi7kp1q38AZDmZiDpRJtvSwCnd9+wB7gF4atJWMLE996DmvM5zfiFi+Y3nRvGIikS+hsAfKJe91eAmxXGTwqwwL9NzOKiM59IdYUT/zsAcDSVw2nYwVopTzOsMVZ95aMY4bjA8X2aAeqhbswdUIZf9IUvyuWXydYaymEI3CTqpyW3VgZaN9F/Ygj45bO0BG5gdLf51hNhZljx6kKP7hsxDaZPWVBx5DXMj17bFBGa1fZFhYN56LD+VQNbaXut8U72EPznFMH1Z9S63uXfl1hhHq+Mfbxwf+2vVO/MqeKLAHjUKvhrZdjXUvIvU6w+T9jDqjdFDon+rB/lg5wB4Q1sGmr6zkkSgrv84w+lWSqmaVdNtvD3fpoGfDHjSdKz69RzCjb1Xrh9cZxiyyfRkWnuLYYEmGMGAPBnYjFV7xPTpUgzamWw6U4b9W1fCrxGB0XffZwHuAPTg0Vqh1WmFpc+JJ3JgRiJJy/jHDfKWKfJl/kcPrKmGyXdgDB/zZ3WScsIxzQT3frWBbYtM/V/4/w3Srv0WCVcya9Pl2VYE9qKGF4cNgxYMcnQZsx8eM8OXX778M79mmiVxqHRLteioCe+Arvkg+EkGn1PmWJENEj73191+/a/iS4dHzZAFSwr6+ccls2uvAHpgJHTmdZEqyon/jYAQ/4ujvv374S4ZHaI54a6HCMmuuOdbYzGEPGt6RbJoZA52W130GzfGfEON5vLIRjUcmMokGaC4YdfIjwMROPDxlYQ/eD+PO28/nwr9bz2IyzFl0lSg5VkIEZTuYedxZQvwlaTNW7fYIe9DnGQrkNOmfraeIJXUcnDcllC9/mon5Sx3l58tgNqIpB6Fu1grsAYL2He6MWy9bz174tsg+KVG0+PomIuhnaXrlP0xHXHc5ORxTyJyUYQ+ieoGfny7ky9az/L711PqLWRnHmSeTH1vSvUAs0MF+4yuM5Tgt2APD/d8nhqzz99Zj/LP1pD7ngwjPBCRVMHUMN+/ybTvNUtWuL8IevHwC+2nrOQ7MNI6XdDRjrof6NSVHhIJxH+XtZkjDHoz+/oTI3v9y65G24nUj93sjxs3evtsEJQr2YEvobkqOSHz0i61nEJkFkcOOTouzw/yMXvd82IOV8/0TOUEgnl5vPXQuW0bQ020YH8nch/ItujBhD84exmHHILNI1r/YevbtWpDbSWwA+vd4DrFDEvYA9Y3oVLPxUcH6xdYjxNctZy9Co0YAMr5PETHsQRjWtZ2kpnFqEf5i69nyjDe9FHC8aWQ/p99vQtiDHL7ibGLDJwgx1eCtJ10ZbzT7QkgLjVPchm7d4rAHreofdu7UtYZvy8h0AW8982KvndAAn0t+i3nP2e4C9uCPwblgkp4jDJ0MG5Gdxk9bT1Qr3OO24+Saycd43191BrAHsnNnmxXJW+tLhhwMzZuftp5e39kKpnM1FDREJzHlYrAHWOm5njKxoHdfG3NHj+J/2nqyi2aYi8ZFK22Fhbqq4jTsARIe6JbJdQfFUHKmMlaY/Lj1PCjyiIz0jYs+R+Tuw4MSwR5YYLPz98/kU3WyFMcLc/Hth63nfXTbj8BJSvlRFlV2Z+6awB70Ng47myA4XrlOL5xr4eMfth670bb1FXOU3c8Z1alv6DUDe6CsxrTumufAfF6yplmwf3pkZin8my5JHZNE+a6TQh4I2ANX7ZgbsVGLJK1thhfyh0fmp1FDve+Q5YzWTc3CjLhu2toB9mC72xhfxt9MYcNmuWH5bfTfI9MrD28KwnDCqf9rSJythlQnfUZgDyrE1jxewWYmhFHfiZj/HpkcCqZvFt1Qj0hWPAx8LIvoy60Be2BjCVZ6p4bTiiO1b6fz/x6ZqDFNhpNB7pr6uyE0SqFbLt2F/e/7wu/7wu/7wu/7wu/7wu/7wu/7wu/7Auz/D3mFdYIxP+6sAAAAAElFTkSuQmCC"},438:function(e,t){e.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjxzdmcKICAgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIgogICB4bWxuczpjYz0iaHR0cDovL2NyZWF0aXZlY29tbW9ucy5vcmcvbnMjIgogICB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiCiAgIHhtbG5zOnN2Zz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIKICAgd2lkdGg9IjQwIgogICB2aWV3Qm94PSIwIDAgNDAgNDAiCiAgIGhlaWdodD0iNDAiPgogIDxwYXRoCiAgICAgZD0ibSAxMS41ODY2OCwzMi4xMTYzOTMgYyAyLjQ2OTY2OCwxLjcxMzcwMiA1LjQwMzg1NiwyLjYzMjA0IDguNDA5ODMsMi42MzIwNCA4LjE0NzA3OSwwIDE0Ljc1MTQyNiwtNi42MDQ0NDkgMTQuNzUxNDI2LC0xNC43NTE0MjYgMCwtMy4wMDUwNzQgLTAuOTE3Nzg4LC01LjkzODU1OSAtMi42MzA1NDIsLTguNDA3NzMzIHogTSAxOS45OTY1MSw1LjI0NTA4MzcgYyAtOC4xNDcwNzcsMCAtMTQuNzUxNDI1NSw2LjYwNDQ0NjMgLTE0Ljc1MTQyNTUsMTQuNzUxNDI0MyAwLDMuMDA0OTc2IDAuOTE3NzIwNSw1LjkzODI2MiAyLjYzMDM0MTIsOC40MDc0MzEgTCAyOC40MDY4NDIsNy44NzY1MjQ1IEMgMjUuOTM3MTc1LDYuMTYyODI1NiAyMy4wMDI5ODYsNS4yNDQ0ODM5IDE5Ljk5NzAxLDUuMjQ0NDgzOSBaIE0gMzkuOTkzMDIxLDE5Ljk5NjUwOCBjIDAsMTEuMDQ0MDc0IC04Ljk1MjczOSwxOS45OTY1MSAtMTkuOTk2NTExLDE5Ljk5NjUxIEMgOC45NTI3MzY4LDM5Ljk5MzAxOCAwLDMxLjA0MDI3OSAwLDE5Ljk5NjUwOCAwLDguOTUyNzM4OCA4Ljk1MjczNjgsMCAxOS45OTY1MSwwIDMxLjA0MDI4MiwwIDM5Ljk5MzAyMSw4Ljk1MjczODggMzkuOTkzMDIxLDE5Ljk5NjUwOCBaIgogICAgIHN0eWxlPSJmaWxsOiNBRjNGM0Y7IiAvPgo8L3N2Zz4K"},44:function(e,t,n){"use strict";n.d(t,"g",function(){return v}),n.d(t,"e",function(){return y}),n.d(t,"a",function(){return g}),n.d(t,"c",function(){return O}),n.d(t,"d",function(){return _}),n.d(t,"f",function(){return E}),n.d(t,"b",function(){return A}),n.d(t,"h",function(){return S});var r=n(6),i=n.n(r),a=n(7),o=n.n(a),c=n(33),s=n.n(c),u=n(34),l=n.n(u),p=n(160),f=n.n(p);function h(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||m(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function d(e){return function(e){if(Array.isArray(e))return e}(e)||m(e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function m(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}var b=i()(f()(""),o()(function(e){return e.charCodeAt(0)}),function(e){return Uint8Array.from(e)});function v(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return new Promise(function(n,r){var i=new Image;i.opacity=t,i.src=e,i.onload=function(){n(i)},i.onerror=r})}function y(e){var t=d(e.layers),n=t[0],r=t.slice(1),i=e.opacity,a=document.createElement("canvas"),o=a.getContext("2d"),c=v(n);return c.then(function(e){a.width=e.width,a.height=e.height},s.a),Promise.all([c].concat(h(r.map(function(e){return v(e,i)})))).then(function(e){return l()(function(e,t){return e.globalAlpha=t.opacity,e.drawImage(t,0,0,e.canvas.width,e.canvas.height),e},e)}(o)).then(function(e){return new Promise(function(t){e.canvas.msToBlob?t(e.canvas.msToBlob()):e.canvas.toBlob(t,"image/png")})})}function g(e){var t=e.width,n=e.height;if(Boolean(t)&&Boolean(n))return t/n}function O(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"image/png",n=atob(e),r=b(n);return new Blob([r],{type:t})}var w,j,_=(w=document.createElement("canvas"),j=w.getContext("2d"),w.width=1,w.height=1,j?j.getImageData(0,0,w.width,w.height):null);function E(e){var t=e.naturalWidth||e.videoWidth,n=e.naturalHeight||e.videoHeight;if(t&&n){var r=document.createElement("canvas"),i=r.getContext("2d");return r.width=t,r.height=n,i.drawImage(e,0,0),i.getImageData(0,0,r.width,r.height)}}function A(e){return URL.createObjectURL(new Blob([e],{type:"image/jpeg"}))}var S=o()(function(e){var t=e.payload;return A(t)})},488:function(e,t){},489:function(e,t){},493:function(e,t){},494:function(e,t){},5:function(e,t,n){"use strict";n.d(t,"h",function(){return u}),n.d(t,"c",function(){return l}),n.d(t,"i",function(){return p}),n.d(t,"f",function(){return f}),n.d(t,"d",function(){return h}),n.d(t,"a",function(){return d}),n.d(t,"e",function(){return m}),n.d(t,"b",function(){return b}),n.d(t,"g",function(){return v}),n.d(t,"q",function(){return y}),n.d(t,"p",function(){return g}),n.d(t,"l",function(){return O}),n.d(t,"m",function(){return w}),n.d(t,"n",function(){return j}),n.d(t,"o",function(){return _}),n.d(t,"k",function(){return E}),n.d(t,"j",function(){return A});var r=n(106),i=n.n(r),a=n(119),o=n.n(a),c=n(6),s=n.n(c),u=1e3,l=u/10,p=10*u,f=60*u,h=60*f,d=24*h,m=1/u,b=d*m,v=0;function y(e){return function(t){return Math.floor(t/e)}}var g=function(e){return e*m};function O(e){var t,n=parseInt(e.substr(0,4),10),r=parseInt(e.substr(4,2),10)-1,i=parseInt(e.substr(6,2),10),a=parseInt(e.substr(9,2),10),o=parseInt(e.substr(11,2),10),c=parseInt(e.substr(13,2),10),s=parseInt(e.substr(16,3),10);return Number.isNaN(s)&&(s=0),t=Date.UTC(n,r,i,a,o,c,s),new Date(t)}function w(e){var t;return e instanceof Date&&(t=e.toISOString().replace(/[-:Z]/g,"")),t}function j(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"HH:MM:ss dd.mm.yyyy";return i()(new Date(e),t)}function _(e){var t=new Date(e),n=new Date(e);return t.setHours(0,0,0,0),n.setHours(23,59,59,999),{begintime:t,endtime:n}}var E=s()(w,o()("past")),A=s()(w,o()("future"))},59:function(e,t,n){"use strict";var r=n(7),i=n.n(r),a=n(32),o=n.n(a),c=n(3),s=n.n(c),u=n(53),l=n.n(u),p=n(167),f=n.n(p),h=n(313),d=n.n(h),m=n(68),b=n.n(m),v=n(6),y=n.n(v),g=n(210),O=n.n(g),w="MAP_VIEW_MODE_LAYOUT_ONLY",j=n(95);function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(n,!0).forEach(function(t){A(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function A(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,"c",function(){return S}),n.d(t,"g",function(){return x}),n.d(t,"a",function(){return R}),n.d(t,"d",function(){return L}),n.d(t,"b",function(){return F}),n.d(t,"e",function(){return U}),n.d(t,"f",function(){return V}),n.d(t,"h",function(){return G});var S=-1,x=function(){return{idx:S}},k=/Cell/,P=o()(function(e){var t=e.type;return k.test(t)}),C=i()(function(e){var t=e.Key,n=e.Value,r=n.camera_adapter,i=n.dimenstions,a=n.linked_cells,o=n.position,c=n.left_sibling,s=n.right_sibling,u=n.top_sibling,l=n.bottom_sibling,p=n.video_parameters,f=p.audio_volume,h=p.camera_stream_resolution,d=p.default_channel_mode,m=n.$type;return{key:t,origin:r,size:Object(j.c)(i),position:o,linkedCells:a,sibling:{left:c,right:s,top:u,bottom:l},ext:{audioVolume:f,cameraStream:!d&&h},type:m}}),T=-1,M={left:0,right:0,top:1,bottom:1};function D(e){var t=d()(function(e,t){e[t.key]=t},O()())(e),n=function(e){return function t(n,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=n.sibling[r];if(a===T)return i;var o=e[a],c=o.size[M[r]];return t(o,r,i+c)}}(t);return e.map(function(e){return E({pos:{left:n(e,"left"),right:n(e,"right"),top:n(e,"top"),bottom:n(e,"bottom")}},e)})}var I=i()(function(e){var t=e.key,n=e.pos,r=e.origin,i=e.ext;return{key:t,pos:n,origin:r,ext:i}}),R={key:0,origin:"",pos:{left:0,right:0,top:0,bottom:0},ext:{audioVolume:50,cameraStream:0}};function L(e){var t=[];return e&&t.push(E({},R,{camera:e,origin:e.origin})),t}var N={left:"width",right:"width",top:"height",bottom:"height"},z={width:{start:"left",end:"right"},height:{start:"top",end:"bottom"}},F={cells:[]},$={top:"top_sibling_position",left:"left_sibling_position",right:"right_sibling_position",bottom:"bottom_sibling_position"},H={top:"top",right:"right",bottom:"bottom",left:"left"},B=function(e){return function(t){return e[$[t]]}},Y=function(e){return{position:e.index,dimensions:e.size,left_sibling_position:e.sibling.left,right_sibling_position:e.sibling.right,top_sibling_position:e.sibling.top,bottom_sibling_position:e.sibling.bottom,camera_ap:e.origin}};var U=function(e){return{id:e.id,display_name:e.displayName,alarm_mode:!1,is_for_alarm:!1,is_user_defined:!0,map_id:"",map_view_mode:w,cells:l()(Y)(e.cells)}},V=function(e){return{etag:e.etag||"",body:U(e)}};function W(e,t,n){for(var r=N[e],i=0,a=B(n)(e);a>-1;){var o=t[a],c=o.dimensions[r];i+=c,a=B(o)(e)}return i}var q=function(e){return function(t){return y()([o()(function(e){return function(t){var n=z[e].start,r=B(t)(n);return r===T}}(e)),i()(function(n){return W(z[e].end,t,n)+n.dimensions[e]}),f.a])(t)}},G=i()(function(e){return{displayName:e.display_name,cells:y()([C,D,P,I,b()("key")])(e.cells)}}),X=function(e){return l()(function(t){return{index:t.position,position:t.position,origin:t.camera_ap,size:t.dimensions,pos:l()(function(e,t){return function(n){var r=W(n,e,t),i=q(N[n])(e);return r/i}}(e,t))(H),sibling:l()(B(t))(H),ext:{audioVolume:s()("video_parameters.audio_volume")(t),cameraStream:s()("video_parameters.stream_resolution")(t)}}})(e)};i()(function(e){var t=e.body,n=e.meta;return{etag:n.etag,id:n.layout_id,displayName:t.display_name,size:{height:q("height")(t.cells),width:q("width")(t.cells)},cells:X(t.cells)}})},618:function(e,t){},619:function(e,t){},620:function(e,t){},621:function(e,t){},622:function(e,t){},643:function(e,t,n){},649:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAABCAIAAABol6gpAAAAH0lEQVR4AWPs7JzBBAbMzMwQBgsLCw8Pt6yslKy0JAA27wKhbDeC0wAAAABJRU5ErkJggg=="},65:function(e,t,n){"use strict";function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=e^t;return n+(n<<1)+(n<<4)+(n<<7)+(n<<8)+(n<<24)>>>0}n.d(t,"a",function(){return r}),n.d(t,"b",function(){return i});var i=function(e){return function(e){for(var t=new Uint8Array(e.length),n=0;n<e.length;n+=1)t[n]=e.charCodeAt(n);return t}(e).reduce(r,0)}},650:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAMCAIAAADUCbv3AAAAKklEQVR4AWMgDDo6OnZjAKAgVBrI+Y8BgIIIaSSzEIKDVTdhaULBQhAAAB9unWOSHVtDAAAAAElFTkSuQmCC"},651:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAMAAABhq6zVAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAATlBMVEX///8AAAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD7AACFAAAAAADiAAAAAAAAAAD9AAClAAAAAADqAAAAAAAAAACmAAAAAAD/AAD///+OY0j8AAAAGHRSTlMAAPZVvzv+r+86828rxEEQ+IMv0EMXhDT4cO2lAAAAAWJLR0QAiAUdSAAAAAlwSFlzAAALEgAACxIB0t1+/AAAAAd0SU1FB+MHCQwYBB9A9TIAAABHSURBVAjXY2BgYmYEAwYQkJBgQeZIMLEicSTY2JE4EhIcnEgcMIBxuLh5eHigenj5+GHKBASF4AYIi4jCjBYQE0dYChaGcACdMgVlgGIcqwAAABh0RVh0Q3JlYXRpb24gVGltZQAxNi4wNC4yMDEzP03H/QAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxOS0wNy0wOVQxMjoyNDowNCswMzowMAl5XuEAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTktMDctMDlUMTI6MjQ6MDQrMDM6MDB4JOZdAAAAHHRFWHRTb2Z0d2FyZQBBZG9iZSBGaXJld29ya3MgQ1M26LyyjAAAAABJRU5ErkJggg=="},652:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAABx0RVh0U29mdHdhcmUAQWRvYmUgRmlyZXdvcmtzIENTNui8sowAAAAYdEVYdENyZWF0aW9uIFRpbWUAMTYuMDQuMjAxMz9Nx/0AAACzSURBVCiRjZAhDsJAEEXfcgIkGiwJSGQVCQ4SDK4SyRFIEGiCIeEGnAAJppoaFEuKaNIbgPuYttnQLfCSrzZv/uwgCVkusvSpQVIZckF5lr8EIwnuRs57DIxNh8QVChqegT2JWJaFr83X4HIGQtpK/hUq+FYquSU8ghkr06Fb5PNKkkXPK6/9miMQAs1vZ1UakU1HbIBB0VQrHLacgDnQclerCGlENhmyAwLfXyqCb2qd8AZbDKsAx7EAawAAAABJRU5ErkJggg=="},653:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAMAAABhq6zVAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAATlBMVEX///8AAAAA4AAA4AAA4AAA4AAA3wAA4AAA4AAAwAAANwAAAAAA2QAAiAAAAAAAAAAAyQAASgAAAAAAlQAAAAAAAAAARwAAAAAA4AD////N4Dq4AAAAGHRSTlMAANAwgCDxcMDggiv4uGAQ6JE4wGgYmEBnzkwYAAAAAWJLR0QAiAUdSAAAAAlwSFlzAAALEgAACxIB0t1+/AAAAAd0SU1FB+MHCQwYHXsrXfIAAABISURBVAjXY2BgYmYEAwYQkJBgQeZIMLEicSTY2JE4EhIcrEgcMIBxOLm4ubkhHB5ePn6YMgFBIbgBwiKiMKMFxMQRloKFIRwAm8QFYhUFtxAAAAAYdEVYdENyZWF0aW9uIFRpbWUAMTYuMDQuMjAxMz9Nx/0AAAAldEVYdGRhdGU6Y3JlYXRlADIwMTktMDctMDlUMTI6MjQ6MjkrMDM6MDAqizhcAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE5LTA3LTA5VDEyOjI0OjI5KzAzOjAwW9aA4AAAABx0RVh0U29mdHdhcmUAQWRvYmUgRmlyZXdvcmtzIENTNui8sowAAAAASUVORK5CYII="},654:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAQAAAD8fJRsAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAACusAAArrAYKLDVoAAAAHdElNRQfjBxEQMSN+nfrWAAAAj0lEQVQY022PoQ3CYBhEHw1DsEVJYICOwAhIJCOQgMDg0Riow9UgikN8BbpBCaYNBlt1iCbl758+d3l34hD2tDEOQogACHnYCo+ByARAzmxaNAuAoK2Eym3Zt2i4Mp8UfaJl2I3v1/pwjz1R10m6OXHWtyM+1S6+HLk5d0ymbcqCkXsQkZTRnsh/jvh3XfEDgw4/SNvHKfwAAAAYdEVYdENyZWF0aW9uIFRpbWUAMTYuMDQuMjAxMz9Nx/0AAAAldEVYdGRhdGU6Y3JlYXRlADIwMTktMDctMTdUMTY6NDk6MzUrMDM6MDBbV0Q7AAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE5LTA3LTE3VDE2OjQ5OjM1KzAzOjAwKgr8hwAAABx0RVh0U29mdHdhcmUAQWRvYmUgRmlyZXdvcmtzIENTNui8sowAAAAASUVORK5CYII="},655:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}
/*! jQuery Timepicker Addon - v1.6.3 - 2016-04-20
* http://trentrichardson.com/examples/timepicker
* Copyright (c) 2016 Trent Richardson; Licensed MIT */__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(30),__webpack_require__(236)],__WEBPACK_AMD_DEFINE_FACTORY__=function($){if($.ui.timepicker=$.ui.timepicker||{},!$.ui.timepicker.version){$.extend($.ui,{timepicker:{version:"1.6.3"}});var Timepicker=function(){this.regional=[],this.regional[""]={currentText:"Now",closeText:"Done",amNames:["AM","A"],pmNames:["PM","P"],timeFormat:"HH:mm",timeSuffix:"",timeOnlyTitle:"Choose Time",timeText:"Time",hourText:"Hour",minuteText:"Minute",secondText:"Second",millisecText:"Millisecond",microsecText:"Microsecond",timezoneText:"Time Zone",isRTL:!1},this._defaults={showButtonPanel:!0,timeOnly:!1,timeOnlyShowDate:!1,showHour:null,showMinute:null,showSecond:null,showMillisec:null,showMicrosec:null,showTimezone:null,showTime:!0,stepHour:1,stepMinute:1,stepSecond:1,stepMillisec:1,stepMicrosec:1,hour:0,minute:0,second:0,millisec:0,microsec:0,timezone:null,hourMin:0,minuteMin:0,secondMin:0,millisecMin:0,microsecMin:0,hourMax:23,minuteMax:59,secondMax:59,millisecMax:999,microsecMax:999,minDateTime:null,maxDateTime:null,maxTime:null,minTime:null,onSelect:null,hourGrid:0,minuteGrid:0,secondGrid:0,millisecGrid:0,microsecGrid:0,alwaysSetTime:!0,separator:" ",altFieldTimeOnly:!0,altTimeFormat:null,altSeparator:null,altTimeSuffix:null,altRedirectFocus:!0,pickerTimeFormat:null,pickerTimeSuffix:null,showTimepicker:!0,timezoneList:null,addSliderAccess:!1,sliderAccessArgs:null,controlType:"slider",oneLine:!1,defaultValue:null,parse:"strict",afterInject:null},$.extend(this._defaults,this.regional[""])};$.extend(Timepicker.prototype,{$input:null,$altInput:null,$timeObj:null,inst:null,hour_slider:null,minute_slider:null,second_slider:null,millisec_slider:null,microsec_slider:null,timezone_select:null,maxTime:null,minTime:null,hour:0,minute:0,second:0,millisec:0,microsec:0,timezone:null,hourMinOriginal:null,minuteMinOriginal:null,secondMinOriginal:null,millisecMinOriginal:null,microsecMinOriginal:null,hourMaxOriginal:null,minuteMaxOriginal:null,secondMaxOriginal:null,millisecMaxOriginal:null,microsecMaxOriginal:null,ampm:"",formattedDate:"",formattedTime:"",formattedDateTime:"",timezoneList:null,units:["hour","minute","second","millisec","microsec"],support:{},control:null,setDefaults:function(e){return extendRemove(this._defaults,e||{}),this},_newInst:function _newInst($input,opts){var tp_inst=new Timepicker,inlineSettings={},fns={},overrides,i;for(var attrName in this._defaults)if(this._defaults.hasOwnProperty(attrName)){var attrValue=$input.attr("time:"+attrName);if(attrValue)try{inlineSettings[attrName]=eval(attrValue)}catch(e){inlineSettings[attrName]=attrValue}}for(i in overrides={beforeShow:function(e,t){if($.isFunction(tp_inst._defaults.evnts.beforeShow))return tp_inst._defaults.evnts.beforeShow.call($input[0],e,t,tp_inst)},onChangeMonthYear:function(e,t,n){$.isFunction(tp_inst._defaults.evnts.onChangeMonthYear)&&tp_inst._defaults.evnts.onChangeMonthYear.call($input[0],e,t,n,tp_inst)},onClose:function(e,t){!0===tp_inst.timeDefined&&""!==$input.val()&&tp_inst._updateDateTime(t),$.isFunction(tp_inst._defaults.evnts.onClose)&&tp_inst._defaults.evnts.onClose.call($input[0],e,t,tp_inst)}},overrides)overrides.hasOwnProperty(i)&&(fns[i]=opts[i]||this._defaults[i]||null);tp_inst._defaults=$.extend({},this._defaults,inlineSettings,opts,overrides,{evnts:fns,timepicker:tp_inst}),tp_inst.amNames=$.map(tp_inst._defaults.amNames,function(e){return e.toUpperCase()}),tp_inst.pmNames=$.map(tp_inst._defaults.pmNames,function(e){return e.toUpperCase()}),tp_inst.support=detectSupport(tp_inst._defaults.timeFormat+(tp_inst._defaults.pickerTimeFormat?tp_inst._defaults.pickerTimeFormat:"")+(tp_inst._defaults.altTimeFormat?tp_inst._defaults.altTimeFormat:"")),"string"==typeof tp_inst._defaults.controlType?("slider"===tp_inst._defaults.controlType&&void 0===$.ui.slider&&(tp_inst._defaults.controlType="select"),tp_inst.control=tp_inst._controls[tp_inst._defaults.controlType]):tp_inst.control=tp_inst._defaults.controlType;var timezoneList=[-720,-660,-600,-570,-540,-480,-420,-360,-300,-270,-240,-210,-180,-120,-60,0,60,120,180,210,240,270,300,330,345,360,390,420,480,525,540,570,600,630,660,690,720,765,780,840];null!==tp_inst._defaults.timezoneList&&(timezoneList=tp_inst._defaults.timezoneList);var tzl=timezoneList.length,tzi=0,tzv=null;if(tzl>0&&"object"!==_typeof(timezoneList[0]))for(;tzi<tzl;tzi++)tzv=timezoneList[tzi],timezoneList[tzi]={value:tzv,label:$.timepicker.timezoneOffsetString(tzv,tp_inst.support.iso8601)};return tp_inst._defaults.timezoneList=timezoneList,tp_inst.timezone=null!==tp_inst._defaults.timezone?$.timepicker.timezoneOffsetNumber(tp_inst._defaults.timezone):-1*(new Date).getTimezoneOffset(),tp_inst.hour=tp_inst._defaults.hour<tp_inst._defaults.hourMin?tp_inst._defaults.hourMin:tp_inst._defaults.hour>tp_inst._defaults.hourMax?tp_inst._defaults.hourMax:tp_inst._defaults.hour,tp_inst.minute=tp_inst._defaults.minute<tp_inst._defaults.minuteMin?tp_inst._defaults.minuteMin:tp_inst._defaults.minute>tp_inst._defaults.minuteMax?tp_inst._defaults.minuteMax:tp_inst._defaults.minute,tp_inst.second=tp_inst._defaults.second<tp_inst._defaults.secondMin?tp_inst._defaults.secondMin:tp_inst._defaults.second>tp_inst._defaults.secondMax?tp_inst._defaults.secondMax:tp_inst._defaults.second,tp_inst.millisec=tp_inst._defaults.millisec<tp_inst._defaults.millisecMin?tp_inst._defaults.millisecMin:tp_inst._defaults.millisec>tp_inst._defaults.millisecMax?tp_inst._defaults.millisecMax:tp_inst._defaults.millisec,tp_inst.microsec=tp_inst._defaults.microsec<tp_inst._defaults.microsecMin?tp_inst._defaults.microsecMin:tp_inst._defaults.microsec>tp_inst._defaults.microsecMax?tp_inst._defaults.microsecMax:tp_inst._defaults.microsec,tp_inst.ampm="",tp_inst.$input=$input,tp_inst._defaults.altField&&(tp_inst.$altInput=$(tp_inst._defaults.altField),!0===tp_inst._defaults.altRedirectFocus&&tp_inst.$altInput.css({cursor:"pointer"}).focus(function(){$input.trigger("focus")})),0!==tp_inst._defaults.minDate&&0!==tp_inst._defaults.minDateTime||(tp_inst._defaults.minDate=new Date),0!==tp_inst._defaults.maxDate&&0!==tp_inst._defaults.maxDateTime||(tp_inst._defaults.maxDate=new Date),void 0!==tp_inst._defaults.minDate&&tp_inst._defaults.minDate instanceof Date&&(tp_inst._defaults.minDateTime=new Date(tp_inst._defaults.minDate.getTime())),void 0!==tp_inst._defaults.minDateTime&&tp_inst._defaults.minDateTime instanceof Date&&(tp_inst._defaults.minDate=new Date(tp_inst._defaults.minDateTime.getTime())),void 0!==tp_inst._defaults.maxDate&&tp_inst._defaults.maxDate instanceof Date&&(tp_inst._defaults.maxDateTime=new Date(tp_inst._defaults.maxDate.getTime())),void 0!==tp_inst._defaults.maxDateTime&&tp_inst._defaults.maxDateTime instanceof Date&&(tp_inst._defaults.maxDate=new Date(tp_inst._defaults.maxDateTime.getTime())),tp_inst.$input.bind("focus",function(){tp_inst._onFocus()}),tp_inst},_addTimePicker:function(e){var t=$.trim(this.$altInput&&this._defaults.altFieldTimeOnly?this.$input.val()+" "+this.$altInput.val():this.$input.val());this.timeDefined=this._parseTime(t),this._limitMinMaxDateTime(e,!1),this._injectTimePicker(),this._afterInject()},_parseTime:function(e,t){if(this.inst||(this.inst=$.datepicker._getInst(this.$input[0])),t||!this._defaults.timeOnly){var n=$.datepicker._get(this.inst,"dateFormat");try{var r=parseDateTimeInternal(n,this._defaults.timeFormat,e,$.datepicker._getFormatConfig(this.inst),this._defaults);if(!r.timeObj)return!1;$.extend(this,r.timeObj)}catch(t){return $.timepicker.log("Error parsing the date/time string: "+t+"\ndate/time string = "+e+"\ntimeFormat = "+this._defaults.timeFormat+"\ndateFormat = "+n),!1}return!0}var i=$.datepicker.parseTime(this._defaults.timeFormat,e,this._defaults);return!!i&&($.extend(this,i),!0)},_afterInject:function(){var e=this.inst.settings;$.isFunction(e.afterInject)&&e.afterInject.call(this)},_injectTimePicker:function(){var e=this.inst.dpDiv,t=this.inst.settings,n=this,r="",i="",a=null,o={},c={},s=null,u=0,l=0;if(0===e.find("div.ui-timepicker-div").length&&t.showTimepicker){var p=" ui_tpicker_unit_hide",f='<div class="ui-timepicker-div'+(t.isRTL?" ui-timepicker-rtl":"")+(t.oneLine&&"select"===t.controlType?" ui-timepicker-oneLine":"")+'"><dl><dt class="ui_tpicker_time_label'+(t.showTime?"":p)+'">'+t.timeText+'</dt><dd class="ui_tpicker_time '+(t.showTime?"":p)+'"><input class="ui_tpicker_time_input" '+(t.timeInput?"":"disabled")+"/></dd>";for(u=0,l=this.units.length;u<l;u++){if(r=this.units[u],i=r.substr(0,1).toUpperCase()+r.substr(1),a=null!==t["show"+i]?t["show"+i]:this.support[r],o[r]=parseInt(t[r+"Max"]-(t[r+"Max"]-t[r+"Min"])%t["step"+i],10),c[r]=0,f+='<dt class="ui_tpicker_'+r+"_label"+(a?"":p)+'">'+t[r+"Text"]+'</dt><dd class="ui_tpicker_'+r+(a?"":p)+'"><div class="ui_tpicker_'+r+"_slider"+(a?"":p)+'"></div>',a&&t[r+"Grid"]>0){if(f+='<div style="padding-left: 1px"><table class="ui-tpicker-grid-label"><tr>',"hour"===r)for(var h=t[r+"Min"];h<=o[r];h+=parseInt(t[r+"Grid"],10)){c[r]++;var d=$.datepicker.formatTime(this.support.ampm?"hht":"HH",{hour:h},t);f+='<td data-for="'+r+'">'+d+"</td>"}else for(var m=t[r+"Min"];m<=o[r];m+=parseInt(t[r+"Grid"],10))c[r]++,f+='<td data-for="'+r+'">'+(m<10?"0":"")+m+"</td>";f+="</tr></table></div>"}f+="</dd>"}var b=null!==t.showTimezone?t.showTimezone:this.support.timezone;f+='<dt class="ui_tpicker_timezone_label'+(b?"":p)+'">'+t.timezoneText+"</dt>",f+='<dd class="ui_tpicker_timezone'+(b?"":p)+'"></dd>',f+="</dl></div>";var v=$(f);for(!0===t.timeOnly&&(v.prepend('<div class="ui-widget-header ui-helper-clearfix ui-corner-all"><div class="ui-datepicker-title">'+t.timeOnlyTitle+"</div></div>"),e.find(".ui-datepicker-header, .ui-datepicker-calendar").hide()),u=0,l=n.units.length;u<l;u++)r=n.units[u],i=r.substr(0,1).toUpperCase()+r.substr(1),a=null!==t["show"+i]?t["show"+i]:this.support[r],n[r+"_slider"]=n.control.create(n,v.find(".ui_tpicker_"+r+"_slider"),r,n[r],t[r+"Min"],o[r],t["step"+i]),a&&t[r+"Grid"]>0&&(s=100*c[r]*t[r+"Grid"]/(o[r]-t[r+"Min"]),v.find(".ui_tpicker_"+r+" table").css({width:s+"%",marginLeft:t.isRTL?"0":s/(-2*c[r])+"%",marginRight:t.isRTL?s/(-2*c[r])+"%":"0",borderCollapse:"collapse"}).find("td").click(function(e){var t=$(this),i=t.html(),a=parseInt(i.replace(/[^0-9]/g),10),o=i.replace(/[^apm]/gi),c=t.data("for");"hour"===c&&(-1!==o.indexOf("p")&&a<12?a+=12:-1!==o.indexOf("a")&&12===a&&(a=0)),n.control.value(n,n[c+"_slider"],r,a),n._onTimeChange(),n._onSelectHandler()}).css({cursor:"pointer",width:100/c[r]+"%",textAlign:"center",overflow:"hidden"}));if(this.timezone_select=v.find(".ui_tpicker_timezone").append("<select></select>").find("select"),$.fn.append.apply(this.timezone_select,$.map(t.timezoneList,function(e,t){return $("<option />").val("object"===_typeof(e)?e.value:e).text("object"===_typeof(e)?e.label:e)})),void 0!==this.timezone&&null!==this.timezone&&""!==this.timezone){var y=-1*new Date(this.inst.selectedYear,this.inst.selectedMonth,this.inst.selectedDay,12).getTimezoneOffset();y===this.timezone?selectLocalTimezone(n):this.timezone_select.val(this.timezone)}else void 0!==this.hour&&null!==this.hour&&""!==this.hour?this.timezone_select.val(t.timezone):selectLocalTimezone(n);this.timezone_select.change(function(){n._onTimeChange(),n._onSelectHandler(),n._afterInject()});var g=e.find(".ui-datepicker-buttonpane");if(g.length?g.before(v):e.append(v),this.$timeObj=v.find(".ui_tpicker_time_input"),this.$timeObj.change(function(){var e=n.inst.settings.timeFormat,t=$.datepicker.parseTime(e,this.value),r=new Date;t?(r.setHours(t.hour),r.setMinutes(t.minute),r.setSeconds(t.second),$.datepicker._setTime(n.inst,r)):(this.value=n.formattedTime,this.blur())}),null!==this.inst){var O=this.timeDefined;this._onTimeChange(),this.timeDefined=O}if(this._defaults.addSliderAccess){var w=this._defaults.sliderAccessArgs,j=this._defaults.isRTL;w.isRTL=j,setTimeout(function(){if(0===v.find(".ui-slider-access").length){v.find(".ui-slider:visible").sliderAccess(w);var e=v.find(".ui-slider-access:eq(0)").outerWidth(!0);e&&v.find("table:visible").each(function(){var t=$(this),n=t.outerWidth(),r=t.css(j?"marginRight":"marginLeft").toString().replace("%",""),i=n-e,a=r*i/n+"%",o={width:i,marginRight:0,marginLeft:0};o[j?"marginRight":"marginLeft"]=a,t.css(o)})}},10)}n._limitMinMaxDateTime(this.inst,!0)}},_limitMinMaxDateTime:function(e,t){var n=this._defaults,r=new Date(e.selectedYear,e.selectedMonth,e.selectedDay);if(this._defaults.showTimepicker){if(null!==$.datepicker._get(e,"minDateTime")&&void 0!==$.datepicker._get(e,"minDateTime")&&r){var i=$.datepicker._get(e,"minDateTime"),a=new Date(i.getFullYear(),i.getMonth(),i.getDate(),0,0,0,0);null!==this.hourMinOriginal&&null!==this.minuteMinOriginal&&null!==this.secondMinOriginal&&null!==this.millisecMinOriginal&&null!==this.microsecMinOriginal||(this.hourMinOriginal=n.hourMin,this.minuteMinOriginal=n.minuteMin,this.secondMinOriginal=n.secondMin,this.millisecMinOriginal=n.millisecMin,this.microsecMinOriginal=n.microsecMin),e.settings.timeOnly||a.getTime()===r.getTime()?(this._defaults.hourMin=i.getHours(),this.hour<=this._defaults.hourMin?(this.hour=this._defaults.hourMin,this._defaults.minuteMin=i.getMinutes(),this.minute<=this._defaults.minuteMin?(this.minute=this._defaults.minuteMin,this._defaults.secondMin=i.getSeconds(),this.second<=this._defaults.secondMin?(this.second=this._defaults.secondMin,this._defaults.millisecMin=i.getMilliseconds(),this.millisec<=this._defaults.millisecMin?(this.millisec=this._defaults.millisecMin,this._defaults.microsecMin=i.getMicroseconds()):(this.microsec<this._defaults.microsecMin&&(this.microsec=this._defaults.microsecMin),this._defaults.microsecMin=this.microsecMinOriginal)):(this._defaults.millisecMin=this.millisecMinOriginal,this._defaults.microsecMin=this.microsecMinOriginal)):(this._defaults.secondMin=this.secondMinOriginal,this._defaults.millisecMin=this.millisecMinOriginal,this._defaults.microsecMin=this.microsecMinOriginal)):(this._defaults.minuteMin=this.minuteMinOriginal,this._defaults.secondMin=this.secondMinOriginal,this._defaults.millisecMin=this.millisecMinOriginal,this._defaults.microsecMin=this.microsecMinOriginal)):(this._defaults.hourMin=this.hourMinOriginal,this._defaults.minuteMin=this.minuteMinOriginal,this._defaults.secondMin=this.secondMinOriginal,this._defaults.millisecMin=this.millisecMinOriginal,this._defaults.microsecMin=this.microsecMinOriginal)}if(null!==$.datepicker._get(e,"maxDateTime")&&void 0!==$.datepicker._get(e,"maxDateTime")&&r){var o=$.datepicker._get(e,"maxDateTime"),c=new Date(o.getFullYear(),o.getMonth(),o.getDate(),0,0,0,0);null!==this.hourMaxOriginal&&null!==this.minuteMaxOriginal&&null!==this.secondMaxOriginal&&null!==this.millisecMaxOriginal||(this.hourMaxOriginal=n.hourMax,this.minuteMaxOriginal=n.minuteMax,this.secondMaxOriginal=n.secondMax,this.millisecMaxOriginal=n.millisecMax,this.microsecMaxOriginal=n.microsecMax),e.settings.timeOnly||c.getTime()===r.getTime()?(this._defaults.hourMax=o.getHours(),this.hour>=this._defaults.hourMax?(this.hour=this._defaults.hourMax,this._defaults.minuteMax=o.getMinutes(),this.minute>=this._defaults.minuteMax?(this.minute=this._defaults.minuteMax,this._defaults.secondMax=o.getSeconds(),this.second>=this._defaults.secondMax?(this.second=this._defaults.secondMax,this._defaults.millisecMax=o.getMilliseconds(),this.millisec>=this._defaults.millisecMax?(this.millisec=this._defaults.millisecMax,this._defaults.microsecMax=o.getMicroseconds()):(this.microsec>this._defaults.microsecMax&&(this.microsec=this._defaults.microsecMax),this._defaults.microsecMax=this.microsecMaxOriginal)):(this._defaults.millisecMax=this.millisecMaxOriginal,this._defaults.microsecMax=this.microsecMaxOriginal)):(this._defaults.secondMax=this.secondMaxOriginal,this._defaults.millisecMax=this.millisecMaxOriginal,this._defaults.microsecMax=this.microsecMaxOriginal)):(this._defaults.minuteMax=this.minuteMaxOriginal,this._defaults.secondMax=this.secondMaxOriginal,this._defaults.millisecMax=this.millisecMaxOriginal,this._defaults.microsecMax=this.microsecMaxOriginal)):(this._defaults.hourMax=this.hourMaxOriginal,this._defaults.minuteMax=this.minuteMaxOriginal,this._defaults.secondMax=this.secondMaxOriginal,this._defaults.millisecMax=this.millisecMaxOriginal,this._defaults.microsecMax=this.microsecMaxOriginal)}if(null!==e.settings.minTime){var s=new Date("01/01/1970 "+e.settings.minTime);this.hour<s.getHours()?(this.hour=this._defaults.hourMin=s.getHours(),this.minute=this._defaults.minuteMin=s.getMinutes()):this.hour===s.getHours()&&this.minute<s.getMinutes()?this.minute=this._defaults.minuteMin=s.getMinutes():this._defaults.hourMin<s.getHours()?(this._defaults.hourMin=s.getHours(),this._defaults.minuteMin=s.getMinutes()):this._defaults.hourMin===s.getHours()===this.hour&&this._defaults.minuteMin<s.getMinutes()?this._defaults.minuteMin=s.getMinutes():this._defaults.minuteMin=0}if(null!==e.settings.maxTime){var u=new Date("01/01/1970 "+e.settings.maxTime);this.hour>u.getHours()?(this.hour=this._defaults.hourMax=u.getHours(),this.minute=this._defaults.minuteMax=u.getMinutes()):this.hour===u.getHours()&&this.minute>u.getMinutes()?this.minute=this._defaults.minuteMax=u.getMinutes():this._defaults.hourMax>u.getHours()?(this._defaults.hourMax=u.getHours(),this._defaults.minuteMax=u.getMinutes()):this._defaults.hourMax===u.getHours()===this.hour&&this._defaults.minuteMax>u.getMinutes()?this._defaults.minuteMax=u.getMinutes():this._defaults.minuteMax=59}if(void 0!==t&&!0===t){var l=parseInt(this._defaults.hourMax-(this._defaults.hourMax-this._defaults.hourMin)%this._defaults.stepHour,10),p=parseInt(this._defaults.minuteMax-(this._defaults.minuteMax-this._defaults.minuteMin)%this._defaults.stepMinute,10),f=parseInt(this._defaults.secondMax-(this._defaults.secondMax-this._defaults.secondMin)%this._defaults.stepSecond,10),h=parseInt(this._defaults.millisecMax-(this._defaults.millisecMax-this._defaults.millisecMin)%this._defaults.stepMillisec,10),d=parseInt(this._defaults.microsecMax-(this._defaults.microsecMax-this._defaults.microsecMin)%this._defaults.stepMicrosec,10);this.hour_slider&&(this.control.options(this,this.hour_slider,"hour",{min:this._defaults.hourMin,max:l,step:this._defaults.stepHour}),this.control.value(this,this.hour_slider,"hour",this.hour-this.hour%this._defaults.stepHour)),this.minute_slider&&(this.control.options(this,this.minute_slider,"minute",{min:this._defaults.minuteMin,max:p,step:this._defaults.stepMinute}),this.control.value(this,this.minute_slider,"minute",this.minute-this.minute%this._defaults.stepMinute)),this.second_slider&&(this.control.options(this,this.second_slider,"second",{min:this._defaults.secondMin,max:f,step:this._defaults.stepSecond}),this.control.value(this,this.second_slider,"second",this.second-this.second%this._defaults.stepSecond)),this.millisec_slider&&(this.control.options(this,this.millisec_slider,"millisec",{min:this._defaults.millisecMin,max:h,step:this._defaults.stepMillisec}),this.control.value(this,this.millisec_slider,"millisec",this.millisec-this.millisec%this._defaults.stepMillisec)),this.microsec_slider&&(this.control.options(this,this.microsec_slider,"microsec",{min:this._defaults.microsecMin,max:d,step:this._defaults.stepMicrosec}),this.control.value(this,this.microsec_slider,"microsec",this.microsec-this.microsec%this._defaults.stepMicrosec))}}},_onTimeChange:function(){if(this._defaults.showTimepicker){var e=!!this.hour_slider&&this.control.value(this,this.hour_slider,"hour"),t=!!this.minute_slider&&this.control.value(this,this.minute_slider,"minute"),n=!!this.second_slider&&this.control.value(this,this.second_slider,"second"),r=!!this.millisec_slider&&this.control.value(this,this.millisec_slider,"millisec"),i=!!this.microsec_slider&&this.control.value(this,this.microsec_slider,"microsec"),a=!!this.timezone_select&&this.timezone_select.val(),o=this._defaults,c=o.pickerTimeFormat||o.timeFormat,s=o.pickerTimeSuffix||o.timeSuffix;"object"===_typeof(e)&&(e=!1),"object"===_typeof(t)&&(t=!1),"object"===_typeof(n)&&(n=!1),"object"===_typeof(r)&&(r=!1),"object"===_typeof(i)&&(i=!1),"object"===_typeof(a)&&(a=!1),!1!==e&&(e=parseInt(e,10)),!1!==t&&(t=parseInt(t,10)),!1!==n&&(n=parseInt(n,10)),!1!==r&&(r=parseInt(r,10)),!1!==i&&(i=parseInt(i,10)),!1!==a&&(a=a.toString());var u=o[e<12?"amNames":"pmNames"][0],l=e!==parseInt(this.hour,10)||t!==parseInt(this.minute,10)||n!==parseInt(this.second,10)||r!==parseInt(this.millisec,10)||i!==parseInt(this.microsec,10)||this.ampm.length>0&&e<12!=(-1!==$.inArray(this.ampm.toUpperCase(),this.amNames))||null!==this.timezone&&a!==this.timezone.toString();if(l&&(!1!==e&&(this.hour=e),!1!==t&&(this.minute=t),!1!==n&&(this.second=n),!1!==r&&(this.millisec=r),!1!==i&&(this.microsec=i),!1!==a&&(this.timezone=a),this.inst||(this.inst=$.datepicker._getInst(this.$input[0])),this._limitMinMaxDateTime(this.inst,!0)),this.support.ampm&&(this.ampm=u),this.formattedTime=$.datepicker.formatTime(o.timeFormat,this,o),this.$timeObj&&(c===o.timeFormat?this.$timeObj.val(this.formattedTime+s):this.$timeObj.val($.datepicker.formatTime(c,this,o)+s),this.$timeObj[0].setSelectionRange)){var p=this.$timeObj[0].selectionStart,f=this.$timeObj[0].selectionEnd;this.$timeObj[0].setSelectionRange(p,f)}this.timeDefined=!0,l&&this._updateDateTime()}},_onSelectHandler:function(){var e=this._defaults.onSelect||this.inst.settings.onSelect,t=this.$input?this.$input[0]:null;e&&t&&e.apply(t,[this.formattedDateTime,this])},_updateDateTime:function(e){e=this.inst||e;var t=e.currentYear>0?new Date(e.currentYear,e.currentMonth,e.currentDay):new Date(e.selectedYear,e.selectedMonth,e.selectedDay),n=$.datepicker._daylightSavingAdjust(t),r=$.datepicker._get(e,"dateFormat"),i=$.datepicker._getFormatConfig(e),a=null!==n&&this.timeDefined;this.formattedDate=$.datepicker.formatDate(r,null===n?new Date:n,i);var o=this.formattedDate;if(""===e.lastVal&&(e.currentYear=e.selectedYear,e.currentMonth=e.selectedMonth,e.currentDay=e.selectedDay),!0===this._defaults.timeOnly&&!1===this._defaults.timeOnlyShowDate?o=this.formattedTime:(!0!==this._defaults.timeOnly&&(this._defaults.alwaysSetTime||a)||!0===this._defaults.timeOnly&&!0===this._defaults.timeOnlyShowDate)&&(o+=this._defaults.separator+this.formattedTime+this._defaults.timeSuffix),this.formattedDateTime=o,this._defaults.showTimepicker)if(this.$altInput&&!1===this._defaults.timeOnly&&!0===this._defaults.altFieldTimeOnly)this.$altInput.val(this.formattedTime),this.$input.val(this.formattedDate);else if(this.$altInput){this.$input.val(o);var c="",s=null!==this._defaults.altSeparator?this._defaults.altSeparator:this._defaults.separator,u=null!==this._defaults.altTimeSuffix?this._defaults.altTimeSuffix:this._defaults.timeSuffix;this._defaults.timeOnly||(c=this._defaults.altFormat?$.datepicker.formatDate(this._defaults.altFormat,null===n?new Date:n,i):this.formattedDate,c&&(c+=s)),null!==this._defaults.altTimeFormat?c+=$.datepicker.formatTime(this._defaults.altTimeFormat,this,this._defaults)+u:c+=this.formattedTime+u,this.$altInput.val(c)}else this.$input.val(o);else this.$input.val(this.formattedDate);this.$input.trigger("change")},_onFocus:function(){if(!this.$input.val()&&this._defaults.defaultValue){this.$input.val(this._defaults.defaultValue);var e=$.datepicker._getInst(this.$input.get(0)),t=$.datepicker._get(e,"timepicker");if(t&&t._defaults.timeOnly&&e.input.val()!==e.lastVal)try{$.datepicker._updateDatepicker(e)}catch(e){$.timepicker.log(e)}}},_controls:{slider:{create:function(e,t,n,r,i,a,o){var c=e._defaults.isRTL;return t.prop("slide",null).slider({orientation:"horizontal",value:c?-1*r:r,min:c?-1*a:i,max:c?-1*i:a,step:o,slide:function(t,r){e.control.value(e,$(this),n,c?-1*r.value:r.value),e._onTimeChange()},stop:function(t,n){e._onSelectHandler()}})},options:function(e,t,n,r,i){if(e._defaults.isRTL){if("string"==typeof r)return"min"===r||"max"===r?void 0!==i?t.slider(r,-1*i):Math.abs(t.slider(r)):t.slider(r);var a=r.min,o=r.max;return r.min=r.max=null,void 0!==a&&(r.max=-1*a),void 0!==o&&(r.min=-1*o),t.slider(r)}return"string"==typeof r&&void 0!==i?t.slider(r,i):t.slider(r)},value:function(e,t,n,r){return e._defaults.isRTL?void 0!==r?t.slider("value",-1*r):Math.abs(t.slider("value")):void 0!==r?t.slider("value",r):t.slider("value")}},select:{create:function(e,t,n,r,i,a,o){for(var c='<select class="ui-timepicker-select ui-state-default ui-corner-all" data-unit="'+n+'" data-min="'+i+'" data-max="'+a+'" data-step="'+o+'">',s=e._defaults.pickerTimeFormat||e._defaults.timeFormat,u=i;u<=a;u+=o)c+='<option value="'+u+'"'+(u===r?" selected":"")+">",c+="hour"===n?$.datepicker.formatTime($.trim(s.replace(/[^ht ]/gi,"")),{hour:u},e._defaults):"millisec"===n||"microsec"===n||u>=10?u:"0"+u.toString(),c+="</option>";return c+="</select>",t.children("select").remove(),$(c).appendTo(t).change(function(t){e._onTimeChange(),e._onSelectHandler(),e._afterInject()}),t},options:function(e,t,n,r,i){var a={},o=t.children("select");if("string"==typeof r){if(void 0===i)return o.data(r);a[r]=i}else a=r;return e.control.create(e,t,o.data("unit"),o.val(),a.min>=0?a.min:o.data("min"),a.max||o.data("max"),a.step||o.data("step"))},value:function(e,t,n,r){var i=t.children("select");return void 0!==r?i.val(r):i.val()}}}}),$.fn.extend({timepicker:function(e){e=e||{};var t=Array.prototype.slice.call(arguments);return"object"===_typeof(e)&&(t[0]=$.extend(e,{timeOnly:!0})),$(this).each(function(){$.fn.datetimepicker.apply($(this),t)})},datetimepicker:function(e){e=e||{};var t=arguments;return"string"==typeof e?"getDate"===e||"option"===e&&2===t.length&&"string"==typeof t[1]?$.fn.datepicker.apply($(this[0]),t):this.each(function(){var e=$(this);e.datepicker.apply(e,t)}):this.each(function(){var t=$(this);t.datepicker($.timepicker._newInst(t,e)._defaults)})}}),$.datepicker.parseDateTime=function(e,t,n,r,i){var a=parseDateTimeInternal(e,t,n,r,i);if(a.timeObj){var o=a.timeObj;a.date.setHours(o.hour,o.minute,o.second,o.millisec),a.date.setMicroseconds(o.microsec)}return a.date},$.datepicker.parseTime=function(e,t,n){var r=extendRemove(extendRemove({},$.timepicker._defaults),n||{}),i=(e.replace(/\'.*?\'/g,"").indexOf("Z"),function(e,t,n){var r,i="^"+e.toString().replace(/([hH]{1,2}|mm?|ss?|[tT]{1,2}|[zZ]|[lc]|'.*?')/g,function(e){var t,r,i,a=e.length;switch(e.charAt(0).toLowerCase()){case"h":case"m":case"s":return 1===a?"(\\d?\\d)":"(\\d{"+a+"})";case"l":case"c":return"(\\d?\\d?\\d)";case"z":return"(z|[-+]\\d\\d:?\\d\\d|\\S+)?";case"t":return t=n.amNames,r=n.pmNames,i=[],t&&$.merge(i,t),r&&$.merge(i,r),i=$.map(i,function(e){return e.replace(/[.*+?|()\[\]{}\\]/g,"\\$&")}),"("+i.join("|")+")?";default:return"("+e.replace(/\'/g,"").replace(/(\.|\$|\^|\\|\/|\(|\)|\[|\]|\?|\+|\*)/g,function(e){return"\\"+e})+")?"}}).replace(/\s/g,"\\s?")+n.timeSuffix+"$",a=function(e){var t=e.toLowerCase().match(/(h{1,2}|m{1,2}|s{1,2}|l{1}|c{1}|t{1,2}|z|'.*?')/g),n={h:-1,m:-1,s:-1,l:-1,c:-1,t:-1,z:-1};if(t)for(var r=0;r<t.length;r++)-1===n[t[r].toString().charAt(0)]&&(n[t[r].toString().charAt(0)]=r+1);return n}(e),o="";r=t.match(new RegExp(i,"i"));var c={hour:0,minute:0,second:0,millisec:0,microsec:0};return!!r&&(-1!==a.t&&(void 0===r[a.t]||0===r[a.t].length?(o="",c.ampm=""):(o=-1!==$.inArray(r[a.t].toUpperCase(),$.map(n.amNames,function(e,t){return e.toUpperCase()}))?"AM":"PM",c.ampm=n["AM"===o?"amNames":"pmNames"][0])),-1!==a.h&&("AM"===o&&"12"===r[a.h]?c.hour=0:"PM"===o&&"12"!==r[a.h]?c.hour=parseInt(r[a.h],10)+12:c.hour=Number(r[a.h])),-1!==a.m&&(c.minute=Number(r[a.m])),-1!==a.s&&(c.second=Number(r[a.s])),-1!==a.l&&(c.millisec=Number(r[a.l])),-1!==a.c&&(c.microsec=Number(r[a.c])),-1!==a.z&&void 0!==r[a.z]&&(c.timezone=$.timepicker.timezoneOffsetNumber(r[a.z])),c)});return"function"==typeof r.parse?r.parse(e,t,r):"loose"===r.parse?function(e,t,n){try{var r=new Date("2012-01-01 "+t);if(isNaN(r.getTime())&&(r=new Date("2012-01-01T"+t),isNaN(r.getTime())&&(r=new Date("01/01/2012 "+t),isNaN(r.getTime()))))throw"Unable to parse time with native Date: "+t;return{hour:r.getHours(),minute:r.getMinutes(),second:r.getSeconds(),millisec:r.getMilliseconds(),microsec:r.getMicroseconds(),timezone:-1*r.getTimezoneOffset()}}catch(r){try{return i(e,t,n)}catch(n){$.timepicker.log("Unable to parse \ntimeString: "+t+"\ntimeFormat: "+e)}}return!1}(e,t,r):i(e,t,r)},$.datepicker.formatTime=function(e,t,n){n=n||{},n=$.extend({},$.timepicker._defaults,n),t=$.extend({hour:0,minute:0,second:0,millisec:0,microsec:0,timezone:null},t);var r=e,i=n.amNames[0],a=parseInt(t.hour,10);return a>11&&(i=n.pmNames[0]),r=r.replace(/(?:HH?|hh?|mm?|ss?|[tT]{1,2}|[zZ]|[lc]|'.*?')/g,function(e){switch(e){case"HH":return("0"+a).slice(-2);case"H":return a;case"hh":return("0"+convert24to12(a)).slice(-2);case"h":return convert24to12(a);case"mm":return("0"+t.minute).slice(-2);case"m":return t.minute;case"ss":return("0"+t.second).slice(-2);case"s":return t.second;case"l":return("00"+t.millisec).slice(-3);case"c":return("00"+t.microsec).slice(-3);case"z":return $.timepicker.timezoneOffsetString(null===t.timezone?n.timezone:t.timezone,!1);case"Z":return $.timepicker.timezoneOffsetString(null===t.timezone?n.timezone:t.timezone,!0);case"T":return i.charAt(0).toUpperCase();case"TT":return i.toUpperCase();case"t":return i.charAt(0).toLowerCase();case"tt":return i.toLowerCase();default:return e.replace(/'/g,"")}}),r},$.datepicker._base_selectDate=$.datepicker._selectDate,$.datepicker._selectDate=function(e,t){var n,r=this._getInst($(e)[0]),i=this._get(r,"timepicker");i&&r.settings.showTimepicker?(i._limitMinMaxDateTime(r,!0),n=r.inline,r.inline=r.stay_open=!0,this._base_selectDate(e,t),r.inline=n,r.stay_open=!1,this._notifyChange(r),this._updateDatepicker(r)):this._base_selectDate(e,t)},$.datepicker._base_updateDatepicker=$.datepicker._updateDatepicker,$.datepicker._updateDatepicker=function(e){var t=e.input[0];if(!($.datepicker._curInst&&$.datepicker._curInst!==e&&$.datepicker._datepickerShowing&&$.datepicker._lastInput!==t||"boolean"==typeof e.stay_open&&!1!==e.stay_open)){this._base_updateDatepicker(e);var n=this._get(e,"timepicker");n&&n._addTimePicker(e)}},$.datepicker._base_doKeyPress=$.datepicker._doKeyPress,$.datepicker._doKeyPress=function(e){var t=$.datepicker._getInst(e.target),n=$.datepicker._get(t,"timepicker");if(n&&$.datepicker._get(t,"constrainInput")){var r=n.support.ampm,i=null!==n._defaults.showTimezone?n._defaults.showTimezone:n.support.timezone,a=$.datepicker._possibleChars($.datepicker._get(t,"dateFormat")),o=n._defaults.timeFormat.toString().replace(/[hms]/g,"").replace(/TT/g,r?"APM":"").replace(/Tt/g,r?"AaPpMm":"").replace(/tT/g,r?"AaPpMm":"").replace(/T/g,r?"AP":"").replace(/tt/g,r?"apm":"").replace(/t/g,r?"ap":"")+" "+n._defaults.separator+n._defaults.timeSuffix+(i?n._defaults.timezoneList.join(""):"")+n._defaults.amNames.join("")+n._defaults.pmNames.join("")+a,c=String.fromCharCode(void 0===e.charCode?e.keyCode:e.charCode);return e.ctrlKey||c<" "||!a||o.indexOf(c)>-1}return $.datepicker._base_doKeyPress(e)},$.datepicker._base_updateAlternate=$.datepicker._updateAlternate,$.datepicker._updateAlternate=function(e){var t=this._get(e,"timepicker");if(t){var n=t._defaults.altField;if(n){t._defaults.altFormat||t._defaults.dateFormat;var r=this._getDate(e),i=$.datepicker._getFormatConfig(e),a="",o=t._defaults.altSeparator?t._defaults.altSeparator:t._defaults.separator,c=t._defaults.altTimeSuffix?t._defaults.altTimeSuffix:t._defaults.timeSuffix,s=null!==t._defaults.altTimeFormat?t._defaults.altTimeFormat:t._defaults.timeFormat;a+=$.datepicker.formatTime(s,t,t._defaults)+c,t._defaults.timeOnly||t._defaults.altFieldTimeOnly||null===r||(a=t._defaults.altFormat?$.datepicker.formatDate(t._defaults.altFormat,r,i)+o+a:t.formattedDate+o+a),$(n).val(e.input.val()?a:"")}}else $.datepicker._base_updateAlternate(e)},$.datepicker._base_doKeyUp=$.datepicker._doKeyUp,$.datepicker._doKeyUp=function(e){var t=$.datepicker._getInst(e.target),n=$.datepicker._get(t,"timepicker");if(n&&n._defaults.timeOnly&&t.input.val()!==t.lastVal)try{$.datepicker._updateDatepicker(t)}catch(e){$.timepicker.log(e)}return $.datepicker._base_doKeyUp(e)},$.datepicker._base_gotoToday=$.datepicker._gotoToday,$.datepicker._gotoToday=function(e){var t=this._getInst($(e)[0]);this._base_gotoToday(e);var n=this._get(t,"timepicker");if(n){var r=$.timepicker.timezoneOffsetNumber(n.timezone),i=new Date;i.setMinutes(i.getMinutes()+i.getTimezoneOffset()+parseInt(r,10)),this._setTime(t,i),this._setDate(t,i),n._onSelectHandler()}},$.datepicker._disableTimepickerDatepicker=function(e){var t=this._getInst(e);if(t){var n=this._get(t,"timepicker");$(e).datepicker("getDate"),n&&(t.settings.showTimepicker=!1,n._defaults.showTimepicker=!1,n._updateDateTime(t))}},$.datepicker._enableTimepickerDatepicker=function(e){var t=this._getInst(e);if(t){var n=this._get(t,"timepicker");$(e).datepicker("getDate"),n&&(t.settings.showTimepicker=!0,n._defaults.showTimepicker=!0,n._addTimePicker(t),n._updateDateTime(t))}},$.datepicker._setTime=function(e,t){var n=this._get(e,"timepicker");if(n){var r=n._defaults;n.hour=t?t.getHours():r.hour,n.minute=t?t.getMinutes():r.minute,n.second=t?t.getSeconds():r.second,n.millisec=t?t.getMilliseconds():r.millisec,n.microsec=t?t.getMicroseconds():r.microsec,n._limitMinMaxDateTime(e,!0),n._onTimeChange(),n._updateDateTime(e)}},$.datepicker._setTimeDatepicker=function(e,t,n){var r=this._getInst(e);if(r){var i,a=this._get(r,"timepicker");a&&(this._setDateFromField(r),t&&("string"==typeof t?(a._parseTime(t,n),i=new Date,i.setHours(a.hour,a.minute,a.second,a.millisec),i.setMicroseconds(a.microsec)):(i=new Date(t.getTime()),i.setMicroseconds(t.getMicroseconds())),"Invalid Date"===i.toString()&&(i=void 0),this._setTime(r,i)))}},$.datepicker._base_setDateDatepicker=$.datepicker._setDateDatepicker,$.datepicker._setDateDatepicker=function(e,t){var n=this._getInst(e),r=t;if(n){"string"==typeof t&&(r=new Date(t),r.getTime()||(this._base_setDateDatepicker.apply(this,arguments),r=$(e).datepicker("getDate")));var i,a=this._get(n,"timepicker");r instanceof Date?(i=new Date(r.getTime()),i.setMicroseconds(r.getMicroseconds())):i=r,a&&i&&(a.support.timezone||null!==a._defaults.timezone||(a.timezone=-1*i.getTimezoneOffset()),r=$.timepicker.timezoneAdjust(r,$.timepicker.timezoneOffsetString(-r.getTimezoneOffset()),a.timezone),i=$.timepicker.timezoneAdjust(i,$.timepicker.timezoneOffsetString(-i.getTimezoneOffset()),a.timezone)),this._updateDatepicker(n),this._base_setDateDatepicker.apply(this,arguments),this._setTimeDatepicker(e,i,!0)}},$.datepicker._base_getDateDatepicker=$.datepicker._getDateDatepicker,$.datepicker._getDateDatepicker=function(e,t){var n=this._getInst(e);if(n){var r=this._get(n,"timepicker");if(r){void 0===n.lastVal&&this._setDateFromField(n,t);var i=this._getDate(n),a=null;return a=r.$altInput&&r._defaults.altFieldTimeOnly?r.$input.val()+" "+r.$altInput.val():"INPUT"!==r.$input.get(0).tagName&&r.$altInput?r.$altInput.val():r.$input.val(),i&&r._parseTime(a,!n.settings.timeOnly)&&(i.setHours(r.hour,r.minute,r.second,r.millisec),i.setMicroseconds(r.microsec),null!=r.timezone&&(r.support.timezone||null!==r._defaults.timezone||(r.timezone=-1*i.getTimezoneOffset()),i=$.timepicker.timezoneAdjust(i,r.timezone,$.timepicker.timezoneOffsetString(-i.getTimezoneOffset())))),i}return this._base_getDateDatepicker(e,t)}},$.datepicker._base_parseDate=$.datepicker.parseDate,$.datepicker.parseDate=function(e,t,n){var r;try{r=this._base_parseDate(e,t,n)}catch(i){if(!(i.indexOf(":")>=0))throw i;r=this._base_parseDate(e,t.substring(0,t.length-(i.length-i.indexOf(":")-2)),n),$.timepicker.log("Error parsing the date string: "+i+"\ndate string = "+t+"\ndate format = "+e)}return r},$.datepicker._base_formatDate=$.datepicker._formatDate,$.datepicker._formatDate=function(e,t,n,r){var i=this._get(e,"timepicker");return i?(i._updateDateTime(e),i.$input.val()):this._base_formatDate(e)},$.datepicker._base_optionDatepicker=$.datepicker._optionDatepicker,$.datepicker._optionDatepicker=function(e,t,n){var r,i=this._getInst(e);if(!i)return null;var a=this._get(i,"timepicker");if(a){var o,c,s,u,l=null,p=null,f=null,h=a._defaults.evnts,d={};if("string"==typeof t){if("minDate"===t||"minDateTime"===t)l=n;else if("maxDate"===t||"maxDateTime"===t)p=n;else if("onSelect"===t)f=n;else if(h.hasOwnProperty(t)){if(void 0===n)return h[t];d[t]=n,r={}}}else if("object"===_typeof(t))for(o in t.minDate?l=t.minDate:t.minDateTime?l=t.minDateTime:t.maxDate?p=t.maxDate:t.maxDateTime&&(p=t.maxDateTime),h)h.hasOwnProperty(o)&&t[o]&&(d[o]=t[o]);for(o in d)d.hasOwnProperty(o)&&(h[o]=d[o],r||(r=$.extend({},t)),delete r[o]);if(r&&isEmptyObject(r))return;if(l?(l=0===l?new Date:new Date(l),a._defaults.minDate=l,a._defaults.minDateTime=l):p?(p=0===p?new Date:new Date(p),a._defaults.maxDate=p,a._defaults.maxDateTime=p):f&&(a._defaults.onSelect=f),l||p)return u=$(e),s=u.datetimepicker("getDate"),c=this._base_optionDatepicker.call($.datepicker,e,r||t,n),u.datetimepicker("setDate",s),c}return void 0===n?this._base_optionDatepicker.call($.datepicker,e,t):this._base_optionDatepicker.call($.datepicker,e,r||t,n)};var isEmptyObject=function(e){var t;for(t in e)if(e.hasOwnProperty(t))return!1;return!0},extendRemove=function(e,t){for(var n in $.extend(e,t),t)null!==t[n]&&void 0!==t[n]||(e[n]=t[n]);return e},detectSupport=function(e){var t=e.replace(/'.*?'/g,"").toLowerCase(),n=function(e,t){return-1!==e.indexOf(t)};return{hour:n(t,"h"),minute:n(t,"m"),second:n(t,"s"),millisec:n(t,"l"),microsec:n(t,"c"),timezone:n(t,"z"),ampm:n(t,"t")&&n(e,"h"),iso8601:n(e,"Z")}},convert24to12=function(e){return e%=12,0===e&&(e=12),String(e)},computeEffectiveSetting=function(e,t){return e&&e[t]?e[t]:$.timepicker._defaults[t]},splitDateTime=function(e,t){var n=computeEffectiveSetting(t,"separator"),r=computeEffectiveSetting(t,"timeFormat"),i=r.split(n),a=i.length,o=e.split(n),c=o.length;return c>1?{dateString:o.splice(0,c-a).join(n),timeString:o.splice(0,a).join(n)}:{dateString:e,timeString:""}},parseDateTimeInternal=function(e,t,n,r,i){var a,o,c;if(o=splitDateTime(n,i),a=$.datepicker._base_parseDate(e,o.dateString,r),""===o.timeString)return{date:a};if(c=$.datepicker.parseTime(t,o.timeString,i),!c)throw"Wrong time format";return{date:a,timeObj:c}},selectLocalTimezone=function(e,t){if(e&&e.timezone_select){var n=t||new Date;e.timezone_select.val(-n.getTimezoneOffset())}};$.timepicker=new Timepicker,$.timepicker.timezoneOffsetString=function(e,t){if(isNaN(e)||e>840||e<-720)return e;var n=e,r=n%60,i=(n-r)/60,a=t?":":"",o=(n>=0?"+":"-")+("0"+Math.abs(i)).slice(-2)+a+("0"+Math.abs(r)).slice(-2);return"+00:00"===o?"Z":o},$.timepicker.timezoneOffsetNumber=function(e){var t=e.toString().replace(":","");return"Z"===t.toUpperCase()?0:/^(\-|\+)\d{4}$/.test(t)?("-"===t.substr(0,1)?-1:1)*(60*parseInt(t.substr(1,2),10)+parseInt(t.substr(3,2),10)):parseInt(e,10)},$.timepicker.timezoneAdjust=function(e,t,n){var r=$.timepicker.timezoneOffsetNumber(t),i=$.timepicker.timezoneOffsetNumber(n);return isNaN(i)||e.setMinutes(e.getMinutes()+-r- -i),e},$.timepicker.timeRange=function(e,t,n){return $.timepicker.handleRange("timepicker",e,t,n)},$.timepicker.datetimeRange=function(e,t,n){$.timepicker.handleRange("datetimepicker",e,t,n)},$.timepicker.dateRange=function(e,t,n){$.timepicker.handleRange("datepicker",e,t,n)},$.timepicker.handleRange=function(e,t,n,r){r=$.extend({},{minInterval:0,maxInterval:0,start:{},end:{}},r);var i=!1;function a(i,a){var o=t[e]("getDate"),c=n[e]("getDate"),s=i[e]("getDate");if(null!==o){var u=new Date(o.getTime()),l=new Date(o.getTime());u.setMilliseconds(u.getMilliseconds()+r.minInterval),l.setMilliseconds(l.getMilliseconds()+r.maxInterval),r.minInterval>0&&u>c?n[e]("setDate",u):r.maxInterval>0&&l<c?n[e]("setDate",l):o>c&&a[e]("setDate",s)}}function o(t,n,i){if(t.val()){var a=t[e].call(t,"getDate");null!==a&&r.minInterval>0&&("minDate"===i&&a.setMilliseconds(a.getMilliseconds()+r.minInterval),"maxDate"===i&&a.setMilliseconds(a.getMilliseconds()-r.minInterval)),a.getTime&&n[e].call(n,"option",i,a)}}return"timepicker"===e&&(i=!0,e="datetimepicker"),$.fn[e].call(t,$.extend({timeOnly:i,onClose:function(e,t){a($(this),n)},onSelect:function(e){o($(this),n,"minDate")}},r,r.start)),$.fn[e].call(n,$.extend({timeOnly:i,onClose:function(e,n){a($(this),t)},onSelect:function(e){o($(this),t,"maxDate")}},r,r.end)),a(t,n),o(t,n,"minDate"),o(n,t,"maxDate"),$([t.get(0),n.get(0)])},$.timepicker.log=function(){window.console&&window.console.log&&window.console.log.apply&&window.console.log.apply(window.console,Array.prototype.slice.call(arguments))},$.timepicker._util={_extendRemove:extendRemove,_isEmptyObject:isEmptyObject,_convert24to12:convert24to12,_detectSupport:detectSupport,_selectLocalTimezone:selectLocalTimezone,_computeEffectiveSetting:computeEffectiveSetting,_splitDateTime:splitDateTime,_parseDateTimeInternal:parseDateTimeInternal},Date.prototype.getMicroseconds||(Date.prototype.microseconds=0,Date.prototype.getMicroseconds=function(){return this.microseconds},Date.prototype.setMicroseconds=function(e){return this.setMilliseconds(this.getMilliseconds()+Math.floor(e/1e3)),this.microseconds=e%1e3,this}),$.timepicker.version="1.6.3"}},__WEBPACK_AMD_DEFINE_RESULT__="function"==typeof __WEBPACK_AMD_DEFINE_FACTORY__?__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__):__WEBPACK_AMD_DEFINE_FACTORY__,void 0===__WEBPACK_AMD_DEFINE_RESULT__||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)},656:function(e,t,n){},657:function(e,t,n){},658:function(e,t,n){},659:function(e,t,n){},660:function(e,t){e.exports='<svg class="ArchivePane__playPause-icon" style="enable-background:new 0 0 41 41;"><ellipse class="ArchivePane__playPause-icon-line" cx="20.5" cy="20.5" rx="20.5" ry="20.5"></ellipse><g><linearGradient gradientUnits="userSpaceOnUse" x1="20.5" y1="1.5" x2="20.5" y2="39.5"><stop offset="0" style="stop-color:#D9D9D9"></stop><stop offset="1" style="stop-color:#B6B6B6"></stop></linearGradient><circle class="ArchivePane__playPause-icon-circle" cx="20.5" cy="20.5" r="19"></circle><path class="ArchivePane__playPause-icon-inner" d="M20.5,2C30.7,2,39,10.3,39,20.5S30.7,39,20.5,39S2,30.7,2,20.5S10.3,2,20.5,2 M20.5,1C9.7,1,1,9.7,1,20.5 S9.7,40,20.5,40S40,31.3,40,20.5S31.3,1,20.5,1L20.5,1z"></path></g><rect x="22.2" y="13" class="ArchivePane__playPause-icon-line" width="4" height="15"></rect><rect x="14.2" y="13" class="ArchivePane__playPause-icon-line" width="4" height="15"></rect></svg>'},661:function(e,t){e.exports='<svg class="ArchivePane__playPause-icon" style="enable-background:new 0 0 41 41;"><ellipse class="ArchivePane__playPause-icon-line" cx="20.5" cy="20.5" rx="20.5" ry="20.5"></ellipse><g><linearGradient gradientUnits="userSpaceOnUse" x1="20.5" y1="1.5" x2="20.5" y2="39.5"><stop offset="0" style="stop-color:#D9D9D9"></stop><stop offset="1" style="stop-color:#B6B6B6"></stop></linearGradient><circle class="ArchivePane__playPause-icon-circle" cx="20.5" cy="20.5" r="19"></circle><path class="ArchivePane__playPause-icon-inner" d="M20.5,2C30.7,2,39,10.3,39,20.5S30.7,39,20.5,39S2,30.7,2,20.5S10.3,2,20.5,2 M20.5,1C9.7,1,1,9.7,1,20.5 S9.7,40,20.5,40S40,31.3,40,20.5S31.3,1,20.5,1L20.5,1z"></path></g><polygon class="ArchivePane__playPause-icon-line" points="27.5,20.1 16.2,27.5 16.2,12.8 "></polygon></svg>'},662:function(e,t,n){},663:function(e,t,n){},666:function(e,t,n){},667:function(e,t,n){},668:function(e,t){},669:function(e,t,n){},67:function(e,t,n){"use strict";var r=n(103),i=n.n(r),a=n(6),o=n.n(a),c=n(3),s=n.n(c),u=n(24),l=n.n(u),p=n(7),f=n.n(p),h=n(34),d=n.n(h),m=n(11),b=n(4),v=n(27),y=n(73),g=n(168),O=n.n(g),w=n(46),j=n.n(w),_=n(42),E=n.n(_),A=n(21),S=n.n(A),x=n(162),k=n.n(x),P=n(133),C=n.n(P),T=n(122),M=n(128),D=n.n(M),I=n(68),R=n.n(I),L=n(288),N=n.n(L),z=n(5),F=n(13),$=o()([f()(o()(z.l,D()("getTime"))),N()(E.a),R()(E.a)]);var H=function(){var e=[],t=-1/0;this.init=function(n){e=$(n),t=-1/0},this.step=function(n,r){return e.length?(Number.isFinite(t)?t+=n:t=Object(F.e)(r,e),e[t]):null},this.next=this.step.bind(null,this.FORWARD),this.prev=this.step.bind(null,this.BACKWARD),this.clear=function(){e=[],t=-1/0},this.current=function(){return e[t]}},B=n(37);function Y(e){return Y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Y(e)}function U(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,c=e[Symbol.iterator]();!(r=(o=c.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(i)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function V(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function W(e){return W=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},W(e)}function q(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function G(e,t){return G=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},G(e,t)}function X(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Z=s()("storage"),K=s()("accessPoint"),Q="archive",J=n(40),ee=n.n(J),te=n(72),ne=n.n(te),re=n(71),ie=n.n(re),ae=n(181),oe=n.n(ae),ce=n(289),se=n.n(ce),ue=n(33),le=n.n(ue),pe=n(9),fe=n(30),he=n.n(fe);function de(e){return de="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},de(e)}function me(e,t){return!t||"object"!==de(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function be(e){return be=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},be(e)}function ve(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ye(e,t)}function ye(e,t){return ye=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},ye(e,t)}function ge(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Oe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function we(e,t,n){return t&&Oe(e.prototype,t),n&&Oe(e,n),e}var je=.67,_e="ptzSession",Ee=function(){function e(t){ge(this,e),this.ctx=t,this.ctx.state=this}return we(e,[{key:"init",value:function(){return this}},{key:"failed",value:function(){return this}},{key:"acquired",value:function(){return this}},{key:"release",value:function(){return new Te(this.ctx)}}]),e}(),Ae=function(e){function t(){return ge(this,t),me(this,be(t).apply(this,arguments))}return ve(t,e),we(t,[{key:"init",value:function(){return new Se(this.ctx)}}]),t}(Ee),Se=function(e){function t(e){var n;ge(this,t),n=me(this,be(t).call(this,e));var r=Object(F.b)(_e);return r?(b.a.camptz("session %c%s (%o)","font-weight: bold","Reusing",r),me(n,new Pe(n.ctx))):me(n,new xe(n.ctx))}return ve(t,e),t}(Ee),xe=function(e){function t(e){var n;return ge(this,t),n=me(this,be(t).call(this,e)),n.ctx.acquireId=null,b.a.camptz("session %c%s","font-weight: bold","Request"),m.z({tcid:e.tcid}).then(function(e){var t=e.data.session_id;b.a.camptz("session %c%s (%o)","font-weight: bold","Acquired",t),Object(F.b)(_e,t,pe.a.settings.ptzKeepaliveInterval)},function(){return n.ctx.state.failed()}).then(function(){return n.ctx.state.acquired()}),n}return ve(t,e),we(t,[{key:"failed",value:function(){return new ke(this.ctx)}},{key:"acquired",value:function(){return document.hidden?new ke(this.ctx):new Pe(this.ctx)}}]),t}(Ee),ke=function(e){function t(e){var n;ge(this,t),n=me(this,be(t).call(this,e)),b.a.camptz("session %c%s","font-weight: bold","Failed to acquire.");var r=n.ctx.topic;return r(r.key.PTZ_READY).put(!1),n.ctx.acquireId=setTimeout(function(){return new xe(n.ctx)},pe.a.settings.ptzKeepaliveInterval),n}return ve(t,e),t}(Ee),Pe=function(e){function t(e){var n;ge(this,t),n=me(this,be(t).call(this,e));var r=n.ctx.topic;return r(r.key.PTZ_READY).put(!0),he()(window).on({"blur.ptz":function(){he()(window).one({focus:function(){return new Se(n.ctx)}}),new Te(n.ctx)}}),function(){Me(this),this.keepId=setInterval(Me,pe.a.settings.ptzKeepaliveInterval*je,this)}.call(n.ctx),n}return ve(t,e),t}(Ee),Ce=function(e){function t(e){var n;return ge(this,t),n=me(this,be(t).call(this,e)),b.a.camptz("session %c%s","font-weight: bold, color: red","Lost"),De.call(n.ctx),new xe(n.ctx),n}return ve(t,e),t}(Ee),Te=function(e){function t(e){var n;ge(this,t),n=me(this,be(t).call(this,e));var r=n.ctx.topic;return r(r.key.PTZ_READY).put(!1),b.a.camptz("session %c%s (%o)","font-weight: bold","Release",Object(F.b)(_e)),he()(window).off("blur.ptz"),De.call(n.ctx),function(){clearTimeout(this.acquireId)}.call(n.ctx),n}return ve(t,e),we(t,[{key:"init",value:function(){return new Se(this.ctx)}}]),t}(Ee);function Me(e){var t=Object(F.b)(_e);m.F({tcid:e.tcid,session_id:t}).then(function(){return Object(F.b)(_e,t,pe.a.settings.ptzKeepaliveInterval)},function(){return new Ce(e)})}function De(){this.keepId&&(clearInterval(this.keepId),this.keepId=void 0,Object(F.b)(_e,null))}var Ie=function(){function e(t,n){ge(this,e),this.ctx={tcid:t,topic:n,acquireId:null,keepId:null},this.ctx.state=new Ae(this.ctx)}return we(e,[{key:"init",value:function(){this.ctx.state.init()}},{key:"release",value:function(){this.ctx.state.release()}}]),e}();function Re(e){return Re="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Re(e)}function Le(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ne(e,t){return!t||"object"!==Re(t)&&"function"!=typeof t?Fe(e):t}function ze(e){return ze=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ze(e)}function Fe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $e(e,t){return $e=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},$e(e,t)}function He(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Be=5,Ye=ee()(1,10),Ue=f()(function(e){return Number(e.id)}),Ve=k()(E.a),We=Object(F.n)(1),qe=ee()(0,1),Ge=function(e){return e?function(e){return Math.pow(1.5,e-15.7)}:se()(.1)},Xe={pan:0,tilt:0,zoom:0},Ze="absolute",Ke="continuous",Qe=S()(Ze),Je=ne()([[s()("isContinous"),ie()(Ke)],[s()("isAbsolute"),ie()(Ze)]]);function et(e){b.a.camptz("error",e)}function tt(e){return tt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},tt(e)}function nt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function rt(e){return rt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},rt(e)}function it(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function at(e,t){return at=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},at(e,t)}function ot(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ct(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var st=d.a.convert({cap:!1}),ut="initial",lt=l()({});function pt(e,t){return 0!==e.streamType&&e.width*e.height<t.width*t.height}var ft=o()(function(e){var t;return t=function(e){function t(e){var n,r,i;return ot(this,t),r=this,i=rt(t).call(this,e),n=!i||"object"!==tt(i)&&"function"!=typeof i?it(r):i,ct(it(n),"online",void 0),ct(it(n),"isReady",void 0),n.initLive=n.initLive.bind(it(n)),n.streams=n.localTopic("streams"),n.streamActive=n.localTopic("streamActive"),n.state=n.localTopic("state").assign(ct({},ut,"")),n.desc.isActivated?n.getStreamsMeta():n.setDefaultStreams(),n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&at(e,t)}(t,e),n=t,r=[{key:"setDefaultStreams",value:function(){var e=this.desc.videoStreams,t=Object(v.d)(e);this.streamsPromise=Promise.resolve(t),this.streamsPromise.then(this.initLive)}},{key:"getStreamsMeta",value:function(){var e=this.desc,t=e.dev,n=e.videoStreams,r=Object(y.b)(),i=r.promise,a=r.resolve;return b.a.cam("%s has %o streams",t,n.length),this.isReady=i,this.state.assign(ct({},"streams",-1)),this.fetchStreamStats().then(a),this.isReady}},{key:"fetchStreamStats",value:function(){var e=this.desc.videoStreams;return this.streamsPromise=m.b(f()(s()(["accessPoint"]),e)).then(v.n),this.streamsPromise.then(this.initLive)}},{key:"initLive",value:function(e){return this.streams.put(e),this.resetLiveStream(),this.state.assign(ct({},"streams",e.length)),this.desc.isActivated}},{key:"getStream",value:function(e){return lt(e,this.streams.get())}},{key:"setSource",value:function(e){this.playSourceIdx=e,this.streamActive.put(e),b.a.cam("Select stream",e,this.sourceInfo)}},{key:"getStreamIdx",value:function(e){return i()(function(t){var n=t.accessPoint;return e===n})(this.streams.get())}},{key:"getStreamBy",value:function(e){return st(function(t,n,r,i){return e(n,i[t])?r:t})(0)(this.streams.get())}},{key:"resetLiveStream",value:function(){var e=pt,t=this.topic(this.topic.key.PREFS).get(),n=t.defaultStream;if(s()(n,this.streams.get()))return b.a.pref("Setting %cuser%c stream","font-weight: bold","font-weight: normal"),void this.streamActive.put(n);b.a.cam("Setting %clowest resolution%c stream","font-weight: bold","font-weight: normal"),this.streamActive.put(this.getStreamBy(e))}},{key:"stream",get:function(){var e=this.streamActive.get();return this.getStream(e)}},{key:"activeSource",get:function(){var e=this.streamActive.get();return s()([e,"accessPoint"],this.streams.get())}},{key:"isOnline",get:function(){var e=this.topic(this.topic.key.CAM_STATES).get(),t=s()(this.origin,e);return t}},{key:"dev",get:function(){return this.desc.dev}},{key:"origin",get:function(){return this.desc.origin}},{key:"id",get:function(){return this.desc.id}},{key:"name",get:function(){return this.desc.displayName}},{key:"fullname",get:function(){return"".concat(this.id," ").concat(this.name)}},{key:"isLive",get:function(){return this!==this.topic(this.topic.key.CAM_ARCH).get()}},{key:"detectors",get:function(){return this.desc.detectors}},{key:"channel",get:function(){return this.desc.channel}}],r&&nt(n.prototype,r),a&&nt(n,a),t}(e),t},function(e){var t;return t=function(e){function t(e){var n,r,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,i=W(t).call(this,e),n=!i||"object"!==Y(i)&&"function"!=typeof i?q(r):i,X(q(n),"archPromise",void 0),X(q(n),"checkArchExists",function(){return n.state.assign(X({},Q,-1)),Object(F.q)(n.archList.map(function(e){return m.j({vsid:e.accessPoint,archive:e.storage,limit:1}).then(function(e){var t=e.data.intervals;return t.length>0},function(){return Promise.resolve(!1)})})).then(k()(E.a)).then(C()(function(e){return n.state.assign(X({},Q,e))}))}),n.archTime=n.localTopic("archTime"),n.archSelected=n.localTopic("archSelected"),n.frames=new H,n.framesReset=function(e){e.getTime()!==n.frames.current()&&(n.frames.clear(),n.archTime.unobserve(n.framesReset))},n.archive=[],n.events={},n.xhr={},n.archiveCache={},n.archHash=function(){return"".concat(n.activeSource).concat(n.archSelectedStorage)},n.fetchIntervals=new T.a(m.j,"intervals"),n.archClear=function(){n.archive=[],n.events={alerts:[],detectors:[]}},n.getIntervals=function(e){return n.fetchIntervals(e).then(B.h).then(C()(function(e){n.archive=e}))},n.getArchiveDays=function(e,t){var r=new Date(Date.UTC(e,t-1,1)),i=new Date(Date.UTC(e,t,0,23,59,59,999));return n.fetchIntervals({scale:z.b,begintime:r,endtime:i}).then(B.h).then(B.b)},n.fetchDetectors=new T.a(m.o,"detectors"),n.fetchAlerts=new T.a(m.o,"alerts"),n.getDetectors=function(e){return n.fetchDetectors(e).then(B.g).then(C()(function(e){n.events.detectors=e}))},n.getAlerts=function(e){return n.fetchAlerts(e).then(B.f).then(C()(function(e){n.events.alerts=e}))},n.currentTimestamp="",n.uuid="",n.archiveIndex=0,n.frameIndex=0,n.speed=1,n.FORWARD=1,n.BACKWARD=-1,n.stepForward=n.stepFrame.bind(q(n),n.FORWARD),n.stepBack=n.stepFrame.bind(q(n),n.BACKWARD),n.nextInterval=n.stepInterval.bind(q(n),n.FORWARD),n.prevInterval=n.stepInterval.bind(q(n),n.BACKWARD),n.archPromise=n.checkArchExists(),n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&G(e,t)}(t,e),n=t,r=[{key:"getArchIdx",value:function(e){return i()(function(t){return S()(t,e)})(this.archList)}},{key:"updateArch",value:function(e){var t=U(e,3),n=t[0],r=t[1],i=t[2];return this.archiveIndex=n.length,this.archive=B.h(n),this.events={detectors:B.g(r),alerts:B.f(i)},Promise.all([this.archive,this.events])}},{key:"getArchEnd",value:function(){return this.fetchIntervals({begintime:"past",endtime:"future",scale:z.b,limit:1}).then(function(e){return B.e(B.h(e))})}},{key:"getArchiveContent",value:function(e,t){var n=this;b.a.deprecated();var r={begintime:e,endtime:t};return this.fetchIntervals(r).then(function(e){return Promise.all([e,n.fetchDetectors(r),n.fetchAlerts(r)])}).then(this.updateArch.bind(this))}},{key:"getArchiveList",value:function(){var e=this;b.a.deprecated();var t=this.streams.getPromise(),n=s()(["data","archives"]);return t.then(function(e){return Promise.all(e.map(function(e){var t=e.source;return m.l({vsid:t})}))}).then(function(e){return e.map(n)}).then(function(t){return e.archStreamsList.put(t),t})}},{key:"initArchive",value:function(){this.setArchSelected(this.archiveDesc)}},{key:"setArchSelectedByIdx",value:function(e){var t=s()(e,this.archList);this.setArchSelected(t)}},{key:"setArchSelectedByStorage",value:function(e){var t=O()(function(e){return o()([s()("storage"),S()(e)])}(e),this.archList);this.setArchSelected(t)}},{key:"setArchSelected",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.defaultArch,t=this.getStreamIdx(e.accessPoint);this.streamActive.put(t),this.archSelected.put(e)}},{key:"dateChange",value:function(e){this.archExist&&this.setDate(e,!0)}},{key:"getArchiveByDate",value:function(e){var t=new Date(e),n=new Date(e);return t.setHours(0,0,0,0),n.setHours(23,59,59,999),this.getArchiveContent(t,n)}},{key:"stepFrame",value:function(e){var t=this,n=this.topic(this.topic.key.ARCH_TIME).get().valueOf(),r=this.frames.step(e,n);if(r){var i=new Date(r);this.topic(this.topic.key.ARCH_TIME).put(i),this.topic(this.topic.key.PLAYBACK).assign({beginTime:i,speed:0}),this.archTime.observe(this.framesReset)}else m.k({vsid:this.activeSource,direction:e,timestamp:new Date(n),limit:10,archive:this.archSelectedStorage}).then(function(n){var r=n.data.frames;t.frames.init(r),t.stepFrame(e)})}},{key:"getIntervalIndex",value:function(e){return i()(function(t){return t.date.begin<=e&&t.date.end>=e})(this.archive)}},{key:"stepInterval",value:function(e){var t,n=this.topic(this.topic.key.ARCH_TIME).get().getTime(),r=this.getIntervalIndex(n),i=r+e,a=this.archive.length-1;if(i>=0&&i<=a)t=this.archive[i].date.begin;else switch(e){case this.FORWARD:t=this.archive[a].date.end;break;case this.BACKWARD:t=this.archive[0].date.begin}this.frames.clear(),this.topic(this.topic.key.ARCH_TIME).put(t),this.topic(this.topic.key.PLAYBACK).assign({beginTime:t,speed:0})}},{key:"archList",get:function(){return this.desc.archives}},{key:"archSelectedStorage",get:function(){return Z(this.archiveDesc)}},{key:"archSelectedAccessPoint",get:function(){return K(this.archiveDesc)}},{key:"archiveDesc",get:function(){var e=this.archSelected.get();return e}},{key:"defaultArch",get:function(){var e=this.archList,t=O()(function(e){return!e.isEmbedded}),n=t(e)||j()(e)||{};return b.a.arch("default","\narch:",n.storage,"\nstream:",n.accessPoint),n}}],r&&V(n.prototype,r),a&&V(n,a),t}(e),t},function(e){var t;return t=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=Ne(this,ze(t).call(this,e)),He(Fe(n),"ABSOLUTE",Ze),He(Fe(n),"CONTINUOUS",Ke),He(Fe(n),"mode",{}),He(Fe(n),"move",le.a),He(Fe(n),"zoom",le.a),He(Fe(n),"areaZoom",le.a),He(Fe(n),"focusAuto",le.a),He(Fe(n),"pointMove",le.a),He(Fe(n),"ptzPos",void 0),He(Fe(n),"savePosition",function(e){var t=e.data;return n.ptzPos=t,b.a.camptz("pan %o; tilt %o; zoom %o",t.pan,t.tilt,t.zoom),t}),He(Fe(n),"getPosition",function(){return m.x(n.tcid).then(n.savePosition)}),He(Fe(n),"makeMove",function(e){var t=Qe(e)?n.getPosition:ie()(Xe),r=Ge(Qe(e)),i=Qe(e)?We:E.a,a=Qe(e)?qe:E.a;return function(o){var c=o.pan,s=void 0===c?0:c,u=o.tilt,l=void 0===u?0:u;return Promise.resolve(t()).then(function(t){var o=t.pan,c=t.tilt,u=Fe(n),p=u.tcid,f=u.ptzSpeed,h=r(f),d=i(s*h+o),v=a(l*h+c);return b.a.camptz("move ".concat(e,": pan ").concat(o," ").concat(d,", tilt ").concat(c," ").concat(v)),m.O({tcid:p,mode:e,pan:d,tilt:v,session_id:Object(F.b)(_e)}).catch(et)})}}),He(Fe(n),"makeZoom",function(e){var t=Qe(e)?n.getPosition:ie()(Xe),r=Ge(Qe(e)),i=Qe(e)?qe:E.a;return function(a){return Promise.resolve(t()).then(function(t){var o=t.zoom,c=Fe(n),s=c.tcid,u=c.ptzSpeed,l=r(u),p=i(a*l+o);return b.a.camptz("move ".concat(e,": zoom ").concat(o," ").concat(p)),m.Q({tcid:s,mode:e,zoom:p,session_id:Object(F.b)(_e)}).catch(et)})}}),n.ptzMgr=new Ie(n.tcid,n.topic),s()(["is_active"],n.ptz)?(n.ptzExist=!0,n.ptzSpeedT=n.localTopic("ptzSpeed").put(Be),n.ptzPresets=n.localTopic("ptzPresets"),n.mode.move=Je(n.ptz.move),n.move=n.makeMove(n.mode.move),n.mode.zoom=Je(n.ptz.zoom),n.zoom=n.makeZoom(n.mode.zoom),n.ptz.pointMove&&(n.pointMove=n.oPointMove),n.ptz.areaZoom&&(n.areaZoom=n.oAreaZoom),n.ptz.autoFocus&&(n.focusAuto=n.oFocusAuto),b.a.camptz("move %o; zoom %o",n.ptz.move,n.ptz.zoom),Ve(n.isAbsolute)&&n.getPosition(),n):Ne(n)}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$e(e,t)}(t,e),n=t,r=[{key:"releasePtz",value:function(){this.ptzMgr.release()}},{key:"initPtz",value:function(){this.ptzMgr.init(),this.getPresets()}},{key:"getPresets",value:function(){var e=this,t=this.desc.ptzs.map(function(e){var t=e.accessPoint;return m.y(t).then(o()([s()("data"),Object(F.k)(t)])).catch(et)});return Promise.all(t).then(oe.a).then(function(t){return e.presetsLastId=Math.max.apply(null,Ue(t))||1,t}).then(function(t){return e.ptzPresets.put(t)}).catch(et)}},{key:"setPreset",value:function(e){var t=e.pos,n=void 0===t?this.presetsLastId+=1:t,r=e.label,i=this.tcid;return m.P({tcid:i,pos:n,label:r,session_id:Object(F.b)(_e)}).then(this.getPresets).catch(et)}},{key:"goPreset",value:function(e){var t=this.ptzPresets.get()[e].tcid;return m.C({tcid:t,pos:e,session_id:Object(F.b)(_e)}).catch(et)}},{key:"removePreset",value:function(e){var t=this.ptzPresets.get()[e].tcid;return m.M({tcid:t,pos:e,session_id:Object(F.b)(_e)}).then(this.getPresets).catch(et)}},{key:"oPointMove",value:function(e){var t=e.x,n=e.y,r=this.tcid;return m.J({tcid:r,x:t,y:n,session_id:Object(F.b)(_e)}).catch(et)}},{key:"oAreaZoom",value:function(e){var t=e.x,n=e.y,r=e.w,i=e.h,a=this.tcid;return m.a({tcid:a,x:t,y:n,w:r,h:i,session_id:Object(F.b)(_e)}).catch(et)}},{key:"oFocusAuto",value:function(){var e=this.tcid;return m.N({tcid:e,degree:"focus",session_id:Object(F.b)(_e)}).catch(et)}},{key:"ptz",get:function(){return Object(v.i)(this.desc)}},{key:"tcid",get:function(){return Object(v.j)(this.desc)}},{key:"ptzSpeed",get:function(){return this.ptzSpeedT.get()},set:function(e){this.ptzSpeedT.put(Ye(e))}}],r&&Le(n.prototype,r),i&&Le(n,i),t}(e),t})(function e(t){var n=this;ot(this,e),ct(this,"desc",void 0),ct(this,"localTopic",void 0),b.a.cam(t),this.desc=t,this.localTopic=function(e){return n.topic("_".concat(t.channel,"::").concat(e))}});t.a=ft},670:function(e,t,n){},671:function(e,t,n){},672:function(e,t,n){},673:function(e,t,n){},674:function(e,t,n){},675:function(e,t,n){},73:function(e,t,n){"use strict";function r(){var e,t;return{promise:new Promise(function(n,r){e=n,t=r}),resolve:e,reject:t}}function i(e){var t=this;function n(e){return e}function r(e){return"function"==typeof e?e:n}var a=n,o=n;function c(e){a=r(e)}var s=new Promise(function(t,n){e(t,n,c),o=r(n)});function u(e,t,n){var o,c=r(e),u=r(t),l=(o=n,"function"==typeof o?o:null);return new i(function(e,t,n){s.catch(l).then(c,u).then(e,t),n(a)})}s.catch(n),this.then=function(e,t){return u(e,t)},this.catch=function(e){return u(void 0,void 0,e)},this.abort=function(e){return a(e),o(e),t}}n.d(t,"b",function(){return r}),n.d(t,"a",function(){return i})},858:function(e,t,n){"use strict";n.d(t,"a",function(){return S});var r=n(1),i=n(859),a=n(6),o=n.n(a),c=n(181),s=n.n(c),u=n(144),l=n.n(u),p=n(32),f=n.n(p),h=n(7),d=n.n(h),m=n(156),b=n.n(m),v=n(33),y=n.n(v),g=n(3),O=n.n(g),w=n(224),j=n.n(w);n(353),n(15),n(67),n(59),n(27),n(13),n(4);var _=l()(function(e){return e.abort()}),E=O()(["camera","streamsPromise"]),A=b()(j.a);o()([d()(E),s.a,f()(A),_]),d()(O()("pending"));function S(e){var t=e.text;i.a(t).catch(y.a),r.a.app.notify({text:t})}},9:function(e,t,n){"use strict";var r={zoomSteps:8,zoomMin:1,zoomMax:8,hashTime:1e4,pollInterval:3e3,refreshInterval:3e4,ptzKeepaliveInterval:5e3,animationTime:250,maxScaleHeight:1e5,slideWindowMessage:!1,prefix:!1,frameWidthList:[360,480,720,960],errorThreshold:3,zoom:3,zoomScaleStep:1.2,mjpegCompression:3,previewTimeout:5e3,prefsDefault:{archFastMjpeg:!1,disconnectInactive:!0,defaultStream:-1,defaultLayout:-1,favorites:[],searchAutoScroll:!1,noKeyFrames:!1,pinned:!0,searchDefaultInterval:1e4},searchHistory:5,alertFrameWidth:320,scaleTags:[{min:-1/0,max:1e3,tags:[{step:144e5,width:20,xbase:63,lineWidth:1,color:"#000",textOut:!0,font:"500 14px Arial",textBaseline:"bottom",textColor:"#000",padding:25,format:function(e){return"".concat(4*e/this.step,":00")}},{step:72e5,width:15,xbase:63,lineWidth:1,color:"#333",textOut:!1,font:"500 14px Arial",textBaseline:"bottom",textColor:"#111",padding:25,format:function(e){return"".concat(e/this.step,":00")}},{step:18e5,width:7,xbase:63,lineWidth:1,color:"#333",textOut:!1,font:"500 14px Arial",textBaseline:"bottom",textColor:"#111",padding:25,format:function(e){return"".concat(e/this.step,":00")}}]},{min:1e3,max:2e3,tags:[{step:72e5,width:20,xbase:63,lineWidth:1,color:"#000",textOut:!0,font:"500 14px Arial",textBaseline:"bottom",textColor:"#000",padding:25,format:function(e){return"".concat(2*e/this.step,":00")}},{step:36e5,width:15,xbase:63,lineWidth:1,color:"#333",textOut:!1,font:"500 14px Arial",textBaseline:"bottom",textColor:"#111",padding:25,format:function(e){return"".concat(e/this.step,":00")}},{step:18e5,width:7,xbase:63,lineWidth:1,color:"#333",textOut:!1,font:"500 14px Arial",textBaseline:"bottom",textColor:"#111",padding:25,format:function(e){return"".concat(e/this.step,":00")}}]},{min:2e3,max:3e3,tags:[{step:36e5,width:20,xbase:63,lineWidth:1,color:"#000",textOut:!0,font:"500 14px Arial",textBaseline:"bottom",textColor:"#000",padding:25,format:function(e){return"".concat(1*e/this.step,":00")}},{step:18e5,width:15,xbase:63,lineWidth:1,color:"#333",textOut:!1,font:"500 14px Arial",textBaseline:"bottom",textColor:"#111",padding:25,format:function(e){return"".concat(e/this.step,":00")}},{step:3e5,width:7,xbase:63,lineWidth:1,color:"#333",textOut:!1,font:"500 14px Arial",textBaseline:"bottom",textColor:"#111",padding:25,format:function(e){return"".concat(e/this.step,":00")}}]},{min:3e3,max:7e3,tags:[{step:36e5,width:20,xbase:63,lineWidth:1,color:"#000",textOut:!0,font:"500 14px Arial",textBaseline:"bottom",textColor:"#000",padding:25,format:function(e){return"".concat(1*e/this.step,":00")}},{step:18e5,width:15,xbase:63,lineWidth:1,color:"#333",textOut:!0,font:"500 14px Arial",textBaseline:"bottom",textColor:"#000",padding:25,format:function(e){return"".concat(Math.floor(.5*e/this.step),":30")}},{step:3e5,width:7,xbase:63,lineWidth:1,color:"#333",textOut:!1,font:"500 12px Arial",textBaseline:"bottom",textColor:"#111",padding:10,format:function(e){var t=.5*e/18e5,n=Math.floor(.5*e/18e5),r=Math.round(60*(t-n));return"".concat(n,":").concat(r)}}]},{min:7e3,max:1/0,tags:[{step:36e5,width:20,xbase:63,lineWidth:1,color:"#000",textOut:!0,font:"500 14px Arial",textBaseline:"bottom",textColor:"#000",padding:25,format:function(e){return"".concat(1*e/this.step,":00")}},{step:18e5,width:15,xbase:63,lineWidth:1,color:"#333",textOut:!0,font:"500 14px Arial",textBaseline:"bottom",textColor:"#000",padding:25,format:function(e){return"".concat(Math.floor(.5*e/this.step),":30")}},{step:3e5,width:7,xbase:63,lineWidth:1,color:"#333",textOut:!0,font:"500 12px Arial",textBaseline:"bottom",textColor:"#111",padding:10,format:function(e){var t=.5*e/18e5,n=Math.floor(.5*e/18e5),r=Math.round(60*(t-n));return r<10&&(r="0".concat(r)),"".concat(n,":").concat(r)}},{step:6e4,width:3,xbase:63,lineWidth:1,color:"#333",textOut:!1,font:"500 12px Arial",textBaseline:"bottom",textColor:"#111",padding:10,format:function(){}}]}],searchFaces:{redSquareMargin:.05},playspeed:[-8,-4,-3,-2,-1,1,2,3,4,8]};r.zoomDelta=Math.pow(r.zoomMax,1/r.zoomSteps)-1;var i=r,a={locale:{},settings:i,scale:0,lastDate:{}};t.a=a},918:function(e,t,n){n(399),n(413),e.exports=n(1140)},93:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"b",function(){return a}),n.d(t,"c",function(){return o});var r=n(134),i=new Intl.Collator(r.b,{sensitivity:"base"}).compare,a=function(e,t){return Math.sign(e-t)};function o(e,t,n){var r=n.slice();return Array.prototype.sort.call(r,function(n,r){for(var i=0,a=0;a<t.length&&0===i;a+=1){var o=e[a];i=t[a](n[o],r[o])}return i})}},95:function(e,t,n){"use strict";n.d(t,"b",function(){return v}),n.d(t,"a",function(){return y}),n.d(t,"c",function(){return g});n(139);var r=n(160),i=n.n(r),a=n(7),o=n.n(a),c=n(3),s=n.n(c),u=n(32),l=n.n(u),p=n(6),f=n.n(p),h=n(286),d=n.n(h),m=n(287),b=n.n(m);function v(e){for(var t=[],n=e,r=0;r<4;r+=1)t.push(String.fromCharCode(255&n)),n>>=8;return t.join("")}var y=function(e){return/DeviceIpint/.test(e)},g=f()([i()(","),o()(d.a),l()(b.a)]);f()([JSON.parse,s()("objects"),l()(function(e){var t=e.name;return t.includes("DeviceIpint")})])}});